function kg(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(i,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var au=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ku(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Qa(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){var a=!1;try{a=this instanceof i}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var a=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:function(){return n[i]}})}),t}var Rd={exports:{}},Va={},Md={exports:{}},ct={};var $0;function av(){if($0)return ct;$0=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),f=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),A=Symbol.iterator;function b(X){return X===null||typeof X!="object"?null:(X=A&&X[A]||X["@@iterator"],typeof X=="function"?X:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,U={};function F(X,le,qe){this.props=X,this.context=le,this.refs=U,this.updater=qe||k}F.prototype.isReactComponent={},F.prototype.setState=function(X,le){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,le,"setState")},F.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function W(){}W.prototype=F.prototype;function $(X,le,qe){this.props=X,this.context=le,this.refs=U,this.updater=qe||k}var G=$.prototype=new W;G.constructor=$,O(G,F.prototype),G.isPureReactComponent=!0;var J=Array.isArray,de=Object.prototype.hasOwnProperty,ue={current:null},ee={key:!0,ref:!0,__self:!0,__source:!0};function Te(X,le,qe){var De,at={},Ce=null,St=null;if(le!=null)for(De in le.ref!==void 0&&(St=le.ref),le.key!==void 0&&(Ce=""+le.key),le)de.call(le,De)&&!ee.hasOwnProperty(De)&&(at[De]=le[De]);var Ze=arguments.length-2;if(Ze===1)at.children=qe;else if(1<Ze){for(var At=Array(Ze),pn=0;pn<Ze;pn++)At[pn]=arguments[pn+2];at.children=At}if(X&&X.defaultProps)for(De in Ze=X.defaultProps,Ze)at[De]===void 0&&(at[De]=Ze[De]);return{$$typeof:n,type:X,key:Ce,ref:St,props:at,_owner:ue.current}}function Z(X,le){return{$$typeof:n,type:X.type,key:le,ref:X.ref,props:X.props,_owner:X._owner}}function Se(X){return typeof X=="object"&&X!==null&&X.$$typeof===n}function Pe(X){var le={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(qe){return le[qe]})}var Ie=/\/+/g;function Ne(X,le){return typeof X=="object"&&X!==null&&X.key!=null?Pe(""+X.key):le.toString(36)}function We(X,le,qe,De,at){var Ce=typeof X;(Ce==="undefined"||Ce==="boolean")&&(X=null);var St=!1;if(X===null)St=!0;else switch(Ce){case"string":case"number":St=!0;break;case"object":switch(X.$$typeof){case n:case e:St=!0}}if(St)return St=X,at=at(St),X=De===""?"."+Ne(St,0):De,J(at)?(qe="",X!=null&&(qe=X.replace(Ie,"$&/")+"/"),We(at,le,qe,"",function(pn){return pn})):at!=null&&(Se(at)&&(at=Z(at,qe+(!at.key||St&&St.key===at.key?"":(""+at.key).replace(Ie,"$&/")+"/")+X)),le.push(at)),1;if(St=0,De=De===""?".":De+":",J(X))for(var Ze=0;Ze<X.length;Ze++){Ce=X[Ze];var At=De+Ne(Ce,Ze);St+=We(Ce,le,qe,At,at)}else if(At=b(X),typeof At=="function")for(X=At.call(X),Ze=0;!(Ce=X.next()).done;)Ce=Ce.value,At=De+Ne(Ce,Ze++),St+=We(Ce,le,qe,At,at);else if(Ce==="object")throw le=String(X),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.");return St}function ie(X,le,qe){if(X==null)return X;var De=[],at=0;return We(X,De,"","",function(Ce){return le.call(qe,Ce,at++)}),De}function ve(X){if(X._status===-1){var le=X._result;le=le(),le.then(function(qe){(X._status===0||X._status===-1)&&(X._status=1,X._result=qe)},function(qe){(X._status===0||X._status===-1)&&(X._status=2,X._result=qe)}),X._status===-1&&(X._status=0,X._result=le)}if(X._status===1)return X._result.default;throw X._result}var me={current:null},pe={transition:null},be={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:pe,ReactCurrentOwner:ue};function we(){throw Error("act(...) is not supported in production builds of React.")}return ct.Children={map:ie,forEach:function(X,le,qe){ie(X,function(){le.apply(this,arguments)},qe)},count:function(X){var le=0;return ie(X,function(){le++}),le},toArray:function(X){return ie(X,function(le){return le})||[]},only:function(X){if(!Se(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},ct.Component=F,ct.Fragment=t,ct.Profiler=a,ct.PureComponent=$,ct.StrictMode=i,ct.Suspense=v,ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=be,ct.act=we,ct.cloneElement=function(X,le,qe){if(X==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+X+".");var De=O({},X.props),at=X.key,Ce=X.ref,St=X._owner;if(le!=null){if(le.ref!==void 0&&(Ce=le.ref,St=ue.current),le.key!==void 0&&(at=""+le.key),X.type&&X.type.defaultProps)var Ze=X.type.defaultProps;for(At in le)de.call(le,At)&&!ee.hasOwnProperty(At)&&(De[At]=le[At]===void 0&&Ze!==void 0?Ze[At]:le[At])}var At=arguments.length-2;if(At===1)De.children=qe;else if(1<At){Ze=Array(At);for(var pn=0;pn<At;pn++)Ze[pn]=arguments[pn+2];De.children=Ze}return{$$typeof:n,type:X.type,key:at,ref:Ce,props:De,_owner:St}},ct.createContext=function(X){return X={$$typeof:f,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},X.Provider={$$typeof:l,_context:X},X.Consumer=X},ct.createElement=Te,ct.createFactory=function(X){var le=Te.bind(null,X);return le.type=X,le},ct.createRef=function(){return{current:null}},ct.forwardRef=function(X){return{$$typeof:x,render:X}},ct.isValidElement=Se,ct.lazy=function(X){return{$$typeof:_,_payload:{_status:-1,_result:X},_init:ve}},ct.memo=function(X,le){return{$$typeof:p,type:X,compare:le===void 0?null:le}},ct.startTransition=function(X){var le=pe.transition;pe.transition={};try{X()}finally{pe.transition=le}},ct.unstable_act=we,ct.useCallback=function(X,le){return me.current.useCallback(X,le)},ct.useContext=function(X){return me.current.useContext(X)},ct.useDebugValue=function(){},ct.useDeferredValue=function(X){return me.current.useDeferredValue(X)},ct.useEffect=function(X,le){return me.current.useEffect(X,le)},ct.useId=function(){return me.current.useId()},ct.useImperativeHandle=function(X,le,qe){return me.current.useImperativeHandle(X,le,qe)},ct.useInsertionEffect=function(X,le){return me.current.useInsertionEffect(X,le)},ct.useLayoutEffect=function(X,le){return me.current.useLayoutEffect(X,le)},ct.useMemo=function(X,le){return me.current.useMemo(X,le)},ct.useReducer=function(X,le,qe){return me.current.useReducer(X,le,qe)},ct.useRef=function(X){return me.current.useRef(X)},ct.useState=function(X){return me.current.useState(X)},ct.useSyncExternalStore=function(X,le,qe){return me.current.useSyncExternalStore(X,le,qe)},ct.useTransition=function(){return me.current.useTransition()},ct.version="18.3.1",ct}var K0;function kf(){return K0||(K0=1,Md.exports=av()),Md.exports}var X0;function lv(){if(X0)return Va;X0=1;var n=kf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function f(x,v,p){var _,A={},b=null,k=null;p!==void 0&&(b=""+p),v.key!==void 0&&(b=""+v.key),v.ref!==void 0&&(k=v.ref);for(_ in v)i.call(v,_)&&!l.hasOwnProperty(_)&&(A[_]=v[_]);if(x&&x.defaultProps)for(_ in v=x.defaultProps,v)A[_]===void 0&&(A[_]=v[_]);return{$$typeof:e,type:x,key:b,ref:k,props:A,_owner:a.current}}return Va.Fragment=t,Va.jsx=f,Va.jsxs=f,Va}var J0;function uv(){return J0||(J0=1,Rd.exports=lv()),Rd.exports}var M=uv(),Je=kf();const nn=Ku(Je);var lu={},kd={exports:{}},ur={},Pd={exports:{}},Dd={};var Q0;function cv(){return Q0||(Q0=1,(function(n){function e(pe,be){var we=pe.length;pe.push(be);e:for(;0<we;){var X=we-1>>>1,le=pe[X];if(0<a(le,be))pe[X]=be,pe[we]=le,we=X;else break e}}function t(pe){return pe.length===0?null:pe[0]}function i(pe){if(pe.length===0)return null;var be=pe[0],we=pe.pop();if(we!==be){pe[0]=we;e:for(var X=0,le=pe.length,qe=le>>>1;X<qe;){var De=2*(X+1)-1,at=pe[De],Ce=De+1,St=pe[Ce];if(0>a(at,we))Ce<le&&0>a(St,at)?(pe[X]=St,pe[Ce]=we,X=Ce):(pe[X]=at,pe[De]=we,X=De);else if(Ce<le&&0>a(St,we))pe[X]=St,pe[Ce]=we,X=Ce;else break e}}return be}function a(pe,be){var we=pe.sortIndex-be.sortIndex;return we!==0?we:pe.id-be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var f=Date,x=f.now();n.unstable_now=function(){return f.now()-x}}var v=[],p=[],_=1,A=null,b=3,k=!1,O=!1,U=!1,F=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(pe){for(var be=t(p);be!==null;){if(be.callback===null)i(p);else if(be.startTime<=pe)i(p),be.sortIndex=be.expirationTime,e(v,be);else break;be=t(p)}}function J(pe){if(U=!1,G(pe),!O)if(t(v)!==null)O=!0,ve(de);else{var be=t(p);be!==null&&me(J,be.startTime-pe)}}function de(pe,be){O=!1,U&&(U=!1,W(Te),Te=-1),k=!0;var we=b;try{for(G(be),A=t(v);A!==null&&(!(A.expirationTime>be)||pe&&!Pe());){var X=A.callback;if(typeof X=="function"){A.callback=null,b=A.priorityLevel;var le=X(A.expirationTime<=be);be=n.unstable_now(),typeof le=="function"?A.callback=le:A===t(v)&&i(v),G(be)}else i(v);A=t(v)}if(A!==null)var qe=!0;else{var De=t(p);De!==null&&me(J,De.startTime-be),qe=!1}return qe}finally{A=null,b=we,k=!1}}var ue=!1,ee=null,Te=-1,Z=5,Se=-1;function Pe(){return!(n.unstable_now()-Se<Z)}function Ie(){if(ee!==null){var pe=n.unstable_now();Se=pe;var be=!0;try{be=ee(!0,pe)}finally{be?Ne():(ue=!1,ee=null)}}else ue=!1}var Ne;if(typeof $=="function")Ne=function(){$(Ie)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,ie=We.port2;We.port1.onmessage=Ie,Ne=function(){ie.postMessage(null)}}else Ne=function(){F(Ie,0)};function ve(pe){ee=pe,ue||(ue=!0,Ne())}function me(pe,be){Te=F(function(){pe(n.unstable_now())},be)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(pe){pe.callback=null},n.unstable_continueExecution=function(){O||k||(O=!0,ve(de))},n.unstable_forceFrameRate=function(pe){0>pe||125<pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<pe?Math.floor(1e3/pe):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_getFirstCallbackNode=function(){return t(v)},n.unstable_next=function(pe){switch(b){case 1:case 2:case 3:var be=3;break;default:be=b}var we=b;b=be;try{return pe()}finally{b=we}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(pe,be){switch(pe){case 1:case 2:case 3:case 4:case 5:break;default:pe=3}var we=b;b=pe;try{return be()}finally{b=we}},n.unstable_scheduleCallback=function(pe,be,we){var X=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?X+we:X):we=X,pe){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=we+le,pe={id:_++,callback:be,priorityLevel:pe,startTime:we,expirationTime:le,sortIndex:-1},we>X?(pe.sortIndex=we,e(p,pe),t(v)===null&&pe===t(p)&&(U?(W(Te),Te=-1):U=!0,me(J,we-X))):(pe.sortIndex=le,e(v,pe),O||k||(O=!0,ve(de))),pe},n.unstable_shouldYield=Pe,n.unstable_wrapCallback=function(pe){var be=b;return function(){var we=b;b=be;try{return pe.apply(this,arguments)}finally{b=we}}}})(Dd)),Dd}var Z0;function dv(){return Z0||(Z0=1,Pd.exports=cv()),Pd.exports}var ep;function fv(){if(ep)return ur;ep=1;var n=kf(),e=dv();function t(s){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+s,m=1;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,a={};function l(s,c){f(s,c),f(s+"Capture",c)}function f(s,c){for(a[s]=c,s=0;s<c.length;s++)i.add(c[s])}var x=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_={},A={};function b(s){return v.call(A,s)?!0:v.call(_,s)?!1:p.test(s)?A[s]=!0:(_[s]=!0,!1)}function k(s,c,m,C){if(m!==null&&m.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return C?!1:m!==null?!m.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function O(s,c,m,C){if(c===null||typeof c>"u"||k(s,c,m,C))return!0;if(C)return!1;if(m!==null)switch(m.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function U(s,c,m,C,I,N,L){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=C,this.attributeNamespace=I,this.mustUseProperty=m,this.propertyName=s,this.type=c,this.sanitizeURL=N,this.removeEmptyString=L}var F={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){F[s]=new U(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var c=s[0];F[c]=new U(c,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){F[s]=new U(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){F[s]=new U(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){F[s]=new U(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){F[s]=new U(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){F[s]=new U(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){F[s]=new U(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){F[s]=new U(s,5,!1,s.toLowerCase(),null,!1,!1)});var W=/[\-:]([a-z])/g;function $(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var c=s.replace(W,$);F[c]=new U(c,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var c=s.replace(W,$);F[c]=new U(c,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var c=s.replace(W,$);F[c]=new U(c,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){F[s]=new U(s,1,!1,s.toLowerCase(),null,!1,!1)}),F.xlinkHref=new U("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){F[s]=new U(s,1,!1,s.toLowerCase(),null,!0,!0)});function G(s,c,m,C){var I=F.hasOwnProperty(c)?F[c]:null;(I!==null?I.type!==0:C||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(O(c,m,I,C)&&(m=null),C||I===null?b(c)&&(m===null?s.removeAttribute(c):s.setAttribute(c,""+m)):I.mustUseProperty?s[I.propertyName]=m===null?I.type===3?!1:"":m:(c=I.attributeName,C=I.attributeNamespace,m===null?s.removeAttribute(c):(I=I.type,m=I===3||I===4&&m===!0?"":""+m,C?s.setAttributeNS(C,c,m):s.setAttribute(c,m))))}var J=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,de=Symbol.for("react.element"),ue=Symbol.for("react.portal"),ee=Symbol.for("react.fragment"),Te=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),Se=Symbol.for("react.provider"),Pe=Symbol.for("react.context"),Ie=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),pe=Symbol.iterator;function be(s){return s===null||typeof s!="object"?null:(s=pe&&s[pe]||s["@@iterator"],typeof s=="function"?s:null)}var we=Object.assign,X;function le(s){if(X===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);X=c&&c[1]||""}return`
`+X+s}var qe=!1;function De(s,c){if(!s||qe)return"";qe=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ae){var C=ae}Reflect.construct(s,[],c)}else{try{c.call()}catch(ae){C=ae}s.call(c.prototype)}else{try{throw Error()}catch(ae){C=ae}s()}}catch(ae){if(ae&&C&&typeof ae.stack=="string"){for(var I=ae.stack.split(`
`),N=C.stack.split(`
`),L=I.length-1,z=N.length-1;1<=L&&0<=z&&I[L]!==N[z];)z--;for(;1<=L&&0<=z;L--,z--)if(I[L]!==N[z]){if(L!==1||z!==1)do if(L--,z--,0>z||I[L]!==N[z]){var q=`
`+I[L].replace(" at new "," at ");return s.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",s.displayName)),q}while(1<=L&&0<=z);break}}}finally{qe=!1,Error.prepareStackTrace=m}return(s=s?s.displayName||s.name:"")?le(s):""}function at(s){switch(s.tag){case 5:return le(s.type);case 16:return le("Lazy");case 13:return le("Suspense");case 19:return le("SuspenseList");case 0:case 2:case 15:return s=De(s.type,!1),s;case 11:return s=De(s.type.render,!1),s;case 1:return s=De(s.type,!0),s;default:return""}}function Ce(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ee:return"Fragment";case ue:return"Portal";case Z:return"Profiler";case Te:return"StrictMode";case Ne:return"Suspense";case We:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Pe:return(s.displayName||"Context")+".Consumer";case Se:return(s._context.displayName||"Context")+".Provider";case Ie:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ie:return c=s.displayName||null,c!==null?c:Ce(s.type)||"Memo";case ve:c=s._payload,s=s._init;try{return Ce(s(c))}catch{}}return null}function St(s){var c=s.type;switch(s.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=c.render,s=s.displayName||s.name||"",c.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ce(c);case 8:return c===Te?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ze(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function At(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function pn(s){var c=At(s)?"checked":"value",m=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),C=""+s[c];if(!s.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var I=m.get,N=m.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return I.call(this)},set:function(L){C=""+L,N.call(this,L)}}),Object.defineProperty(s,c,{enumerable:m.enumerable}),{getValue:function(){return C},setValue:function(L){C=""+L},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function gn(s){s._valueTracker||(s._valueTracker=pn(s))}function xs(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var m=c.getValue(),C="";return s&&(C=At(s)?s.checked?"true":"false":s.value),s=C,s!==m?(c.setValue(s),!0):!1}function pt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ii(s,c){var m=c.checked;return we({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??s._wrapperState.initialChecked})}function fr(s,c){var m=c.defaultValue==null?"":c.defaultValue,C=c.checked!=null?c.checked:c.defaultChecked;m=Ze(c.value!=null?c.value:m),s._wrapperState={initialChecked:C,initialValue:m,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Fi(s,c){c=c.checked,c!=null&&G(s,"checked",c,!1)}function rn(s,c){Fi(s,c);var m=Ze(c.value),C=c.type;if(m!=null)C==="number"?(m===0&&s.value===""||s.value!=m)&&(s.value=""+m):s.value!==""+m&&(s.value=""+m);else if(C==="submit"||C==="reset"){s.removeAttribute("value");return}c.hasOwnProperty("value")?dt(s,c.type,m):c.hasOwnProperty("defaultValue")&&dt(s,c.type,Ze(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(s.defaultChecked=!!c.defaultChecked)}function Nt(s,c,m){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var C=c.type;if(!(C!=="submit"&&C!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+s._wrapperState.initialValue,m||c===s.value||(s.value=c),s.defaultValue=c}m=s.name,m!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,m!==""&&(s.name=m)}function dt(s,c,m){(c!=="number"||pt(s.ownerDocument)!==s)&&(m==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+m&&(s.defaultValue=""+m))}var si=Array.isArray;function Oe(s,c,m,C){if(s=s.options,c){c={};for(var I=0;I<m.length;I++)c["$"+m[I]]=!0;for(m=0;m<s.length;m++)I=c.hasOwnProperty("$"+s[m].value),s[m].selected!==I&&(s[m].selected=I),I&&C&&(s[m].defaultSelected=!0)}else{for(m=""+Ze(m),c=null,I=0;I<s.length;I++){if(s[I].value===m){s[I].selected=!0,C&&(s[I].defaultSelected=!0);return}c!==null||s[I].disabled||(c=s[I])}c!==null&&(c.selected=!0)}}function Ui(s,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return we({},c,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Zo(s,c){var m=c.value;if(m==null){if(m=c.children,c=c.defaultValue,m!=null){if(c!=null)throw Error(t(92));if(si(m)){if(1<m.length)throw Error(t(93));m=m[0]}c=m}c==null&&(c=""),m=c}s._wrapperState={initialValue:Ze(m)}}function br(s,c){var m=Ze(c.value),C=Ze(c.defaultValue);m!=null&&(m=""+m,m!==s.value&&(s.value=m),c.defaultValue==null&&s.defaultValue!==m&&(s.defaultValue=m)),C!=null&&(s.defaultValue=""+C)}function to(s){var c=s.textContent;c===s._wrapperState.initialValue&&c!==""&&c!==null&&(s.value=c)}function er(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function no(s,c){return s==null||s==="http://www.w3.org/1999/xhtml"?er(c):s==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var hr,Cn=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,m,C,I){MSApp.execUnsafeLocalFunction(function(){return s(c,m,C,I)})}:s})(function(s,c){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=c;else{for(hr=hr||document.createElement("div"),hr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=hr.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;c.firstChild;)s.appendChild(c.firstChild)}});function Vi(s,c){if(c){var m=s.firstChild;if(m&&m===s.lastChild&&m.nodeType===3){m.nodeValue=c;return}}s.textContent=c}var oi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uc=["Webkit","ms","Moz","O"];Object.keys(oi).forEach(function(s){uc.forEach(function(c){c=c+s.charAt(0).toUpperCase()+s.substring(1),oi[c]=oi[s]})});function Yt(s,c,m){return c==null||typeof c=="boolean"||c===""?"":m||typeof c!="number"||c===0||oi.hasOwnProperty(s)&&oi[s]?(""+c).trim():c+"px"}function Ae(s,c){s=s.style;for(var m in c)if(c.hasOwnProperty(m)){var C=m.indexOf("--")===0,I=Yt(m,c[m],C);m==="float"&&(m="cssFloat"),C?s.setProperty(m,I):s[m]=I}}var sn=we({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _t(s,c){if(c){if(sn[s]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Ot(s,c){if(s.indexOf("-")===-1)return typeof c.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yi=null;function vs(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ro=null,ut=null,tr=null;function ea(s){if(s=Aa(s)){if(typeof ro!="function")throw Error(t(280));var c=s.stateNode;c&&(c=_l(c),ro(s.stateNode,s.type,c))}}function ta(s){ut?tr?tr.push(s):tr=[s]:ut=s}function nr(){if(ut){var s=ut,c=tr;if(tr=ut=null,ea(s),c)for(s=0;s<c.length;s++)ea(c[s])}}function io(s,c){return s(c)}function mn(){}var ai=!1;function ws(s,c,m){if(ai)return s(c,m);ai=!0;try{return io(s,c,m)}finally{ai=!1,(ut!==null||tr!==null)&&(mn(),nr())}}function Fn(s,c){var m=s.stateNode;if(m===null)return null;var C=_l(m);if(C===null)return null;m=C[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(s=s.type,C=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!C;break e;default:s=!1}if(s)return null;if(m&&typeof m!="function")throw Error(t(231,c,typeof m));return m}var na=!1;if(x)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){na=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{na=!1}function ra(s,c,m,C,I,N,L,z,q){var ae=Array.prototype.slice.call(arguments,3);try{c.apply(m,ae)}catch(ge){this.onError(ge)}}var cn=!1,Nr=null,Rn=!1,Me=null,Hi={onError:function(s){cn=!0,Nr=s}};function ia(s,c,m,C,I,N,L,z,q){cn=!1,Nr=null,ra.apply(Hi,arguments)}function Un(s,c,m,C,I,N,L,z,q){if(ia.apply(this,arguments),cn){if(cn){var ae=Nr;cn=!1,Nr=null}else throw Error(t(198));Rn||(Rn=!0,Me=ae)}}function rr(s){var c=s,m=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(m=c.return),s=c.return;while(s)}return c.tag===3?m:null}function Es(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function _s(s){if(rr(s)!==s)throw Error(t(188))}function Rr(s){var c=s.alternate;if(!c){if(c=rr(s),c===null)throw Error(t(188));return c!==s?null:s}for(var m=s,C=c;;){var I=m.return;if(I===null)break;var N=I.alternate;if(N===null){if(C=I.return,C!==null){m=C;continue}break}if(I.child===N.child){for(N=I.child;N;){if(N===m)return _s(I),s;if(N===C)return _s(I),c;N=N.sibling}throw Error(t(188))}if(m.return!==C.return)m=I,C=N;else{for(var L=!1,z=I.child;z;){if(z===m){L=!0,m=I,C=N;break}if(z===C){L=!0,C=I,m=N;break}z=z.sibling}if(!L){for(z=N.child;z;){if(z===m){L=!0,m=N,C=I;break}if(z===C){L=!0,C=N,m=I;break}z=z.sibling}if(!L)throw Error(t(189))}}if(m.alternate!==C)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?s:c}function tl(s){return s=Rr(s),s!==null?nl(s):null}function nl(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var c=nl(s);if(c!==null)return c;s=s.sibling}return null}var gr=e.unstable_scheduleCallback,Sn=e.unstable_cancelCallback,Lt=e.unstable_shouldYield,rl=e.unstable_requestPaint,Tt=e.unstable_now,sa=e.unstable_getCurrentPriorityLevel,ce=e.unstable_ImmediatePriority,il=e.unstable_UserBlockingPriority,Pt=e.unstable_NormalPriority,Gi=e.unstable_LowPriority,sl=e.unstable_IdlePriority,mt=null,st=null;function ft(s){if(st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(mt,s,void 0,(s.current.flags&128)===128)}catch{}}var $n=Math.clz32?Math.clz32:on,oa=Math.log,aa=Math.LN2;function on(s){return s>>>=0,s===0?32:31-(oa(s)/aa|0)|0}var mr=64,so=4194304;function Dt(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function yr(s,c){var m=s.pendingLanes;if(m===0)return 0;var C=0,I=s.suspendedLanes,N=s.pingedLanes,L=m&268435455;if(L!==0){var z=L&~I;z!==0?C=Dt(z):(N&=L,N!==0&&(C=Dt(N)))}else L=m&~I,L!==0?C=Dt(L):N!==0&&(C=Dt(N));if(C===0)return 0;if(c!==0&&c!==C&&(c&I)===0&&(I=C&-C,N=c&-c,I>=N||I===16&&(N&4194240)!==0))return c;if((C&4)!==0&&(C|=m&16),c=s.entangledLanes,c!==0)for(s=s.entanglements,c&=C;0<c;)m=31-$n(c),I=1<<m,C|=s[m],c&=~I;return C}function cc(s,c){switch(s){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zi(s,c){for(var m=s.suspendedLanes,C=s.pingedLanes,I=s.expirationTimes,N=s.pendingLanes;0<N;){var L=31-$n(N),z=1<<L,q=I[L];q===-1?((z&m)===0||(z&C)!==0)&&(I[L]=cc(z,c)):q<=c&&(s.expiredLanes|=z),N&=~z}}function It(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yn(){var s=mr;return mr<<=1,(mr&4194240)===0&&(mr=64),s}function te(s){for(var c=[],m=0;31>m;m++)c.push(s);return c}function V(s,c,m){s.pendingLanes|=c,c!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,c=31-$n(c),s[c]=m}function ze(s,c){var m=s.pendingLanes&~c;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=c,s.mutableReadLanes&=c,s.entangledLanes&=c,c=s.entanglements;var C=s.eventTimes;for(s=s.expirationTimes;0<m;){var I=31-$n(m),N=1<<I;c[I]=0,C[I]=-1,s[I]=-1,m&=~N}}function Jt(s,c){var m=s.entangledLanes|=c;for(s=s.entanglements;m;){var C=31-$n(m),I=1<<C;I&c|s[C]&c&&(s[C]|=c),m&=~I}}var ot=0;function ol(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var oo,Vn,je,Bt,la,ua=!1,ji=[],xr=null,Mr=null,li=null,jt=new Map,Gr=new Map,Mn=[],Xe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function al(s,c){switch(s){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":li=null;break;case"pointerover":case"pointerout":jt.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gr.delete(c.pointerId)}}function tt(s,c,m,C,I,N){return s===null||s.nativeEvent!==N?(s={blockedOn:c,domEventName:m,eventSystemFlags:C,nativeEvent:N,targetContainers:[I]},c!==null&&(c=Aa(c),c!==null&&Vn(c)),s):(s.eventSystemFlags|=C,c=s.targetContainers,I!==null&&c.indexOf(I)===-1&&c.push(I),s)}function xn(s,c,m,C,I){switch(c){case"focusin":return xr=tt(xr,s,c,m,C,I),!0;case"dragenter":return Mr=tt(Mr,s,c,m,C,I),!0;case"mouseover":return li=tt(li,s,c,m,C,I),!0;case"pointerover":var N=I.pointerId;return jt.set(N,tt(jt.get(N)||null,s,c,m,C,I)),!0;case"gotpointercapture":return N=I.pointerId,Gr.set(N,tt(Gr.get(N)||null,s,c,m,C,I)),!0}return!1}function ll(s){var c=ks(s.target);if(c!==null){var m=rr(c);if(m!==null){if(c=m.tag,c===13){if(c=Es(m),c!==null){s.blockedOn=c,la(s.priority,function(){je(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){s.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}s.blockedOn=null}function qi(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var m=ao(s.domEventName,s.eventSystemFlags,c[0],s.nativeEvent);if(m===null){m=s.nativeEvent;var C=new m.constructor(m.type,m);yi=C,m.target.dispatchEvent(C),yi=null}else return c=Aa(m),c!==null&&Vn(c),s.blockedOn=m,!1;c.shift()}return!0}function ca(s,c,m){qi(s)&&m.delete(c)}function xi(){ua=!1,xr!==null&&qi(xr)&&(xr=null),Mr!==null&&qi(Mr)&&(Mr=null),li!==null&&qi(li)&&(li=null),jt.forEach(ca),Gr.forEach(ca)}function Cs(s,c){s.blockedOn===c&&(s.blockedOn=null,ua||(ua=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,xi)))}function zr(s){function c(I){return Cs(I,s)}if(0<ji.length){Cs(ji[0],s);for(var m=1;m<ji.length;m++){var C=ji[m];C.blockedOn===s&&(C.blockedOn=null)}}for(xr!==null&&Cs(xr,s),Mr!==null&&Cs(Mr,s),li!==null&&Cs(li,s),jt.forEach(c),Gr.forEach(c),m=0;m<Mn.length;m++)C=Mn[m],C.blockedOn===s&&(C.blockedOn=null);for(;0<Mn.length&&(m=Mn[0],m.blockedOn===null);)ll(m),m.blockedOn===null&&Mn.shift()}var kr=J.ReactCurrentBatchConfig,ui=!0;function ul(s,c,m,C){var I=ot,N=kr.transition;kr.transition=null;try{ot=1,vi(s,c,m,C)}finally{ot=I,kr.transition=N}}function Ss(s,c,m,C){var I=ot,N=kr.transition;kr.transition=null;try{ot=4,vi(s,c,m,C)}finally{ot=I,kr.transition=N}}function vi(s,c,m,C){if(ui){var I=ao(s,c,m,C);if(I===null)wc(s,c,C,vn,m),al(s,C);else if(xn(I,s,c,m,C))C.stopPropagation();else if(al(s,C),c&4&&-1<Xe.indexOf(s)){for(;I!==null;){var N=Aa(I);if(N!==null&&oo(N),N=ao(s,c,m,C),N===null&&wc(s,c,C,vn,m),N===I)break;I=N}I!==null&&C.stopPropagation()}else wc(s,c,C,null,m)}}var vn=null;function ao(s,c,m,C){if(vn=null,s=vs(C),s=ks(s),s!==null)if(c=rr(s),c===null)s=null;else if(m=c.tag,m===13){if(s=Es(c),s!==null)return s;s=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null);return vn=s,null}function da(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sa()){case ce:return 1;case il:return 4;case Pt:case Gi:return 16;case sl:return 536870912;default:return 16}default:return 16}}var jr=null,fa=null,lo=null;function cl(){if(lo)return lo;var s,c=fa,m=c.length,C,I="value"in jr?jr.value:jr.textContent,N=I.length;for(s=0;s<m&&c[s]===I[s];s++);var L=m-s;for(C=1;C<=L&&c[m-C]===I[N-C];C++);return lo=I.slice(s,1<C?1-C:void 0)}function yt(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function As(){return!0}function Ts(){return!1}function Qt(s){function c(m,C,I,N,L){this._reactName=m,this._targetInst=I,this.type=C,this.nativeEvent=N,this.target=L,this.currentTarget=null;for(var z in s)s.hasOwnProperty(z)&&(m=s[z],this[z]=m?m(N):N[z]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?As:Ts,this.isPropagationStopped=Ts,this}return we(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=As)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=As)},persist:function(){},isPersistent:As}),c}var Wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oe=Qt(Wi),rt=we({},Wi,{view:0,detail:0}),wn=Qt(rt),Yi,uo,Is,co=we({},rt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Is&&(Is&&s.type==="mousemove"?(Yi=s.screenX-Is.screenX,uo=s.screenY-Is.screenY):uo=Yi=0,Is=s),Yi)},movementY:function(s){return"movementY"in s?s.movementY:uo}}),dl=Qt(co),ha=we({},co,{dataTransfer:0}),an=Qt(ha),pa=we({},rt,{relatedTarget:0}),Ft=Qt(pa),fo=we({},Wi,{animationName:0,elapsedTime:0,pseudoElement:0}),wi=Qt(fo),Rt=we({},Wi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ye=Qt(Rt),dc=we({},Wi,{data:0}),kt=Qt(dc),Ei={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pr(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=fc[s])?!!c[s]:!1}function bs(){return Pr}var fl=we({},rt,{key:function(s){if(s.key){var c=Ei[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=yt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?$i[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bs,charCode:function(s){return s.type==="keypress"?yt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?yt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ga=Qt(fl),hl=we({},co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ma=Qt(hl),hc=we({},rt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bs}),Ki=Qt(hc),ya=we({},Wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),pc=Qt(ya),Ns=we({},co,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),gc=Qt(Ns),ci=[9,13,27,32],Xi=x&&"CompositionEvent"in window,An=null;x&&"documentMode"in document&&(An=document.documentMode);var pl=x&&"TextEvent"in window&&!An,vr=x&&(!Xi||An&&8<An&&11>=An),gl=" ",ho=!1;function ml(s,c){switch(s){case"keyup":return ci.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xa(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var kn=!1;function mc(s,c){switch(s){case"compositionend":return xa(c);case"keypress":return c.which!==32?null:(ho=!0,gl);case"textInput":return s=c.data,s===gl&&ho?null:s;default:return null}}function va(s,c){if(kn)return s==="compositionend"||!Xi&&ml(s,c)?(s=cl(),lo=fa=jr=null,kn=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return vr&&c.locale!=="ko"?null:c.data;default:return null}}var Rs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gt(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Rs[s.type]:c==="textarea"}function Ms(s,c,m,C){ta(C),c=vl(c,"onChange"),0<c.length&&(m=new oe("onChange","change",null,m,C),s.push({event:m,listeners:c}))}var P=null,r=null;function o(s){ch(s,0)}function u(s){var c=mo(s);if(xs(c))return s}function d(s,c){if(s==="change")return c}var h=!1;if(x){var g;if(x){var w="oninput"in document;if(!w){var S=document.createElement("div");S.setAttribute("oninput","return;"),w=typeof S.oninput=="function"}g=w}else g=!1;h=g&&(!document.documentMode||9<document.documentMode)}function T(){P&&(P.detachEvent("onpropertychange",R),r=P=null)}function R(s){if(s.propertyName==="value"&&u(r)){var c=[];Ms(c,r,s,vs(s)),ws(o,c)}}function D(s,c,m){s==="focusin"?(T(),P=c,r=m,P.attachEvent("onpropertychange",R)):s==="focusout"&&T()}function B(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return u(r)}function H(s,c){if(s==="click")return u(c)}function j(s,c){if(s==="input"||s==="change")return u(c)}function Y(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var Q=typeof Object.is=="function"?Object.is:Y;function se(s,c){if(Q(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var m=Object.keys(s),C=Object.keys(c);if(m.length!==C.length)return!1;for(C=0;C<m.length;C++){var I=m[C];if(!v.call(c,I)||!Q(s[I],c[I]))return!1}return!0}function xe(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ee(s,c){var m=xe(s);s=0;for(var C;m;){if(m.nodeType===3){if(C=s+m.textContent.length,s<=c&&C>=c)return{node:m,offset:c-s};s=C}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=xe(m)}}function he(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?he(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function lt(){for(var s=window,c=pt();c instanceof s.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)s=c.contentWindow;else break;c=pt(s.document)}return c}function nt(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}function Hn(s){var c=lt(),m=s.focusedElem,C=s.selectionRange;if(c!==m&&m&&m.ownerDocument&&he(m.ownerDocument.documentElement,m)){if(C!==null&&nt(m)){if(c=C.start,s=C.end,s===void 0&&(s=c),"selectionStart"in m)m.selectionStart=c,m.selectionEnd=Math.min(s,m.value.length);else if(s=(c=m.ownerDocument||document)&&c.defaultView||window,s.getSelection){s=s.getSelection();var I=m.textContent.length,N=Math.min(C.start,I);C=C.end===void 0?N:Math.min(C.end,I),!s.extend&&N>C&&(I=C,C=N,N=I),I=Ee(m,N);var L=Ee(m,C);I&&L&&(s.rangeCount!==1||s.anchorNode!==I.node||s.anchorOffset!==I.offset||s.focusNode!==L.node||s.focusOffset!==L.offset)&&(c=c.createRange(),c.setStart(I.node,I.offset),s.removeAllRanges(),N>C?(s.addRange(c),s.extend(L.node,L.offset)):(c.setEnd(L.node,L.offset),s.addRange(c)))}}for(c=[],s=m;s=s.parentNode;)s.nodeType===1&&c.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<c.length;m++)s=c[m],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var wr=x&&"documentMode"in document&&11>=document.documentMode,ln=null,Ct=null,$t=null,Pn=!1;function _i(s,c,m){var C=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Pn||ln==null||ln!==pt(C)||(C=ln,"selectionStart"in C&&nt(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),$t&&se($t,C)||($t=C,C=vl(Ct,"onSelect"),0<C.length&&(c=new oe("onSelect","select",null,c,m),s.push({event:c,listeners:C}),c.target=ln)))}function qr(s,c){var m={};return m[s.toLowerCase()]=c.toLowerCase(),m["Webkit"+s]="webkit"+c,m["Moz"+s]="moz"+c,m}var Ji={animationend:qr("Animation","AnimationEnd"),animationiteration:qr("Animation","AnimationIteration"),animationstart:qr("Animation","AnimationStart"),transitionend:qr("Transition","TransitionEnd")},wa={},nh={};x&&(nh=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function yl(s){if(wa[s])return wa[s];if(!Ji[s])return s;var c=Ji[s],m;for(m in c)if(c.hasOwnProperty(m)&&m in nh)return wa[s]=c[m];return s}var rh=yl("animationend"),ih=yl("animationiteration"),sh=yl("animationstart"),oh=yl("transitionend"),ah=new Map,lh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qi(s,c){ah.set(s,c),l(c,[s])}for(var yc=0;yc<lh.length;yc++){var xc=lh[yc],mx=xc.toLowerCase(),yx=xc[0].toUpperCase()+xc.slice(1);Qi(mx,"on"+yx)}Qi(rh,"onAnimationEnd"),Qi(ih,"onAnimationIteration"),Qi(sh,"onAnimationStart"),Qi("dblclick","onDoubleClick"),Qi("focusin","onFocus"),Qi("focusout","onBlur"),Qi(oh,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ea="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ea));function uh(s,c,m){var C=s.type||"unknown-event";s.currentTarget=m,Un(C,c,void 0,s),s.currentTarget=null}function ch(s,c){c=(c&4)!==0;for(var m=0;m<s.length;m++){var C=s[m],I=C.event;C=C.listeners;e:{var N=void 0;if(c)for(var L=C.length-1;0<=L;L--){var z=C[L],q=z.instance,ae=z.currentTarget;if(z=z.listener,q!==N&&I.isPropagationStopped())break e;uh(I,z,ae),N=q}else for(L=0;L<C.length;L++){if(z=C[L],q=z.instance,ae=z.currentTarget,z=z.listener,q!==N&&I.isPropagationStopped())break e;uh(I,z,ae),N=q}}}if(Rn)throw s=Me,Rn=!1,Me=null,s}function Ht(s,c){var m=c[Tc];m===void 0&&(m=c[Tc]=new Set);var C=s+"__bubble";m.has(C)||(dh(c,s,2,!1),m.add(C))}function vc(s,c,m){var C=0;c&&(C|=4),dh(m,s,C,c)}var xl="_reactListening"+Math.random().toString(36).slice(2);function _a(s){if(!s[xl]){s[xl]=!0,i.forEach(function(m){m!=="selectionchange"&&(xx.has(m)||vc(m,!1,s),vc(m,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[xl]||(c[xl]=!0,vc("selectionchange",!1,c))}}function dh(s,c,m,C){switch(da(c)){case 1:var I=ul;break;case 4:I=Ss;break;default:I=vi}m=I.bind(null,c,m,s),I=void 0,!na||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(I=!0),C?I!==void 0?s.addEventListener(c,m,{capture:!0,passive:I}):s.addEventListener(c,m,!0):I!==void 0?s.addEventListener(c,m,{passive:I}):s.addEventListener(c,m,!1)}function wc(s,c,m,C,I){var N=C;if((c&1)===0&&(c&2)===0&&C!==null)e:for(;;){if(C===null)return;var L=C.tag;if(L===3||L===4){var z=C.stateNode.containerInfo;if(z===I||z.nodeType===8&&z.parentNode===I)break;if(L===4)for(L=C.return;L!==null;){var q=L.tag;if((q===3||q===4)&&(q=L.stateNode.containerInfo,q===I||q.nodeType===8&&q.parentNode===I))return;L=L.return}for(;z!==null;){if(L=ks(z),L===null)return;if(q=L.tag,q===5||q===6){C=N=L;continue e}z=z.parentNode}}C=C.return}ws(function(){var ae=N,ge=vs(m),ye=[];e:{var fe=ah.get(s);if(fe!==void 0){var ke=oe,Ue=s;switch(s){case"keypress":if(yt(m)===0)break e;case"keydown":case"keyup":ke=ga;break;case"focusin":Ue="focus",ke=Ft;break;case"focusout":Ue="blur",ke=Ft;break;case"beforeblur":case"afterblur":ke=Ft;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=dl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=Ki;break;case rh:case ih:case sh:ke=wi;break;case oh:ke=pc;break;case"scroll":ke=wn;break;case"wheel":ke=gc;break;case"copy":case"cut":case"paste":ke=Ye;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=ma}var Ve=(c&4)!==0,un=!Ve&&s==="scroll",ne=Ve?fe!==null?fe+"Capture":null:fe;Ve=[];for(var K=ae,re;K!==null;){re=K;var _e=re.stateNode;if(re.tag===5&&_e!==null&&(re=_e,ne!==null&&(_e=Fn(K,ne),_e!=null&&Ve.push(Ca(K,_e,re)))),un)break;K=K.return}0<Ve.length&&(fe=new ke(fe,Ue,null,m,ge),ye.push({event:fe,listeners:Ve}))}}if((c&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",ke=s==="mouseout"||s==="pointerout",fe&&m!==yi&&(Ue=m.relatedTarget||m.fromElement)&&(ks(Ue)||Ue[Ci]))break e;if((ke||fe)&&(fe=ge.window===ge?ge:(fe=ge.ownerDocument)?fe.defaultView||fe.parentWindow:window,ke?(Ue=m.relatedTarget||m.toElement,ke=ae,Ue=Ue?ks(Ue):null,Ue!==null&&(un=rr(Ue),Ue!==un||Ue.tag!==5&&Ue.tag!==6)&&(Ue=null)):(ke=null,Ue=ae),ke!==Ue)){if(Ve=dl,_e="onMouseLeave",ne="onMouseEnter",K="mouse",(s==="pointerout"||s==="pointerover")&&(Ve=ma,_e="onPointerLeave",ne="onPointerEnter",K="pointer"),un=ke==null?fe:mo(ke),re=Ue==null?fe:mo(Ue),fe=new Ve(_e,K+"leave",ke,m,ge),fe.target=un,fe.relatedTarget=re,_e=null,ks(ge)===ae&&(Ve=new Ve(ne,K+"enter",Ue,m,ge),Ve.target=re,Ve.relatedTarget=un,_e=Ve),un=_e,ke&&Ue)t:{for(Ve=ke,ne=Ue,K=0,re=Ve;re;re=po(re))K++;for(re=0,_e=ne;_e;_e=po(_e))re++;for(;0<K-re;)Ve=po(Ve),K--;for(;0<re-K;)ne=po(ne),re--;for(;K--;){if(Ve===ne||ne!==null&&Ve===ne.alternate)break t;Ve=po(Ve),ne=po(ne)}Ve=null}else Ve=null;ke!==null&&fh(ye,fe,ke,Ve,!1),Ue!==null&&un!==null&&fh(ye,un,Ue,Ve,!0)}}e:{if(fe=ae?mo(ae):window,ke=fe.nodeName&&fe.nodeName.toLowerCase(),ke==="select"||ke==="input"&&fe.type==="file")var He=d;else if(gt(fe))if(h)He=j;else{He=B;var $e=D}else(ke=fe.nodeName)&&ke.toLowerCase()==="input"&&(fe.type==="checkbox"||fe.type==="radio")&&(He=H);if(He&&(He=He(s,ae))){Ms(ye,He,m,ge);break e}$e&&$e(s,fe,ae),s==="focusout"&&($e=fe._wrapperState)&&$e.controlled&&fe.type==="number"&&dt(fe,"number",fe.value)}switch($e=ae?mo(ae):window,s){case"focusin":(gt($e)||$e.contentEditable==="true")&&(ln=$e,Ct=ae,$t=null);break;case"focusout":$t=Ct=ln=null;break;case"mousedown":Pn=!0;break;case"contextmenu":case"mouseup":case"dragend":Pn=!1,_i(ye,m,ge);break;case"selectionchange":if(wr)break;case"keydown":case"keyup":_i(ye,m,ge)}var Ke;if(Xi)e:{switch(s){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else kn?ml(s,m)&&(et="onCompositionEnd"):s==="keydown"&&m.keyCode===229&&(et="onCompositionStart");et&&(vr&&m.locale!=="ko"&&(kn||et!=="onCompositionStart"?et==="onCompositionEnd"&&kn&&(Ke=cl()):(jr=ge,fa="value"in jr?jr.value:jr.textContent,kn=!0)),$e=vl(ae,et),0<$e.length&&(et=new kt(et,s,null,m,ge),ye.push({event:et,listeners:$e}),Ke?et.data=Ke:(Ke=xa(m),Ke!==null&&(et.data=Ke)))),(Ke=pl?mc(s,m):va(s,m))&&(ae=vl(ae,"onBeforeInput"),0<ae.length&&(ge=new kt("onBeforeInput","beforeinput",null,m,ge),ye.push({event:ge,listeners:ae}),ge.data=Ke))}ch(ye,c)})}function Ca(s,c,m){return{instance:s,listener:c,currentTarget:m}}function vl(s,c){for(var m=c+"Capture",C=[];s!==null;){var I=s,N=I.stateNode;I.tag===5&&N!==null&&(I=N,N=Fn(s,m),N!=null&&C.unshift(Ca(s,N,I)),N=Fn(s,c),N!=null&&C.push(Ca(s,N,I))),s=s.return}return C}function po(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function fh(s,c,m,C,I){for(var N=c._reactName,L=[];m!==null&&m!==C;){var z=m,q=z.alternate,ae=z.stateNode;if(q!==null&&q===C)break;z.tag===5&&ae!==null&&(z=ae,I?(q=Fn(m,N),q!=null&&L.unshift(Ca(m,q,z))):I||(q=Fn(m,N),q!=null&&L.push(Ca(m,q,z)))),m=m.return}L.length!==0&&s.push({event:c,listeners:L})}var vx=/\r\n?/g,wx=/\u0000|\uFFFD/g;function hh(s){return(typeof s=="string"?s:""+s).replace(vx,`
`).replace(wx,"")}function wl(s,c,m){if(c=hh(c),hh(s)!==c&&m)throw Error(t(425))}function El(){}var Ec=null,_c=null;function Cc(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Sc=typeof setTimeout=="function"?setTimeout:void 0,Ex=typeof clearTimeout=="function"?clearTimeout:void 0,ph=typeof Promise=="function"?Promise:void 0,_x=typeof queueMicrotask=="function"?queueMicrotask:typeof ph<"u"?function(s){return ph.resolve(null).then(s).catch(Cx)}:Sc;function Cx(s){setTimeout(function(){throw s})}function Ac(s,c){var m=c,C=0;do{var I=m.nextSibling;if(s.removeChild(m),I&&I.nodeType===8)if(m=I.data,m==="/$"){if(C===0){s.removeChild(I),zr(c);return}C--}else m!=="$"&&m!=="$?"&&m!=="$!"||C++;m=I}while(m);zr(c)}function Zi(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return s}function gh(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var m=s.data;if(m==="$"||m==="$!"||m==="$?"){if(c===0)return s;c--}else m==="/$"&&c++}s=s.previousSibling}return null}var go=Math.random().toString(36).slice(2),di="__reactFiber$"+go,Sa="__reactProps$"+go,Ci="__reactContainer$"+go,Tc="__reactEvents$"+go,Sx="__reactListeners$"+go,Ax="__reactHandles$"+go;function ks(s){var c=s[di];if(c)return c;for(var m=s.parentNode;m;){if(c=m[Ci]||m[di]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(s=gh(s);s!==null;){if(m=s[di])return m;s=gh(s)}return c}s=m,m=s.parentNode}return null}function Aa(s){return s=s[di]||s[Ci],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function mo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function _l(s){return s[Sa]||null}var Ic=[],yo=-1;function es(s){return{current:s}}function Gt(s){0>yo||(s.current=Ic[yo],Ic[yo]=null,yo--)}function Ut(s,c){yo++,Ic[yo]=s.current,s.current=c}var ts={},Gn=es(ts),ir=es(!1),Ps=ts;function xo(s,c){var m=s.type.contextTypes;if(!m)return ts;var C=s.stateNode;if(C&&C.__reactInternalMemoizedUnmaskedChildContext===c)return C.__reactInternalMemoizedMaskedChildContext;var I={},N;for(N in m)I[N]=c[N];return C&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=c,s.__reactInternalMemoizedMaskedChildContext=I),I}function sr(s){return s=s.childContextTypes,s!=null}function Cl(){Gt(ir),Gt(Gn)}function mh(s,c,m){if(Gn.current!==ts)throw Error(t(168));Ut(Gn,c),Ut(ir,m)}function yh(s,c,m){var C=s.stateNode;if(c=c.childContextTypes,typeof C.getChildContext!="function")return m;C=C.getChildContext();for(var I in C)if(!(I in c))throw Error(t(108,St(s)||"Unknown",I));return we({},m,C)}function Sl(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ts,Ps=Gn.current,Ut(Gn,s),Ut(ir,ir.current),!0}function xh(s,c,m){var C=s.stateNode;if(!C)throw Error(t(169));m?(s=yh(s,c,Ps),C.__reactInternalMemoizedMergedChildContext=s,Gt(ir),Gt(Gn),Ut(Gn,s)):Gt(ir),Ut(ir,m)}var Si=null,Al=!1,bc=!1;function vh(s){Si===null?Si=[s]:Si.push(s)}function Tx(s){Al=!0,vh(s)}function ns(){if(!bc&&Si!==null){bc=!0;var s=0,c=ot;try{var m=Si;for(ot=1;s<m.length;s++){var C=m[s];do C=C(!0);while(C!==null)}Si=null,Al=!1}catch(I){throw Si!==null&&(Si=Si.slice(s+1)),gr(ce,ns),I}finally{ot=c,bc=!1}}return null}var vo=[],wo=0,Tl=null,Il=0,Dr=[],Or=0,Ds=null,Ai=1,Ti="";function Os(s,c){vo[wo++]=Il,vo[wo++]=Tl,Tl=s,Il=c}function wh(s,c,m){Dr[Or++]=Ai,Dr[Or++]=Ti,Dr[Or++]=Ds,Ds=s;var C=Ai;s=Ti;var I=32-$n(C)-1;C&=~(1<<I),m+=1;var N=32-$n(c)+I;if(30<N){var L=I-I%5;N=(C&(1<<L)-1).toString(32),C>>=L,I-=L,Ai=1<<32-$n(c)+I|m<<I|C,Ti=N+s}else Ai=1<<N|m<<I|C,Ti=s}function Nc(s){s.return!==null&&(Os(s,1),wh(s,1,0))}function Rc(s){for(;s===Tl;)Tl=vo[--wo],vo[wo]=null,Il=vo[--wo],vo[wo]=null;for(;s===Ds;)Ds=Dr[--Or],Dr[Or]=null,Ti=Dr[--Or],Dr[Or]=null,Ai=Dr[--Or],Dr[Or]=null}var Er=null,_r=null,qt=!1,Wr=null;function Eh(s,c){var m=Ur(5,null,null,0);m.elementType="DELETED",m.stateNode=c,m.return=s,c=s.deletions,c===null?(s.deletions=[m],s.flags|=16):c.push(m)}function _h(s,c){switch(s.tag){case 5:var m=s.type;return c=c.nodeType!==1||m.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(s.stateNode=c,Er=s,_r=Zi(c.firstChild),!0):!1;case 6:return c=s.pendingProps===""||c.nodeType!==3?null:c,c!==null?(s.stateNode=c,Er=s,_r=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(m=Ds!==null?{id:Ai,overflow:Ti}:null,s.memoizedState={dehydrated:c,treeContext:m,retryLane:1073741824},m=Ur(18,null,null,0),m.stateNode=c,m.return=s,s.child=m,Er=s,_r=null,!0):!1;default:return!1}}function Mc(s){return(s.mode&1)!==0&&(s.flags&128)===0}function kc(s){if(qt){var c=_r;if(c){var m=c;if(!_h(s,c)){if(Mc(s))throw Error(t(418));c=Zi(m.nextSibling);var C=Er;c&&_h(s,c)?Eh(C,m):(s.flags=s.flags&-4097|2,qt=!1,Er=s)}}else{if(Mc(s))throw Error(t(418));s.flags=s.flags&-4097|2,qt=!1,Er=s}}}function Ch(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Er=s}function bl(s){if(s!==Er)return!1;if(!qt)return Ch(s),qt=!0,!1;var c;if((c=s.tag!==3)&&!(c=s.tag!==5)&&(c=s.type,c=c!=="head"&&c!=="body"&&!Cc(s.type,s.memoizedProps)),c&&(c=_r)){if(Mc(s))throw Sh(),Error(t(418));for(;c;)Eh(s,c),c=Zi(c.nextSibling)}if(Ch(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8){var m=s.data;if(m==="/$"){if(c===0){_r=Zi(s.nextSibling);break e}c--}else m!=="$"&&m!=="$!"&&m!=="$?"||c++}s=s.nextSibling}_r=null}}else _r=Er?Zi(s.stateNode.nextSibling):null;return!0}function Sh(){for(var s=_r;s;)s=Zi(s.nextSibling)}function Eo(){_r=Er=null,qt=!1}function Pc(s){Wr===null?Wr=[s]:Wr.push(s)}var Ix=J.ReactCurrentBatchConfig;function Ta(s,c,m){if(s=m.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var C=m.stateNode}if(!C)throw Error(t(147,s));var I=C,N=""+s;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===N?c.ref:(c=function(L){var z=I.refs;L===null?delete z[N]:z[N]=L},c._stringRef=N,c)}if(typeof s!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,s))}return s}function Nl(s,c){throw s=Object.prototype.toString.call(c),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s))}function Ah(s){var c=s._init;return c(s._payload)}function Th(s){function c(ne,K){if(s){var re=ne.deletions;re===null?(ne.deletions=[K],ne.flags|=16):re.push(K)}}function m(ne,K){if(!s)return null;for(;K!==null;)c(ne,K),K=K.sibling;return null}function C(ne,K){for(ne=new Map;K!==null;)K.key!==null?ne.set(K.key,K):ne.set(K.index,K),K=K.sibling;return ne}function I(ne,K){return ne=cs(ne,K),ne.index=0,ne.sibling=null,ne}function N(ne,K,re){return ne.index=re,s?(re=ne.alternate,re!==null?(re=re.index,re<K?(ne.flags|=2,K):re):(ne.flags|=2,K)):(ne.flags|=1048576,K)}function L(ne){return s&&ne.alternate===null&&(ne.flags|=2),ne}function z(ne,K,re,_e){return K===null||K.tag!==6?(K=Sd(re,ne.mode,_e),K.return=ne,K):(K=I(K,re),K.return=ne,K)}function q(ne,K,re,_e){var He=re.type;return He===ee?ge(ne,K,re.props.children,_e,re.key):K!==null&&(K.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ve&&Ah(He)===K.type)?(_e=I(K,re.props),_e.ref=Ta(ne,K,re),_e.return=ne,_e):(_e=Zl(re.type,re.key,re.props,null,ne.mode,_e),_e.ref=Ta(ne,K,re),_e.return=ne,_e)}function ae(ne,K,re,_e){return K===null||K.tag!==4||K.stateNode.containerInfo!==re.containerInfo||K.stateNode.implementation!==re.implementation?(K=Ad(re,ne.mode,_e),K.return=ne,K):(K=I(K,re.children||[]),K.return=ne,K)}function ge(ne,K,re,_e,He){return K===null||K.tag!==7?(K=zs(re,ne.mode,_e,He),K.return=ne,K):(K=I(K,re),K.return=ne,K)}function ye(ne,K,re){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Sd(""+K,ne.mode,re),K.return=ne,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case de:return re=Zl(K.type,K.key,K.props,null,ne.mode,re),re.ref=Ta(ne,null,K),re.return=ne,re;case ue:return K=Ad(K,ne.mode,re),K.return=ne,K;case ve:var _e=K._init;return ye(ne,_e(K._payload),re)}if(si(K)||be(K))return K=zs(K,ne.mode,re,null),K.return=ne,K;Nl(ne,K)}return null}function fe(ne,K,re,_e){var He=K!==null?K.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return He!==null?null:z(ne,K,""+re,_e);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case de:return re.key===He?q(ne,K,re,_e):null;case ue:return re.key===He?ae(ne,K,re,_e):null;case ve:return He=re._init,fe(ne,K,He(re._payload),_e)}if(si(re)||be(re))return He!==null?null:ge(ne,K,re,_e,null);Nl(ne,re)}return null}function ke(ne,K,re,_e,He){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return ne=ne.get(re)||null,z(K,ne,""+_e,He);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case de:return ne=ne.get(_e.key===null?re:_e.key)||null,q(K,ne,_e,He);case ue:return ne=ne.get(_e.key===null?re:_e.key)||null,ae(K,ne,_e,He);case ve:var $e=_e._init;return ke(ne,K,re,$e(_e._payload),He)}if(si(_e)||be(_e))return ne=ne.get(re)||null,ge(K,ne,_e,He,null);Nl(K,_e)}return null}function Ue(ne,K,re,_e){for(var He=null,$e=null,Ke=K,et=K=0,bn=null;Ke!==null&&et<re.length;et++){Ke.index>et?(bn=Ke,Ke=null):bn=Ke.sibling;var vt=fe(ne,Ke,re[et],_e);if(vt===null){Ke===null&&(Ke=bn);break}s&&Ke&&vt.alternate===null&&c(ne,Ke),K=N(vt,K,et),$e===null?He=vt:$e.sibling=vt,$e=vt,Ke=bn}if(et===re.length)return m(ne,Ke),qt&&Os(ne,et),He;if(Ke===null){for(;et<re.length;et++)Ke=ye(ne,re[et],_e),Ke!==null&&(K=N(Ke,K,et),$e===null?He=Ke:$e.sibling=Ke,$e=Ke);return qt&&Os(ne,et),He}for(Ke=C(ne,Ke);et<re.length;et++)bn=ke(Ke,ne,et,re[et],_e),bn!==null&&(s&&bn.alternate!==null&&Ke.delete(bn.key===null?et:bn.key),K=N(bn,K,et),$e===null?He=bn:$e.sibling=bn,$e=bn);return s&&Ke.forEach(function(ds){return c(ne,ds)}),qt&&Os(ne,et),He}function Ve(ne,K,re,_e){var He=be(re);if(typeof He!="function")throw Error(t(150));if(re=He.call(re),re==null)throw Error(t(151));for(var $e=He=null,Ke=K,et=K=0,bn=null,vt=re.next();Ke!==null&&!vt.done;et++,vt=re.next()){Ke.index>et?(bn=Ke,Ke=null):bn=Ke.sibling;var ds=fe(ne,Ke,vt.value,_e);if(ds===null){Ke===null&&(Ke=bn);break}s&&Ke&&ds.alternate===null&&c(ne,Ke),K=N(ds,K,et),$e===null?He=ds:$e.sibling=ds,$e=ds,Ke=bn}if(vt.done)return m(ne,Ke),qt&&Os(ne,et),He;if(Ke===null){for(;!vt.done;et++,vt=re.next())vt=ye(ne,vt.value,_e),vt!==null&&(K=N(vt,K,et),$e===null?He=vt:$e.sibling=vt,$e=vt);return qt&&Os(ne,et),He}for(Ke=C(ne,Ke);!vt.done;et++,vt=re.next())vt=ke(Ke,ne,et,vt.value,_e),vt!==null&&(s&&vt.alternate!==null&&Ke.delete(vt.key===null?et:vt.key),K=N(vt,K,et),$e===null?He=vt:$e.sibling=vt,$e=vt);return s&&Ke.forEach(function(ov){return c(ne,ov)}),qt&&Os(ne,et),He}function un(ne,K,re,_e){if(typeof re=="object"&&re!==null&&re.type===ee&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case de:e:{for(var He=re.key,$e=K;$e!==null;){if($e.key===He){if(He=re.type,He===ee){if($e.tag===7){m(ne,$e.sibling),K=I($e,re.props.children),K.return=ne,ne=K;break e}}else if($e.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ve&&Ah(He)===$e.type){m(ne,$e.sibling),K=I($e,re.props),K.ref=Ta(ne,$e,re),K.return=ne,ne=K;break e}m(ne,$e);break}else c(ne,$e);$e=$e.sibling}re.type===ee?(K=zs(re.props.children,ne.mode,_e,re.key),K.return=ne,ne=K):(_e=Zl(re.type,re.key,re.props,null,ne.mode,_e),_e.ref=Ta(ne,K,re),_e.return=ne,ne=_e)}return L(ne);case ue:e:{for($e=re.key;K!==null;){if(K.key===$e)if(K.tag===4&&K.stateNode.containerInfo===re.containerInfo&&K.stateNode.implementation===re.implementation){m(ne,K.sibling),K=I(K,re.children||[]),K.return=ne,ne=K;break e}else{m(ne,K);break}else c(ne,K);K=K.sibling}K=Ad(re,ne.mode,_e),K.return=ne,ne=K}return L(ne);case ve:return $e=re._init,un(ne,K,$e(re._payload),_e)}if(si(re))return Ue(ne,K,re,_e);if(be(re))return Ve(ne,K,re,_e);Nl(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,K!==null&&K.tag===6?(m(ne,K.sibling),K=I(K,re),K.return=ne,ne=K):(m(ne,K),K=Sd(re,ne.mode,_e),K.return=ne,ne=K),L(ne)):m(ne,K)}return un}var _o=Th(!0),Ih=Th(!1),Rl=es(null),Ml=null,Co=null,Dc=null;function Oc(){Dc=Co=Ml=null}function Lc(s){var c=Rl.current;Gt(Rl),s._currentValue=c}function Bc(s,c,m){for(;s!==null;){var C=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,C!==null&&(C.childLanes|=c)):C!==null&&(C.childLanes&c)!==c&&(C.childLanes|=c),s===m)break;s=s.return}}function So(s,c){Ml=s,Dc=Co=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&c)!==0&&(or=!0),s.firstContext=null)}function Lr(s){var c=s._currentValue;if(Dc!==s)if(s={context:s,memoizedValue:c,next:null},Co===null){if(Ml===null)throw Error(t(308));Co=s,Ml.dependencies={lanes:0,firstContext:s}}else Co=Co.next=s;return c}var Ls=null;function Fc(s){Ls===null?Ls=[s]:Ls.push(s)}function bh(s,c,m,C){var I=c.interleaved;return I===null?(m.next=m,Fc(c)):(m.next=I.next,I.next=m),c.interleaved=m,Ii(s,C)}function Ii(s,c){s.lanes|=c;var m=s.alternate;for(m!==null&&(m.lanes|=c),m=s,s=s.return;s!==null;)s.childLanes|=c,m=s.alternate,m!==null&&(m.childLanes|=c),m=s,s=s.return;return m.tag===3?m.stateNode:null}var rs=!1;function Uc(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nh(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function bi(s,c){return{eventTime:s,lane:c,tag:0,payload:null,callback:null,next:null}}function is(s,c,m){var C=s.updateQueue;if(C===null)return null;if(C=C.shared,(xt&2)!==0){var I=C.pending;return I===null?c.next=c:(c.next=I.next,I.next=c),C.pending=c,Ii(s,m)}return I=C.interleaved,I===null?(c.next=c,Fc(C)):(c.next=I.next,I.next=c),C.interleaved=c,Ii(s,m)}function kl(s,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194240)!==0)){var C=c.lanes;C&=s.pendingLanes,m|=C,c.lanes=m,Jt(s,m)}}function Rh(s,c){var m=s.updateQueue,C=s.alternate;if(C!==null&&(C=C.updateQueue,m===C)){var I=null,N=null;if(m=m.firstBaseUpdate,m!==null){do{var L={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};N===null?I=N=L:N=N.next=L,m=m.next}while(m!==null);N===null?I=N=c:N=N.next=c}else I=N=c;m={baseState:C.baseState,firstBaseUpdate:I,lastBaseUpdate:N,shared:C.shared,effects:C.effects},s.updateQueue=m;return}s=m.lastBaseUpdate,s===null?m.firstBaseUpdate=c:s.next=c,m.lastBaseUpdate=c}function Pl(s,c,m,C){var I=s.updateQueue;rs=!1;var N=I.firstBaseUpdate,L=I.lastBaseUpdate,z=I.shared.pending;if(z!==null){I.shared.pending=null;var q=z,ae=q.next;q.next=null,L===null?N=ae:L.next=ae,L=q;var ge=s.alternate;ge!==null&&(ge=ge.updateQueue,z=ge.lastBaseUpdate,z!==L&&(z===null?ge.firstBaseUpdate=ae:z.next=ae,ge.lastBaseUpdate=q))}if(N!==null){var ye=I.baseState;L=0,ge=ae=q=null,z=N;do{var fe=z.lane,ke=z.eventTime;if((C&fe)===fe){ge!==null&&(ge=ge.next={eventTime:ke,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Ue=s,Ve=z;switch(fe=c,ke=m,Ve.tag){case 1:if(Ue=Ve.payload,typeof Ue=="function"){ye=Ue.call(ke,ye,fe);break e}ye=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Ve.payload,fe=typeof Ue=="function"?Ue.call(ke,ye,fe):Ue,fe==null)break e;ye=we({},ye,fe);break e;case 2:rs=!0}}z.callback!==null&&z.lane!==0&&(s.flags|=64,fe=I.effects,fe===null?I.effects=[z]:fe.push(z))}else ke={eventTime:ke,lane:fe,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ge===null?(ae=ge=ke,q=ye):ge=ge.next=ke,L|=fe;if(z=z.next,z===null){if(z=I.shared.pending,z===null)break;fe=z,z=fe.next,fe.next=null,I.lastBaseUpdate=fe,I.shared.pending=null}}while(!0);if(ge===null&&(q=ye),I.baseState=q,I.firstBaseUpdate=ae,I.lastBaseUpdate=ge,c=I.shared.interleaved,c!==null){I=c;do L|=I.lane,I=I.next;while(I!==c)}else N===null&&(I.shared.lanes=0);Us|=L,s.lanes=L,s.memoizedState=ye}}function Mh(s,c,m){if(s=c.effects,c.effects=null,s!==null)for(c=0;c<s.length;c++){var C=s[c],I=C.callback;if(I!==null){if(C.callback=null,C=m,typeof I!="function")throw Error(t(191,I));I.call(C)}}}var Ia={},fi=es(Ia),ba=es(Ia),Na=es(Ia);function Bs(s){if(s===Ia)throw Error(t(174));return s}function Vc(s,c){switch(Ut(Na,c),Ut(ba,s),Ut(fi,Ia),s=c.nodeType,s){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:no(null,"");break;default:s=s===8?c.parentNode:c,c=s.namespaceURI||null,s=s.tagName,c=no(c,s)}Gt(fi),Ut(fi,c)}function Ao(){Gt(fi),Gt(ba),Gt(Na)}function kh(s){Bs(Na.current);var c=Bs(fi.current),m=no(c,s.type);c!==m&&(Ut(ba,s),Ut(fi,m))}function Hc(s){ba.current===s&&(Gt(fi),Gt(ba))}var Kt=es(0);function Dl(s){for(var c=s;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Gc=[];function zc(){for(var s=0;s<Gc.length;s++)Gc[s]._workInProgressVersionPrimary=null;Gc.length=0}var Ol=J.ReactCurrentDispatcher,jc=J.ReactCurrentBatchConfig,Fs=0,Xt=null,En=null,Tn=null,Ll=!1,Ra=!1,Ma=0,bx=0;function zn(){throw Error(t(321))}function qc(s,c){if(c===null)return!1;for(var m=0;m<c.length&&m<s.length;m++)if(!Q(s[m],c[m]))return!1;return!0}function Wc(s,c,m,C,I,N){if(Fs=N,Xt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Ol.current=s===null||s.memoizedState===null?kx:Px,s=m(C,I),Ra){N=0;do{if(Ra=!1,Ma=0,25<=N)throw Error(t(301));N+=1,Tn=En=null,c.updateQueue=null,Ol.current=Dx,s=m(C,I)}while(Ra)}if(Ol.current=Ul,c=En!==null&&En.next!==null,Fs=0,Tn=En=Xt=null,Ll=!1,c)throw Error(t(300));return s}function Yc(){var s=Ma!==0;return Ma=0,s}function hi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Xt.memoizedState=Tn=s:Tn=Tn.next=s,Tn}function Br(){if(En===null){var s=Xt.alternate;s=s!==null?s.memoizedState:null}else s=En.next;var c=Tn===null?Xt.memoizedState:Tn.next;if(c!==null)Tn=c,En=s;else{if(s===null)throw Error(t(310));En=s,s={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},Tn===null?Xt.memoizedState=Tn=s:Tn=Tn.next=s}return Tn}function ka(s,c){return typeof c=="function"?c(s):c}function $c(s){var c=Br(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=s;var C=En,I=C.baseQueue,N=m.pending;if(N!==null){if(I!==null){var L=I.next;I.next=N.next,N.next=L}C.baseQueue=I=N,m.pending=null}if(I!==null){N=I.next,C=C.baseState;var z=L=null,q=null,ae=N;do{var ge=ae.lane;if((Fs&ge)===ge)q!==null&&(q=q.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),C=ae.hasEagerState?ae.eagerState:s(C,ae.action);else{var ye={lane:ge,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};q===null?(z=q=ye,L=C):q=q.next=ye,Xt.lanes|=ge,Us|=ge}ae=ae.next}while(ae!==null&&ae!==N);q===null?L=C:q.next=z,Q(C,c.memoizedState)||(or=!0),c.memoizedState=C,c.baseState=L,c.baseQueue=q,m.lastRenderedState=C}if(s=m.interleaved,s!==null){I=s;do N=I.lane,Xt.lanes|=N,Us|=N,I=I.next;while(I!==s)}else I===null&&(m.lanes=0);return[c.memoizedState,m.dispatch]}function Kc(s){var c=Br(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=s;var C=m.dispatch,I=m.pending,N=c.memoizedState;if(I!==null){m.pending=null;var L=I=I.next;do N=s(N,L.action),L=L.next;while(L!==I);Q(N,c.memoizedState)||(or=!0),c.memoizedState=N,c.baseQueue===null&&(c.baseState=N),m.lastRenderedState=N}return[N,C]}function Ph(){}function Dh(s,c){var m=Xt,C=Br(),I=c(),N=!Q(C.memoizedState,I);if(N&&(C.memoizedState=I,or=!0),C=C.queue,Xc(Bh.bind(null,m,C,s),[s]),C.getSnapshot!==c||N||Tn!==null&&Tn.memoizedState.tag&1){if(m.flags|=2048,Pa(9,Lh.bind(null,m,C,I,c),void 0,null),In===null)throw Error(t(349));(Fs&30)!==0||Oh(m,c,I)}return I}function Oh(s,c,m){s.flags|=16384,s={getSnapshot:c,value:m},c=Xt.updateQueue,c===null?(c={lastEffect:null,stores:null},Xt.updateQueue=c,c.stores=[s]):(m=c.stores,m===null?c.stores=[s]:m.push(s))}function Lh(s,c,m,C){c.value=m,c.getSnapshot=C,Fh(c)&&Uh(s)}function Bh(s,c,m){return m(function(){Fh(c)&&Uh(s)})}function Fh(s){var c=s.getSnapshot;s=s.value;try{var m=c();return!Q(s,m)}catch{return!0}}function Uh(s){var c=Ii(s,1);c!==null&&Xr(c,s,1,-1)}function Vh(s){var c=hi();return typeof s=="function"&&(s=s()),c.memoizedState=c.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:s},c.queue=s,s=s.dispatch=Mx.bind(null,Xt,s),[c.memoizedState,s]}function Pa(s,c,m,C){return s={tag:s,create:c,destroy:m,deps:C,next:null},c=Xt.updateQueue,c===null?(c={lastEffect:null,stores:null},Xt.updateQueue=c,c.lastEffect=s.next=s):(m=c.lastEffect,m===null?c.lastEffect=s.next=s:(C=m.next,m.next=s,s.next=C,c.lastEffect=s)),s}function Hh(){return Br().memoizedState}function Bl(s,c,m,C){var I=hi();Xt.flags|=s,I.memoizedState=Pa(1|c,m,void 0,C===void 0?null:C)}function Fl(s,c,m,C){var I=Br();C=C===void 0?null:C;var N=void 0;if(En!==null){var L=En.memoizedState;if(N=L.destroy,C!==null&&qc(C,L.deps)){I.memoizedState=Pa(c,m,N,C);return}}Xt.flags|=s,I.memoizedState=Pa(1|c,m,N,C)}function Gh(s,c){return Bl(8390656,8,s,c)}function Xc(s,c){return Fl(2048,8,s,c)}function zh(s,c){return Fl(4,2,s,c)}function jh(s,c){return Fl(4,4,s,c)}function qh(s,c){if(typeof c=="function")return s=s(),c(s),function(){c(null)};if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Wh(s,c,m){return m=m!=null?m.concat([s]):null,Fl(4,4,qh.bind(null,c,s),m)}function Jc(){}function Yh(s,c){var m=Br();c=c===void 0?null:c;var C=m.memoizedState;return C!==null&&c!==null&&qc(c,C[1])?C[0]:(m.memoizedState=[s,c],s)}function $h(s,c){var m=Br();c=c===void 0?null:c;var C=m.memoizedState;return C!==null&&c!==null&&qc(c,C[1])?C[0]:(s=s(),m.memoizedState=[s,c],s)}function Kh(s,c,m){return(Fs&21)===0?(s.baseState&&(s.baseState=!1,or=!0),s.memoizedState=m):(Q(m,c)||(m=yn(),Xt.lanes|=m,Us|=m,s.baseState=!0),c)}function Nx(s,c){var m=ot;ot=m!==0&&4>m?m:4,s(!0);var C=jc.transition;jc.transition={};try{s(!1),c()}finally{ot=m,jc.transition=C}}function Xh(){return Br().memoizedState}function Rx(s,c,m){var C=ls(s);if(m={lane:C,action:m,hasEagerState:!1,eagerState:null,next:null},Jh(s))Qh(c,m);else if(m=bh(s,c,m,C),m!==null){var I=Xn();Xr(m,s,C,I),Zh(m,c,C)}}function Mx(s,c,m){var C=ls(s),I={lane:C,action:m,hasEagerState:!1,eagerState:null,next:null};if(Jh(s))Qh(c,I);else{var N=s.alternate;if(s.lanes===0&&(N===null||N.lanes===0)&&(N=c.lastRenderedReducer,N!==null))try{var L=c.lastRenderedState,z=N(L,m);if(I.hasEagerState=!0,I.eagerState=z,Q(z,L)){var q=c.interleaved;q===null?(I.next=I,Fc(c)):(I.next=q.next,q.next=I),c.interleaved=I;return}}catch{}finally{}m=bh(s,c,I,C),m!==null&&(I=Xn(),Xr(m,s,C,I),Zh(m,c,C))}}function Jh(s){var c=s.alternate;return s===Xt||c!==null&&c===Xt}function Qh(s,c){Ra=Ll=!0;var m=s.pending;m===null?c.next=c:(c.next=m.next,m.next=c),s.pending=c}function Zh(s,c,m){if((m&4194240)!==0){var C=c.lanes;C&=s.pendingLanes,m|=C,c.lanes=m,Jt(s,m)}}var Ul={readContext:Lr,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},kx={readContext:Lr,useCallback:function(s,c){return hi().memoizedState=[s,c===void 0?null:c],s},useContext:Lr,useEffect:Gh,useImperativeHandle:function(s,c,m){return m=m!=null?m.concat([s]):null,Bl(4194308,4,qh.bind(null,c,s),m)},useLayoutEffect:function(s,c){return Bl(4194308,4,s,c)},useInsertionEffect:function(s,c){return Bl(4,2,s,c)},useMemo:function(s,c){var m=hi();return c=c===void 0?null:c,s=s(),m.memoizedState=[s,c],s},useReducer:function(s,c,m){var C=hi();return c=m!==void 0?m(c):c,C.memoizedState=C.baseState=c,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:c},C.queue=s,s=s.dispatch=Rx.bind(null,Xt,s),[C.memoizedState,s]},useRef:function(s){var c=hi();return s={current:s},c.memoizedState=s},useState:Vh,useDebugValue:Jc,useDeferredValue:function(s){return hi().memoizedState=s},useTransition:function(){var s=Vh(!1),c=s[0];return s=Nx.bind(null,s[1]),hi().memoizedState=s,[c,s]},useMutableSource:function(){},useSyncExternalStore:function(s,c,m){var C=Xt,I=hi();if(qt){if(m===void 0)throw Error(t(407));m=m()}else{if(m=c(),In===null)throw Error(t(349));(Fs&30)!==0||Oh(C,c,m)}I.memoizedState=m;var N={value:m,getSnapshot:c};return I.queue=N,Gh(Bh.bind(null,C,N,s),[s]),C.flags|=2048,Pa(9,Lh.bind(null,C,N,m,c),void 0,null),m},useId:function(){var s=hi(),c=In.identifierPrefix;if(qt){var m=Ti,C=Ai;m=(C&~(1<<32-$n(C)-1)).toString(32)+m,c=":"+c+"R"+m,m=Ma++,0<m&&(c+="H"+m.toString(32)),c+=":"}else m=bx++,c=":"+c+"r"+m.toString(32)+":";return s.memoizedState=c},unstable_isNewReconciler:!1},Px={readContext:Lr,useCallback:Yh,useContext:Lr,useEffect:Xc,useImperativeHandle:Wh,useInsertionEffect:zh,useLayoutEffect:jh,useMemo:$h,useReducer:$c,useRef:Hh,useState:function(){return $c(ka)},useDebugValue:Jc,useDeferredValue:function(s){var c=Br();return Kh(c,En.memoizedState,s)},useTransition:function(){var s=$c(ka)[0],c=Br().memoizedState;return[s,c]},useMutableSource:Ph,useSyncExternalStore:Dh,useId:Xh,unstable_isNewReconciler:!1},Dx={readContext:Lr,useCallback:Yh,useContext:Lr,useEffect:Xc,useImperativeHandle:Wh,useInsertionEffect:zh,useLayoutEffect:jh,useMemo:$h,useReducer:Kc,useRef:Hh,useState:function(){return Kc(ka)},useDebugValue:Jc,useDeferredValue:function(s){var c=Br();return En===null?c.memoizedState=s:Kh(c,En.memoizedState,s)},useTransition:function(){var s=Kc(ka)[0],c=Br().memoizedState;return[s,c]},useMutableSource:Ph,useSyncExternalStore:Dh,useId:Xh,unstable_isNewReconciler:!1};function Yr(s,c){if(s&&s.defaultProps){c=we({},c),s=s.defaultProps;for(var m in s)c[m]===void 0&&(c[m]=s[m]);return c}return c}function Qc(s,c,m,C){c=s.memoizedState,m=m(C,c),m=m==null?c:we({},c,m),s.memoizedState=m,s.lanes===0&&(s.updateQueue.baseState=m)}var Vl={isMounted:function(s){return(s=s._reactInternals)?rr(s)===s:!1},enqueueSetState:function(s,c,m){s=s._reactInternals;var C=Xn(),I=ls(s),N=bi(C,I);N.payload=c,m!=null&&(N.callback=m),c=is(s,N,I),c!==null&&(Xr(c,s,I,C),kl(c,s,I))},enqueueReplaceState:function(s,c,m){s=s._reactInternals;var C=Xn(),I=ls(s),N=bi(C,I);N.tag=1,N.payload=c,m!=null&&(N.callback=m),c=is(s,N,I),c!==null&&(Xr(c,s,I,C),kl(c,s,I))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var m=Xn(),C=ls(s),I=bi(m,C);I.tag=2,c!=null&&(I.callback=c),c=is(s,I,C),c!==null&&(Xr(c,s,C,m),kl(c,s,C))}};function e0(s,c,m,C,I,N,L){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(C,N,L):c.prototype&&c.prototype.isPureReactComponent?!se(m,C)||!se(I,N):!0}function t0(s,c,m){var C=!1,I=ts,N=c.contextType;return typeof N=="object"&&N!==null?N=Lr(N):(I=sr(c)?Ps:Gn.current,C=c.contextTypes,N=(C=C!=null)?xo(s,I):ts),c=new c(m,N),s.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Vl,s.stateNode=c,c._reactInternals=s,C&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=I,s.__reactInternalMemoizedMaskedChildContext=N),c}function n0(s,c,m,C){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,C),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,C),c.state!==s&&Vl.enqueueReplaceState(c,c.state,null)}function Zc(s,c,m,C){var I=s.stateNode;I.props=m,I.state=s.memoizedState,I.refs={},Uc(s);var N=c.contextType;typeof N=="object"&&N!==null?I.context=Lr(N):(N=sr(c)?Ps:Gn.current,I.context=xo(s,N)),I.state=s.memoizedState,N=c.getDerivedStateFromProps,typeof N=="function"&&(Qc(s,c,N,m),I.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(c=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),c!==I.state&&Vl.enqueueReplaceState(I,I.state,null),Pl(s,m,I,C),I.state=s.memoizedState),typeof I.componentDidMount=="function"&&(s.flags|=4194308)}function To(s,c){try{var m="",C=c;do m+=at(C),C=C.return;while(C);var I=m}catch(N){I=`
Error generating stack: `+N.message+`
`+N.stack}return{value:s,source:c,stack:I,digest:null}}function ed(s,c,m){return{value:s,source:null,stack:m??null,digest:c??null}}function td(s,c){try{console.error(c.value)}catch(m){setTimeout(function(){throw m})}}var Ox=typeof WeakMap=="function"?WeakMap:Map;function r0(s,c,m){m=bi(-1,m),m.tag=3,m.payload={element:null};var C=c.value;return m.callback=function(){Yl||(Yl=!0,md=C),td(s,c)},m}function i0(s,c,m){m=bi(-1,m),m.tag=3;var C=s.type.getDerivedStateFromError;if(typeof C=="function"){var I=c.value;m.payload=function(){return C(I)},m.callback=function(){td(s,c)}}var N=s.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(m.callback=function(){td(s,c),typeof C!="function"&&(os===null?os=new Set([this]):os.add(this));var L=c.stack;this.componentDidCatch(c.value,{componentStack:L!==null?L:""})}),m}function s0(s,c,m){var C=s.pingCache;if(C===null){C=s.pingCache=new Ox;var I=new Set;C.set(c,I)}else I=C.get(c),I===void 0&&(I=new Set,C.set(c,I));I.has(m)||(I.add(m),s=Kx.bind(null,s,c,m),c.then(s,s))}function o0(s){do{var c;if((c=s.tag===13)&&(c=s.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return s;s=s.return}while(s!==null);return null}function a0(s,c,m,C,I){return(s.mode&1)===0?(s===c?s.flags|=65536:(s.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(c=bi(-1,1),c.tag=2,is(m,c,1))),m.lanes|=1),s):(s.flags|=65536,s.lanes=I,s)}var Lx=J.ReactCurrentOwner,or=!1;function Kn(s,c,m,C){c.child=s===null?Ih(c,null,m,C):_o(c,s.child,m,C)}function l0(s,c,m,C,I){m=m.render;var N=c.ref;return So(c,I),C=Wc(s,c,m,C,N,I),m=Yc(),s!==null&&!or?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~I,Ni(s,c,I)):(qt&&m&&Nc(c),c.flags|=1,Kn(s,c,C,I),c.child)}function u0(s,c,m,C,I){if(s===null){var N=m.type;return typeof N=="function"&&!Cd(N)&&N.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(c.tag=15,c.type=N,c0(s,c,N,C,I)):(s=Zl(m.type,null,C,c,c.mode,I),s.ref=c.ref,s.return=c,c.child=s)}if(N=s.child,(s.lanes&I)===0){var L=N.memoizedProps;if(m=m.compare,m=m!==null?m:se,m(L,C)&&s.ref===c.ref)return Ni(s,c,I)}return c.flags|=1,s=cs(N,C),s.ref=c.ref,s.return=c,c.child=s}function c0(s,c,m,C,I){if(s!==null){var N=s.memoizedProps;if(se(N,C)&&s.ref===c.ref)if(or=!1,c.pendingProps=C=N,(s.lanes&I)!==0)(s.flags&131072)!==0&&(or=!0);else return c.lanes=s.lanes,Ni(s,c,I)}return nd(s,c,m,C,I)}function d0(s,c,m){var C=c.pendingProps,I=C.children,N=s!==null?s.memoizedState:null;if(C.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ut(bo,Cr),Cr|=m;else{if((m&1073741824)===0)return s=N!==null?N.baseLanes|m:m,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:s,cachePool:null,transitions:null},c.updateQueue=null,Ut(bo,Cr),Cr|=s,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},C=N!==null?N.baseLanes:m,Ut(bo,Cr),Cr|=C}else N!==null?(C=N.baseLanes|m,c.memoizedState=null):C=m,Ut(bo,Cr),Cr|=C;return Kn(s,c,I,m),c.child}function f0(s,c){var m=c.ref;(s===null&&m!==null||s!==null&&s.ref!==m)&&(c.flags|=512,c.flags|=2097152)}function nd(s,c,m,C,I){var N=sr(m)?Ps:Gn.current;return N=xo(c,N),So(c,I),m=Wc(s,c,m,C,N,I),C=Yc(),s!==null&&!or?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~I,Ni(s,c,I)):(qt&&C&&Nc(c),c.flags|=1,Kn(s,c,m,I),c.child)}function h0(s,c,m,C,I){if(sr(m)){var N=!0;Sl(c)}else N=!1;if(So(c,I),c.stateNode===null)Gl(s,c),t0(c,m,C),Zc(c,m,C,I),C=!0;else if(s===null){var L=c.stateNode,z=c.memoizedProps;L.props=z;var q=L.context,ae=m.contextType;typeof ae=="object"&&ae!==null?ae=Lr(ae):(ae=sr(m)?Ps:Gn.current,ae=xo(c,ae));var ge=m.getDerivedStateFromProps,ye=typeof ge=="function"||typeof L.getSnapshotBeforeUpdate=="function";ye||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(z!==C||q!==ae)&&n0(c,L,C,ae),rs=!1;var fe=c.memoizedState;L.state=fe,Pl(c,C,L,I),q=c.memoizedState,z!==C||fe!==q||ir.current||rs?(typeof ge=="function"&&(Qc(c,m,ge,C),q=c.memoizedState),(z=rs||e0(c,m,z,C,fe,q,ae))?(ye||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(c.flags|=4194308)):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=C,c.memoizedState=q),L.props=C,L.state=q,L.context=ae,C=z):(typeof L.componentDidMount=="function"&&(c.flags|=4194308),C=!1)}else{L=c.stateNode,Nh(s,c),z=c.memoizedProps,ae=c.type===c.elementType?z:Yr(c.type,z),L.props=ae,ye=c.pendingProps,fe=L.context,q=m.contextType,typeof q=="object"&&q!==null?q=Lr(q):(q=sr(m)?Ps:Gn.current,q=xo(c,q));var ke=m.getDerivedStateFromProps;(ge=typeof ke=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(z!==ye||fe!==q)&&n0(c,L,C,q),rs=!1,fe=c.memoizedState,L.state=fe,Pl(c,C,L,I);var Ue=c.memoizedState;z!==ye||fe!==Ue||ir.current||rs?(typeof ke=="function"&&(Qc(c,m,ke,C),Ue=c.memoizedState),(ae=rs||e0(c,m,ae,C,fe,Ue,q)||!1)?(ge||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(C,Ue,q),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(C,Ue,q)),typeof L.componentDidUpdate=="function"&&(c.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof L.componentDidUpdate!="function"||z===s.memoizedProps&&fe===s.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||z===s.memoizedProps&&fe===s.memoizedState||(c.flags|=1024),c.memoizedProps=C,c.memoizedState=Ue),L.props=C,L.state=Ue,L.context=q,C=ae):(typeof L.componentDidUpdate!="function"||z===s.memoizedProps&&fe===s.memoizedState||(c.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||z===s.memoizedProps&&fe===s.memoizedState||(c.flags|=1024),C=!1)}return rd(s,c,m,C,N,I)}function rd(s,c,m,C,I,N){f0(s,c);var L=(c.flags&128)!==0;if(!C&&!L)return I&&xh(c,m,!1),Ni(s,c,N);C=c.stateNode,Lx.current=c;var z=L&&typeof m.getDerivedStateFromError!="function"?null:C.render();return c.flags|=1,s!==null&&L?(c.child=_o(c,s.child,null,N),c.child=_o(c,null,z,N)):Kn(s,c,z,N),c.memoizedState=C.state,I&&xh(c,m,!0),c.child}function p0(s){var c=s.stateNode;c.pendingContext?mh(s,c.pendingContext,c.pendingContext!==c.context):c.context&&mh(s,c.context,!1),Vc(s,c.containerInfo)}function g0(s,c,m,C,I){return Eo(),Pc(I),c.flags|=256,Kn(s,c,m,C),c.child}var id={dehydrated:null,treeContext:null,retryLane:0};function sd(s){return{baseLanes:s,cachePool:null,transitions:null}}function m0(s,c,m){var C=c.pendingProps,I=Kt.current,N=!1,L=(c.flags&128)!==0,z;if((z=L)||(z=s!==null&&s.memoizedState===null?!1:(I&2)!==0),z?(N=!0,c.flags&=-129):(s===null||s.memoizedState!==null)&&(I|=1),Ut(Kt,I&1),s===null)return kc(c),s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((c.mode&1)===0?c.lanes=1:s.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(L=C.children,s=C.fallback,N?(C=c.mode,N=c.child,L={mode:"hidden",children:L},(C&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=L):N=eu(L,C,0,null),s=zs(s,C,m,null),N.return=c,s.return=c,N.sibling=s,c.child=N,c.child.memoizedState=sd(m),c.memoizedState=id,s):od(c,L));if(I=s.memoizedState,I!==null&&(z=I.dehydrated,z!==null))return Bx(s,c,L,C,z,I,m);if(N){N=C.fallback,L=c.mode,I=s.child,z=I.sibling;var q={mode:"hidden",children:C.children};return(L&1)===0&&c.child!==I?(C=c.child,C.childLanes=0,C.pendingProps=q,c.deletions=null):(C=cs(I,q),C.subtreeFlags=I.subtreeFlags&14680064),z!==null?N=cs(z,N):(N=zs(N,L,m,null),N.flags|=2),N.return=c,C.return=c,C.sibling=N,c.child=C,C=N,N=c.child,L=s.child.memoizedState,L=L===null?sd(m):{baseLanes:L.baseLanes|m,cachePool:null,transitions:L.transitions},N.memoizedState=L,N.childLanes=s.childLanes&~m,c.memoizedState=id,C}return N=s.child,s=N.sibling,C=cs(N,{mode:"visible",children:C.children}),(c.mode&1)===0&&(C.lanes=m),C.return=c,C.sibling=null,s!==null&&(m=c.deletions,m===null?(c.deletions=[s],c.flags|=16):m.push(s)),c.child=C,c.memoizedState=null,C}function od(s,c){return c=eu({mode:"visible",children:c},s.mode,0,null),c.return=s,s.child=c}function Hl(s,c,m,C){return C!==null&&Pc(C),_o(c,s.child,null,m),s=od(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Bx(s,c,m,C,I,N,L){if(m)return c.flags&256?(c.flags&=-257,C=ed(Error(t(422))),Hl(s,c,L,C)):c.memoizedState!==null?(c.child=s.child,c.flags|=128,null):(N=C.fallback,I=c.mode,C=eu({mode:"visible",children:C.children},I,0,null),N=zs(N,I,L,null),N.flags|=2,C.return=c,N.return=c,C.sibling=N,c.child=C,(c.mode&1)!==0&&_o(c,s.child,null,L),c.child.memoizedState=sd(L),c.memoizedState=id,N);if((c.mode&1)===0)return Hl(s,c,L,null);if(I.data==="$!"){if(C=I.nextSibling&&I.nextSibling.dataset,C)var z=C.dgst;return C=z,N=Error(t(419)),C=ed(N,C,void 0),Hl(s,c,L,C)}if(z=(L&s.childLanes)!==0,or||z){if(C=In,C!==null){switch(L&-L){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}I=(I&(C.suspendedLanes|L))!==0?0:I,I!==0&&I!==N.retryLane&&(N.retryLane=I,Ii(s,I),Xr(C,s,I,-1))}return _d(),C=ed(Error(t(421))),Hl(s,c,L,C)}return I.data==="$?"?(c.flags|=128,c.child=s.child,c=Xx.bind(null,s),I._reactRetry=c,null):(s=N.treeContext,_r=Zi(I.nextSibling),Er=c,qt=!0,Wr=null,s!==null&&(Dr[Or++]=Ai,Dr[Or++]=Ti,Dr[Or++]=Ds,Ai=s.id,Ti=s.overflow,Ds=c),c=od(c,C.children),c.flags|=4096,c)}function y0(s,c,m){s.lanes|=c;var C=s.alternate;C!==null&&(C.lanes|=c),Bc(s.return,c,m)}function ad(s,c,m,C,I){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:C,tail:m,tailMode:I}:(N.isBackwards=c,N.rendering=null,N.renderingStartTime=0,N.last=C,N.tail=m,N.tailMode=I)}function x0(s,c,m){var C=c.pendingProps,I=C.revealOrder,N=C.tail;if(Kn(s,c,C.children,m),C=Kt.current,(C&2)!==0)C=C&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&y0(s,m,c);else if(s.tag===19)y0(s,m,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}C&=1}if(Ut(Kt,C),(c.mode&1)===0)c.memoizedState=null;else switch(I){case"forwards":for(m=c.child,I=null;m!==null;)s=m.alternate,s!==null&&Dl(s)===null&&(I=m),m=m.sibling;m=I,m===null?(I=c.child,c.child=null):(I=m.sibling,m.sibling=null),ad(c,!1,I,m,N);break;case"backwards":for(m=null,I=c.child,c.child=null;I!==null;){if(s=I.alternate,s!==null&&Dl(s)===null){c.child=I;break}s=I.sibling,I.sibling=m,m=I,I=s}ad(c,!0,m,null,N);break;case"together":ad(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Gl(s,c){(c.mode&1)===0&&s!==null&&(s.alternate=null,c.alternate=null,c.flags|=2)}function Ni(s,c,m){if(s!==null&&(c.dependencies=s.dependencies),Us|=c.lanes,(m&c.childLanes)===0)return null;if(s!==null&&c.child!==s.child)throw Error(t(153));if(c.child!==null){for(s=c.child,m=cs(s,s.pendingProps),c.child=m,m.return=c;s.sibling!==null;)s=s.sibling,m=m.sibling=cs(s,s.pendingProps),m.return=c;m.sibling=null}return c.child}function Fx(s,c,m){switch(c.tag){case 3:p0(c),Eo();break;case 5:kh(c);break;case 1:sr(c.type)&&Sl(c);break;case 4:Vc(c,c.stateNode.containerInfo);break;case 10:var C=c.type._context,I=c.memoizedProps.value;Ut(Rl,C._currentValue),C._currentValue=I;break;case 13:if(C=c.memoizedState,C!==null)return C.dehydrated!==null?(Ut(Kt,Kt.current&1),c.flags|=128,null):(m&c.child.childLanes)!==0?m0(s,c,m):(Ut(Kt,Kt.current&1),s=Ni(s,c,m),s!==null?s.sibling:null);Ut(Kt,Kt.current&1);break;case 19:if(C=(m&c.childLanes)!==0,(s.flags&128)!==0){if(C)return x0(s,c,m);c.flags|=128}if(I=c.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Ut(Kt,Kt.current),C)break;return null;case 22:case 23:return c.lanes=0,d0(s,c,m)}return Ni(s,c,m)}var v0,ld,w0,E0;v0=function(s,c){for(var m=c.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},ld=function(){},w0=function(s,c,m,C){var I=s.memoizedProps;if(I!==C){s=c.stateNode,Bs(fi.current);var N=null;switch(m){case"input":I=ii(s,I),C=ii(s,C),N=[];break;case"select":I=we({},I,{value:void 0}),C=we({},C,{value:void 0}),N=[];break;case"textarea":I=Ui(s,I),C=Ui(s,C),N=[];break;default:typeof I.onClick!="function"&&typeof C.onClick=="function"&&(s.onclick=El)}_t(m,C);var L;m=null;for(ae in I)if(!C.hasOwnProperty(ae)&&I.hasOwnProperty(ae)&&I[ae]!=null)if(ae==="style"){var z=I[ae];for(L in z)z.hasOwnProperty(L)&&(m||(m={}),m[L]="")}else ae!=="dangerouslySetInnerHTML"&&ae!=="children"&&ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&ae!=="autoFocus"&&(a.hasOwnProperty(ae)?N||(N=[]):(N=N||[]).push(ae,null));for(ae in C){var q=C[ae];if(z=I?.[ae],C.hasOwnProperty(ae)&&q!==z&&(q!=null||z!=null))if(ae==="style")if(z){for(L in z)!z.hasOwnProperty(L)||q&&q.hasOwnProperty(L)||(m||(m={}),m[L]="");for(L in q)q.hasOwnProperty(L)&&z[L]!==q[L]&&(m||(m={}),m[L]=q[L])}else m||(N||(N=[]),N.push(ae,m)),m=q;else ae==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,z=z?z.__html:void 0,q!=null&&z!==q&&(N=N||[]).push(ae,q)):ae==="children"?typeof q!="string"&&typeof q!="number"||(N=N||[]).push(ae,""+q):ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&(a.hasOwnProperty(ae)?(q!=null&&ae==="onScroll"&&Ht("scroll",s),N||z===q||(N=[])):(N=N||[]).push(ae,q))}m&&(N=N||[]).push("style",m);var ae=N;(c.updateQueue=ae)&&(c.flags|=4)}},E0=function(s,c,m,C){m!==C&&(c.flags|=4)};function Da(s,c){if(!qt)switch(s.tailMode){case"hidden":c=s.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?s.tail=null:m.sibling=null;break;case"collapsed":m=s.tail;for(var C=null;m!==null;)m.alternate!==null&&(C=m),m=m.sibling;C===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:C.sibling=null}}function jn(s){var c=s.alternate!==null&&s.alternate.child===s.child,m=0,C=0;if(c)for(var I=s.child;I!==null;)m|=I.lanes|I.childLanes,C|=I.subtreeFlags&14680064,C|=I.flags&14680064,I.return=s,I=I.sibling;else for(I=s.child;I!==null;)m|=I.lanes|I.childLanes,C|=I.subtreeFlags,C|=I.flags,I.return=s,I=I.sibling;return s.subtreeFlags|=C,s.childLanes=m,c}function Ux(s,c,m){var C=c.pendingProps;switch(Rc(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(c),null;case 1:return sr(c.type)&&Cl(),jn(c),null;case 3:return C=c.stateNode,Ao(),Gt(ir),Gt(Gn),zc(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(s===null||s.child===null)&&(bl(c)?c.flags|=4:s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Wr!==null&&(vd(Wr),Wr=null))),ld(s,c),jn(c),null;case 5:Hc(c);var I=Bs(Na.current);if(m=c.type,s!==null&&c.stateNode!=null)w0(s,c,m,C,I),s.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!C){if(c.stateNode===null)throw Error(t(166));return jn(c),null}if(s=Bs(fi.current),bl(c)){C=c.stateNode,m=c.type;var N=c.memoizedProps;switch(C[di]=c,C[Sa]=N,s=(c.mode&1)!==0,m){case"dialog":Ht("cancel",C),Ht("close",C);break;case"iframe":case"object":case"embed":Ht("load",C);break;case"video":case"audio":for(I=0;I<Ea.length;I++)Ht(Ea[I],C);break;case"source":Ht("error",C);break;case"img":case"image":case"link":Ht("error",C),Ht("load",C);break;case"details":Ht("toggle",C);break;case"input":fr(C,N),Ht("invalid",C);break;case"select":C._wrapperState={wasMultiple:!!N.multiple},Ht("invalid",C);break;case"textarea":Zo(C,N),Ht("invalid",C)}_t(m,N),I=null;for(var L in N)if(N.hasOwnProperty(L)){var z=N[L];L==="children"?typeof z=="string"?C.textContent!==z&&(N.suppressHydrationWarning!==!0&&wl(C.textContent,z,s),I=["children",z]):typeof z=="number"&&C.textContent!==""+z&&(N.suppressHydrationWarning!==!0&&wl(C.textContent,z,s),I=["children",""+z]):a.hasOwnProperty(L)&&z!=null&&L==="onScroll"&&Ht("scroll",C)}switch(m){case"input":gn(C),Nt(C,N,!0);break;case"textarea":gn(C),to(C);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(C.onclick=El)}C=I,c.updateQueue=C,C!==null&&(c.flags|=4)}else{L=I.nodeType===9?I:I.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=er(m)),s==="http://www.w3.org/1999/xhtml"?m==="script"?(s=L.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof C.is=="string"?s=L.createElement(m,{is:C.is}):(s=L.createElement(m),m==="select"&&(L=s,C.multiple?L.multiple=!0:C.size&&(L.size=C.size))):s=L.createElementNS(s,m),s[di]=c,s[Sa]=C,v0(s,c,!1,!1),c.stateNode=s;e:{switch(L=Ot(m,C),m){case"dialog":Ht("cancel",s),Ht("close",s),I=C;break;case"iframe":case"object":case"embed":Ht("load",s),I=C;break;case"video":case"audio":for(I=0;I<Ea.length;I++)Ht(Ea[I],s);I=C;break;case"source":Ht("error",s),I=C;break;case"img":case"image":case"link":Ht("error",s),Ht("load",s),I=C;break;case"details":Ht("toggle",s),I=C;break;case"input":fr(s,C),I=ii(s,C),Ht("invalid",s);break;case"option":I=C;break;case"select":s._wrapperState={wasMultiple:!!C.multiple},I=we({},C,{value:void 0}),Ht("invalid",s);break;case"textarea":Zo(s,C),I=Ui(s,C),Ht("invalid",s);break;default:I=C}_t(m,I),z=I;for(N in z)if(z.hasOwnProperty(N)){var q=z[N];N==="style"?Ae(s,q):N==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&Cn(s,q)):N==="children"?typeof q=="string"?(m!=="textarea"||q!=="")&&Vi(s,q):typeof q=="number"&&Vi(s,""+q):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(a.hasOwnProperty(N)?q!=null&&N==="onScroll"&&Ht("scroll",s):q!=null&&G(s,N,q,L))}switch(m){case"input":gn(s),Nt(s,C,!1);break;case"textarea":gn(s),to(s);break;case"option":C.value!=null&&s.setAttribute("value",""+Ze(C.value));break;case"select":s.multiple=!!C.multiple,N=C.value,N!=null?Oe(s,!!C.multiple,N,!1):C.defaultValue!=null&&Oe(s,!!C.multiple,C.defaultValue,!0);break;default:typeof I.onClick=="function"&&(s.onclick=El)}switch(m){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}}C&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return jn(c),null;case 6:if(s&&c.stateNode!=null)E0(s,c,s.memoizedProps,C);else{if(typeof C!="string"&&c.stateNode===null)throw Error(t(166));if(m=Bs(Na.current),Bs(fi.current),bl(c)){if(C=c.stateNode,m=c.memoizedProps,C[di]=c,(N=C.nodeValue!==m)&&(s=Er,s!==null))switch(s.tag){case 3:wl(C.nodeValue,m,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&wl(C.nodeValue,m,(s.mode&1)!==0)}N&&(c.flags|=4)}else C=(m.nodeType===9?m:m.ownerDocument).createTextNode(C),C[di]=c,c.stateNode=C}return jn(c),null;case 13:if(Gt(Kt),C=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(qt&&_r!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Sh(),Eo(),c.flags|=98560,N=!1;else if(N=bl(c),C!==null&&C.dehydrated!==null){if(s===null){if(!N)throw Error(t(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(t(317));N[di]=c}else Eo(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;jn(c),N=!1}else Wr!==null&&(vd(Wr),Wr=null),N=!0;if(!N)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=m,c):(C=C!==null,C!==(s!==null&&s.memoizedState!==null)&&C&&(c.child.flags|=8192,(c.mode&1)!==0&&(s===null||(Kt.current&1)!==0?_n===0&&(_n=3):_d())),c.updateQueue!==null&&(c.flags|=4),jn(c),null);case 4:return Ao(),ld(s,c),s===null&&_a(c.stateNode.containerInfo),jn(c),null;case 10:return Lc(c.type._context),jn(c),null;case 17:return sr(c.type)&&Cl(),jn(c),null;case 19:if(Gt(Kt),N=c.memoizedState,N===null)return jn(c),null;if(C=(c.flags&128)!==0,L=N.rendering,L===null)if(C)Da(N,!1);else{if(_n!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(L=Dl(s),L!==null){for(c.flags|=128,Da(N,!1),C=L.updateQueue,C!==null&&(c.updateQueue=C,c.flags|=4),c.subtreeFlags=0,C=m,m=c.child;m!==null;)N=m,s=C,N.flags&=14680066,L=N.alternate,L===null?(N.childLanes=0,N.lanes=s,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=L.childLanes,N.lanes=L.lanes,N.child=L.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=L.memoizedProps,N.memoizedState=L.memoizedState,N.updateQueue=L.updateQueue,N.type=L.type,s=L.dependencies,N.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),m=m.sibling;return Ut(Kt,Kt.current&1|2),c.child}s=s.sibling}N.tail!==null&&Tt()>No&&(c.flags|=128,C=!0,Da(N,!1),c.lanes=4194304)}else{if(!C)if(s=Dl(L),s!==null){if(c.flags|=128,C=!0,m=s.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),Da(N,!0),N.tail===null&&N.tailMode==="hidden"&&!L.alternate&&!qt)return jn(c),null}else 2*Tt()-N.renderingStartTime>No&&m!==1073741824&&(c.flags|=128,C=!0,Da(N,!1),c.lanes=4194304);N.isBackwards?(L.sibling=c.child,c.child=L):(m=N.last,m!==null?m.sibling=L:c.child=L,N.last=L)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Tt(),c.sibling=null,m=Kt.current,Ut(Kt,C?m&1|2:m&1),c):(jn(c),null);case 22:case 23:return Ed(),C=c.memoizedState!==null,s!==null&&s.memoizedState!==null!==C&&(c.flags|=8192),C&&(c.mode&1)!==0?(Cr&1073741824)!==0&&(jn(c),c.subtreeFlags&6&&(c.flags|=8192)):jn(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function Vx(s,c){switch(Rc(c),c.tag){case 1:return sr(c.type)&&Cl(),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return Ao(),Gt(ir),Gt(Gn),zc(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 5:return Hc(c),null;case 13:if(Gt(Kt),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Eo()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return Gt(Kt),null;case 4:return Ao(),null;case 10:return Lc(c.type._context),null;case 22:case 23:return Ed(),null;case 24:return null;default:return null}}var zl=!1,qn=!1,Hx=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Io(s,c){var m=s.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(C){Zt(s,c,C)}else m.current=null}function ud(s,c,m){try{m()}catch(C){Zt(s,c,C)}}var _0=!1;function Gx(s,c){if(Ec=ui,s=lt(),nt(s)){if("selectionStart"in s)var m={start:s.selectionStart,end:s.selectionEnd};else e:{m=(m=s.ownerDocument)&&m.defaultView||window;var C=m.getSelection&&m.getSelection();if(C&&C.rangeCount!==0){m=C.anchorNode;var I=C.anchorOffset,N=C.focusNode;C=C.focusOffset;try{m.nodeType,N.nodeType}catch{m=null;break e}var L=0,z=-1,q=-1,ae=0,ge=0,ye=s,fe=null;t:for(;;){for(var ke;ye!==m||I!==0&&ye.nodeType!==3||(z=L+I),ye!==N||C!==0&&ye.nodeType!==3||(q=L+C),ye.nodeType===3&&(L+=ye.nodeValue.length),(ke=ye.firstChild)!==null;)fe=ye,ye=ke;for(;;){if(ye===s)break t;if(fe===m&&++ae===I&&(z=L),fe===N&&++ge===C&&(q=L),(ke=ye.nextSibling)!==null)break;ye=fe,fe=ye.parentNode}ye=ke}m=z===-1||q===-1?null:{start:z,end:q}}else m=null}m=m||{start:0,end:0}}else m=null;for(_c={focusedElem:s,selectionRange:m},ui=!1,Be=c;Be!==null;)if(c=Be,s=c.child,(c.subtreeFlags&1028)!==0&&s!==null)s.return=c,Be=s;else for(;Be!==null;){c=Be;try{var Ue=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ue!==null){var Ve=Ue.memoizedProps,un=Ue.memoizedState,ne=c.stateNode,K=ne.getSnapshotBeforeUpdate(c.elementType===c.type?Ve:Yr(c.type,Ve),un);ne.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var re=c.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(_e){Zt(c,c.return,_e)}if(s=c.sibling,s!==null){s.return=c.return,Be=s;break}Be=c.return}return Ue=_0,_0=!1,Ue}function Oa(s,c,m){var C=c.updateQueue;if(C=C!==null?C.lastEffect:null,C!==null){var I=C=C.next;do{if((I.tag&s)===s){var N=I.destroy;I.destroy=void 0,N!==void 0&&ud(c,m,N)}I=I.next}while(I!==C)}}function jl(s,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&s)===s){var C=m.create;m.destroy=C()}m=m.next}while(m!==c)}}function cd(s){var c=s.ref;if(c!==null){var m=s.stateNode;switch(s.tag){case 5:s=m;break;default:s=m}typeof c=="function"?c(s):c.current=s}}function C0(s){var c=s.alternate;c!==null&&(s.alternate=null,C0(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&(delete c[di],delete c[Sa],delete c[Tc],delete c[Sx],delete c[Ax])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function S0(s){return s.tag===5||s.tag===3||s.tag===4}function A0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||S0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function dd(s,c,m){var C=s.tag;if(C===5||C===6)s=s.stateNode,c?m.nodeType===8?m.parentNode.insertBefore(s,c):m.insertBefore(s,c):(m.nodeType===8?(c=m.parentNode,c.insertBefore(s,m)):(c=m,c.appendChild(s)),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=El));else if(C!==4&&(s=s.child,s!==null))for(dd(s,c,m),s=s.sibling;s!==null;)dd(s,c,m),s=s.sibling}function fd(s,c,m){var C=s.tag;if(C===5||C===6)s=s.stateNode,c?m.insertBefore(s,c):m.appendChild(s);else if(C!==4&&(s=s.child,s!==null))for(fd(s,c,m),s=s.sibling;s!==null;)fd(s,c,m),s=s.sibling}var Dn=null,$r=!1;function ss(s,c,m){for(m=m.child;m!==null;)T0(s,c,m),m=m.sibling}function T0(s,c,m){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(mt,m)}catch{}switch(m.tag){case 5:qn||Io(m,c);case 6:var C=Dn,I=$r;Dn=null,ss(s,c,m),Dn=C,$r=I,Dn!==null&&($r?(s=Dn,m=m.stateNode,s.nodeType===8?s.parentNode.removeChild(m):s.removeChild(m)):Dn.removeChild(m.stateNode));break;case 18:Dn!==null&&($r?(s=Dn,m=m.stateNode,s.nodeType===8?Ac(s.parentNode,m):s.nodeType===1&&Ac(s,m),zr(s)):Ac(Dn,m.stateNode));break;case 4:C=Dn,I=$r,Dn=m.stateNode.containerInfo,$r=!0,ss(s,c,m),Dn=C,$r=I;break;case 0:case 11:case 14:case 15:if(!qn&&(C=m.updateQueue,C!==null&&(C=C.lastEffect,C!==null))){I=C=C.next;do{var N=I,L=N.destroy;N=N.tag,L!==void 0&&((N&2)!==0||(N&4)!==0)&&ud(m,c,L),I=I.next}while(I!==C)}ss(s,c,m);break;case 1:if(!qn&&(Io(m,c),C=m.stateNode,typeof C.componentWillUnmount=="function"))try{C.props=m.memoizedProps,C.state=m.memoizedState,C.componentWillUnmount()}catch(z){Zt(m,c,z)}ss(s,c,m);break;case 21:ss(s,c,m);break;case 22:m.mode&1?(qn=(C=qn)||m.memoizedState!==null,ss(s,c,m),qn=C):ss(s,c,m);break;default:ss(s,c,m)}}function I0(s){var c=s.updateQueue;if(c!==null){s.updateQueue=null;var m=s.stateNode;m===null&&(m=s.stateNode=new Hx),c.forEach(function(C){var I=Jx.bind(null,s,C);m.has(C)||(m.add(C),C.then(I,I))})}}function Kr(s,c){var m=c.deletions;if(m!==null)for(var C=0;C<m.length;C++){var I=m[C];try{var N=s,L=c,z=L;e:for(;z!==null;){switch(z.tag){case 5:Dn=z.stateNode,$r=!1;break e;case 3:Dn=z.stateNode.containerInfo,$r=!0;break e;case 4:Dn=z.stateNode.containerInfo,$r=!0;break e}z=z.return}if(Dn===null)throw Error(t(160));T0(N,L,I),Dn=null,$r=!1;var q=I.alternate;q!==null&&(q.return=null),I.return=null}catch(ae){Zt(I,c,ae)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)b0(c,s),c=c.sibling}function b0(s,c){var m=s.alternate,C=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Kr(c,s),pi(s),C&4){try{Oa(3,s,s.return),jl(3,s)}catch(Ve){Zt(s,s.return,Ve)}try{Oa(5,s,s.return)}catch(Ve){Zt(s,s.return,Ve)}}break;case 1:Kr(c,s),pi(s),C&512&&m!==null&&Io(m,m.return);break;case 5:if(Kr(c,s),pi(s),C&512&&m!==null&&Io(m,m.return),s.flags&32){var I=s.stateNode;try{Vi(I,"")}catch(Ve){Zt(s,s.return,Ve)}}if(C&4&&(I=s.stateNode,I!=null)){var N=s.memoizedProps,L=m!==null?m.memoizedProps:N,z=s.type,q=s.updateQueue;if(s.updateQueue=null,q!==null)try{z==="input"&&N.type==="radio"&&N.name!=null&&Fi(I,N),Ot(z,L);var ae=Ot(z,N);for(L=0;L<q.length;L+=2){var ge=q[L],ye=q[L+1];ge==="style"?Ae(I,ye):ge==="dangerouslySetInnerHTML"?Cn(I,ye):ge==="children"?Vi(I,ye):G(I,ge,ye,ae)}switch(z){case"input":rn(I,N);break;case"textarea":br(I,N);break;case"select":var fe=I._wrapperState.wasMultiple;I._wrapperState.wasMultiple=!!N.multiple;var ke=N.value;ke!=null?Oe(I,!!N.multiple,ke,!1):fe!==!!N.multiple&&(N.defaultValue!=null?Oe(I,!!N.multiple,N.defaultValue,!0):Oe(I,!!N.multiple,N.multiple?[]:"",!1))}I[Sa]=N}catch(Ve){Zt(s,s.return,Ve)}}break;case 6:if(Kr(c,s),pi(s),C&4){if(s.stateNode===null)throw Error(t(162));I=s.stateNode,N=s.memoizedProps;try{I.nodeValue=N}catch(Ve){Zt(s,s.return,Ve)}}break;case 3:if(Kr(c,s),pi(s),C&4&&m!==null&&m.memoizedState.isDehydrated)try{zr(c.containerInfo)}catch(Ve){Zt(s,s.return,Ve)}break;case 4:Kr(c,s),pi(s);break;case 13:Kr(c,s),pi(s),I=s.child,I.flags&8192&&(N=I.memoizedState!==null,I.stateNode.isHidden=N,!N||I.alternate!==null&&I.alternate.memoizedState!==null||(gd=Tt())),C&4&&I0(s);break;case 22:if(ge=m!==null&&m.memoizedState!==null,s.mode&1?(qn=(ae=qn)||ge,Kr(c,s),qn=ae):Kr(c,s),pi(s),C&8192){if(ae=s.memoizedState!==null,(s.stateNode.isHidden=ae)&&!ge&&(s.mode&1)!==0)for(Be=s,ge=s.child;ge!==null;){for(ye=Be=ge;Be!==null;){switch(fe=Be,ke=fe.child,fe.tag){case 0:case 11:case 14:case 15:Oa(4,fe,fe.return);break;case 1:Io(fe,fe.return);var Ue=fe.stateNode;if(typeof Ue.componentWillUnmount=="function"){C=fe,m=fe.return;try{c=C,Ue.props=c.memoizedProps,Ue.state=c.memoizedState,Ue.componentWillUnmount()}catch(Ve){Zt(C,m,Ve)}}break;case 5:Io(fe,fe.return);break;case 22:if(fe.memoizedState!==null){M0(ye);continue}}ke!==null?(ke.return=fe,Be=ke):M0(ye)}ge=ge.sibling}e:for(ge=null,ye=s;;){if(ye.tag===5){if(ge===null){ge=ye;try{I=ye.stateNode,ae?(N=I.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(z=ye.stateNode,q=ye.memoizedProps.style,L=q!=null&&q.hasOwnProperty("display")?q.display:null,z.style.display=Yt("display",L))}catch(Ve){Zt(s,s.return,Ve)}}}else if(ye.tag===6){if(ge===null)try{ye.stateNode.nodeValue=ae?"":ye.memoizedProps}catch(Ve){Zt(s,s.return,Ve)}}else if((ye.tag!==22&&ye.tag!==23||ye.memoizedState===null||ye===s)&&ye.child!==null){ye.child.return=ye,ye=ye.child;continue}if(ye===s)break e;for(;ye.sibling===null;){if(ye.return===null||ye.return===s)break e;ge===ye&&(ge=null),ye=ye.return}ge===ye&&(ge=null),ye.sibling.return=ye.return,ye=ye.sibling}}break;case 19:Kr(c,s),pi(s),C&4&&I0(s);break;case 21:break;default:Kr(c,s),pi(s)}}function pi(s){var c=s.flags;if(c&2){try{e:{for(var m=s.return;m!==null;){if(S0(m)){var C=m;break e}m=m.return}throw Error(t(160))}switch(C.tag){case 5:var I=C.stateNode;C.flags&32&&(Vi(I,""),C.flags&=-33);var N=A0(s);fd(s,N,I);break;case 3:case 4:var L=C.stateNode.containerInfo,z=A0(s);dd(s,z,L);break;default:throw Error(t(161))}}catch(q){Zt(s,s.return,q)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function zx(s,c,m){Be=s,N0(s)}function N0(s,c,m){for(var C=(s.mode&1)!==0;Be!==null;){var I=Be,N=I.child;if(I.tag===22&&C){var L=I.memoizedState!==null||zl;if(!L){var z=I.alternate,q=z!==null&&z.memoizedState!==null||qn;z=zl;var ae=qn;if(zl=L,(qn=q)&&!ae)for(Be=I;Be!==null;)L=Be,q=L.child,L.tag===22&&L.memoizedState!==null?k0(I):q!==null?(q.return=L,Be=q):k0(I);for(;N!==null;)Be=N,N0(N),N=N.sibling;Be=I,zl=z,qn=ae}R0(s)}else(I.subtreeFlags&8772)!==0&&N!==null?(N.return=I,Be=N):R0(s)}}function R0(s){for(;Be!==null;){var c=Be;if((c.flags&8772)!==0){var m=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:qn||jl(5,c);break;case 1:var C=c.stateNode;if(c.flags&4&&!qn)if(m===null)C.componentDidMount();else{var I=c.elementType===c.type?m.memoizedProps:Yr(c.type,m.memoizedProps);C.componentDidUpdate(I,m.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var N=c.updateQueue;N!==null&&Mh(c,N,C);break;case 3:var L=c.updateQueue;if(L!==null){if(m=null,c.child!==null)switch(c.child.tag){case 5:m=c.child.stateNode;break;case 1:m=c.child.stateNode}Mh(c,L,m)}break;case 5:var z=c.stateNode;if(m===null&&c.flags&4){m=z;var q=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&m.focus();break;case"img":q.src&&(m.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ae=c.alternate;if(ae!==null){var ge=ae.memoizedState;if(ge!==null){var ye=ge.dehydrated;ye!==null&&zr(ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}qn||c.flags&512&&cd(c)}catch(fe){Zt(c,c.return,fe)}}if(c===s){Be=null;break}if(m=c.sibling,m!==null){m.return=c.return,Be=m;break}Be=c.return}}function M0(s){for(;Be!==null;){var c=Be;if(c===s){Be=null;break}var m=c.sibling;if(m!==null){m.return=c.return,Be=m;break}Be=c.return}}function k0(s){for(;Be!==null;){var c=Be;try{switch(c.tag){case 0:case 11:case 15:var m=c.return;try{jl(4,c)}catch(q){Zt(c,m,q)}break;case 1:var C=c.stateNode;if(typeof C.componentDidMount=="function"){var I=c.return;try{C.componentDidMount()}catch(q){Zt(c,I,q)}}var N=c.return;try{cd(c)}catch(q){Zt(c,N,q)}break;case 5:var L=c.return;try{cd(c)}catch(q){Zt(c,L,q)}}}catch(q){Zt(c,c.return,q)}if(c===s){Be=null;break}var z=c.sibling;if(z!==null){z.return=c.return,Be=z;break}Be=c.return}}var jx=Math.ceil,ql=J.ReactCurrentDispatcher,hd=J.ReactCurrentOwner,Fr=J.ReactCurrentBatchConfig,xt=0,In=null,dn=null,On=0,Cr=0,bo=es(0),_n=0,La=null,Us=0,Wl=0,pd=0,Ba=null,ar=null,gd=0,No=1/0,Ri=null,Yl=!1,md=null,os=null,$l=!1,as=null,Kl=0,Fa=0,yd=null,Xl=-1,Jl=0;function Xn(){return(xt&6)!==0?Tt():Xl!==-1?Xl:Xl=Tt()}function ls(s){return(s.mode&1)===0?1:(xt&2)!==0&&On!==0?On&-On:Ix.transition!==null?(Jl===0&&(Jl=yn()),Jl):(s=ot,s!==0||(s=window.event,s=s===void 0?16:da(s.type)),s)}function Xr(s,c,m,C){if(50<Fa)throw Fa=0,yd=null,Error(t(185));V(s,m,C),((xt&2)===0||s!==In)&&(s===In&&((xt&2)===0&&(Wl|=m),_n===4&&us(s,On)),lr(s,C),m===1&&xt===0&&(c.mode&1)===0&&(No=Tt()+500,Al&&ns()))}function lr(s,c){var m=s.callbackNode;zi(s,c);var C=yr(s,s===In?On:0);if(C===0)m!==null&&Sn(m),s.callbackNode=null,s.callbackPriority=0;else if(c=C&-C,s.callbackPriority!==c){if(m!=null&&Sn(m),c===1)s.tag===0?Tx(D0.bind(null,s)):vh(D0.bind(null,s)),_x(function(){(xt&6)===0&&ns()}),m=null;else{switch(ol(C)){case 1:m=ce;break;case 4:m=il;break;case 16:m=Pt;break;case 536870912:m=sl;break;default:m=Pt}m=G0(m,P0.bind(null,s))}s.callbackPriority=c,s.callbackNode=m}}function P0(s,c){if(Xl=-1,Jl=0,(xt&6)!==0)throw Error(t(327));var m=s.callbackNode;if(Ro()&&s.callbackNode!==m)return null;var C=yr(s,s===In?On:0);if(C===0)return null;if((C&30)!==0||(C&s.expiredLanes)!==0||c)c=Ql(s,C);else{c=C;var I=xt;xt|=2;var N=L0();(In!==s||On!==c)&&(Ri=null,No=Tt()+500,Hs(s,c));do try{Yx();break}catch(z){O0(s,z)}while(!0);Oc(),ql.current=N,xt=I,dn!==null?c=0:(In=null,On=0,c=_n)}if(c!==0){if(c===2&&(I=It(s),I!==0&&(C=I,c=xd(s,I))),c===1)throw m=La,Hs(s,0),us(s,C),lr(s,Tt()),m;if(c===6)us(s,C);else{if(I=s.current.alternate,(C&30)===0&&!qx(I)&&(c=Ql(s,C),c===2&&(N=It(s),N!==0&&(C=N,c=xd(s,N))),c===1))throw m=La,Hs(s,0),us(s,C),lr(s,Tt()),m;switch(s.finishedWork=I,s.finishedLanes=C,c){case 0:case 1:throw Error(t(345));case 2:Gs(s,ar,Ri);break;case 3:if(us(s,C),(C&130023424)===C&&(c=gd+500-Tt(),10<c)){if(yr(s,0)!==0)break;if(I=s.suspendedLanes,(I&C)!==C){Xn(),s.pingedLanes|=s.suspendedLanes&I;break}s.timeoutHandle=Sc(Gs.bind(null,s,ar,Ri),c);break}Gs(s,ar,Ri);break;case 4:if(us(s,C),(C&4194240)===C)break;for(c=s.eventTimes,I=-1;0<C;){var L=31-$n(C);N=1<<L,L=c[L],L>I&&(I=L),C&=~N}if(C=I,C=Tt()-C,C=(120>C?120:480>C?480:1080>C?1080:1920>C?1920:3e3>C?3e3:4320>C?4320:1960*jx(C/1960))-C,10<C){s.timeoutHandle=Sc(Gs.bind(null,s,ar,Ri),C);break}Gs(s,ar,Ri);break;case 5:Gs(s,ar,Ri);break;default:throw Error(t(329))}}}return lr(s,Tt()),s.callbackNode===m?P0.bind(null,s):null}function xd(s,c){var m=Ba;return s.current.memoizedState.isDehydrated&&(Hs(s,c).flags|=256),s=Ql(s,c),s!==2&&(c=ar,ar=m,c!==null&&vd(c)),s}function vd(s){ar===null?ar=s:ar.push.apply(ar,s)}function qx(s){for(var c=s;;){if(c.flags&16384){var m=c.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var C=0;C<m.length;C++){var I=m[C],N=I.getSnapshot;I=I.value;try{if(!Q(N(),I))return!1}catch{return!1}}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function us(s,c){for(c&=~pd,c&=~Wl,s.suspendedLanes|=c,s.pingedLanes&=~c,s=s.expirationTimes;0<c;){var m=31-$n(c),C=1<<m;s[m]=-1,c&=~C}}function D0(s){if((xt&6)!==0)throw Error(t(327));Ro();var c=yr(s,0);if((c&1)===0)return lr(s,Tt()),null;var m=Ql(s,c);if(s.tag!==0&&m===2){var C=It(s);C!==0&&(c=C,m=xd(s,C))}if(m===1)throw m=La,Hs(s,0),us(s,c),lr(s,Tt()),m;if(m===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=c,Gs(s,ar,Ri),lr(s,Tt()),null}function wd(s,c){var m=xt;xt|=1;try{return s(c)}finally{xt=m,xt===0&&(No=Tt()+500,Al&&ns())}}function Vs(s){as!==null&&as.tag===0&&(xt&6)===0&&Ro();var c=xt;xt|=1;var m=Fr.transition,C=ot;try{if(Fr.transition=null,ot=1,s)return s()}finally{ot=C,Fr.transition=m,xt=c,(xt&6)===0&&ns()}}function Ed(){Cr=bo.current,Gt(bo)}function Hs(s,c){s.finishedWork=null,s.finishedLanes=0;var m=s.timeoutHandle;if(m!==-1&&(s.timeoutHandle=-1,Ex(m)),dn!==null)for(m=dn.return;m!==null;){var C=m;switch(Rc(C),C.tag){case 1:C=C.type.childContextTypes,C!=null&&Cl();break;case 3:Ao(),Gt(ir),Gt(Gn),zc();break;case 5:Hc(C);break;case 4:Ao();break;case 13:Gt(Kt);break;case 19:Gt(Kt);break;case 10:Lc(C.type._context);break;case 22:case 23:Ed()}m=m.return}if(In=s,dn=s=cs(s.current,null),On=Cr=c,_n=0,La=null,pd=Wl=Us=0,ar=Ba=null,Ls!==null){for(c=0;c<Ls.length;c++)if(m=Ls[c],C=m.interleaved,C!==null){m.interleaved=null;var I=C.next,N=m.pending;if(N!==null){var L=N.next;N.next=I,C.next=L}m.pending=C}Ls=null}return s}function O0(s,c){do{var m=dn;try{if(Oc(),Ol.current=Ul,Ll){for(var C=Xt.memoizedState;C!==null;){var I=C.queue;I!==null&&(I.pending=null),C=C.next}Ll=!1}if(Fs=0,Tn=En=Xt=null,Ra=!1,Ma=0,hd.current=null,m===null||m.return===null){_n=1,La=c,dn=null;break}e:{var N=s,L=m.return,z=m,q=c;if(c=On,z.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ae=q,ge=z,ye=ge.tag;if((ge.mode&1)===0&&(ye===0||ye===11||ye===15)){var fe=ge.alternate;fe?(ge.updateQueue=fe.updateQueue,ge.memoizedState=fe.memoizedState,ge.lanes=fe.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var ke=o0(L);if(ke!==null){ke.flags&=-257,a0(ke,L,z,N,c),ke.mode&1&&s0(N,ae,c),c=ke,q=ae;var Ue=c.updateQueue;if(Ue===null){var Ve=new Set;Ve.add(q),c.updateQueue=Ve}else Ue.add(q);break e}else{if((c&1)===0){s0(N,ae,c),_d();break e}q=Error(t(426))}}else if(qt&&z.mode&1){var un=o0(L);if(un!==null){(un.flags&65536)===0&&(un.flags|=256),a0(un,L,z,N,c),Pc(To(q,z));break e}}N=q=To(q,z),_n!==4&&(_n=2),Ba===null?Ba=[N]:Ba.push(N),N=L;do{switch(N.tag){case 3:N.flags|=65536,c&=-c,N.lanes|=c;var ne=r0(N,q,c);Rh(N,ne);break e;case 1:z=q;var K=N.type,re=N.stateNode;if((N.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(os===null||!os.has(re)))){N.flags|=65536,c&=-c,N.lanes|=c;var _e=i0(N,z,c);Rh(N,_e);break e}}N=N.return}while(N!==null)}F0(m)}catch(He){c=He,dn===m&&m!==null&&(dn=m=m.return);continue}break}while(!0)}function L0(){var s=ql.current;return ql.current=Ul,s===null?Ul:s}function _d(){(_n===0||_n===3||_n===2)&&(_n=4),In===null||(Us&268435455)===0&&(Wl&268435455)===0||us(In,On)}function Ql(s,c){var m=xt;xt|=2;var C=L0();(In!==s||On!==c)&&(Ri=null,Hs(s,c));do try{Wx();break}catch(I){O0(s,I)}while(!0);if(Oc(),xt=m,ql.current=C,dn!==null)throw Error(t(261));return In=null,On=0,_n}function Wx(){for(;dn!==null;)B0(dn)}function Yx(){for(;dn!==null&&!Lt();)B0(dn)}function B0(s){var c=H0(s.alternate,s,Cr);s.memoizedProps=s.pendingProps,c===null?F0(s):dn=c,hd.current=null}function F0(s){var c=s;do{var m=c.alternate;if(s=c.return,(c.flags&32768)===0){if(m=Ux(m,c,Cr),m!==null){dn=m;return}}else{if(m=Vx(m,c),m!==null){m.flags&=32767,dn=m;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{_n=6,dn=null;return}}if(c=c.sibling,c!==null){dn=c;return}dn=c=s}while(c!==null);_n===0&&(_n=5)}function Gs(s,c,m){var C=ot,I=Fr.transition;try{Fr.transition=null,ot=1,$x(s,c,m,C)}finally{Fr.transition=I,ot=C}return null}function $x(s,c,m,C){do Ro();while(as!==null);if((xt&6)!==0)throw Error(t(327));m=s.finishedWork;var I=s.finishedLanes;if(m===null)return null;if(s.finishedWork=null,s.finishedLanes=0,m===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var N=m.lanes|m.childLanes;if(ze(s,N),s===In&&(dn=In=null,On=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||$l||($l=!0,G0(Pt,function(){return Ro(),null})),N=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||N){N=Fr.transition,Fr.transition=null;var L=ot;ot=1;var z=xt;xt|=4,hd.current=null,Gx(s,m),b0(m,s),Hn(_c),ui=!!Ec,_c=Ec=null,s.current=m,zx(m),rl(),xt=z,ot=L,Fr.transition=N}else s.current=m;if($l&&($l=!1,as=s,Kl=I),N=s.pendingLanes,N===0&&(os=null),ft(m.stateNode),lr(s,Tt()),c!==null)for(C=s.onRecoverableError,m=0;m<c.length;m++)I=c[m],C(I.value,{componentStack:I.stack,digest:I.digest});if(Yl)throw Yl=!1,s=md,md=null,s;return(Kl&1)!==0&&s.tag!==0&&Ro(),N=s.pendingLanes,(N&1)!==0?s===yd?Fa++:(Fa=0,yd=s):Fa=0,ns(),null}function Ro(){if(as!==null){var s=ol(Kl),c=Fr.transition,m=ot;try{if(Fr.transition=null,ot=16>s?16:s,as===null)var C=!1;else{if(s=as,as=null,Kl=0,(xt&6)!==0)throw Error(t(331));var I=xt;for(xt|=4,Be=s.current;Be!==null;){var N=Be,L=N.child;if((Be.flags&16)!==0){var z=N.deletions;if(z!==null){for(var q=0;q<z.length;q++){var ae=z[q];for(Be=ae;Be!==null;){var ge=Be;switch(ge.tag){case 0:case 11:case 15:Oa(8,ge,N)}var ye=ge.child;if(ye!==null)ye.return=ge,Be=ye;else for(;Be!==null;){ge=Be;var fe=ge.sibling,ke=ge.return;if(C0(ge),ge===ae){Be=null;break}if(fe!==null){fe.return=ke,Be=fe;break}Be=ke}}}var Ue=N.alternate;if(Ue!==null){var Ve=Ue.child;if(Ve!==null){Ue.child=null;do{var un=Ve.sibling;Ve.sibling=null,Ve=un}while(Ve!==null)}}Be=N}}if((N.subtreeFlags&2064)!==0&&L!==null)L.return=N,Be=L;else e:for(;Be!==null;){if(N=Be,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:Oa(9,N,N.return)}var ne=N.sibling;if(ne!==null){ne.return=N.return,Be=ne;break e}Be=N.return}}var K=s.current;for(Be=K;Be!==null;){L=Be;var re=L.child;if((L.subtreeFlags&2064)!==0&&re!==null)re.return=L,Be=re;else e:for(L=K;Be!==null;){if(z=Be,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:jl(9,z)}}catch(He){Zt(z,z.return,He)}if(z===L){Be=null;break e}var _e=z.sibling;if(_e!==null){_e.return=z.return,Be=_e;break e}Be=z.return}}if(xt=I,ns(),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(mt,s)}catch{}C=!0}return C}finally{ot=m,Fr.transition=c}}return!1}function U0(s,c,m){c=To(m,c),c=r0(s,c,1),s=is(s,c,1),c=Xn(),s!==null&&(V(s,1,c),lr(s,c))}function Zt(s,c,m){if(s.tag===3)U0(s,s,m);else for(;c!==null;){if(c.tag===3){U0(c,s,m);break}else if(c.tag===1){var C=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(os===null||!os.has(C))){s=To(m,s),s=i0(c,s,1),c=is(c,s,1),s=Xn(),c!==null&&(V(c,1,s),lr(c,s));break}}c=c.return}}function Kx(s,c,m){var C=s.pingCache;C!==null&&C.delete(c),c=Xn(),s.pingedLanes|=s.suspendedLanes&m,In===s&&(On&m)===m&&(_n===4||_n===3&&(On&130023424)===On&&500>Tt()-gd?Hs(s,0):pd|=m),lr(s,c)}function V0(s,c){c===0&&((s.mode&1)===0?c=1:(c=so,so<<=1,(so&130023424)===0&&(so=4194304)));var m=Xn();s=Ii(s,c),s!==null&&(V(s,c,m),lr(s,m))}function Xx(s){var c=s.memoizedState,m=0;c!==null&&(m=c.retryLane),V0(s,m)}function Jx(s,c){var m=0;switch(s.tag){case 13:var C=s.stateNode,I=s.memoizedState;I!==null&&(m=I.retryLane);break;case 19:C=s.stateNode;break;default:throw Error(t(314))}C!==null&&C.delete(c),V0(s,m)}var H0;H0=function(s,c,m){if(s!==null)if(s.memoizedProps!==c.pendingProps||ir.current)or=!0;else{if((s.lanes&m)===0&&(c.flags&128)===0)return or=!1,Fx(s,c,m);or=(s.flags&131072)!==0}else or=!1,qt&&(c.flags&1048576)!==0&&wh(c,Il,c.index);switch(c.lanes=0,c.tag){case 2:var C=c.type;Gl(s,c),s=c.pendingProps;var I=xo(c,Gn.current);So(c,m),I=Wc(null,c,C,s,I,m);var N=Yc();return c.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,sr(C)?(N=!0,Sl(c)):N=!1,c.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,Uc(c),I.updater=Vl,c.stateNode=I,I._reactInternals=c,Zc(c,C,s,m),c=rd(null,c,C,!0,N,m)):(c.tag=0,qt&&N&&Nc(c),Kn(null,c,I,m),c=c.child),c;case 16:C=c.elementType;e:{switch(Gl(s,c),s=c.pendingProps,I=C._init,C=I(C._payload),c.type=C,I=c.tag=Zx(C),s=Yr(C,s),I){case 0:c=nd(null,c,C,s,m);break e;case 1:c=h0(null,c,C,s,m);break e;case 11:c=l0(null,c,C,s,m);break e;case 14:c=u0(null,c,C,Yr(C.type,s),m);break e}throw Error(t(306,C,""))}return c;case 0:return C=c.type,I=c.pendingProps,I=c.elementType===C?I:Yr(C,I),nd(s,c,C,I,m);case 1:return C=c.type,I=c.pendingProps,I=c.elementType===C?I:Yr(C,I),h0(s,c,C,I,m);case 3:e:{if(p0(c),s===null)throw Error(t(387));C=c.pendingProps,N=c.memoizedState,I=N.element,Nh(s,c),Pl(c,C,null,m);var L=c.memoizedState;if(C=L.element,N.isDehydrated)if(N={element:C,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},c.updateQueue.baseState=N,c.memoizedState=N,c.flags&256){I=To(Error(t(423)),c),c=g0(s,c,C,m,I);break e}else if(C!==I){I=To(Error(t(424)),c),c=g0(s,c,C,m,I);break e}else for(_r=Zi(c.stateNode.containerInfo.firstChild),Er=c,qt=!0,Wr=null,m=Ih(c,null,C,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Eo(),C===I){c=Ni(s,c,m);break e}Kn(s,c,C,m)}c=c.child}return c;case 5:return kh(c),s===null&&kc(c),C=c.type,I=c.pendingProps,N=s!==null?s.memoizedProps:null,L=I.children,Cc(C,I)?L=null:N!==null&&Cc(C,N)&&(c.flags|=32),f0(s,c),Kn(s,c,L,m),c.child;case 6:return s===null&&kc(c),null;case 13:return m0(s,c,m);case 4:return Vc(c,c.stateNode.containerInfo),C=c.pendingProps,s===null?c.child=_o(c,null,C,m):Kn(s,c,C,m),c.child;case 11:return C=c.type,I=c.pendingProps,I=c.elementType===C?I:Yr(C,I),l0(s,c,C,I,m);case 7:return Kn(s,c,c.pendingProps,m),c.child;case 8:return Kn(s,c,c.pendingProps.children,m),c.child;case 12:return Kn(s,c,c.pendingProps.children,m),c.child;case 10:e:{if(C=c.type._context,I=c.pendingProps,N=c.memoizedProps,L=I.value,Ut(Rl,C._currentValue),C._currentValue=L,N!==null)if(Q(N.value,L)){if(N.children===I.children&&!ir.current){c=Ni(s,c,m);break e}}else for(N=c.child,N!==null&&(N.return=c);N!==null;){var z=N.dependencies;if(z!==null){L=N.child;for(var q=z.firstContext;q!==null;){if(q.context===C){if(N.tag===1){q=bi(-1,m&-m),q.tag=2;var ae=N.updateQueue;if(ae!==null){ae=ae.shared;var ge=ae.pending;ge===null?q.next=q:(q.next=ge.next,ge.next=q),ae.pending=q}}N.lanes|=m,q=N.alternate,q!==null&&(q.lanes|=m),Bc(N.return,m,c),z.lanes|=m;break}q=q.next}}else if(N.tag===10)L=N.type===c.type?null:N.child;else if(N.tag===18){if(L=N.return,L===null)throw Error(t(341));L.lanes|=m,z=L.alternate,z!==null&&(z.lanes|=m),Bc(L,m,c),L=N.sibling}else L=N.child;if(L!==null)L.return=N;else for(L=N;L!==null;){if(L===c){L=null;break}if(N=L.sibling,N!==null){N.return=L.return,L=N;break}L=L.return}N=L}Kn(s,c,I.children,m),c=c.child}return c;case 9:return I=c.type,C=c.pendingProps.children,So(c,m),I=Lr(I),C=C(I),c.flags|=1,Kn(s,c,C,m),c.child;case 14:return C=c.type,I=Yr(C,c.pendingProps),I=Yr(C.type,I),u0(s,c,C,I,m);case 15:return c0(s,c,c.type,c.pendingProps,m);case 17:return C=c.type,I=c.pendingProps,I=c.elementType===C?I:Yr(C,I),Gl(s,c),c.tag=1,sr(C)?(s=!0,Sl(c)):s=!1,So(c,m),t0(c,C,I),Zc(c,C,I,m),rd(null,c,C,!0,s,m);case 19:return x0(s,c,m);case 22:return d0(s,c,m)}throw Error(t(156,c.tag))};function G0(s,c){return gr(s,c)}function Qx(s,c,m,C){this.tag=s,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(s,c,m,C){return new Qx(s,c,m,C)}function Cd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zx(s){if(typeof s=="function")return Cd(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Ie)return 11;if(s===ie)return 14}return 2}function cs(s,c){var m=s.alternate;return m===null?(m=Ur(s.tag,c,s.key,s.mode),m.elementType=s.elementType,m.type=s.type,m.stateNode=s.stateNode,m.alternate=s,s.alternate=m):(m.pendingProps=c,m.type=s.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=s.flags&14680064,m.childLanes=s.childLanes,m.lanes=s.lanes,m.child=s.child,m.memoizedProps=s.memoizedProps,m.memoizedState=s.memoizedState,m.updateQueue=s.updateQueue,c=s.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=s.sibling,m.index=s.index,m.ref=s.ref,m}function Zl(s,c,m,C,I,N){var L=2;if(C=s,typeof s=="function")Cd(s)&&(L=1);else if(typeof s=="string")L=5;else e:switch(s){case ee:return zs(m.children,I,N,c);case Te:L=8,I|=8;break;case Z:return s=Ur(12,m,c,I|2),s.elementType=Z,s.lanes=N,s;case Ne:return s=Ur(13,m,c,I),s.elementType=Ne,s.lanes=N,s;case We:return s=Ur(19,m,c,I),s.elementType=We,s.lanes=N,s;case me:return eu(m,I,N,c);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Se:L=10;break e;case Pe:L=9;break e;case Ie:L=11;break e;case ie:L=14;break e;case ve:L=16,C=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return c=Ur(L,m,c,I),c.elementType=s,c.type=C,c.lanes=N,c}function zs(s,c,m,C){return s=Ur(7,s,C,c),s.lanes=m,s}function eu(s,c,m,C){return s=Ur(22,s,C,c),s.elementType=me,s.lanes=m,s.stateNode={isHidden:!1},s}function Sd(s,c,m){return s=Ur(6,s,null,c),s.lanes=m,s}function Ad(s,c,m){return c=Ur(4,s.children!==null?s.children:[],s.key,c),c.lanes=m,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}function ev(s,c,m,C,I){this.tag=c,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=te(0),this.expirationTimes=te(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=te(0),this.identifierPrefix=C,this.onRecoverableError=I,this.mutableSourceEagerHydrationData=null}function Td(s,c,m,C,I,N,L,z,q){return s=new ev(s,c,m,z,q),c===1?(c=1,N===!0&&(c|=8)):c=0,N=Ur(3,null,null,c),s.current=N,N.stateNode=s,N.memoizedState={element:C,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uc(N),s}function tv(s,c,m){var C=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ue,key:C==null?null:""+C,children:s,containerInfo:c,implementation:m}}function z0(s){if(!s)return ts;s=s._reactInternals;e:{if(rr(s)!==s||s.tag!==1)throw Error(t(170));var c=s;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(sr(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(s.tag===1){var m=s.type;if(sr(m))return yh(s,m,c)}return c}function j0(s,c,m,C,I,N,L,z,q){return s=Td(m,C,!0,s,I,N,L,z,q),s.context=z0(null),m=s.current,C=Xn(),I=ls(m),N=bi(C,I),N.callback=c??null,is(m,N,I),s.current.lanes=I,V(s,I,C),lr(s,C),s}function tu(s,c,m,C){var I=c.current,N=Xn(),L=ls(I);return m=z0(m),c.context===null?c.context=m:c.pendingContext=m,c=bi(N,L),c.payload={element:s},C=C===void 0?null:C,C!==null&&(c.callback=C),s=is(I,c,L),s!==null&&(Xr(s,I,L,N),kl(s,I,L)),L}function nu(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function q0(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var m=s.retryLane;s.retryLane=m!==0&&m<c?m:c}}function Id(s,c){q0(s,c),(s=s.alternate)&&q0(s,c)}function nv(){return null}var W0=typeof reportError=="function"?reportError:function(s){console.error(s)};function bd(s){this._internalRoot=s}ru.prototype.render=bd.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(t(409));tu(s,c,null,null)},ru.prototype.unmount=bd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;Vs(function(){tu(null,s,null,null)}),c[Ci]=null}};function ru(s){this._internalRoot=s}ru.prototype.unstable_scheduleHydration=function(s){if(s){var c=Bt();s={blockedOn:null,target:s,priority:c};for(var m=0;m<Mn.length&&c!==0&&c<Mn[m].priority;m++);Mn.splice(m,0,s),m===0&&ll(s)}};function Nd(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function iu(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Y0(){}function rv(s,c,m,C,I){if(I){if(typeof C=="function"){var N=C;C=function(){var ae=nu(L);N.call(ae)}}var L=j0(c,C,s,0,null,!1,!1,"",Y0);return s._reactRootContainer=L,s[Ci]=L.current,_a(s.nodeType===8?s.parentNode:s),Vs(),L}for(;I=s.lastChild;)s.removeChild(I);if(typeof C=="function"){var z=C;C=function(){var ae=nu(q);z.call(ae)}}var q=Td(s,0,!1,null,null,!1,!1,"",Y0);return s._reactRootContainer=q,s[Ci]=q.current,_a(s.nodeType===8?s.parentNode:s),Vs(function(){tu(c,q,m,C)}),q}function su(s,c,m,C,I){var N=m._reactRootContainer;if(N){var L=N;if(typeof I=="function"){var z=I;I=function(){var q=nu(L);z.call(q)}}tu(c,L,s,I)}else L=rv(m,c,s,I,C);return nu(L)}oo=function(s){switch(s.tag){case 3:var c=s.stateNode;if(c.current.memoizedState.isDehydrated){var m=Dt(c.pendingLanes);m!==0&&(Jt(c,m|1),lr(c,Tt()),(xt&6)===0&&(No=Tt()+500,ns()))}break;case 13:Vs(function(){var C=Ii(s,1);if(C!==null){var I=Xn();Xr(C,s,1,I)}}),Id(s,1)}},Vn=function(s){if(s.tag===13){var c=Ii(s,134217728);if(c!==null){var m=Xn();Xr(c,s,134217728,m)}Id(s,134217728)}},je=function(s){if(s.tag===13){var c=ls(s),m=Ii(s,c);if(m!==null){var C=Xn();Xr(m,s,c,C)}Id(s,c)}},Bt=function(){return ot},la=function(s,c){var m=ot;try{return ot=s,c()}finally{ot=m}},ro=function(s,c,m){switch(c){case"input":if(rn(s,m),c=m.name,m.type==="radio"&&c!=null){for(m=s;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<m.length;c++){var C=m[c];if(C!==s&&C.form===s.form){var I=_l(C);if(!I)throw Error(t(90));xs(C),rn(C,I)}}}break;case"textarea":br(s,m);break;case"select":c=m.value,c!=null&&Oe(s,!!m.multiple,c,!1)}},io=wd,mn=Vs;var iv={usingClientEntryPoint:!1,Events:[Aa,mo,_l,ta,nr,wd]},Ua={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sv={bundleType:Ua.bundleType,version:Ua.version,rendererPackageName:Ua.rendererPackageName,rendererConfig:Ua.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=tl(s),s===null?null:s.stateNode},findFiberByHostInstance:Ua.findFiberByHostInstance||nv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{mt=ou.inject(sv),st=ou}catch{}}return ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iv,ur.createPortal=function(s,c){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nd(c))throw Error(t(200));return tv(s,c,null,m)},ur.createRoot=function(s,c){if(!Nd(s))throw Error(t(299));var m=!1,C="",I=W0;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(C=c.identifierPrefix),c.onRecoverableError!==void 0&&(I=c.onRecoverableError)),c=Td(s,1,!1,null,null,m,!1,C,I),s[Ci]=c.current,_a(s.nodeType===8?s.parentNode:s),new bd(c)},ur.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=tl(c),s=s===null?null:s.stateNode,s},ur.flushSync=function(s){return Vs(s)},ur.hydrate=function(s,c,m){if(!iu(c))throw Error(t(200));return su(null,s,c,!0,m)},ur.hydrateRoot=function(s,c,m){if(!Nd(s))throw Error(t(405));var C=m!=null&&m.hydratedSources||null,I=!1,N="",L=W0;if(m!=null&&(m.unstable_strictMode===!0&&(I=!0),m.identifierPrefix!==void 0&&(N=m.identifierPrefix),m.onRecoverableError!==void 0&&(L=m.onRecoverableError)),c=j0(c,null,s,1,m??null,I,!1,N,L),s[Ci]=c.current,_a(s),C)for(s=0;s<C.length;s++)m=C[s],I=m._getVersion,I=I(m._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[m,I]:c.mutableSourceEagerHydrationData.push(m,I);return new ru(c)},ur.render=function(s,c,m){if(!iu(c))throw Error(t(200));return su(null,s,c,!1,m)},ur.unmountComponentAtNode=function(s){if(!iu(s))throw Error(t(40));return s._reactRootContainer?(Vs(function(){su(null,null,s,!1,function(){s._reactRootContainer=null,s[Ci]=null})}),!0):!1},ur.unstable_batchedUpdates=wd,ur.unstable_renderSubtreeIntoContainer=function(s,c,m,C){if(!iu(m))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return su(s,c,m,!1,C)},ur.version="18.3.1-next-f1338f8080-20240426",ur}var tp;function hv(){if(tp)return kd.exports;tp=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kd.exports=fv(),kd.exports}var np;function pv(){if(np)return lu;np=1;var n=hv();return lu.createRoot=n.createRoot,lu.hydrateRoot=n.hydrateRoot,lu}var gv=pv();const mv=Ku(gv);var bt=(n=>(n.HOME="HOME",n.BOOKING="BOOKING",n.CATALOG="CATALOG",n.CONTACT="CONTACT",n.CONFIRMATION="CONFIRMATION",n.LOYALTY="LOYALTY",n.ADMIN="ADMIN",n.GALLERY="GALLERY",n))(bt||{}),yv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xv=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Et=(n,e)=>{const t=Je.forwardRef(({color:i="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:f,children:x,...v},p)=>Je.createElement("svg",{ref:p,...yv,width:a,height:a,stroke:i,strokeWidth:f?Number(l)*24/Number(a):l,className:`lucide lucide-${xv(n)}`,...v},[...e.map(([_,A])=>Je.createElement(_,A)),...(Array.isArray(x)?x:[x])||[]]));return t.displayName=`${n}`,t},vv=Et("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),wv=Et("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Ev=Et("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Pg=Et("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),_v=Et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Cv=Et("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),Dg=Et("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Sv=Et("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Av=Et("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Tv=Et("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Nu=Et("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Og=Et("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Iv=Et("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Lg=Et("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),bv=Et("PackageSearch",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["circle",{cx:"18.5",cy:"15.5",r:"2.5",key:"b5zd12"}],["path",{d:"M20.27 17.27 22 19",key:"1l4muz"}]]),Nv=Et("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Rv=Et("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Mv=Et("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]),kv=Et("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Pv=Et("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Pf=Et("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),Bg=Et("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Dv=Et("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Ov=Et("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Lv=Et("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Xu=Et("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),Bv=Et("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),$d=Et("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Df=Et("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Fv=Et("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ju=Et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uv=Et("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Vv=({currentView:n,onChangeView:e})=>{const[t,i]=Je.useState(!1),[a,l]=Je.useState(!1);Je.useEffect(()=>{const p=()=>{i(window.scrollY>50)};return window.addEventListener("scroll",p),()=>window.removeEventListener("scroll",p)},[]);const f=`fixed w-full z-50 transition-all duration-300 ${t?"bg-white/90 backdrop-blur-md shadow-sm py-2":"bg-transparent py-4"}`,x=p=>`cursor-pointer font-medium tracking-wide transition-colors ${n===p?"text-stone-900 border-b-2 border-stone-800":t?"text-stone-600 hover:text-stone-900":"text-stone-800 hover:text-stone-600"}`,v=p=>{e(p),l(!1)};return M.jsxs("nav",{className:f,children:[M.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:M.jsxs("div",{className:"flex justify-between items-center h-16",children:[M.jsx("div",{className:"flex-shrink-0 flex items-center cursor-pointer",onClick:()=>v(bt.HOME),children:M.jsxs("span",{className:"serif text-3xl font-bold italic tracking-tighter text-stone-900",children:["Tus3B ",M.jsx("span",{className:"text-stone-500 not-italic font-light text-xl ml-1",children:"Style"})]})}),M.jsxs("div",{className:"hidden md:flex space-x-12 items-center",children:[M.jsx("a",{onClick:()=>v(bt.HOME),className:x(bt.HOME),children:"Inicio"}),M.jsx("a",{onClick:()=>v(bt.BOOKING),className:x(bt.BOOKING),children:"Servicios & Reserva"}),M.jsx("a",{onClick:()=>v(bt.CATALOG),className:x(bt.CATALOG),children:"Perfumes (Decants)"}),M.jsx("button",{onClick:()=>v(bt.BOOKING),className:"bg-stone-900 text-white px-6 py-2 rounded-full text-sm uppercase tracking-wider hover:bg-stone-800 transition shadow-lg",children:"Reservar"})]}),M.jsx("div",{className:"md:hidden flex items-center",children:M.jsx("button",{onClick:()=>l(!a),className:"text-stone-800 focus:outline-none",children:a?M.jsx(Ju,{size:28}):M.jsx(Iv,{size:28})})})]})}),a&&M.jsxs("div",{className:"md:hidden fixed inset-0 top-16 bg-white z-40 flex flex-col p-6 space-y-8 animate-in slide-in-from-right-10",children:[M.jsx("button",{onClick:()=>v(bt.HOME),className:"flex items-center space-x-4 text-xl font-medium text-stone-700 p-2 active:bg-stone-50 rounded-lg",children:M.jsx("span",{children:"Inicio"})}),M.jsxs("button",{onClick:()=>v(bt.BOOKING),className:"flex items-center space-x-4 text-xl font-medium text-stone-700 p-2 active:bg-stone-50 rounded-lg",children:[M.jsx(Pf,{size:24}),M.jsx("span",{children:"Corte & Brushing"})]}),M.jsxs("button",{onClick:()=>v(bt.CATALOG),className:"flex items-center space-x-4 text-xl font-medium text-stone-700 p-2 active:bg-stone-50 rounded-lg",children:[M.jsx(Xu,{size:24}),M.jsx("span",{children:"Perfumes"})]}),M.jsx("div",{className:"mt-auto pb-8",children:M.jsx("button",{onClick:()=>v(bt.BOOKING),className:"w-full bg-stone-900 text-white py-4 rounded-xl text-center uppercase tracking-widest font-bold shadow-lg active:scale-95 transition-transform",children:"Agendar Cita"})})]})]})},Hv=({onCtaClick:n})=>M.jsxs("div",{className:"relative h-screen min-h-[600px] w-full overflow-hidden",children:[M.jsxs("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url('/images/greici/greici-main-new.jpg')"},children:[M.jsx("div",{className:"absolute inset-0 bg-black/20 mix-blend-multiply"}),M.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-stone-900/60 via-transparent to-transparent"})]}),M.jsxs("div",{className:"relative h-full flex flex-col justify-center items-center text-center px-4",children:[M.jsx("h2",{className:"text-white text-base md:text-xl uppercase tracking-[0.3em] mb-4 font-light",children:"Belleza & Elegancia"}),M.jsxs("h1",{className:"text-white text-4xl md:text-7xl lg:text-8xl serif font-light mb-6 md:mb-8 max-w-4xl leading-tight",children:["Redefine Tu Estilo ",M.jsx("br",{})," ",M.jsx("span",{className:"italic",children:"Tu Esencia"})]}),M.jsx("p",{className:"text-stone-200 max-w-lg mx-auto text-lg mb-10 font-light",children:"Cortes profesionales a domicilio y perfumera de alta gama. Descubre nuestras ofertas de verano."}),M.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:M.jsx("button",{onClick:n,className:"px-8 py-4 bg-white text-stone-900 rounded-full font-bold uppercase tracking-widest hover:bg-stone-100 transition shadow-lg",children:"Reserva Tu Cita"})}),M.jsxs("div",{className:"mt-12 flex items-center justify-center space-x-8 text-white/90 text-sm font-medium",children:[M.jsxs("div",{className:"flex items-center bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[M.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"}),"Disponible Hoy"]}),M.jsxs("div",{className:"flex items-center bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10",children:[M.jsx("span",{className:"mr-1",children:"Desde"}),M.jsx("span",{className:"font-bold text-lg",children:"$7.000"})]})]})]})]}),Ru="56984524774",ja=[{id:"cut-1",name:"Corte de Puntas / Flequillos",description:"Mantenimiento esencial para eliminar horquillas y sanear el cabello.",price:7e3,durationMin:30,includes:["Corte tcnico de puntas o flequillo","Sellado de puntas"]},{id:"cut-2",name:"Corte Bordado",description:"Elimina el frizz y puntas daadas sin afectar el largo de tu cabello.",price:1e4,durationMin:45,includes:["Corte con mquina bordadora","Limpieza de puntas"]},{id:"wash-1",name:"Lavado",description:"Lavado profesional refrescante.",price:5e3,durationMin:20,includes:["Shampoo profesional","Acondicionador"],homeServiceOnly:!0},{id:"massage-1",name:"Masaje Capilar",description:"Tratamiento profundo para hidratar y revitalizar tu cabello.",price:5e3,durationMin:30,includes:["Ampolla o crema de tratamiento","Masaje craneal"]},{id:"brushing-1",name:"Brushing",description:"Peinado profesional para dar volumen, brillo y movimiento.",price:14e3,durationMin:45,includes:["Secado","Modelado con cepillo"]},{id:"color-1",name:"Aplicacin de Tintura",description:"Aplicacin profesional de tu color (tintura no incluida).",price:1e4,durationMin:60,includes:["Aplicacin uniforme","Lavado final"],homeServiceOnly:!0}],Gv=3e3,zv=30,jv=["Santiago Centro","uoa"],Kd=[{id:"p1",brand:"Lancme",name:"La Vie Est Belle EDP",description:'Proyectado como el lder indiscutible en valor. Destaca por su nota de "Iris Noble" y se mantiene como el pilar del lujo y la "felicidad".',price5ml:9990,price10ml:18990,image:"/images/perfumes/lancome-la-vie-est-belle.png",notes:["Floral Gourmand","Iris Noble","Pachul"],category:"classic"},{id:"p2",brand:"Carolina Herrera",name:"Good Girl EDP",description:"Un smbolo de estatus masivo en Chile. Su aroma potente (tuberosa y caf) y su icnica botella de tacn aseguran su puesto en el podio.",price5ml:9990,price10ml:18990,image:"/images/perfumes/carolina-herrera-good-girl.png",notes:["mbar Floral","Tuberosa","Caf"],category:"classic"},{id:"p3",brand:"Lancme",name:"Idle EDP",description:"Se consolida como la opcin moderna y elegante, especialmente atractiva para el segmento millennial que busca notas de flores blancas y sal.",price5ml:10500,price10ml:19500,image:"/images/perfumes/lancome-idole.png",notes:["Chipre Floral","Flores Blancas","Sal"],category:"classic"},{id:"p4",brand:"Giorgio Armani",name:"Acqua Di Gioia EDP",description:"Un clsico esencial para el verano chileno. Se mantiene en el top por su perfil fresco de menta y limn, ideal para el uso diario.",price5ml:9500,price10ml:17900,image:"/images/perfumes/armani-acqua-di-gioia.png",notes:["Floral Acutica","Menta","Limn"],category:"classic"},{id:"p5",brand:"Yves Saint Laurent",name:"Black Opium EDP",description:"Sigue firme en las listas de popularidad para 2025-26, siendo la opcin preferida para la vida nocturna y fiestas por su intensidad.",price5ml:10990,price10ml:19990,image:"/images/perfumes/ysl-black-opium.png",notes:["Oriental Vainilla","Caf","Vainilla"],category:"classic"},{id:"p6",brand:"Dolce & Gabbana",name:"Light Blue EDT",description:"A pesar de las nuevas propuestas, este clsico mantiene su popularidad gracias a su reconocimiento global y frescura, ideal para primavera-verano.",price5ml:8990,price10ml:16990,image:"/images/perfumes/dg-light-blue.png",notes:["Floral Frutal","Manzana","Cedro"],category:"classic"},{id:"a1",brand:"Lattafa",name:"Yara EDP",description:"Es el fenmeno viral del momento en Chile. Destaca por su aroma dulce y cremoso (a menudo comparado con batido de fresa) y lidera las ventas online.",price5ml:5990,price10ml:10990,image:"/images/perfumes/lattafa-yara.png",notes:["Orqudea","Heliotropo","Frutas Tropicales"],category:"arab"},{id:"a2",brand:"Armaf",name:"Club de Nuit Intense Woman",description:"Un superventas constante en tiendas especializadas chilenas. Es muy buscado por su perfil olfativo oscuro y elegante, similar a Coco Noir de Chanel.",price5ml:6500,price10ml:11990,image:"/images/perfumes/armaf-club-de-nuit-intense.png",notes:["Rosa","Azafrn","Pachul"],category:"arab"},{id:"a3",brand:"Lattafa",name:"Eclaire EDP",description:"Una tendencia creciente en 2025-26 dentro de la categora gourmand (aromas comestibles).",price5ml:6990,price10ml:12500,image:"/images/perfumes/lattafa-eclaire.png",notes:["Caramelo","Leche","Miel"],category:"arab"},{id:"a4",brand:"Armaf",name:"Club de Nuit Imperiale",description:"Gana popularidad por su similitud con Delina Exclusif. Es una opcin floral frutal muy potente y femenina disponible en el retail local.",price5ml:7500,price10ml:13500,image:"/images/perfumes/armaf-imperiale.png",notes:["Lichi","Bergamota","Rosa Turca"],category:"arab"},{id:"a5",brand:"Armaf",name:"Club de Nuit Untold",description:"Aunque es unisex, tiene una venta masiva en el pblico femenino por ser la alternativa directa al lujoso Baccarat Rouge 540.",price5ml:7500,price10ml:13500,image:"/images/perfumes/armaf-untold.png",notes:["Azafrn","Jazmn","mbar Gris"],category:"arab"},{id:"a6",brand:"Lattafa",name:"Khamrah",description:"Un xito rotundo en ventas globales y locales. Es una fragancia unisex que muchas mujeres chilenas adoptan en invierno por su calidez especiada y dulce.",price5ml:7990,price10ml:14500,image:"/images/perfumes/lattafa-khamrah.png",notes:["Dtiles","Canela","Vainilla"],category:"arab"}],rp=[{id:"1",url:"/images/greici/greici-portrait.jpg",category:"Cortes",description:"Estilista Greici Nataly"},{id:"2",url:"/images/greici/greici-salon-wide.jpg",category:"Color",description:"Atencin Personalizada"},{id:"3",url:"/images/greici/greici-back-view.jpg",category:"Cortes",description:"Acabados Perfectos"},{id:"4",url:"/images/greici/greici-red-shirt.jpg",category:"Cortes",description:"Precisin y Estilo"},{id:"5",url:"/images/greici/greici-side-work.jpg",category:"Color",description:"Tcnica Profesional"}],qv=[{id:"r1",name:"Maria Paz",rating:5,comment:"Me encant el servicio, muy profesionales y puntuales. El corte que me hicieron fue exactamente lo que peda.",date:"Hace 2 semanas"},{id:"r2",name:"Carla S.",rating:5,comment:"Increble la atencin a domicilio. Todo muy limpio y ordenado, y los perfumes huelen delicioso. Totalmente recomendada.",date:"Hace 1 mes"},{id:"r3",name:"Valentina R.",rating:5,comment:"Compr el Lattafa Yara y es exquisito, lleg super rpido. Adems aprovech de hacerme un masaje capilar y qued como nueva.",date:"Hace 3 semanas"},{id:"r4",name:"Isidora M.",rating:5,comment:"Excelente experiencia con Tus3B. La calidad de los productos y la dedicacin en el servicio se notan. Volver a comprar seguro.",date:"Hace 1 mes"},{id:"r5",name:"Fernanda L.",rating:5,comment:"Muy buena disposicin y asesora para elegir mi perfume. Los precios son muy convenientes para la calidad que ofrecen.",date:"Hace 2 semanas"},{id:"r6",name:"Camila J.",rating:4,comment:"Todo super bien, el perfume lleg en perfecto estado. Solo demor un poquito ms de lo esperado la coordinacin, pero la atencin un 7.",date:"Hace 1 mes"}];var Mi={},uu={},Xd=function(n,e){return Xd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])},Xd(n,e)};function Fg(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Xd(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Mu=function(){return Mu=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++){t=arguments[i];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},Mu.apply(this,arguments)};function $o(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t}function Ug(n,e,t,i){var a=arguments.length,l=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,e,t,i);else for(var x=n.length-1;x>=0;x--)(f=n[x])&&(l=(a<3?f(l):a>3?f(e,t,l):f(e,t))||l);return a>3&&l&&Object.defineProperty(e,t,l),l}function Vg(n,e){return function(t,i){e(t,i,n)}}function Hg(n,e,t,i,a,l){function f(W){if(W!==void 0&&typeof W!="function")throw new TypeError("Function expected");return W}for(var x=i.kind,v=x==="getter"?"get":x==="setter"?"set":"value",p=!e&&n?i.static?n:n.prototype:null,_=e||(p?Object.getOwnPropertyDescriptor(p,i.name):{}),A,b=!1,k=t.length-1;k>=0;k--){var O={};for(var U in i)O[U]=U==="access"?{}:i[U];for(var U in i.access)O.access[U]=i.access[U];O.addInitializer=function(W){if(b)throw new TypeError("Cannot add initializers after decoration has completed");l.push(f(W||null))};var F=(0,t[k])(x==="accessor"?{get:_.get,set:_.set}:_[v],O);if(x==="accessor"){if(F===void 0)continue;if(F===null||typeof F!="object")throw new TypeError("Object expected");(A=f(F.get))&&(_.get=A),(A=f(F.set))&&(_.set=A),(A=f(F.init))&&a.unshift(A)}else(A=f(F))&&(x==="field"?a.unshift(A):_[v]=A)}p&&Object.defineProperty(p,i.name,_),b=!0}function Gg(n,e,t){for(var i=arguments.length>2,a=0;a<e.length;a++)t=i?e[a].call(n,t):e[a].call(n);return i?t:void 0}function zg(n){return typeof n=="symbol"?n:"".concat(n)}function jg(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function qg(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Fe(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})}function Wg(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=x(0),f.throw=x(1),f.return=x(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var Qu=Object.create?(function(n,e,t,i){i===void 0&&(i=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,a)}):(function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]});function Yg(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Qu(e,n,t)}function ku(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Of(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),a,l=[],f;try{for(;(e===void 0||e-- >0)&&!(a=i.next()).done;)l.push(a.value)}catch(x){f={error:x}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(f)throw f.error}}return l}function $g(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Of(arguments[e]));return n}function Kg(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),a=0,e=0;e<t;e++)for(var l=arguments[e],f=0,x=l.length;f<x;f++,a++)i[a]=l[f];return i}function Xg(n,e,t){if(t||arguments.length===2)for(var i=0,a=e.length,l;i<a;i++)(l||!(i in e))&&(l||(l=Array.prototype.slice.call(e,0,i)),l[i]=e[i]);return n.concat(l||Array.prototype.slice.call(e))}function Wo(n){return this instanceof Wo?(this.v=n,this):new Wo(n)}function Jg(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),x("next"),x("throw"),x("return",f),a[Symbol.asyncIterator]=function(){return this},a;function f(k){return function(O){return Promise.resolve(O).then(k,A)}}function x(k,O){i[k]&&(a[k]=function(U){return new Promise(function(F,W){l.push([k,U,F,W])>1||v(k,U)})},O&&(a[k]=O(a[k])))}function v(k,O){try{p(i[k](O))}catch(U){b(l[0][3],U)}}function p(k){k.value instanceof Wo?Promise.resolve(k.value.v).then(_,A):b(l[0][2],k)}function _(k){v("next",k)}function A(k){v("throw",k)}function b(k,O){k(O),l.shift(),l.length&&v(l[0][0],l[0][1])}}function Qg(n){var e,t;return e={},i("next"),i("throw",function(a){throw a}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(a,l){e[a]=n[a]?function(f){return(t=!t)?{value:Wo(n[a](f)),done:!1}:l?l(f):f}:l}}function Zg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ku=="function"?ku(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(f){return new Promise(function(x,v){f=n[l](f),a(x,v,f.done,f.value)})}}function a(l,f,x,v){Promise.resolve(v).then(function(p){l({value:p,done:x})},f)}}function em(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Wv=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},Jd=function(n){return Jd=Object.getOwnPropertyNames||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[t.length]=i);return t},Jd(n)};function tm(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=Jd(n),i=0;i<t.length;i++)t[i]!=="default"&&Qu(e,n,t[i]);return Wv(e,n),e}function nm(n){return n&&n.__esModule?n:{default:n}}function rm(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)}function im(n,e,t,i,a){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t}function sm(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function om(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var i,a;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose],t&&(a=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");a&&(i=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),n.stack.push({value:e,dispose:i,async:t})}else t&&n.stack.push({async:!0});return e}var Yv=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var i=new Error(t);return i.name="SuppressedError",i.error=n,i.suppressed=e,i};function am(n){function e(l){n.error=n.hasError?new Yv(l,n.error,"An error was suppressed during disposal."):l,n.hasError=!0}var t,i=0;function a(){for(;t=n.stack.pop();)try{if(!t.async&&i===1)return i=0,n.stack.push(t),Promise.resolve().then(a);if(t.dispose){var l=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(l).then(a,function(f){return e(f),a()})}else i|=1}catch(f){e(f)}if(i===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return a()}function lm(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,i,a,l,f){return i?e?".jsx":".js":a&&(!l||!f)?t:a+l+"."+f.toLowerCase()+"js"}):n}const $v={__extends:Fg,__assign:Mu,__rest:$o,__decorate:Ug,__param:Vg,__esDecorate:Hg,__runInitializers:Gg,__propKey:zg,__setFunctionName:jg,__metadata:qg,__awaiter:Fe,__generator:Wg,__createBinding:Qu,__exportStar:Yg,__values:ku,__read:Of,__spread:$g,__spreadArrays:Kg,__spreadArray:Xg,__await:Wo,__asyncGenerator:Jg,__asyncDelegator:Qg,__asyncValues:Zg,__makeTemplateObject:em,__importStar:tm,__importDefault:nm,__classPrivateFieldGet:rm,__classPrivateFieldSet:im,__classPrivateFieldIn:sm,__addDisposableResource:om,__disposeResources:am,__rewriteRelativeImportExtension:lm},Kv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:om,get __assign(){return Mu},__asyncDelegator:Qg,__asyncGenerator:Jg,__asyncValues:Zg,__await:Wo,__awaiter:Fe,__classPrivateFieldGet:rm,__classPrivateFieldIn:sm,__classPrivateFieldSet:im,__createBinding:Qu,__decorate:Ug,__disposeResources:am,__esDecorate:Hg,__exportStar:Yg,__extends:Fg,__generator:Wg,__importDefault:nm,__importStar:tm,__makeTemplateObject:em,__metadata:qg,__param:Vg,__propKey:zg,__read:Of,__rest:$o,__rewriteRelativeImportExtension:lm,__runInitializers:Gg,__setFunctionName:jg,__spread:$g,__spreadArray:Xg,__spreadArrays:Kg,__values:ku,default:$v},Symbol.toStringTag,{value:"Module"})),Xv=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);let Zu=class extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}},um=class extends Zu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Qd=class extends Zu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Zd=class extends Zu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}};var Pu;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Pu||(Pu={}));class Jv{constructor(e,{headers:t={},customFetch:i,region:a=Pu.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=Xv(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Fe(this,arguments,void 0,function*(t,i={}){var a;let l,f;try{const{headers:x,method:v,body:p,signal:_,timeout:A}=i;let b={},{region:k}=i;k||(k=this.region);const O=new URL(`${this.url}/${t}`);k&&k!=="any"&&(b["x-region"]=k,O.searchParams.set("forceFunctionRegion",k));let U;p&&(x&&!Object.prototype.hasOwnProperty.call(x,"Content-Type")||!x)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",U=p):typeof p=="string"?(b["Content-Type"]="text/plain",U=p):typeof FormData<"u"&&p instanceof FormData?U=p:(b["Content-Type"]="application/json",U=JSON.stringify(p)):U=p;let F=_;A&&(f=new AbortController,l=setTimeout(()=>f.abort(),A),_?(F=f.signal,_.addEventListener("abort",()=>f.abort())):F=f.signal);const W=yield this.fetch(O.toString(),{method:v||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),x),body:U,signal:F}).catch(de=>{throw new um(de)}),$=W.headers.get("x-relay-error");if($&&$==="true")throw new Qd(W);if(!W.ok)throw new Zd(W);let G=((a=W.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),J;return G==="application/json"?J=yield W.json():G==="application/octet-stream"||G==="application/pdf"?J=yield W.blob():G==="text/event-stream"?J=W:G==="multipart/form-data"?J=yield W.formData():J=yield W.text(),{data:J,error:null,response:W}}catch(x){return{data:null,error:x,response:x instanceof Zd||x instanceof Qd?x.context:void 0}}finally{l&&clearTimeout(l)}})}}const Qv=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return Pu},FunctionsClient:Jv,FunctionsError:Zu,FunctionsFetchError:um,FunctionsHttpError:Zd,FunctionsRelayError:Qd},Symbol.toStringTag,{value:"Module"})),cm=Qa(Qv);var Wn={};const Ko=Qa(Kv);var cu={},du={},fu={},hu={},pu={},gu={},ip;function dm(){if(ip)return gu;ip=1,Object.defineProperty(gu,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return gu.default=n,gu}var sp;function fm(){if(sp)return pu;sp=1,Object.defineProperty(pu,"__esModule",{value:!0});const e=Ko.__importDefault(dm());let t=class{constructor(a){var l,f;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(f=a.isMaybeSingle)!==null&&f!==void 0?f:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let x=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async v=>{var p,_,A,b;let k=null,O=null,U=null,F=v.status,W=v.statusText;if(v.ok){if(this.method!=="HEAD"){const de=await v.text();de===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?O=de:O=JSON.parse(de))}const G=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),J=(A=v.headers.get("content-range"))===null||A===void 0?void 0:A.split("/");G&&J&&J.length>1&&(U=parseInt(J[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(O)&&(O.length>1?(k={code:"PGRST116",details:`Results contain ${O.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},O=null,U=null,F=406,W="Not Acceptable"):O.length===1?O=O[0]:O=null)}else{const G=await v.text();try{k=JSON.parse(G),Array.isArray(k)&&v.status===404&&(O=[],k=null,F=200,W="OK")}catch{v.status===404&&G===""?(F=204,W="No Content"):k={message:G}}if(k&&this.isMaybeSingle&&(!((b=k?.details)===null||b===void 0)&&b.includes("0 rows"))&&(k=null,F=200,W="OK"),k&&this.shouldThrowOnError)throw new e.default(k)}return{error:k,data:O,count:U,status:F,statusText:W}});return this.shouldThrowOnError||(x=x.catch(v=>{var p,_,A,b,k,O;let U="";const F=v?.cause;if(F){const W=(p=F?.message)!==null&&p!==void 0?p:"",$=(_=F?.code)!==null&&_!==void 0?_:"";U=`${(A=v?.name)!==null&&A!==void 0?A:"FetchError"}: ${v?.message}`,U+=`

Caused by: ${(b=F?.name)!==null&&b!==void 0?b:"Error"}: ${W}`,$&&(U+=` (${$})`),F?.stack&&(U+=`
${F.stack}`)}else U=(k=v?.stack)!==null&&k!==void 0?k:"";return{error:{message:`${(O=v?.name)!==null&&O!==void 0?O:"FetchError"}: ${v?.message}`,details:U,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),x.then(a,l)}returns(){return this}overrideTypes(){return this}};return pu.default=t,pu}var op;function hm(){if(op)return hu;op=1,Object.defineProperty(hu,"__esModule",{value:!0});const e=Ko.__importDefault(fm());let t=class extends e.default{select(a){let l=!1;const f=(a??"*").split("").map(x=>/\s/.test(x)&&!l?"":(x==='"'&&(l=!l),x)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:f,foreignTable:x,referencedTable:v=x}={}){const p=v?`${v}.order`:"order",_=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${_?`${_},`:""}${a}.${l?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:f=l}={}){const x=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(x,`${a}`),this}range(a,l,{foreignTable:f,referencedTable:x=f}={}){const v=typeof x>"u"?"offset":`${x}.offset`,p=typeof x>"u"?"limit":`${x}.limit`;return this.url.searchParams.set(v,`${a}`),this.url.searchParams.set(p,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:f=!1,buffers:x=!1,wal:v=!1,format:p="text"}={}){var _;const A=[a?"analyze":null,l?"verbose":null,f?"settings":null,x?"buffers":null,v?"wal":null].filter(Boolean).join("|"),b=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${p}; for="${b}"; options=${A};`),p==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};return hu.default=t,hu}var ap;function Lf(){if(ap)return fu;ap=1,Object.defineProperty(fu,"__esModule",{value:!0});const e=Ko.__importDefault(hm()),t=new RegExp("[,()]");let i=class extends e.default{eq(l,f){return this.url.searchParams.append(l,`eq.${f}`),this}neq(l,f){return this.url.searchParams.append(l,`neq.${f}`),this}gt(l,f){return this.url.searchParams.append(l,`gt.${f}`),this}gte(l,f){return this.url.searchParams.append(l,`gte.${f}`),this}lt(l,f){return this.url.searchParams.append(l,`lt.${f}`),this}lte(l,f){return this.url.searchParams.append(l,`lte.${f}`),this}like(l,f){return this.url.searchParams.append(l,`like.${f}`),this}likeAllOf(l,f){return this.url.searchParams.append(l,`like(all).{${f.join(",")}}`),this}likeAnyOf(l,f){return this.url.searchParams.append(l,`like(any).{${f.join(",")}}`),this}ilike(l,f){return this.url.searchParams.append(l,`ilike.${f}`),this}ilikeAllOf(l,f){return this.url.searchParams.append(l,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(l,f){return this.url.searchParams.append(l,`ilike(any).{${f.join(",")}}`),this}regexMatch(l,f){return this.url.searchParams.append(l,`match.${f}`),this}regexIMatch(l,f){return this.url.searchParams.append(l,`imatch.${f}`),this}is(l,f){return this.url.searchParams.append(l,`is.${f}`),this}isDistinct(l,f){return this.url.searchParams.append(l,`isdistinct.${f}`),this}in(l,f){const x=Array.from(new Set(f)).map(v=>typeof v=="string"&&t.test(v)?`"${v}"`:`${v}`).join(",");return this.url.searchParams.append(l,`in.(${x})`),this}contains(l,f){return typeof f=="string"?this.url.searchParams.append(l,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(l,`cs.{${f.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(f)}`),this}containedBy(l,f){return typeof f=="string"?this.url.searchParams.append(l,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(l,`cd.{${f.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(f)}`),this}rangeGt(l,f){return this.url.searchParams.append(l,`sr.${f}`),this}rangeGte(l,f){return this.url.searchParams.append(l,`nxl.${f}`),this}rangeLt(l,f){return this.url.searchParams.append(l,`sl.${f}`),this}rangeLte(l,f){return this.url.searchParams.append(l,`nxr.${f}`),this}rangeAdjacent(l,f){return this.url.searchParams.append(l,`adj.${f}`),this}overlaps(l,f){return typeof f=="string"?this.url.searchParams.append(l,`ov.${f}`):this.url.searchParams.append(l,`ov.{${f.join(",")}}`),this}textSearch(l,f,{config:x,type:v}={}){let p="";v==="plain"?p="pl":v==="phrase"?p="ph":v==="websearch"&&(p="w");const _=x===void 0?"":`(${x})`;return this.url.searchParams.append(l,`${p}fts${_}.${f}`),this}match(l){return Object.entries(l).forEach(([f,x])=>{this.url.searchParams.append(f,`eq.${x}`)}),this}not(l,f,x){return this.url.searchParams.append(l,`not.${f}.${x}`),this}or(l,{foreignTable:f,referencedTable:x=f}={}){const v=x?`${x}.or`:"or";return this.url.searchParams.append(v,`(${l})`),this}filter(l,f,x){return this.url.searchParams.append(l,`${f}.${x}`),this}};return fu.default=i,fu}var lp;function pm(){if(lp)return du;lp=1,Object.defineProperty(du,"__esModule",{value:!0});const e=Ko.__importDefault(Lf());let t=class{constructor(a,{headers:l={},schema:f,fetch:x}){this.url=a,this.headers=new Headers(l),this.schema=f,this.fetch=x}select(a,l){const{head:f=!1,count:x}=l??{},v=f?"HEAD":"GET";let p=!1;const _=(a??"*").split("").map(A=>/\s/.test(A)&&!p?"":(A==='"'&&(p=!p),A)).join("");return this.url.searchParams.set("select",_),x&&this.headers.append("Prefer",`count=${x}`),new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:f=!0}={}){var x;const v="POST";if(l&&this.headers.append("Prefer",`count=${l}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((_,A)=>_.concat(Object.keys(A)),[]);if(p.length>0){const _=[...new Set(p)].map(A=>`"${A}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:f=!1,count:x,defaultToNull:v=!0}={}){var p;const _="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),x&&this.headers.append("Prefer",`count=${x}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const A=a.reduce((b,k)=>b.concat(Object.keys(k)),[]);if(A.length>0){const b=[...new Set(A)].map(k=>`"${k}"`);this.url.searchParams.set("columns",b.join(","))}}return new e.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}update(a,{count:l}={}){var f;const x="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:a}={}){var l;const f="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};return du.default=t,du}var up;function Zv(){if(up)return cu;up=1,Object.defineProperty(cu,"__esModule",{value:!0});const n=Ko,e=n.__importDefault(pm()),t=n.__importDefault(Lf());let i=class gm{constructor(l,{headers:f={},schema:x,fetch:v}={}){this.url=l,this.headers=new Headers(f),this.schemaName=x,this.fetch=v}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const f=new URL(`${this.url}/${l}`);return new e.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new gm(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,f={},{head:x=!1,get:v=!1,count:p}={}){var _;let A;const b=new URL(`${this.url}/rpc/${l}`);let k;x||v?(A=x?"HEAD":"GET",Object.entries(f).filter(([U,F])=>F!==void 0).map(([U,F])=>[U,Array.isArray(F)?`{${F.join(",")}}`:`${F}`]).forEach(([U,F])=>{b.searchParams.append(U,F)})):(A="POST",k=f);const O=new Headers(this.headers);return p&&O.set("Prefer",`count=${p}`),new t.default({method:A,url:b,headers:O,schema:this.schemaName,body:k,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}};return cu.default=i,cu}var cp;function mm(){if(cp)return Wn;cp=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.PostgrestError=Wn.PostgrestBuilder=Wn.PostgrestTransformBuilder=Wn.PostgrestFilterBuilder=Wn.PostgrestQueryBuilder=Wn.PostgrestClient=void 0;const n=Ko,e=n.__importDefault(Zv());Wn.PostgrestClient=e.default;const t=n.__importDefault(pm());Wn.PostgrestQueryBuilder=t.default;const i=n.__importDefault(Lf());Wn.PostgrestFilterBuilder=i.default;const a=n.__importDefault(hm());Wn.PostgrestTransformBuilder=a.default;const l=n.__importDefault(fm());Wn.PostgrestBuilder=l.default;const f=n.__importDefault(dm());return Wn.PostgrestError=f.default,Wn.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:f.default},Wn}class ym{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const i=t.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ew="2.87.1",tw=`realtime-js/${ew}`,xm="1.0.0",nw="2.0.0",dp=xm,ef=1e4,rw=1e3,iw=100;var Xs;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Xs||(Xs={}));var fn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(fn||(fn={}));var Zr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Zr||(Zr={}));var tf;(function(n){n.websocket="websocket"})(tf||(tf={}));var Js;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Js||(Js={}));class sw{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},f=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(e,t,i){var a,l;const f=e.topic,x=(a=e.ref)!==null&&a!==void 0?a:"",v=(l=e.join_ref)!==null&&l!==void 0?l:"",p=e.payload.event,_=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},A=Object.keys(_).length===0?"":JSON.stringify(_);if(v.length>255)throw new Error(`joinRef length ${v.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`ref length ${x.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(A.length>255)throw new Error(`metadata length ${A.length} exceeds maximum of 255`);const b=this.USER_BROADCAST_PUSH_META_LENGTH+v.length+x.length+f.length+p.length+A.length,k=new ArrayBuffer(this.HEADER_LENGTH+b);let O=new DataView(k),U=0;O.setUint8(U++,this.KINDS.userBroadcastPush),O.setUint8(U++,v.length),O.setUint8(U++,x.length),O.setUint8(U++,f.length),O.setUint8(U++,p.length),O.setUint8(U++,A.length),O.setUint8(U++,t),Array.from(v,W=>O.setUint8(U++,W.charCodeAt(0))),Array.from(x,W=>O.setUint8(U++,W.charCodeAt(0))),Array.from(f,W=>O.setUint8(U++,W.charCodeAt(0))),Array.from(p,W=>O.setUint8(U++,W.charCodeAt(0))),Array.from(A,W=>O.setUint8(U++,W.charCodeAt(0)));var F=new Uint8Array(k.byteLength+i.byteLength);return F.set(new Uint8Array(k),0),F.set(new Uint8Array(i),k.byteLength),F.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[a,l,f,x,v]=i;return t({join_ref:a,ref:l,topic:f,event:x,payload:v})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),a=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,i){const a=t.getUint8(1),l=t.getUint8(2),f=t.getUint8(3),x=t.getUint8(4);let v=this.HEADER_LENGTH+4;const p=i.decode(e.slice(v,v+a));v=v+a;const _=i.decode(e.slice(v,v+l));v=v+l;const A=i.decode(e.slice(v,v+f));v=v+f;const b=e.slice(v,e.byteLength),k=x===this.JSON_ENCODING?JSON.parse(i.decode(b)):b,O={type:this.BROADCAST_EVENT,event:_,payload:k};return f>0&&(O.meta=JSON.parse(A)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:O}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class vm{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Vt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Vt||(Vt={}));const fp=(n,e,t={})=>{var i;const a=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,f)=>(l[f]=ow(f,n,e,a),l),{}):{}},ow=(n,e,t,i)=>{const a=e.find(x=>x.name===n),l=a?.type,f=t[n];return l&&!i.includes(l)?wm(l,f):nf(f)},wm=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return cw(e,t)}switch(n){case Vt.bool:return aw(e);case Vt.float4:case Vt.float8:case Vt.int2:case Vt.int4:case Vt.int8:case Vt.numeric:case Vt.oid:return lw(e);case Vt.json:case Vt.jsonb:return uw(e);case Vt.timestamp:return dw(e);case Vt.abstime:case Vt.date:case Vt.daterange:case Vt.int4range:case Vt.int8range:case Vt.money:case Vt.reltime:case Vt.text:case Vt.time:case Vt.timestamptz:case Vt.timetz:case Vt.tsrange:case Vt.tstzrange:return nf(e);default:return nf(e)}},nf=n=>n,aw=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},lw=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},uw=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},cw=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const f=n.slice(1,t);try{l=JSON.parse("["+f+"]")}catch{l=f?f.split(","):[]}return l.map(x=>wm(e,x))}return n},dw=n=>typeof n=="string"?n.replace(" ","T"):n,Em=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Od{constructor(e,t,i={},a=ef){this.channel=e,this.event=t,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rf;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(rf||(rf={}));let _m=class Cu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:f,onSync:x}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cu.syncState(this.state,a,l,f),this.pendingDiffs.forEach(v=>{this.state=Cu.syncDiff(this.state,v,l,f)}),this.pendingDiffs=[],x()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:f,onSync:x}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Cu.syncDiff(this.state,a,l,f),x())}),this.onJoin((a,l,f)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:f})}),this.onLeave((a,l,f)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,a){const l=this.cloneDeep(e),f=this.transformState(t),x={},v={};return this.map(l,(p,_)=>{f[p]||(v[p]=_)}),this.map(f,(p,_)=>{const A=l[p];if(A){const b=_.map(F=>F.presence_ref),k=A.map(F=>F.presence_ref),O=_.filter(F=>k.indexOf(F.presence_ref)<0),U=A.filter(F=>b.indexOf(F.presence_ref)<0);O.length>0&&(x[p]=O),U.length>0&&(v[p]=U)}else x[p]=_}),this.syncDiff(l,{joins:x,leaves:v},i,a)}static syncDiff(e,t,i,a){const{joins:l,leaves:f}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(x,v)=>{var p;const _=(p=e[x])!==null&&p!==void 0?p:[];if(e[x]=this.cloneDeep(v),_.length>0){const A=e[x].map(k=>k.presence_ref),b=_.filter(k=>A.indexOf(k.presence_ref)<0);e[x].unshift(...b)}i(x,_,v)}),this.map(f,(x,v)=>{let p=e[x];if(!p)return;const _=v.map(A=>A.presence_ref);p=p.filter(A=>_.indexOf(A.presence_ref)<0),e[x]=p,a(x,p,v),p.length===0&&delete e[x]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const a=e[i];return"metas"in a?t[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var sf;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(sf||(sf={}));var Go;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Go||(Go={}));var mi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(mi||(mi={}));const fw=fn;let Cm=class qa{constructor(e,t={config:{}},i){var a,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=fn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Od(this,Zr.join,this.params,this.timeout),this.rejoinTimer=new vm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fn.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=fn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zr.reply,{},(f,x)=>{this._trigger(this._replyEventName(x),f)}),this.presence=new _m(this),this.broadcastEndpointURL=Em(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==fn.closed){const{config:{broadcast:f,presence:x,private:v}}=this.params,p=(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(k=>k.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[Go.PRESENCE]&&this.bindings[Go.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,A={},b={broadcast:f,presence:Object.assign(Object.assign({},x),{enabled:_}),postgres_changes:p,private:v};this.socket.accessTokenValue&&(A.access_token=this.socket.accessTokenValue),this._onError(k=>e?.(mi.CHANNEL_ERROR,k)),this._onClose(()=>e?.(mi.CLOSED)),this.updateJoinPayload(Object.assign({config:b},A)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:k})=>{var O;if(this.socket._isManualToken()||this.socket.setAuth(),k===void 0){e?.(mi.SUBSCRIBED);return}else{const U=this.bindings.postgres_changes,F=(O=U?.length)!==null&&O!==void 0?O:0,W=[];for(let $=0;$<F;$++){const G=U[$],{filter:{event:J,schema:de,table:ue,filter:ee}}=G,Te=k&&k[$];if(Te&&Te.event===J&&qa.isFilterValueEqual(Te.schema,de)&&qa.isFilterValueEqual(Te.table,ue)&&qa.isFilterValueEqual(Te.filter,ee))W.push(Object.assign(Object.assign({},G),{id:Te.id}));else{this.unsubscribe(),this.state=fn.errored,e?.(mi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=W,e&&e(mi.SUBSCRIBED);return}}).receive("error",k=>{this.state=fn.errored,e?.(mi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(k).join(", ")||"error")))}).receive("timeout",()=>{e?.(mi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===fn.joined&&e===Go.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},x=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=i.timeout)!==null&&a!==void 0?a:this.timeout);if(x.status===202)return{success:!0};let v=x.statusText;try{const p=await x.json();v=p.error||p.message||v}catch{}return Promise.reject(new Error(v))}async send(e,t={}){var i,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:f}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:f,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=p.body)===null||a===void 0?void 0:a.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var f,x,v;const p=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(x=(f=this.params)===null||f===void 0?void 0:f.config)===null||x===void 0?void 0:x.broadcast)===null||v===void 0)&&v.ack)&&l("ok"),p.receive("ok",()=>l("ok")),p.receive("error",()=>l("error")),p.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=fn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zr.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(a=>{i=new Od(this,Zr.leave,{},e),i.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=fn.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),f=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),f}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Od(this,e,t,i);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>iw){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var a,l;const f=e.toLocaleLowerCase(),{close:x,error:v,leave:p,join:_}=Zr;if(i&&[x,v,p,_].indexOf(f)>=0&&i!==this._joinRef())return;let b=this._onMessage(f,t,i);if(t&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(k=>{var O,U,F;return((O=k.filter)===null||O===void 0?void 0:O.event)==="*"||((F=(U=k.filter)===null||U===void 0?void 0:U.event)===null||F===void 0?void 0:F.toLocaleLowerCase())===f}).map(k=>k.callback(b,i)):(l=this.bindings[f])===null||l===void 0||l.filter(k=>{var O,U,F,W,$,G;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in k){const J=k.id,de=(O=k.filter)===null||O===void 0?void 0:O.event;return J&&((U=t.ids)===null||U===void 0?void 0:U.includes(J))&&(de==="*"||de?.toLocaleLowerCase()===((F=t.data)===null||F===void 0?void 0:F.type.toLocaleLowerCase()))}else{const J=($=(W=k?.filter)===null||W===void 0?void 0:W.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return J==="*"||J===((G=t?.event)===null||G===void 0?void 0:G.toLocaleLowerCase())}else return k.type.toLocaleLowerCase()===f}).map(k=>{if(typeof b=="object"&&"ids"in b){const O=b.data,{schema:U,table:F,commit_timestamp:W,type:$,errors:G}=O;b=Object.assign(Object.assign({},{schema:U,table:F,commit_timestamp:W,eventType:$,new:{},old:{},errors:G}),this._getPayloadRecords(O))}k.callback(b,i)})}_isClosed(){return this.state===fn.closed}_isJoined(){return this.state===fn.joined}_isJoining(){return this.state===fn.joining}_isLeaving(){return this.state===fn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&qa.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Zr.close,{},e)}_onError(e){this._on(Zr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=fp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=fp(e.columns,e.old_record)),t}};const Ld=()=>{},mu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},hw=[1e3,2e3,5e3,1e4],pw=1e4,gw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let mw=class{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ef,this.transport=null,this.heartbeatIntervalMs=mu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ld,this.ref=0,this.reconnectTimer=null,this.vsn=dp,this.logger=Ld,this.conn=null,this.sendBuffer=[],this.serializer=new sw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${tf.websocket}`,this.httpEndpoint=Em(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ym.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Xs.connecting:return Js.Connecting;case Xs.open:return Js.Open;case Xs.closing:return Js.Closing;default:return Js.Closed}}isConnected(){return this.connectionState()===Js.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===i);if(a)return a;{const l=new Cm(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:a,ref:l}=e,f=()=>{this.encode(e,x=>{var v;(v=this.conn)===null||v===void 0||v.send(x)})};this.log("push",`${t} ${i} (${l})`,a),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(rw,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},mu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(p){this.log("error","error in heartbeat callback",p)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:i,event:a,payload:l,ref:f}=t,x=f?`(${f})`:"",v=l.status||"";this.log("receive",`${v} ${i} ${a} ${x}`.trim(),l),this.channels.filter(p=>p._isMember(i)).forEach(p=>p._trigger(a,l,f)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Xs.open||this.conn.readyState===Xs.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Zr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${i}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([gw],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const l={access_token:t,version:tw};t&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(Zr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new vm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},mu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,a,l,f,x,v,p,_,A,b,k;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:ef,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:mu.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(f=e?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(x=e?.heartbeatCallback)!==null&&x!==void 0?x:Ld,this.vsn=(v=e?.vsn)!==null&&v!==void 0?v:dp,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=e?.reconnectAfterMs)!==null&&p!==void 0?p:(O=>hw[O-1]||pw),this.vsn){case xm:this.encode=(_=e?.encode)!==null&&_!==void 0?_:((O,U)=>U(JSON.stringify(O))),this.decode=(A=e?.decode)!==null&&A!==void 0?A:((O,U)=>U(JSON.parse(O)));break;case nw:this.encode=(b=e?.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(k=e?.decode)!==null&&k!==void 0?k:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}};const yw=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:fw,get REALTIME_LISTEN_TYPES(){return Go},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return sf},get REALTIME_PRESENCE_LISTEN_EVENTS(){return rf},get REALTIME_SUBSCRIBE_STATES(){return mi},RealtimeChannel:Cm,RealtimeClient:mw,RealtimePresence:_m,WebSocketFactory:ym},Symbol.toStringTag,{value:"Module"})),Sm=Qa(yw);class Za extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Wt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Am extends Za{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Du extends Za{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const Bf=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),xw=()=>Response,of=n=>{if(Array.isArray(n))return n.map(t=>of(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=of(i)}),e},vw=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},ww=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n),Bd=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},Ew=(n,e,t)=>Fe(void 0,void 0,void 0,function*(){const i=yield xw();n instanceof i&&!t?.noResolveJson?n.json().then(a=>{const l=n.status||500,f=a?.statusCode||l+"";e(new Am(Bd(a),l,f))}).catch(a=>{e(new Du(Bd(a),a))}):e(new Du(Bd(n),n))}),_w=(n,e,t,i)=>{const a={method:n,headers:e?.headers||{}};return n==="GET"||!i?a:(vw(i)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(i)):a.body=i,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function el(n,e,t,i,a,l){return Fe(this,void 0,void 0,function*(){return new Promise((f,x)=>{n(t,_w(e,i,a,l)).then(v=>{if(!v.ok)throw v;return i?.noResolveJson?v:v.json()}).then(v=>f(v)).catch(v=>Ew(v,x,i))})})}function Xa(n,e,t,i){return Fe(this,void 0,void 0,function*(){return el(n,"GET",e,t,i)})}function Qr(n,e,t,i,a){return Fe(this,void 0,void 0,function*(){return el(n,"POST",e,i,a,t)})}function af(n,e,t,i,a){return Fe(this,void 0,void 0,function*(){return el(n,"PUT",e,i,a,t)})}function Cw(n,e,t,i){return Fe(this,void 0,void 0,function*(){return el(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function Ff(n,e,t,i,a){return Fe(this,void 0,void 0,function*(){return el(n,"DELETE",e,i,a,t)})}class Sw{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Wt(e))return{data:null,error:e};throw e}})}}var Tm;class Aw{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Tm]="BlobDownloadBuilder",this.promise=null}asStream(){return new Sw(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Wt(e))return{data:null,error:e};throw e}})}}Tm=Symbol.toStringTag;const Tw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Iw{constructor(e,t={},i,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=i,this.fetch=Bf(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,i,a){return Fe(this,void 0,void 0,function*(){try{let l;const f=Object.assign(Object.assign({},hp),a);let x=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(f.upsert)});const v=f.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",f.cacheControl),v&&l.append("metadata",this.encodeMetadata(v)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.has("cacheControl")||l.append("cacheControl",f.cacheControl),v&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(v))):(l=i,x["cache-control"]=`max-age=${f.cacheControl}`,x["content-type"]=f.contentType,v&&(x["x-metadata"]=this.toBase64(this.encodeMetadata(v))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!f.duplex&&(f.duplex="half")),a?.headers&&(x=Object.assign(Object.assign({},x),a.headers));const p=this._removeEmptyFolders(t),_=this._getFinalPath(p),A=yield(e=="PUT"?af:Qr)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:x},f?.duplex?{duplex:f.duplex}:{}));return{data:{path:p,id:A.Id,fullPath:A.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Wt(l))return{data:null,error:l};throw l}})}upload(e,t,i){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,a){return Fe(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),f=this._getFinalPath(l),x=new URL(this.url+`/object/upload/sign/${f}`);x.searchParams.set("token",t);try{let v;const p=Object.assign({upsert:hp.upsert},a),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&i instanceof Blob?(v=new FormData,v.append("cacheControl",p.cacheControl),v.append("",i)):typeof FormData<"u"&&i instanceof FormData?(v=i,v.append("cacheControl",p.cacheControl)):(v=i,_["cache-control"]=`max-age=${p.cacheControl}`,_["content-type"]=p.contentType);const A=yield af(this.fetch,x.toString(),v,{headers:_});return{data:{path:l,fullPath:A.Key},error:null}}catch(v){if(this.shouldThrowOnError)throw v;if(Wt(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return Fe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const l=yield Qr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:a}),f=new URL(this.url+l.url),x=f.searchParams.get("token");if(!x)throw new Za("No token returned by API");return{data:{signedUrl:f.toString(),path:e,token:x},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i))return{data:null,error:i};throw i}})}update(e,t,i){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return Fe(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}copy(e,t,i){return Fe(this,void 0,void 0,function*(){try{return{data:{path:(yield Qr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,i){return Fe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Qr(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const f=i?.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${f}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,i){return Fe(this,void 0,void 0,function*(){try{const a=yield Qr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:a.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}download(e,t){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),f=l?`?${l}`:"",x=this._getFinalPath(e),v=()=>Xa(this.fetch,`${this.url}/${a}/${x}${f}`,{headers:this.headers,noResolveJson:!0});return new Aw(v,this.shouldThrowOnError)}info(e){return Fe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield Xa(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:of(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i))return{data:null,error:i};throw i}})}exists(e){return Fe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Cw(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i)&&i instanceof Du){const a=i.originalError;if([400,404].includes(a?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),a=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const x=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&a.push(v);let p=a.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${x}/public/${i}${p}`)}}}remove(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}list(e,t,i){return Fe(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Tw),t),{prefix:e||""});return{data:yield Qr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},i),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}listV2(e,t){return Fe(this,void 0,void 0,function*(){try{const i=Object.assign({},e);return{data:yield Qr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},t),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Im="2.87.1",bm={"X-Client-Info":`storage-js/${Im}`};class bw{constructor(e,t={},i,a){this.shouldThrowOnError=!1;const l=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bm),t),this.fetch=Bf(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Fe(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Xa(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}getBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}createBucket(e){return Fe(this,arguments,void 0,function*(t,i={public:!1}){try{return{data:yield Qr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return Fe(this,void 0,void 0,function*(){try{return{data:yield af(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Wt(i))return{data:null,error:i};throw i}})}emptyBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var Ja=class extends Error{constructor(n,e){super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Nw(n,e,t){const i=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&i.searchParams.set(a,l);return i.toString()}async function Rw(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function Mw(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:a,body:l,headers:f}){const x=Nw(n.baseUrl,i,a),v=await Rw(n.auth),p=await e(x,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...v,...f},body:l?JSON.stringify(l):void 0}),_=await p.text(),A=(p.headers.get("content-type")||"").includes("application/json"),b=A&&_?JSON.parse(_):_;if(!p.ok){const k=A?b:void 0,O=k?.error;throw new Ja(O?.message??`Request failed with status ${p.status}`,{status:p.status,icebergType:O?.type,icebergCode:O?.code,details:k})}return{status:p.status,headers:p.headers,data:b}}}}function yu(n){return n.join("")}var kw=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:yu(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${yu(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yu(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${yu(n.namespace)}`}),!0}catch(e){if(e instanceof Ja&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Ja&&t.status===409)return;throw t}}};function Mo(n){return n.join("")}var Pw=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Mo(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Ja&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Ja&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},Dw=class{constructor(n){let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=Mw({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new kw(this.client,e),this.tableOps=new Pw(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}};class Nm{constructor(e,t={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},bm),t),this.fetch=Bf(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}listBuckets(e){return Fe(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const i=t.toString(),a=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`;return{data:yield Xa(this.fetch,a,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}from(e){if(!ww(e))throw new Za("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new Dw({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>Fe(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(l,f){const x=l[f];return typeof x!="function"?x:(...v)=>Fe(this,void 0,void 0,function*(){try{return{data:yield x.apply(l,v),error:null}}catch(p){if(i)throw p;return{data:null,error:p}}})}})}}const Uf={"X-Client-Info":`storage-js/${Im}`,"Content-Type":"application/json"};class Vf extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function dr(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class Su extends Vf{constructor(e,t,i){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rm extends Vf{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var lf;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(lf||(lf={}));const ec=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Ow=()=>Response,Mm=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Lw=n=>Array.from(new Float32Array(n)),Bw=(n,e)=>{if(e!==void 0&&n.float32.length!==e)throw new Error(`Vector dimension mismatch: expected ${e}, got ${n.float32.length}`)},pp=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fw=(n,e,t)=>Fe(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const a=n.status||500,l=n;if(typeof l.json=="function")l.json().then(f=>{const x=f?.statusCode||f?.code||a+"";e(new Su(pp(f),a,x))}).catch(()=>{const f=a+"",x=l.statusText||`HTTP ${a} error`;e(new Su(x,a,f))});else{const f=a+"",x=l.statusText||`HTTP ${a} error`;e(new Su(x,a,f))}}else e(new Rm(pp(n),n))}),Uw=(n,e,t,i)=>{const a={method:n,headers:e?.headers||{}};return i?(Mm(i)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(i)):a.body=i,Object.assign(Object.assign({},a),t)):a};function Vw(n,e,t,i,a,l){return Fe(this,void 0,void 0,function*(){return new Promise((f,x)=>{n(t,Uw(e,i,a,l)).then(v=>{if(!v.ok)throw v;if(i?.noResolveJson)return v;const p=v.headers.get("content-type");return!p||!p.includes("application/json")?{}:v.json()}).then(v=>f(v)).catch(v=>Fw(v,x,i))})})}function Tr(n,e,t,i,a){return Fe(this,void 0,void 0,function*(){return Vw(n,"POST",e,i,a,t)})}class km{constructor(e,t={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uf),t),this.fetch=ec(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}getIndex(e,t){return Fe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dr(i))return{data:null,error:i};throw i}})}listIndexes(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(dr(i))return{data:null,error:i};throw i}})}}class Pm{constructor(e,t={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uf),t),this.fetch=ec(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Fe(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Tr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}getVectors(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}listVectors(e){return Fe(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Tr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}queryVectors(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}deleteVectors(e){return Fe(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Tr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}}class Dm{constructor(e,t={},i){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uf),t),this.fetch=ec(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}getBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}listBuckets(){return Fe(this,arguments,void 0,function*(e={}){try{return{data:yield Tr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Tr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(dr(t))return{data:null,error:t};throw t}})}}class Om extends Dm{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Lm(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Fe(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Fe(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Fe(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Fe(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class Lm extends km{constructor(e,t,i,a){super(e,t,a),this.vectorBucketName=i}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Fe(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Fe(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Fe(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Fe(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Bm(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Bm extends Pm{constructor(e,t,i,a,l){super(e,t,l),this.vectorBucketName=i,this.indexName=a}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Fe(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Fe(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Fe(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Fe(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Fe(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Hw extends bw{constructor(e,t={},i,a){super(e,t,i,a)}from(e){return new Iw(this.url,this.headers,e,this.fetch)}get vectors(){return new Om(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Nm(this.url+"/iceberg",this.headers,this.fetch)}}const Gw=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:Nm,StorageApiError:Am,StorageClient:Hw,StorageError:Za,StorageUnknownError:Du,StorageVectorsApiError:Su,StorageVectorsClient:Om,StorageVectorsError:Vf,get StorageVectorsErrorCode(){return lf},StorageVectorsUnknownError:Rm,VectorBucketApi:Dm,VectorBucketScope:Lm,VectorDataApi:Pm,VectorIndexApi:km,VectorIndexScope:Bm,isPlainObject:Mm,isStorageError:Wt,isStorageVectorsError:dr,normalizeToFloat32:Lw,resolveFetch:ec,resolveResponse:Ow,validateVectorDimension:Bw},Symbol.toStringTag,{value:"Module"})),zw=Qa(Gw);var Fd={},Ha={},gp;function jw(){return gp||(gp=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.version=void 0,Ha.version="2.87.1"),Ha}var mp;function qw(){return mp||(mp=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_REALTIME_OPTIONS=n.DEFAULT_AUTH_OPTIONS=n.DEFAULT_DB_OPTIONS=n.DEFAULT_GLOBAL_OPTIONS=n.DEFAULT_HEADERS=void 0;const e=jw();let t="";typeof Deno<"u"?t="deno":typeof document<"u"?t="web":typeof navigator<"u"&&navigator.product==="ReactNative"?t="react-native":t="node",n.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${t}/${e.version}`},n.DEFAULT_GLOBAL_OPTIONS={headers:n.DEFAULT_HEADERS},n.DEFAULT_DB_OPTIONS={schema:"public"},n.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},n.DEFAULT_REALTIME_OPTIONS={}})(Fd)),Fd}var Ud={},yp;function Ww(){return yp||(yp=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.fetchWithAuth=n.resolveHeadersConstructor=n.resolveFetch=void 0;const e=a=>a?(...l)=>a(...l):(...l)=>fetch(...l);n.resolveFetch=e;const t=()=>Headers;n.resolveHeadersConstructor=t;const i=(a,l,f)=>{const x=(0,n.resolveFetch)(f),v=(0,n.resolveHeadersConstructor)();return async(p,_)=>{var A;const b=(A=await l())!==null&&A!==void 0?A:a;let k=new v(_?.headers);return k.has("apikey")||k.set("apikey",a),k.has("Authorization")||k.set("Authorization",`Bearer ${b}`),x(p,Object.assign(Object.assign({},_),{headers:k}))}};n.fetchWithAuth=i})(Ud)),Ud}var ki={},xp;function Yw(){if(xp)return ki;xp=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.isBrowser=void 0,ki.uuid=n,ki.ensureTrailingSlash=e,ki.applySettingDefaults=i,ki.validateSupabaseUrl=a;function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var f=Math.random()*16|0,x=l=="x"?f:f&3|8;return x.toString(16)})}function e(l){return l.endsWith("/")?l:l+"/"}const t=()=>typeof window<"u";ki.isBrowser=t;function i(l,f){var x,v;const{db:p,auth:_,realtime:A,global:b}=l,{db:k,auth:O,realtime:U,global:F}=f,W={db:Object.assign(Object.assign({},k),p),auth:Object.assign(Object.assign({},O),_),realtime:Object.assign(Object.assign({},U),A),storage:{},global:Object.assign(Object.assign(Object.assign({},F),b),{headers:Object.assign(Object.assign({},(x=F?.headers)!==null&&x!==void 0?x:{}),(v=b?.headers)!==null&&v!==void 0?v:{})}),accessToken:async()=>""};return l.accessToken?W.accessToken=l.accessToken:delete W.accessToken,W}function a(l){const f=l?.trim();if(!f)throw new Error("supabaseUrl is required.");if(!f.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(e(f))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}return ki}var Ga={};const Fm="2.87.1",Oo=30*1e3,uf=3,Vd=uf*Oo,$w="http://localhost:9999",Kw="supabase.auth.token",Xw={"X-Client-Info":`gotrue-js/${Fm}`},cf="X-Supabase-Api-Version",Um={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Jw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Qw=600*1e3;let Yo=class extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}};function Ge(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}let Vm=class extends Yo{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}};function Hm(n){return Ge(n)&&n.name==="AuthApiError"}let hs=class extends Yo{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},Oi=class extends Yo{constructor(e,t,i,a){super(e,i,a),this.name=t,this.status=i}},cr=class extends Oi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function Gm(n){return Ge(n)&&n.name==="AuthSessionMissingError"}let Ws=class extends Oi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Wa=class extends Oi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},Ya=class extends Oi{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function zm(n){return Ge(n)&&n.name==="AuthImplicitGrantRedirectError"}let df=class extends Oi{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Ou=class extends Oi{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}};function Au(n){return Ge(n)&&n.name==="AuthRetryableFetchError"}let ff=class extends Oi{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}};function Zw(n){return Ge(n)&&n.name==="AuthWeakPasswordError"}let Lu=class extends Oi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}};const Bu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vp=` 	
\r=`.split(""),eE=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<vp.length;e+=1)n[vp[e].charCodeAt(0)]=-2;for(let e=0;e<Bu.length;e+=1)n[Bu[e].charCodeAt(0)]=e;return n})();function wp(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Bu[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Bu[i]),e.queuedBits-=6}}function jm(n,e,t){const i=eE[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Ep(n){const e=[],t=f=>{e.push(String.fromCodePoint(f))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=f=>{rE(f,i,t)};for(let f=0;f<n.length;f+=1)jm(n.charCodeAt(f),a,l);return e.join("")}function tE(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function nE(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}tE(i,e)}}function rE(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function zo(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)jm(n.charCodeAt(a),t,i);return new Uint8Array(e)}function iE(n){const e=[];return nE(n,t=>e.push(t)),new Uint8Array(e)}function Qs(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};return n.forEach(a=>wp(a,t,i)),wp(null,t,i),e.join("")}function sE(n){return Math.round(Date.now()/1e3)+n}function oE(){return Symbol("auth-callback")}const Bn=()=>typeof window<"u"&&typeof document<"u",js={tested:!1,writable:!1},qm=()=>{if(!Bn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(js.tested)return js.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),js.tested=!0,js.writable=!0}catch{js.tested=!0,js.writable=!1}return js.writable};function aE(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((i,a)=>{e[a]=i}),e}const Wm=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),lE=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Lo=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},qs=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ln=async(n,e)=>{await n.removeItem(e)};class tc{constructor(){this.promise=new tc.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}tc.promiseConstructor=Promise;function Hd(n){const e=n.split(".");if(e.length!==3)throw new Lu("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!Jw.test(e[i]))throw new Lu("JWT not in base64url format");return{header:JSON.parse(Ep(e[0])),payload:JSON.parse(Ep(e[1])),signature:zo(e[2]),raw:{header:e[0],payload:e[1]}}}async function uE(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function cE(n,e){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const f=await n(l);if(!e(l,null,f)){i(f);return}}catch(f){if(!e(l,f)){a(f);return}}})()})}function dE(n){return("0"+n.toString(16)).substr(-2)}function fE(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(e),Array.from(e,dE).join("")}async function hE(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function pE(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await hE(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ko(n,e,t=!1){const i=fE();let a=i;t&&(a+="/PASSWORD_RECOVERY"),await Lo(n,`${e}-code-verifier`,a);const l=await pE(i);return[l,i===l?"plain":"s256"]}const gE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mE(n){const e=n.headers.get(cf);if(!e||!e.match(gE))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function yE(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function xE(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Po(n){if(!vE.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gd(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function wE(n,e){return new Proxy(n,{get:(t,i,a)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,a)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,a)}})}function _p(n){return JSON.parse(JSON.stringify(n))}const Ys=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),EE=[502,503,504];async function Cp(n){var e;if(!lE(n))throw new Ou(Ys(n),0);if(EE.includes(n.status))throw new Ou(Ys(n),n.status);let t;try{t=await n.json()}catch(l){throw new hs(Ys(l),l)}let i;const a=mE(n);if(a&&a.getTime()>=Um["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new ff(Ys(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new cr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,f)=>l&&typeof f=="string",!0))throw new ff(Ys(t),n.status,t.weak_password.reasons);throw new Vm(Ys(t),n.status||500,i)}const _E=(n,e,t,i)=>{const a={method:n,headers:e?.headers||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),t))};async function Qe(n,e,t,i){var a;const l=Object.assign({},i?.headers);l[cf]||(l[cf]=Um["2024-01-01"].name),i?.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const f=(a=i?.query)!==null&&a!==void 0?a:{};i?.redirectTo&&(f.redirect_to=i.redirectTo);const x=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",v=await CE(n,e,t+x,{headers:l,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(v):{data:Object.assign({},v),error:null}}async function CE(n,e,t,i,a,l){const f=_E(e,i,a,l);let x;try{x=await n(t,Object.assign({},f))}catch(v){throw console.error(v),new Ou(Ys(v),0)}if(x.ok||await Cp(x),i?.noResolveJson)return x;try{return await x.json()}catch(v){await Cp(v)}}function Jr(n){var e;let t=null;TE(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=sE(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function Sp(n){const e=Jr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ps(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function SE(n){return{data:n,error:null}}function AE(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l}=n,f=$o(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),x={action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l},v=Object.assign({},f);return{data:{properties:x,user:v},error:null}}function Ap(n){return n}function TE(n){return n.access_token&&n.refresh_token&&n.expires_in}const Tu=["global","local","others"];let Hf=class{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=Wm(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Tu[0]){if(Tu.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Tu.join(", ")}`);try{return await Qe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ge(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Qe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ps})}catch(i){if(Ge(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=$o(e,["options"]),a=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(a.new_email=i?.newEmail,delete a.newEmail),await Qe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:AE,redirectTo:t?.redirectTo})}catch(t){if(Ge(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ps})}catch(t){if(Ge(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,a,l,f,x,v;try{const p={nextPage:null,lastPage:0,total:0},_=await Qe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Ap});if(_.error)throw _.error;const A=await _.json(),b=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,k=(v=(x=_.headers.get("link"))===null||x===void 0?void 0:x.split(","))!==null&&v!==void 0?v:[];return k.length>0&&(k.forEach(O=>{const U=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),F=JSON.parse(O.split(";")[1].split("=")[1]);p[`${F}Page`]=U}),p.total=parseInt(b)),{data:Object.assign(Object.assign({},A),p),error:null}}catch(p){if(Ge(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){Po(e);try{return await Qe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ps})}catch(t){if(Ge(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Po(e);try{return await Qe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ps})}catch(i){if(Ge(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Po(e);try{return await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ps})}catch(i){if(Ge(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Po(e.userId);try{const{data:t,error:i}=await Qe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:i}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Po(e.userId),Po(e.id);try{return{data:await Qe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,a,l,f,x,v;try{const p={nextPage:null,lastPage:0,total:0},_=await Qe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Ap});if(_.error)throw _.error;const A=await _.json(),b=(f=_.headers.get("x-total-count"))!==null&&f!==void 0?f:0,k=(v=(x=_.headers.get("link"))===null||x===void 0?void 0:x.split(","))!==null&&v!==void 0?v:[];return k.length>0&&(k.forEach(O=>{const U=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),F=JSON.parse(O.split(";")[1].split("=")[1]);p[`${F}Page`]=U}),p.total=parseInt(b)),{data:Object.assign(Object.assign({},A),p),error:null}}catch(p){if(Ge(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Qe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Qe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(Ge(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Qe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Qe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}};function Tp(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const $s={debug:!!(globalThis&&qm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Gf extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}let Ym=class extends Gf{};class IE extends Gf{}async function $m(n,e,t){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),$s.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw $s.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Ym(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if($s.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}const Ip={};async function bE(n,e,t){var i;const a=(i=Ip[n])!==null&&i!==void 0?i:Promise.resolve(),l=Promise.race([a.catch(()=>null),e>=0?new Promise((f,x)=>{setTimeout(()=>{x(new IE(`Acquring process lock with name "${n}" timed out`))},e)}):null].filter(f=>f)).catch(f=>{if(f&&f.isAcquireTimeout)throw f;return null}).then(async()=>await t());return Ip[n]=l.catch(async f=>{if(f&&f.isAcquireTimeout)return await a,null;throw f}),await l}function NE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Km(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function RE(n){return parseInt(n,16)}function ME(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function kE(n){var e;const{chainId:t,domain:i,expirationTime:a,issuedAt:l=new Date,nonce:f,notBefore:x,requestId:v,resources:p,scheme:_,uri:A,version:b}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!A)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const k=Km(n.address),O=_?`${_}://${i}`:i,U=n.statement?`${n.statement}
`:"",F=`${O} wants you to sign in with your Ethereum account:
${k}

${U}`;let W=`URI: ${A}
Version: ${b}
Chain ID: ${t}${f?`
Nonce: ${f}`:""}
Issued At: ${l.toISOString()}`;if(a&&(W+=`
Expiration Time: ${a.toISOString()}`),x&&(W+=`
Not Before: ${x.toISOString()}`),v&&(W+=`
Request ID: ${v}`),p){let $=`
Resources:`;for(const G of p){if(!G||typeof G!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${G}`);$+=`
- ${G}`}W+=$}return`${F}
${W}`}class hn extends Error{constructor({message:e,code:t,cause:i,name:a}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=a??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class Fu extends hn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function PE({error:n,options:e}){var t,i,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new hn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new hn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new hn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new hn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new hn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new hn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(x=>x.type==="public-key").length===0?new hn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new hn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const f=window.location.hostname;if(Xm(f)){if(l.rp.id!==f)return new hn({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new hn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new hn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new hn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new hn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function DE({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new hn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new hn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(Xm(i)){if(t.rpId!==i)return new hn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new hn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new hn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new hn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class OE{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const LE=new OE;function BE(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,a=$o(n,["challenge","user","excludeCredentials"]),l=zo(e).buffer,f=Object.assign(Object.assign({},t),{id:zo(t.id).buffer}),x=Object.assign(Object.assign({},a),{challenge:l,user:f});if(i&&i.length>0){x.excludeCredentials=new Array(i.length);for(let v=0;v<i.length;v++){const p=i[v];x.excludeCredentials[v]=Object.assign(Object.assign({},p),{id:zo(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return x}function FE(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=$o(n,["challenge","allowCredentials"]),a=zo(e).buffer,l=Object.assign(Object.assign({},i),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let f=0;f<t.length;f++){const x=t[f];l.allowCredentials[f]=Object.assign(Object.assign({},x),{id:zo(x.id).buffer,type:x.type||"public-key",transports:x.transports})}}return l}function UE(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Qs(new Uint8Array(n.response.attestationObject)),clientDataJSON:Qs(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function VE(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Qs(new Uint8Array(a.authenticatorData)),clientDataJSON:Qs(new Uint8Array(a.clientDataJSON)),signature:Qs(new Uint8Array(a.signature)),userHandle:a.userHandle?Qs(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Xm(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function bp(){var n,e;return!!(Bn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function HE(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Fu("Browser returned unexpected credential type",e)}:{data:null,error:new Fu("Empty credential response",e)}}catch(e){return{data:null,error:PE({error:e,options:n})}}}async function GE(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Fu("Browser returned unexpected credential type",e)}:{data:null,error:new Fu("Empty credential response",e)}}catch(e){return{data:null,error:DE({error:e,options:n})}}}const zE={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jE={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Uu(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),i={};for(const a of n)if(a)for(const l in a){const f=a[l];if(f!==void 0)if(Array.isArray(f))i[l]=f;else if(t(f))i[l]=f;else if(e(f)){const x=i[l];e(x)?i[l]=Uu(x,f):i[l]=Uu(f)}else i[l]=f}return i}function qE(n,e){return Uu(zE,n,e||{})}function WE(n,e){return Uu(jE,n,e||{})}class YE{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:a},l){try{const{data:f,error:x}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!f)return{data:null,error:x};const v=a??LE.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:p}=f.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${i}`),p.displayName||(p.displayName=p.name)}switch(f.webauthn.type){case"create":{const p=qE(f.webauthn.credential_options.publicKey,l?.create),{data:_,error:A}=await HE({publicKey:p,signal:v});return _?{data:{factorId:e,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:A}}case"request":{const p=WE(f.webauthn.credential_options.publicKey,l?.request),{data:_,error:A}=await GE(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:p,signal:v}));return _?{data:{factorId:e,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:_}},error:null}:{data:null,error:A}}}}catch(f){return Ge(f)?{data:null,error:f}:{data:null,error:new hs("Unexpected error in challenge",f)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Yo("rpId is required for WebAuthn authentication")};try{if(!bp())return{data:null,error:new hs("Browser does not support WebAuthn",null)};const{data:f,error:x}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:a},{request:l});if(!f)return{data:null,error:x};const{webauthn:v}=f;return this._verify({factorId:e,challengeId:f.challengeId,webauthn:{type:v.type,rpId:t,rpOrigins:i,credential_response:v.credential_response}})}catch(f){return Ge(f)?{data:null,error:f}:{data:null,error:new hs("Unexpected error in authenticate",f)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Yo("rpId is required for WebAuthn registration")};try{if(!bp())return{data:null,error:new hs("Browser does not support WebAuthn",null)};const{data:f,error:x}=await this._enroll({friendlyName:e});if(!f)return await this.client.mfa.listFactors().then(_=>{var A;return(A=_.data)===null||A===void 0?void 0:A.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===e&&b.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_?.id}):void 0),{data:null,error:x};const{data:v,error:p}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:a},{create:l});return v?this._verify({factorId:f.id,challengeId:v.challengeId,webauthn:{rpId:t,rpOrigins:i,type:v.webauthn.type,credential_response:v.webauthn.credential_response}}):{data:null,error:p}}catch(f){return Ge(f)?{data:null,error:f}:{data:null,error:new hs("Unexpected error in register",f)}}}}NE();const $E={url:$w,storageKey:Kw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Xw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Np(n,e,t){return await t()}const Do={};let zf=class hf{get jwks(){var e,t;return(t=(e=Do[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Do[this.storageKey]=Object.assign(Object.assign({},Do[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Do[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Do[this.storageKey]=Object.assign(Object.assign({},Do[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},$E),e);if(this.storageKey=l.storageKey,this.instanceID=(t=hf.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,hf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Bn()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new Hf({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Wm(l.fetch),this.lock=l.lock||Np,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&Bn()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=$m:this.lock=Np,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new YE(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:qm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Tp(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Tp(this.memoryStorage)),Bn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fm}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(Bn()&&(t=aE(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),Bn()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),zm(l)){const v=(e=l.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:f,redirectType:x}=a;return this._debug("#_initialize()","detected session in URL",f,"redirect type",x),await this._saveSession(f),setTimeout(async()=>{x==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ge(t)?this._returnResult({error:t}):this._returnResult({error:new hs("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,a;try{const l=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Jr}),{data:f,error:x}=l;if(x||!f)return this._returnResult({data:{user:null,session:null},error:x});const v=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",v)),this._returnResult({data:{user:p,session:v},error:null})}catch(l){if(Ge(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,a;try{let l;if("email"in e){const{email:_,password:A,options:b}=e;let k=null,O=null;this.flowType==="pkce"&&([k,O]=await ko(this.storage,this.storageKey)),l=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:_,password:A,data:(t=b?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:k,code_challenge_method:O},xform:Jr})}else if("phone"in e){const{phone:_,password:A,options:b}=e;l=await Qe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:A,data:(i=b?.data)!==null&&i!==void 0?i:{},channel:(a=b?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:Jr})}else throw new Wa("You must provide either an email or phone number and a password");const{data:f,error:x}=l;if(x||!f)return await Ln(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:x});const v=f.session,p=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",v)),this._returnResult({data:{user:p,session:v},error:null})}catch(l){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:f,options:x}=e;t=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:f,gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Sp})}else if("phone"in e){const{phone:l,password:f,options:x}=e;t=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:f,gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Sp})}else throw new Wa("You must provide either an email or phone number and a password");const{data:i,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!i||!i.session||!i.user){const l=new Ws;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,a,l,f,x,v,p,_,A,b;let k,O;if("message"in e)k=e.message,O=e.signature;else{const{chain:U,wallet:F,statement:W,options:$}=e;let G;if(Bn())if(typeof F=="object")G=F;else{const Z=window;if("ethereum"in Z&&typeof Z.ethereum=="object"&&"request"in Z.ethereum&&typeof Z.ethereum.request=="function")G=Z.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof F!="object"||!$?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=F}const J=new URL((t=$?.url)!==null&&t!==void 0?t:window.location.href),de=await G.request({method:"eth_requestAccounts"}).then(Z=>Z).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!de||de.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ue=Km(de[0]);let ee=(i=$?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!ee){const Z=await G.request({method:"eth_chainId"});ee=RE(Z)}const Te={domain:J.host,address:ue,statement:W,uri:J.href,version:"1",chainId:ee,nonce:(a=$?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(f=(l=$?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(x=$?.signInWithEthereum)===null||x===void 0?void 0:x.expirationTime,notBefore:(v=$?.signInWithEthereum)===null||v===void 0?void 0:v.notBefore,requestId:(p=$?.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(_=$?.signInWithEthereum)===null||_===void 0?void 0:_.resources};k=kE(Te),O=await G.request({method:"personal_sign",params:[ME(k),ue]})}try{const{data:U,error:F}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:k,signature:O},!((A=e.options)===null||A===void 0)&&A.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Jr});if(F)throw F;if(!U||!U.session||!U.user){const W=new Ws;return this._returnResult({data:{user:null,session:null},error:W})}return U.session&&(await this._saveSession(U.session),await this._notifyAllSubscribers("SIGNED_IN",U.session)),this._returnResult({data:Object.assign({},U),error:F})}catch(U){if(Ge(U))return this._returnResult({data:{user:null,session:null},error:U});throw U}}async signInWithSolana(e){var t,i,a,l,f,x,v,p,_,A,b,k;let O,U;if("message"in e)O=e.message,U=e.signature;else{const{chain:F,wallet:W,statement:$,options:G}=e;let J;if(Bn())if(typeof W=="object")J=W;else{const ue=window;if("solana"in ue&&typeof ue.solana=="object"&&("signIn"in ue.solana&&typeof ue.solana.signIn=="function"||"signMessage"in ue.solana&&typeof ue.solana.signMessage=="function"))J=ue.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof W!="object"||!G?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");J=W}const de=new URL((t=G?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in J&&J.signIn){const ue=await J.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},G?.signInWithSolana),{version:"1",domain:de.host,uri:de.href}),$?{statement:$}:null));let ee;if(Array.isArray(ue)&&ue[0]&&typeof ue[0]=="object")ee=ue[0];else if(ue&&typeof ue=="object"&&"signedMessage"in ue&&"signature"in ue)ee=ue;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ee&&"signature"in ee&&(typeof ee.signedMessage=="string"||ee.signedMessage instanceof Uint8Array)&&ee.signature instanceof Uint8Array)O=typeof ee.signedMessage=="string"?ee.signedMessage:new TextDecoder().decode(ee.signedMessage),U=ee.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in J)||typeof J.signMessage!="function"||!("publicKey"in J)||typeof J!="object"||!J.publicKey||!("toBase58"in J.publicKey)||typeof J.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");O=[`${de.host} wants you to sign in with your Solana account:`,J.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${de.href}`,`Issued At: ${(a=(i=G?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=G?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${G.signInWithSolana.notBefore}`]:[],...!((f=G?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${G.signInWithSolana.expirationTime}`]:[],...!((x=G?.signInWithSolana)===null||x===void 0)&&x.chainId?[`Chain ID: ${G.signInWithSolana.chainId}`]:[],...!((v=G?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${G.signInWithSolana.nonce}`]:[],...!((p=G?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${G.signInWithSolana.requestId}`]:[],...!((A=(_=G?.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||A===void 0)&&A.length?["Resources",...G.signInWithSolana.resources.map(ee=>`- ${ee}`)]:[]].join(`
`);const ue=await J.signMessage(new TextEncoder().encode(O),"utf8");if(!ue||!(ue instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");U=ue}}try{const{data:F,error:W}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:O,signature:Qs(U)},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(k=e.options)===null||k===void 0?void 0:k.captchaToken}}:null),xform:Jr});if(W)throw W;if(!F||!F.session||!F.user){const $=new Ws;return this._returnResult({data:{user:null,session:null},error:$})}return F.session&&(await this._saveSession(F.session),await this._notifyAllSubscribers("SIGNED_IN",F.session)),this._returnResult({data:Object.assign({},F),error:W})}catch(F){if(Ge(F))return this._returnResult({data:{user:null,session:null},error:F});throw F}}async _exchangeCodeForSession(e){const t=await qs(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(t??"").split("/");try{const{data:l,error:f}=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Jr});if(await Ln(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!l||!l.session||!l.user){const x=new Ws;return this._returnResult({data:{user:null,session:null,redirectType:null},error:x})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:f})}catch(l){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:a,access_token:l,nonce:f}=e,x=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:f,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Jr}),{data:v,error:p}=x;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!v||!v.session||!v.user){const _=new Ws;return this._returnResult({data:{user:null,session:null},error:_})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:v,error:p})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,a,l,f;try{if("email"in e){const{email:x,options:v}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await ko(this.storage,this.storageKey));const{error:A}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:x,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(i=v?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:p,code_challenge_method:_},redirectTo:v?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:A})}if("phone"in e){const{phone:x,options:v}=e,{data:p,error:_}=await Qe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:x,data:(a=v?.data)!==null&&a!==void 0?a:{},create_user:(l=v?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(f=v?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p?.message_id},error:_})}throw new Wa("You must provide either an email or phone number.")}catch(x){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async verifyOtp(e){var t,i;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:f,error:x}=await Qe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Jr});if(x)throw x;if(!f)throw new Error("An error occurred on token verification.");const v=f.session,p=f.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),this._returnResult({data:{user:p,session:v},error:null})}catch(a){if(Ge(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,i,a,l,f;try{let x=null,v=null;this.flowType==="pkce"&&([x,v]=await ko(this.storage,this.storageKey));const p=await Qe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:x,code_challenge_method:v}),headers:this.headers,xform:SE});return!((l=p.data)===null||l===void 0)&&l.url&&Bn()&&!(!((f=e.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(x){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(x))return this._returnResult({data:null,error:x});throw x}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new cr;const{error:a}=await Qe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Ge(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:a,options:l}=e,{error:f}=await Qe(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in e){const{phone:i,type:a,options:l}=e,{data:f,error:x}=await Qe(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:x})}throw new Wa("You must provide either an email or phone number and a type")}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await qs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Vd:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const f=await qs(this.userStorage,this.storageKey+"-user");f?.user?e.user=f.user:e.user=Gd()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};e.user=wE(e.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ps}):await this._useSession(async t=>{var i,a,l;const{data:f,error:x}=t;if(x)throw x;return!(!((i=f.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new cr}:await Qe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=f.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:ps})})}catch(t){if(Ge(t))return Gm(t)&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new cr;const f=a.session;let x=null,v=null;this.flowType==="pkce"&&e.email!=null&&([x,v]=await ko(this.storage,this.storageKey));const{data:p,error:_}=await Qe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:x,code_challenge_method:v}),jwt:f.access_token,xform:ps});if(_)throw _;return f.user=p.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(i){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new cr;const t=Date.now()/1e3;let i=t,a=!0,l=null;const{payload:f}=Hd(e.access_token);if(f.exp&&(i=f.exp,a=i<=t),a){const{data:x,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return this._returnResult({data:{user:null,session:null},error:v});if(!x)return{data:{user:null,session:null},error:null};l=x}else{const{data:x,error:v}=await this._getUser(e.access_token);if(v)throw v;l={access_token:e.access_token,refresh_token:e.refresh_token,user:x.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(Ge(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:f,error:x}=t;if(x)throw x;e=(i=f.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new cr;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Bn())throw new Ya("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ya(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new df("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ya("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new df("No code detected.");const{data:$,error:G}=await this._exchangeCodeForSession(e.code);if(G)throw G;const J=new URL(window.location.href);return J.searchParams.delete("code"),window.history.replaceState(window.history.state,"",J.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:f,expires_in:x,expires_at:v,token_type:p}=e;if(!l||!x||!f||!p)throw new Ya("No session defined in URL");const _=Math.round(Date.now()/1e3),A=parseInt(x);let b=_+A;v&&(b=parseInt(v));const k=b-_;k*1e3<=Oo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${k}s, should have been closer to ${A}s`);const O=b-A;_-O>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",O,b,_):_-O<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",O,b,_);const{data:U,error:F}=await this._getUser(l);if(F)throw F;const W={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:A,expires_at:b,refresh_token:f,token_type:p,user:U.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:W,redirectType:e.type},error:null})}catch(i){if(Ge(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({error:l});const f=(i=a.session)===null||i===void 0?void 0:i.access_token;if(f){const{error:x}=await this.admin.signOut(f,e);if(x&&!(Hm(x)&&(x.status===404||x.status===401||x.status===403)))return this._returnResult({error:x})}return e!=="others"&&(await this._removeSession(),await Ln(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=oE(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,a;try{const{data:{session:l},error:f}=t;if(f)throw f;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await ko(this.storage,this.storageKey,!0));try{return await Qe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:a}=await this._useSession(async l=>{var f,x,v,p,_;const{data:A,error:b}=l;if(b)throw b;const k=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(f=e.options)===null||f===void 0?void 0:f.redirectTo,scopes:(x=e.options)===null||x===void 0?void 0:x.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await Qe(this.fetch,"GET",k,{headers:this.headers,jwt:(_=(p=A.session)===null||p===void 0?void 0:p.access_token)!==null&&_!==void 0?_:void 0})});if(a)throw a;return Bn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(Ge(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:f,provider:x,token:v,access_token:p,nonce:_}=e,A=await Qe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:x,id_token:v,access_token:p,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Jr}),{data:b,error:k}=A;return k?this._returnResult({data:{user:null,session:null},error:k}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new Ws}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:k}))}catch(a){if(await Ln(this.storage,`${this.storageKey}-code-verifier`),Ge(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:f}=t;if(f)throw f;return await Qe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await cE(async a=>(a>0&&await uE(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Qe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Jr})),(a,l)=>{const f=200*Math.pow(2,a);return l&&Au(l)&&Date.now()+f-i<Oo})}catch(i){if(this._debug(t,"error",i),Ge(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),Bn()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const a=await qs(this.storage,this.storageKey);if(a&&this.userStorage){let f=await qs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:a.user},await Lo(this.userStorage,this.storageKey+"-user",f)),a.user=(e=f?.user)!==null&&e!==void 0?e:Gd()}else if(a&&!a.user&&!a.user){const f=await qs(this.storage,this.storageKey+"-user");f&&f?.user?(a.user=f.user,await Ln(this.storage,this.storageKey+"-user"),await Lo(this.storage,this.storageKey,a)):a.user=Gd()}if(this._debug(i,"session from storage",a),!this._isValidSession(a)){this._debug(i,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Vd;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${Vd}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:f}=await this._callRefreshToken(a.refresh_token);f&&(console.error(f),Au(f)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:x}=await this._getUser(a.access_token);!x&&f?.user?(a.user=f.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(i,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(i,"error",a),console.error(a);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new cr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new tc;const{data:l,error:f}=await this._refreshAccessToken(e);if(f)throw f;if(!l.session)throw new cr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const x={data:l.session,error:null};return this.refreshingDeferred.resolve(x),x}catch(l){if(this._debug(a,"error",l),Ge(l)){const f={data:null,error:l};return Au(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(f),f}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,i=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],f=Array.from(this.stateChangeEmitters.values()).map(async x=>{try{await x.callback(e,t)}catch(v){l.push(v)}});if(await Promise.all(f),l.length>0){for(let x=0;x<l.length;x+=1)console.error(l[x]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ln(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Lo(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=_p(a);await Lo(this.storage,this.storageKey,l)}else{const a=_p(t);await Lo(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ln(this.storage,this.storageKey),await Ln(this.storage,this.storageKey+"-code-verifier"),await Ln(this.storage,this.storageKey+"-user"),this.userStorage&&await Ln(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Bn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-e)/Oo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Oo}ms, refresh threshold is ${uf} ticks`),a<=uf&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Gf)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const a=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,f]=await ko(this.storage,this.storageKey),x=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(f)}`});a.push(x.toString())}if(i?.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i?.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await Qe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:f}=t;if(f)return this._returnResult({data:null,error:f});const x=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:v,error:p}=await Qe(this.fetch,"POST",`${this.url}/factors`,{body:x,headers:this.headers,jwt:(i=l?.session)===null||i===void 0?void 0:i.access_token});return p?this._returnResult({data:null,error:p}):(e.factorType==="totp"&&v.type==="totp"&&(!((a=v?.totp)===null||a===void 0)&&a.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),this._returnResult({data:v,error:null}))})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const f=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?UE(e.webauthn.credential_response):VE(e.webauthn.credential_response)})}:{code:e.code}),{data:x,error:v}=await Qe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:f,headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token});return v?this._returnResult({data:null,error:v}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+x.expires_in},x)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",x),this._returnResult({data:x,error:v}))})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const f=await Qe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token});if(f.error)return f;const{data:x}=f;if(x.type!=="webauthn")return{data:x,error:null};switch(x.webauthn.type){case"create":return{data:Object.assign(Object.assign({},x),{webauthn:Object.assign(Object.assign({},x.webauthn),{credential_options:Object.assign(Object.assign({},x.webauthn.credential_options),{publicKey:BE(x.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},x),{webauthn:Object.assign(Object.assign({},x.webauthn),{credential_options:Object.assign(Object.assign({},x.webauthn.credential_options),{publicKey:FE(x.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t?.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:i},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Hd(i.access_token);let f=null;l.aal&&(f=l.aal);let x=f;((t=(e=i.user.factors)===null||e===void 0?void 0:e.filter(_=>_.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(x="aal2");const p=l.amr||[];return{data:{currentLevel:f,nextLevel:x,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?await Qe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new cr})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new cr});const f=await Qe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:x=>({data:x,error:null})});return f.data&&f.data.redirect_url&&Bn()&&!t?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(i){if(Ge(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new cr});const f=await Qe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:x=>({data:x,error:null})});return f.data&&f.data.redirect_url&&Bn()&&!t?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(i){if(Ge(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await Qe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new cr})})}catch(e){if(Ge(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?(await Qe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new cr})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(x=>x.kid===e);if(i)return i;const a=Date.now();if(i=this.jwks.keys.find(x=>x.kid===e),i&&this.jwks_cached_at+Qw>a)return i;const{data:l,error:f}=await Qe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,i=l.keys.find(x=>x.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:k,error:O}=await this.getSession();if(O||!k.session)return this._returnResult({data:null,error:O});i=k.session.access_token}const{header:a,payload:l,signature:f,raw:{header:x,payload:v}}=Hd(i);t?.allowExpired||yE(l.exp);const p=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!p){const{error:k}=await this.getUser(i);if(k)throw k;return{data:{claims:l,header:a,signature:f},error:null}}const _=xE(a.alg),A=await crypto.subtle.importKey("jwk",p,_,!0,["verify"]);if(!await crypto.subtle.verify(_,A,f,iE(`${x}.${v}`)))throw new Lu("Invalid JWT signature");return{data:{claims:l,header:a,signature:f},error:null}}catch(i){if(Ge(i))return this._returnResult({data:null,error:i});throw i}}};zf.nextInstanceID={};const KE=Hf,XE=zf,JE=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:KE,AuthApiError:Vm,AuthClient:XE,AuthError:Yo,AuthImplicitGrantRedirectError:Ya,AuthInvalidCredentialsError:Wa,AuthInvalidJwtError:Lu,AuthInvalidTokenResponseError:Ws,AuthPKCEGrantCodeExchangeError:df,AuthRetryableFetchError:Ou,AuthSessionMissingError:cr,AuthUnknownError:hs,AuthWeakPasswordError:ff,CustomAuthError:Oi,GoTrueAdminApi:Hf,GoTrueClient:zf,NavigatorLockAcquireTimeoutError:Ym,SIGN_OUT_SCOPES:Tu,isAuthApiError:Hm,isAuthError:Ge,isAuthImplicitGrantRedirectError:zm,isAuthRetryableFetchError:Au,isAuthSessionMissingError:Gm,isAuthWeakPasswordError:Zw,lockInternals:$s,navigatorLock:$m,processLock:bE},Symbol.toStringTag,{value:"Module"})),Jm=Qa(JE);var Rp;function QE(){if(Rp)return Ga;Rp=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.SupabaseAuthClient=void 0;const n=Jm;let e=class extends n.AuthClient{constructor(i){super(i)}};return Ga.SupabaseAuthClient=e,Ga}var Mp;function kp(){if(Mp)return uu;Mp=1,Object.defineProperty(uu,"__esModule",{value:!0});const n=cm,e=mm(),t=Sm,i=zw,a=qw(),l=Ww(),f=Yw(),x=QE();class v{constructor(_,A,b){var k,O,U;this.supabaseUrl=_,this.supabaseKey=A;const F=(0,f.validateSupabaseUrl)(_);if(!A)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",F),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",F),this.storageUrl=new URL("storage/v1",F),this.functionsUrl=new URL("functions/v1",F);const W=`sb-${F.hostname.split(".")[0]}-auth-token`,$={db:a.DEFAULT_DB_OPTIONS,realtime:a.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},a.DEFAULT_AUTH_OPTIONS),{storageKey:W}),global:a.DEFAULT_GLOBAL_OPTIONS},G=(0,f.applySettingDefaults)(b??{},$);this.storageKey=(k=G.auth.storageKey)!==null&&k!==void 0?k:"",this.headers=(O=G.global.headers)!==null&&O!==void 0?O:{},G.accessToken?(this.accessToken=G.accessToken,this.auth=new Proxy({},{get:(J,de)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(de)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((U=G.auth)!==null&&U!==void 0?U:{},this.headers,G.global.fetch),this.fetch=(0,l.fetchWithAuth)(A,this._getAccessToken.bind(this),G.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},G.realtime)),this.accessToken&&this.accessToken().then(J=>this.realtime.setAuth(J)).catch(J=>console.warn("Failed to set initial Realtime auth token:",J)),this.rest=new e.PostgrestClient(new URL("rest/v1",F).href,{headers:this.headers,schema:G.db.schema,fetch:this.fetch}),this.storage=new i.StorageClient(this.storageUrl.href,this.headers,this.fetch,b?.storage),G.accessToken||this._listenForAuthEvents()}get functions(){return new n.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(_){return this.rest.from(_)}schema(_){return this.rest.schema(_)}rpc(_,A={},b={head:!1,get:!1,count:void 0}){return this.rest.rpc(_,A,b)}channel(_,A={config:{}}){return this.realtime.channel(_,A)}getChannels(){return this.realtime.getChannels()}removeChannel(_){return this.realtime.removeChannel(_)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var _,A;if(this.accessToken)return await this.accessToken();const{data:b}=await this.auth.getSession();return(A=(_=b.session)===null||_===void 0?void 0:_.access_token)!==null&&A!==void 0?A:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:_,persistSession:A,detectSessionInUrl:b,storage:k,userStorage:O,storageKey:U,flowType:F,lock:W,debug:$,throwOnError:G},J,de){const ue={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new x.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},ue),J),storageKey:U,autoRefreshToken:_,persistSession:A,detectSessionInUrl:b,storage:k,userStorage:O,flowType:F,lock:W,debug:$,throwOnError:G,fetch:de,hasCustomAuthorizationHeader:Object.keys(this.headers).some(ee=>ee.toLowerCase()==="authorization")})}_initRealtimeClient(_){return new t.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},_),{params:Object.assign({apikey:this.supabaseKey},_?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((A,b)=>{this._handleTokenChanged(A,"CLIENT",b?.access_token)})}_handleTokenChanged(_,A,b){(_==="TOKEN_REFRESHED"||_==="SIGNED_IN")&&this.changedAccessToken!==b?(this.changedAccessToken=b,this.realtime.setAuth(b)):_==="SIGNED_OUT"&&(this.realtime.setAuth(),A=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}return uu.default=v,uu}var Pp;function ZE(){return Pp||(Pp=1,(function(n){var e=Mi&&Mi.__createBinding||(Object.create?(function(_,A,b,k){k===void 0&&(k=b);var O=Object.getOwnPropertyDescriptor(A,b);(!O||("get"in O?!A.__esModule:O.writable||O.configurable))&&(O={enumerable:!0,get:function(){return A[b]}}),Object.defineProperty(_,k,O)}):(function(_,A,b,k){k===void 0&&(k=b),_[k]=A[b]})),t=Mi&&Mi.__exportStar||function(_,A){for(var b in _)b!=="default"&&!Object.prototype.hasOwnProperty.call(A,b)&&e(A,_,b)},i=Mi&&Mi.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(n,"__esModule",{value:!0}),n.createClient=n.SupabaseClient=n.FunctionRegion=n.FunctionsError=n.FunctionsRelayError=n.FunctionsFetchError=n.FunctionsHttpError=n.PostgrestError=void 0;const a=i(kp());t(Jm,n);var l=mm();Object.defineProperty(n,"PostgrestError",{enumerable:!0,get:function(){return l.PostgrestError}});var f=cm;Object.defineProperty(n,"FunctionsHttpError",{enumerable:!0,get:function(){return f.FunctionsHttpError}}),Object.defineProperty(n,"FunctionsFetchError",{enumerable:!0,get:function(){return f.FunctionsFetchError}}),Object.defineProperty(n,"FunctionsRelayError",{enumerable:!0,get:function(){return f.FunctionsRelayError}}),Object.defineProperty(n,"FunctionsError",{enumerable:!0,get:function(){return f.FunctionsError}}),Object.defineProperty(n,"FunctionRegion",{enumerable:!0,get:function(){return f.FunctionRegion}}),t(Sm,n);var x=kp();Object.defineProperty(n,"SupabaseClient",{enumerable:!0,get:function(){return i(x).default}});const v=(_,A,b)=>new a.default(_,A,b);n.createClient=v;function p(){if(typeof window<"u"||typeof process>"u")return!1;const _=process.version;if(_==null)return!1;const A=_.match(/^v(\d+)\./);return A?parseInt(A[1],10)<=18:!1}p()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(Mi)),Mi}var Qm=ZE();const Zm=Ku(Qm),e2=kg({__proto__:null,default:Zm},[Qm]),{PostgrestError:WN,FunctionsHttpError:YN,FunctionsFetchError:$N,FunctionsRelayError:KN,FunctionsError:XN,FunctionRegion:JN,SupabaseClient:QN,createClient:t2,GoTrueAdminApi:ZN,GoTrueClient:e3,AuthAdminApi:t3,AuthClient:n3,navigatorLock:r3,NavigatorLockAcquireTimeoutError:i3,lockInternals:s3,processLock:o3,SIGN_OUT_SCOPES:a3,AuthError:l3,AuthApiError:u3,AuthUnknownError:c3,CustomAuthError:d3,AuthSessionMissingError:f3,AuthInvalidTokenResponseError:h3,AuthInvalidCredentialsError:p3,AuthImplicitGrantRedirectError:g3,AuthPKCEGrantCodeExchangeError:m3,AuthRetryableFetchError:y3,AuthWeakPasswordError:x3,AuthInvalidJwtError:v3,isAuthError:w3,isAuthApiError:E3,isAuthSessionMissingError:_3,isAuthImplicitGrantRedirectError:C3,isAuthRetryableFetchError:S3,isAuthWeakPasswordError:A3,RealtimePresence:T3,RealtimeChannel:I3,RealtimeClient:b3,REALTIME_LISTEN_TYPES:N3,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:R3,REALTIME_PRESENCE_LISTEN_EVENTS:M3,REALTIME_SUBSCRIBE_STATES:k3,REALTIME_CHANNEL_STATES:P3}=Zm||e2,zd={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GEMINI_API_KEY:"",VITE_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1hYmpsaGpsa2VlaGFjenhyZ2N5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4Mzg5MDMsImV4cCI6MjA4MTQxNDkwM30.eHuUAZMQ9eGffxCwYwOczhzZuRksv41QoUaIulebpT4",VITE_SUPABASE_URL:"https://mabjlhjlkeehaczxrgcy.supabase.co"},ey=n=>zd&&zd[n]?zd[n]:"",jd=ey("VITE_SUPABASE_URL"),Dp=ey("VITE_SUPABASE_KEY");let ty=null;if(jd&&Dp&&jd!=="https://placeholder.supabase.co")try{ty=t2(jd,Dp)}catch(n){console.error("Error initializing Supabase:",n)}else console.warn("VITE_SUPABASE_URL o VITE_SUPABASE_KEY no configuradas. El backend funcionar en modo MOCK (sin persistencia).");const Qn=ty,n2=({onSuccess:n})=>{const[e,t]=Je.useState(ja[0].id),i=ja.find(ve=>ve.id===e)||ja[0],[a,l]=Je.useState({name:"",email:"",phone:"+569 ",date:"",time:"",isHomeService:!1,address:"",serviceId:i.id,serviceName:i.name,referral:""}),[f,x]=Je.useState(!1),[v,p]=Je.useState(!1),[_,A]=Je.useState([]),[b,k]=Je.useState([]),[O,U]=Je.useState({}),[F,W]=Je.useState(null),[$,G]=Je.useState(!1);Je.useEffect(()=>{l(ve=>({...ve,serviceId:i.id,serviceName:i.name,isHomeService:i.homeServiceOnly?!0:ve.isHomeService}))},[i]);const J=i.durationMin+(a.isHomeService?zv:0),de=i.price+(a.isHomeService?Gv:0);Je.useEffect(()=>{a.date&&ue(a.date)},[a.date]),Je.useEffect(()=>{a.date&&ee()},[a.date,b,J]),Je.useEffect(()=>{const me=setTimeout(()=>{if(a.name.length>3&&a.phone.length>8){const be=JSON.parse(localStorage.getItem("mock_bookings")||"[]").find(we=>we.phone.replace(/\s/g,"")===a.phone.replace(/\s/g,"")&&we.name.toLowerCase()===a.name.toLowerCase());be&&(W(be),G(!0))}},1e3);return()=>clearTimeout(me)},[a.name,a.phone]);const ue=async ve=>{p(!0);try{let me=[];if(Qn){const{data:X,error:le}=await Qn.from("bookings").select("time, duration_minutes").eq("date",ve);!le&&X&&(me=X.map(qe=>{const[De,at]=qe.time.split(":").map(Number),Ce=De*60+at;return{start:Ce,end:Ce+qe.duration_minutes}}))}const we=JSON.parse(localStorage.getItem("mock_bookings")||"[]").filter(X=>X.date===ve).map(X=>{const[le,qe]=X.time.split(":").map(Number),De=le*60+qe,at=X.duration_minutes||60;return{start:De,end:De+at}});k([...me,...we])}catch(me){console.warn("Error fetching slots",me),k([])}finally{p(!1)}},ee=()=>{const pe=[];for(let be=9;be<20;be++)for(let we=0;we<60;we+=30){const X=be*60+we,le=X+J;if(le>1200)continue;if(!b.some(De=>X>=De.start&&X<De.end||le>De.start&&le<=De.end||X<=De.start&&le>=De.end)){const De=`${be.toString().padStart(2,"0")}:${we.toString().padStart(2,"0")}`;pe.push(De)}}A(pe),a.time&&!pe.includes(a.time)&&l(be=>({...be,time:""}))},Te=()=>{const ve={};return a.name||(ve.name="El nombre es obligatorio"),(!a.phone||a.phone.trim()==="+569")&&(ve.phone="El telfono es obligatorio"),a.email?/\S+@\S+\.\S+/.test(a.email)||(ve.email="El formato del email no es vlido"):ve.email="El email es obligatorio",a.date||(ve.date="Selecciona una fecha"),a.time||(ve.time="Selecciona una hora"),a.isHomeService&&!a.address&&(ve.address="La direccin es obligatoria para servicio a domicilio"),U(ve),Object.keys(ve).length===0},Z=ve=>{const{name:me,value:pe,type:be}=ve.target,we=ve.target.checked;l(X=>({...X,[me]:be==="checkbox"?we:pe})),O[me]&&U(X=>{const le={...X};return delete le[me],le})},Se=ve=>{l(me=>({...me,time:ve})),O.time&&U(me=>{const pe={...me};return delete pe.time,pe})},Pe=async()=>{const ve=JSON.parse(localStorage.getItem("mock_bookings")||"[]"),me={id:Date.now(),...a,duration_minutes:J,created_at:new Date().toISOString()};if(ve.push(me),localStorage.setItem("mock_bookings",JSON.stringify(ve)),Qn)try{const{error:pe}=await Qn.from("leads").upsert({phone:a.phone,name:a.name,email:a.email,last_booking_date:a.date},{onConflict:"phone"});pe&&console.warn("Error saving lead:",pe),await Qn.from("bookings").insert([{name:a.name,email:a.email,phone:a.phone,date:a.date,time:a.time,is_home_service:a.isHomeService,address:a.address||null,duration_minutes:J}])}catch(pe){console.warn("Supabase save failed, relying on local:",pe)}},Ie=ve=>{const pe=JSON.parse(localStorage.getItem("mock_bookings")||"[]").filter(be=>be.id!==ve);localStorage.setItem("mock_bookings",JSON.stringify(pe))},Ne=()=>{F&&(Ie(F.id),W(null),G(!1))},We=()=>{G(!1),l(ve=>({...ve,name:"",phone:"+569 "})),alert(`Entendido. Tu cita anterior (${F.date} a las ${F.time}) se mantiene. Gracias!`)},ie=async ve=>{if(!Te())return;x(!0),await Pe();const me=`${i.name}${a.isHomeService?" + Domicilio":" (En Studio)"}`,pe=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(de),be=`
Hola Tus3B Style, acabo de reservar en la web.
--------------------------------
*Cliente:* ${a.name}
*Telfono:* ${a.phone}
*Servicio:* ${me}
*Fecha:* ${a.date}
*Hora:* ${a.time}
*Duracin:* ${J} min
${a.isHomeService?`*Direccin:* ${a.address}`:""}
${a.referral?`*Referido por:* ${a.referral}`:""}
*Total:* ${pe}
--------------------------------
Espero su confirmacin final. Gracias.
    `.trim();await new Promise(we=>setTimeout(we,800)),x(!1),n&&n(a);{const we=`https://wa.me/${Ru}?text=${encodeURIComponent(be)}`;window.open(we,"_blank")}};return M.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start fade-in pb-12 relative",children:[$&&F&&M.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4 bg-white/95 backdrop-blur-sm rounded-2xl animate-in fade-in zoom-in-95",children:M.jsxs("div",{className:"bg-white border border-stone-200 shadow-2xl p-8 rounded-2xl max-w-sm text-center",children:[M.jsx(vv,{className:"mx-auto text-amber-500 mb-4 h-12 w-12"}),M.jsx("h3",{className:"serif text-2xl font-bold text-stone-900 mb-2",children:"Ya tienes una reserva"}),M.jsxs("p",{className:"text-stone-600 mb-6 text-sm",children:["Hemos encontrado una cita para ",M.jsx("strong",{children:F.name})," el da ",M.jsx("strong",{children:F.date})," a las ",M.jsx("strong",{children:F.time}),"."]}),M.jsx("p",{className:"font-bold text-stone-900 mb-6 text-lg",children:"Deseas cambiar tu reserva?"}),M.jsxs("div",{className:"space-y-3",children:[M.jsx("button",{onClick:Ne,className:"w-full bg-stone-900 text-white py-3 rounded-xl font-bold hover:bg-stone-700 transition",children:"S, cambiar cita"}),M.jsx("button",{onClick:We,className:"w-full bg-stone-100 text-stone-600 py-3 rounded-xl font-bold hover:bg-stone-200 transition",children:"No, mantener la anterior"})]})]})}),M.jsxs("div",{className:"space-y-6",children:[M.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-stone-100 relative",children:[!Qn&&M.jsxs("div",{className:"absolute top-0 right-0 bg-amber-100 text-amber-800 text-[10px] font-bold px-3 py-1 rounded-bl-lg flex items-center gap-1 z-10",children:[M.jsx(Av,{size:12})," MODO DEMO"]}),M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-2",children:"Elige tu Servicio"}),M.jsxs("div",{className:"relative mb-6",children:[M.jsx("select",{value:e,onChange:ve=>t(ve.target.value),className:"w-full p-4 rounded-xl bg-stone-50 border border-stone-200 text-stone-900 font-serif text-lg focus:ring-2 focus:ring-stone-900 outline-none appearance-none",children:ja.map(ve=>M.jsxs("option",{value:ve.id,children:[ve.name," - $",ve.price.toLocaleString("es-CL")]},ve.id))}),M.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:M.jsx("svg",{className:"w-5 h-5 text-stone-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),M.jsx("p",{className:"text-stone-500 font-light text-sm mb-4",children:i.description}),M.jsxs("div",{className:"flex justify-between items-center bg-stone-50 p-4 rounded-xl mb-4",children:[M.jsxs("div",{children:[M.jsx("span",{className:"block text-2xl font-semibold text-stone-900",children:new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(de)}),M.jsx("span",{className:"text-xs text-stone-500 uppercase tracking-wide",children:"Precio Estimado"})]}),M.jsxs("div",{className:"text-right",children:[M.jsxs("span",{className:"block text-lg font-medium text-stone-900",children:[J," min"]}),M.jsx("span",{className:"text-xs text-stone-500 uppercase tracking-wide",children:"Duracin"})]})]}),M.jsx("div",{className:"mb-4",children:M.jsxs("div",{className:`flex items-start p-3 rounded-lg border relative transition-colors ${i.homeServiceOnly?"bg-amber-50 border-amber-200":"bg-blue-50/50 border-blue-100"}`,children:[M.jsx("div",{className:"flex items-center h-5 mt-0.5",children:M.jsx("input",{id:"isHomeService",name:"isHomeService",type:"checkbox",checked:a.isHomeService,onChange:Z,disabled:i.homeServiceOnly,className:"focus:ring-stone-500 h-5 w-5 text-stone-900 border-gray-300 rounded cursor-pointer disabled:opacity-50"})}),M.jsxs("div",{className:"ml-3",children:[M.jsx("label",{htmlFor:"isHomeService",className:"font-bold text-stone-900 cursor-pointer",children:i.homeServiceOnly?"Servicio Exclusivo a Domicilio":"Servicio a Domicilio? (+ $3.000)"}),M.jsxs("p",{className:"text-xs text-stone-500 mt-1 leading-relaxed",children:["Vamos a tu casa en ",jv.join(", "),". ",M.jsx("br",{}),M.jsx("span",{className:"text-blue-600 font-medium",children:"Incluye +30 min de traslado."})]})]})]})}),M.jsx("h4",{className:"text-xs uppercase tracking-widest text-stone-400 mb-3 font-bold mt-6",children:"Incluye"}),M.jsx("ul",{className:"space-y-2",children:i.includes.map((ve,me)=>M.jsxs("li",{className:"flex items-center text-sm text-stone-700",children:[M.jsx(Pg,{size:14,className:"text-stone-900 mr-2"}),ve]},me))})]}),M.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-stone-100",children:[M.jsxs("h3",{className:"serif text-xl text-stone-900 mb-4 flex items-center gap-2",children:[M.jsx("span",{className:"bg-stone-900 text-white w-6 h-6 rounded-full text-xs flex items-center justify-center font-sans",children:"1"}),"Tus Datos"]}),M.jsxs("div",{className:"space-y-4",children:[M.jsxs("div",{children:[M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-1",children:"Nombre y Apellido"}),M.jsx("input",{type:"text",name:"name",value:a.name,onChange:Z,className:`w-full px-4 py-3 rounded-lg bg-stone-50 border ${O.name?"border-red-300 focus:border-red-500":"border-stone-200 focus:border-stone-900"} focus:ring-1 outline-none transition-all`,placeholder:"Ej: Mara Prez"}),O.name&&M.jsx("p",{className:"text-red-500 text-xs mt-1",children:O.name})]}),M.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[M.jsxs("div",{children:[M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-1",children:"Telfono"}),M.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:Z,className:`w-full px-4 py-3 rounded-lg bg-stone-50 border ${O.phone?"border-red-300 focus:border-red-500":"border-stone-200 focus:border-stone-900"} focus:ring-1 outline-none transition-all`,placeholder:"+569...",inputMode:"numeric"}),O.phone&&M.jsx("p",{className:"text-red-500 text-xs mt-1",children:O.phone})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-1",children:"Email"}),M.jsx("input",{type:"email",name:"email",value:a.email,onChange:Z,className:`w-full px-4 py-3 rounded-lg bg-stone-50 border ${O.email?"border-red-300 focus:border-red-500":"border-stone-200 focus:border-stone-900"} focus:ring-1 outline-none transition-all`,placeholder:"correo@ejemplo.com"}),O.email&&M.jsx("p",{className:"text-red-500 text-xs mt-1",children:O.email})]})]}),M.jsxs("div",{className:"animate-in fade-in pt-2",children:[M.jsxs("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-1 flex items-center gap-1",children:[M.jsx(Fv,{size:12})," Quin te recomend? (Opcional)"]}),M.jsx("input",{type:"text",name:"referral",value:a.referral,onChange:Z,className:"w-full px-4 py-3 rounded-lg bg-purple-50 border border-purple-100 focus:border-purple-300 focus:ring-1 outline-none transition-all placeholder-purple-300 text-purple-900",placeholder:"Nombre o Telfono de tu amiga"})]}),a.isHomeService&&M.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 pt-2",children:[M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-1",children:"Direccin (Comuna y Calle)"}),M.jsxs("div",{className:"relative",children:[M.jsx("input",{type:"text",name:"address",value:a.address,onChange:Z,className:`w-full px-4 py-3 rounded-lg bg-amber-50 border ${O.address?"border-red-300 focus:border-red-500":"border-amber-200 focus:border-amber-500"} focus:ring-1 pl-10 outline-none transition-all`,placeholder:"Av. Irarrzaval 1234, uoa"}),M.jsx(Og,{size:18,className:"absolute left-3 top-3.5 text-amber-500"})]}),O.address&&M.jsx("p",{className:"text-red-500 text-xs mt-1",children:O.address})]})]})]})]}),M.jsxs("div",{className:"space-y-6",children:[M.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-stone-100",children:[M.jsxs("h3",{className:"serif text-xl text-stone-900 mb-4 flex items-center gap-2",children:[M.jsx("span",{className:"bg-stone-900 text-white w-6 h-6 rounded-full text-xs flex items-center justify-center font-sans",children:"2"}),"Fecha y Hora"]}),M.jsxs("div",{className:"mb-6",children:[M.jsx("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-2",children:"Selecciona un da"}),M.jsxs("div",{className:"relative",children:[M.jsx("input",{type:"date",name:"date",min:new Date().toISOString().split("T")[0],value:a.date,onChange:Z,className:`w-full px-4 py-4 rounded-xl bg-stone-50 border ${O.date?"border-red-300 focus:border-red-500":"border-stone-200 focus:border-stone-900"} text-lg font-medium shadow-sm outline-none`}),M.jsx(Ev,{size:20,className:"absolute right-4 top-4.5 text-stone-400 pointer-events-none"})]}),O.date&&M.jsx("p",{className:"text-red-500 text-xs mt-1",children:O.date})]}),a.date&&M.jsxs("div",{className:"animate-in fade-in",children:[M.jsxs("label",{className:"block text-xs font-bold text-stone-500 uppercase mb-3 flex justify-between",children:[M.jsx("span",{children:"Horas Disponibles"}),v&&M.jsxs("span",{className:"flex items-center text-stone-400",children:[M.jsx(Nu,{size:12,className:"animate-spin mr-1"})," Buscando..."]})]}),_.length>0?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-4 gap-3",children:_.map(ve=>M.jsx("button",{onClick:()=>Se(ve),className:`py-3 px-2 rounded-lg text-sm font-bold transition-all transform active:scale-95 ${a.time===ve?"bg-stone-900 text-white shadow-md scale-105 ring-2 ring-offset-2 ring-stone-900":"bg-white border border-stone-200 text-stone-600 hover:border-stone-900 hover:bg-stone-50"}`,children:ve},ve))}),O.time&&M.jsx("p",{className:"text-red-500 text-xs mt-2 text-center bg-red-50 p-2 rounded",children:O.time})]}):M.jsx("div",{className:"bg-stone-50 p-4 rounded-lg text-center text-stone-500 text-sm",children:v?"Cargando...":"No hay horas disponibles para este da. Intenta otra fecha."})]}),!a.date&&M.jsxs("div",{className:"text-center py-8 text-stone-400 text-sm italic",children:[M.jsx(_v,{size:32,className:"mx-auto mb-2 opacity-20"}),"Selecciona una fecha para ver disponibilidad"]})]}),M.jsxs("div",{className:"pt-2 sticky bottom-4 z-10",children:[M.jsxs("button",{onClick:()=>ie(),disabled:f,className:"w-full flex justify-center items-center space-x-2 bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-xl transition-all transform hover:-translate-y-1 disabled:opacity-75 disabled:cursor-not-allowed disabled:transform-none",children:[f?M.jsx(Nu,{className:"animate-spin"}):M.jsx(Bv,{size:22}),M.jsx("span",{className:"text-lg",children:f?"Procesando...":"Confirmar y Enviar WhatsApp"})]}),M.jsx("p",{className:"text-xs text-center text-stone-400 mt-3 px-4",children:"Al confirmar, volvers al inicio y se abrir WhatsApp."})]})]})]})},r2=()=>{const[n,e]=Je.useState(""),[t,i]=Je.useState(null),a=Je.useMemo(()=>{const A=new Set;return Kd.forEach(b=>b.notes.forEach(k=>A.add(k))),Array.from(A).sort()},[]),l=Je.useMemo(()=>Kd.filter(A=>{const b=A.name.toLowerCase().includes(n.toLowerCase())||A.brand.toLowerCase().includes(n.toLowerCase()),k=t?A.notes.includes(t):!0;return b&&k}),[n,t]),f=l.filter(A=>A.category==="classic"),x=l.filter(A=>A.category==="arab"),v=(A,b)=>{const k=b==="5ml"?A.price5ml:A.price10ml,O=`Hola Tus3B Style, quiero comprar el decant de *${A.brand} - ${A.name}* en formato *${b}* por $${k}. Tienen disponibilidad?`,U=`https://wa.me/${Ru}?text=${encodeURIComponent(O)}`;window.open(U,"_blank")},p=()=>{window.open(`https://wa.me/${Ru}?text=${encodeURIComponent("Hola Tus3B Style, me gustara cotizar/encargar un perfume que no veo en el catlogo.")}`,"_blank")},_=A=>M.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12",children:A.map((b,k)=>M.jsxs("div",{className:"group flex flex-col h-full",children:[M.jsxs("div",{className:"relative aspect-[4/5] overflow-hidden bg-white rounded-2xl mb-5 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] border border-stone-100 transition-all duration-300 group-hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.1)]",children:[!n&&!t&&M.jsx("div",{className:"absolute top-0 left-0 bg-stone-900 text-white w-8 h-8 flex items-center justify-center font-serif text-sm border-br-xl z-10",children:k+1}),M.jsx("img",{src:b.image,alt:b.name,className:"w-full h-full object-contain p-8 transition-transform duration-700 ease-out group-hover:scale-110"}),M.jsx("div",{className:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity bg-stone-900/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded",children:"Original"})]}),M.jsxs("div",{className:"flex-1 flex flex-col",children:[M.jsx("h4",{className:"text-xs uppercase tracking-wider text-stone-500 font-bold mb-1",children:b.brand}),M.jsx("h3",{className:"serif text-2xl text-stone-900 mb-2 group-hover:text-stone-700 transition-colors",children:b.name}),M.jsx("p",{className:"text-stone-600 text-sm mb-4 line-clamp-3 leading-relaxed flex-grow",children:b.description}),M.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:b.notes.slice(0,3).map(O=>M.jsx("span",{className:"text-[10px] uppercase tracking-wide bg-stone-50 text-stone-500 px-2 py-1 rounded border border-stone-100",children:O},O))}),M.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-auto",children:[M.jsxs("button",{onClick:()=>v(b,"5ml"),className:"group/btn flex flex-col items-center justify-center p-2.5 border border-stone-200 rounded-lg hover:border-stone-900 hover:bg-stone-900 transition-all duration-300",children:[M.jsx("span",{className:"text-[10px] font-bold text-stone-500 uppercase mb-0.5 group-hover/btn:text-stone-400",children:"5 ML"}),M.jsxs("span",{className:"text-stone-900 font-semibold group-hover/btn:text-white",children:["$",b.price5ml.toLocaleString("es-CL")]})]}),M.jsxs("button",{onClick:()=>v(b,"10ml"),className:"group/btn flex flex-col items-center justify-center p-2.5 border border-stone-200 rounded-lg hover:border-stone-900 hover:bg-stone-900 transition-all duration-300",children:[M.jsx("span",{className:"text-[10px] font-bold text-stone-500 uppercase mb-0.5 group-hover/btn:text-stone-400",children:"10 ML"}),M.jsxs("span",{className:"text-stone-900 font-semibold group-hover/btn:text-white",children:["$",b.price10ml.toLocaleString("es-CL")]})]})]})]})]},b.id))});return M.jsxs("div",{className:"space-y-16 fade-in",children:[M.jsxs("div",{className:"flex flex-col border-b border-stone-200 pb-8 gap-6",children:[M.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[M.jsxs("div",{children:[M.jsx("h3",{className:"serif text-4xl text-stone-900",children:"Catlogo de Decants"}),M.jsx("p",{className:"text-stone-500 mt-2 max-w-xl",children:"Descubre tu firma olfativa con nuestra curadura de perfumes 100% originales."})]}),M.jsxs("div",{className:"relative w-full md:w-72",children:[M.jsx("input",{type:"text",placeholder:"Buscar marca o nombre...",className:"pl-10 pr-4 py-3 border border-stone-300 rounded-xl focus:ring-stone-900 focus:border-stone-900 w-full transition-shadow hover:shadow-sm",value:n,onChange:A=>e(A.target.value)}),M.jsx(Bg,{size:18,className:"absolute left-3 top-3.5 text-stone-400"})]})]}),M.jsx("div",{className:"w-full overflow-x-auto pb-2 -mx-4 px-4 md:mx-0 md:px-0 scrollbar-hide",children:M.jsxs("div",{className:"flex flex-nowrap md:flex-wrap gap-2 items-center min-w-max",children:[M.jsx("span",{className:"text-xs font-bold uppercase text-stone-400 mr-2 sticky left-0 bg-white pl-2 md:pl-0",children:"Filtrar:"}),a.map(A=>M.jsx("button",{onClick:()=>i(t===A?null:A),className:`text-xs px-4 py-2 rounded-full border transition-all duration-200 whitespace-nowrap ${t===A?"bg-stone-900 text-white border-stone-900 shadow-md":"bg-white text-stone-600 border-stone-200 active:bg-stone-100"}`,children:A},A))]})})]}),f.length>0&&M.jsxs("section",{children:[M.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[M.jsx("div",{className:"bg-stone-100 p-2 rounded-full",children:M.jsx(Cv,{size:24,className:"text-stone-800"})}),M.jsxs("div",{children:[M.jsx("h2",{className:"serif text-3xl text-stone-900",children:"Clsicos del Lujo"}),M.jsx("p",{className:"text-sm text-stone-500 uppercase tracking-widest font-bold mt-1",children:"Ranking de Tendencia 2025-26"})]})]}),_(f)]}),f.length>0&&x.length>0&&M.jsx("div",{className:"border-t border-stone-100"}),x.length>0&&M.jsxs("section",{children:[M.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[M.jsx("div",{className:"bg-amber-50 p-2 rounded-full",children:M.jsx($d,{size:24,className:"text-amber-600"})}),M.jsxs("div",{children:[M.jsx("h2",{className:"serif text-3xl text-stone-900",children:"Tendencia rabe"}),M.jsx("p",{className:"text-sm text-amber-600/80 uppercase tracking-widest font-bold mt-1",children:"Exclusividad & Notas Gourmand"})]})]}),_(x)]}),l.length===0&&M.jsxs("div",{className:"text-center py-24 bg-stone-50 rounded-2xl border border-dashed border-stone-200",children:[M.jsx(Xu,{size:48,className:"mx-auto text-stone-300 mb-4"}),M.jsx("h4",{className:"text-stone-900 font-bold text-lg mb-1",children:"No encontramos resultados"}),M.jsx("p",{className:"text-stone-500 text-sm",children:"Prueba ajustando tus filtros de bsqueda."})]}),M.jsxs("div",{className:"mt-20 bg-stone-900 rounded-3xl p-8 md:p-14 text-center text-white relative overflow-hidden shadow-2xl ring-1 ring-white/10",children:[M.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[M.jsx("div",{className:"bg-white/10 backdrop-blur-sm p-4 rounded-full mb-6 ring-1 ring-white/20",children:M.jsx(bv,{size:32,className:"text-yellow-200"})}),M.jsx("h3",{className:"serif text-3xl md:text-5xl mb-6",children:"Buscas algo exclusivo?"}),M.jsx("p",{className:"text-stone-300 mb-10 max-w-2xl mx-auto text-lg font-light leading-relaxed",children:"Si no encuentras tu fragancia favorita en nuestro catlogo, contctanos. Hacemos encargos especiales para que encuentres tu firma olfativa perfecta."}),M.jsxs("button",{onClick:p,className:"group inline-flex items-center bg-white text-stone-900 px-8 py-4 rounded-full font-bold uppercase tracking-widest hover:bg-stone-100 transition-all transform hover:-translate-y-1 shadow-[0_10px_20px_-10px_rgba(255,255,255,0.3)]",children:[M.jsx(Lg,{className:"mr-3 group-hover:text-amber-600 transition-colors",size:20}),"Cotizar Encargo"]})]}),M.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('https://images.unsplash.com/photo-1541643600914-78b084683601?auto=format&fit=crop&q=80')] opacity-20 bg-cover bg-center mix-blend-overlay grayscale"})]})]})},i2=()=>M.jsx("footer",{className:"bg-stone-900 text-white py-12 md:py-16",children:M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12 text-center md:text-left",children:[M.jsxs("div",{children:[M.jsxs("span",{className:"serif text-3xl font-bold italic tracking-tighter block mb-4",children:["Tus3B ",M.jsx("span",{className:"text-stone-400 not-italic font-light text-xl ml-1",children:"Style"})]}),M.jsx("p",{className:"text-stone-400 font-light max-w-xs mx-auto md:mx-0",children:"Elevando tu estilo con servicios de peluquera premium a domicilio y lo mejor de la perfumera internacional."})]}),M.jsxs("div",{className:"flex flex-col items-center md:items-start",children:[M.jsx("h4",{className:"uppercase tracking-widest text-xs font-bold text-stone-500 mb-4",children:"Contacto"}),M.jsxs("a",{href:`https://wa.me/${Ru}`,className:"text-stone-300 hover:text-white mb-2 transition flex items-center gap-2",children:[M.jsx(Lg,{size:16})," WhatsApp: +56 9 8452 4774"]}),M.jsx("span",{className:"text-stone-300 mb-2",children:"Santiago, Chile"}),M.jsx("span",{className:"text-stone-300",children:"contacto@tus3b.cl"})]}),M.jsxs("div",{className:"flex flex-col items-center md:items-start",children:[M.jsx("h4",{className:"uppercase tracking-widest text-xs font-bold text-stone-500 mb-4",children:"Sguenos"}),M.jsx("div",{className:"flex space-x-4",children:M.jsx("a",{href:"#",className:"p-2 bg-stone-800 rounded-full hover:bg-stone-700 transition",children:M.jsx(Tv,{size:20})})})]})]}),M.jsxs("div",{className:"border-t border-stone-800 mt-12 pt-8 text-center text-stone-500 text-sm font-light",children:[" ",new Date().getFullYear()," Tus3B Style. Todos los derechos reservados."]})]})});var s2={};let o2,a2;function l2(){return{geminiUrl:o2,vertexUrl:a2}}function u2(n,e,t,i){var a,l;if(!n?.baseUrl){const f=l2();return e?(a=f.vertexUrl)!==null&&a!==void 0?a:t:(l=f.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}class Li{}function Re(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const l=e[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function E(n,e,t){for(let l=0;l<e.length-1;l++){const f=e[l];if(f.endsWith("[]")){const x=f.slice(0,-2);if(!(x in n))if(Array.isArray(t))n[x]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${f}`);if(Array.isArray(n[x])){const v=n[x];if(Array.isArray(t))for(let p=0;p<v.length;p++){const _=v[p];E(_,e.slice(l+1),t[p])}else for(const p of v)E(p,e.slice(l+1),t)}return}else if(f.endsWith("[0]")){const x=f.slice(0,-3);x in n||(n[x]=[{}]);const v=n[x];E(v[0],e.slice(l+1),t);return}(!n[f]||typeof n[f]!="object")&&(n[f]={}),n=n[f]}const i=e[e.length-1],a=n[i];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function y(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2);if(l in n){const f=n[l];return Array.isArray(f)?f.map(x=>y(x,e.slice(i+1),t)):t}else return t}else n=n[a]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function c2(n,e){for(const[t,i]of Object.entries(e)){const a=t.split("."),l=i.split("."),f=new Set;let x=-1;for(let v=0;v<a.length;v++)if(a[v]==="*"){x=v;break}if(x!==-1&&l.length>x)for(let v=x;v<l.length;v++){const p=l[v];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&f.add(p)}pf(n,a,l,0,f)}}function pf(n,e,t,i,a){if(i>=e.length||typeof n!="object"||n===null)return;const l=e[i];if(l.endsWith("[]")){const f=l.slice(0,-2),x=n;if(f in x&&Array.isArray(x[f]))for(const v of x[f])pf(v,e,t,i+1,a)}else if(l==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const f=n,x=Object.keys(f).filter(p=>!p.startsWith("_")&&!a.has(p)),v={};for(const p of x)v[p]=f[p];for(const[p,_]of Object.entries(v)){const A=[];for(const b of t.slice(i))b==="*"?A.push(p):A.push(b);E(f,A,_)}for(const p of x)delete f[p]}}else{const f=n;l in f&&pf(f[l],e,t,i+1,a)}}function jf(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function d2(n){const e={},t=y(n,["operationName"]);t!=null&&E(e,["operationName"],t);const i=y(n,["resourceName"]);return i!=null&&E(e,["_url","resourceName"],i),e}function f2(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response","generateVideoResponse"]);return f!=null&&E(e,["response"],p2(f)),e}function h2(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response"]);return f!=null&&E(e,["response"],g2(f)),e}function p2(n){const e={},t=y(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(f=>m2(f))),E(e,["generatedVideos"],l)}const i=y(n,["raiMediaFilteredCount"]);i!=null&&E(e,["raiMediaFilteredCount"],i);const a=y(n,["raiMediaFilteredReasons"]);return a!=null&&E(e,["raiMediaFilteredReasons"],a),e}function g2(n){const e={},t=y(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(f=>y2(f))),E(e,["generatedVideos"],l)}const i=y(n,["raiMediaFilteredCount"]);i!=null&&E(e,["raiMediaFilteredCount"],i);const a=y(n,["raiMediaFilteredReasons"]);return a!=null&&E(e,["raiMediaFilteredReasons"],a),e}function m2(n){const e={},t=y(n,["video"]);return t!=null&&E(e,["video"],C2(t)),e}function y2(n){const e={},t=y(n,["_self"]);return t!=null&&E(e,["video"],S2(t)),e}function x2(n){const e={},t=y(n,["operationName"]);return t!=null&&E(e,["_url","operationName"],t),e}function v2(n){const e={},t=y(n,["operationName"]);return t!=null&&E(e,["_url","operationName"],t),e}function w2(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response"]);return f!=null&&E(e,["response"],E2(f)),e}function E2(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["parent"]);i!=null&&E(e,["parent"],i);const a=y(n,["documentName"]);return a!=null&&E(e,["documentName"],a),e}function ny(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response"]);return f!=null&&E(e,["response"],_2(f)),e}function _2(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["parent"]);i!=null&&E(e,["parent"],i);const a=y(n,["documentName"]);return a!=null&&E(e,["documentName"],a),e}function C2(n){const e={},t=y(n,["uri"]);t!=null&&E(e,["uri"],t);const i=y(n,["encodedVideo"]);i!=null&&E(e,["videoBytes"],jf(i));const a=y(n,["encoding"]);return a!=null&&E(e,["mimeType"],a),e}function S2(n){const e={},t=y(n,["gcsUri"]);t!=null&&E(e,["uri"],t);const i=y(n,["bytesBase64Encoded"]);i!=null&&E(e,["videoBytes"],jf(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["mimeType"],a),e}var Op;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Op||(Op={}));var Lp;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Lp||(Lp={}));var Bp;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Bp||(Bp={}));var gs;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(gs||(gs={}));var Fp;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Fp||(Fp={}));var Up;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Up||(Up={}));var Vp;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Vp||(Vp={}));var Hp;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Hp||(Hp={}));var Gp;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Gp||(Gp={}));var zp;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(zp||(zp={}));var jp;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(jp||(jp={}));var qp;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(qp||(qp={}));var Wp;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Wp||(Wp={}));var Yp;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(Yp||(Yp={}));var $p;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})($p||($p={}));var Kp;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Kp||(Kp={}));var Xp;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Xp||(Xp={}));var Jp;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Jp||(Jp={}));var Qp;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Qp||(Qp={}));var Vu;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Vu||(Vu={}));var Zp;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zp||(Zp={}));var e1;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(e1||(e1={}));var t1;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(t1||(t1={}));var gf;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(gf||(gf={}));var n1;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(n1||(n1={}));var r1;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(r1||(r1={}));var i1;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(i1||(i1={}));var s1;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(s1||(s1={}));var o1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(o1||(o1={}));var a1;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(a1||(a1={}));var l1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(l1||(l1={}));var u1;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(u1||(u1={}));var c1;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(c1||(c1={}));var d1;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(d1||(d1={}));var f1;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(f1||(f1={}));var h1;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(h1||(h1={}));var p1;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(p1||(p1={}));var g1;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(g1||(g1={}));var m1;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(m1||(m1={}));var y1;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(y1||(y1={}));var x1;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(x1||(x1={}));var v1;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(v1||(v1={}));var w1;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(w1||(w1={}));var E1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(E1||(E1={}));var _1;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(_1||(_1={}));var C1;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(C1||(C1={}));var S1;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(S1||(S1={}));var A1;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(A1||(A1={}));var T1;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(T1||(T1={}));var I1;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(I1||(I1={}));var b1;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(b1||(b1={}));var N1;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(N1||(N1={}));var R1;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(R1||(R1={}));var M1;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(M1||(M1={}));var k1;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(k1||(k1={}));var Fo;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Fo||(Fo={}));class mf{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class za{get text(){var e,t,i,a,l,f,x,v;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",_=!1;const A=[];for(const b of(v=(x=(f=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content)===null||x===void 0?void 0:x.parts)!==null&&v!==void 0?v:[]){for(const[k,O]of Object.entries(b))k!=="text"&&k!=="thought"&&k!=="thoughtSignature"&&(O!==null||O!==void 0)&&A.push(k);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;_=!0,p+=b.text}}return A.length>0&&console.warn(`there are non-text parts ${A} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?p:void 0}get data(){var e,t,i,a,l,f,x,v;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const _=[];for(const A of(v=(x=(f=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content)===null||x===void 0?void 0:x.parts)!==null&&v!==void 0?v:[]){for(const[b,k]of Object.entries(A))b!=="inlineData"&&(k!==null||k!==void 0)&&_.push(b);A.inlineData&&typeof A.inlineData.data=="string"&&(p+=atob(A.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,a,l,f,x,v;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(v=(x=(f=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content)===null||x===void 0?void 0:x.parts)===null||v===void 0?void 0:v.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if(p?.length!==0)return p}get executableCode(){var e,t,i,a,l,f,x,v,p;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(v=(x=(f=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content)===null||x===void 0?void 0:x.parts)===null||v===void 0?void 0:v.filter(A=>A.executableCode).map(A=>A.executableCode).filter(A=>A!==void 0);if(_?.length!==0)return(p=_?.[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,a,l,f,x,v,p;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(v=(x=(f=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content)===null||x===void 0?void 0:x.parts)===null||v===void 0?void 0:v.filter(A=>A.codeExecutionResult).map(A=>A.codeExecutionResult).filter(A=>A!==void 0);if(_?.length!==0)return(p=_?.[0])===null||p===void 0?void 0:p.output}}class P1{}class D1{}class A2{}class T2{}class I2{}class b2{}class O1{}class L1{}class B1{}class N2{}class Hu{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Hu;let a;const l=e;return t?a=h2(l):a=f2(l),Object.assign(i,a),i}}class F1{}class U1{}class V1{}class H1{}class R2{}class M2{}class k2{}class qf{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new qf,l=w2(e);return Object.assign(i,l),i}}class P2{}class D2{}class O2{}class G1{}class L2{get text(){var e,t,i;let a="",l=!1;const f=[];for(const x of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[v,p]of Object.entries(x))v!=="text"&&v!=="thought"&&p!==null&&f.push(v);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;l=!0,a+=x.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var e,t,i;let a="";const l=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[x,v]of Object.entries(f))x!=="inlineData"&&v!==null&&l.push(x);f.inlineData&&typeof f.inlineData.data=="string"&&(a+=atob(f.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class B2{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Wf{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Wf,l=ny(e);return Object.assign(i,l),i}}function wt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ry(n,e){const t=wt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function iy(n){return Array.isArray(n)?n.map(e=>Gu(e)):[Gu(n)]}function Gu(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function sy(n){const e=Gu(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function oy(n){const e=Gu(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function z1(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function ay(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>z1(e)):[z1(n)]}function yf(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function j1(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function q1(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Yn(n){if(n==null)throw new Error("ContentUnion is required");return yf(n)?n:{role:"user",parts:ay(n)}}function Yf(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Yn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Yn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Yn(t)):[Yn(e)]}function Vr(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(j1(n)||q1(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Yn(n)]}const e=[],t=[],i=yf(n[0]);for(const a of n){const l=yf(a);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(a);else{if(j1(a)||q1(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(a)}}return i||e.push({role:"user",parts:ay(t)}),e}function F2(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(gs).includes(t[0].toUpperCase())?t[0].toUpperCase():gs.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(gs).includes(i.toUpperCase())?i.toUpperCase():gs.TYPE_UNSPECIFIED})}}function jo(n){const e={},t=["items"],i=["anyOf"],a=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&F2(n.type,e);for(const[f,x]of Object.entries(n))if(x!=null)if(f=="type"){if(x==="null")throw new Error("type: null can not be the only possible type for the field.");if(x instanceof Array)continue;e.type=Object.values(gs).includes(x.toUpperCase())?x.toUpperCase():gs.TYPE_UNSPECIFIED}else if(t.includes(f))e[f]=jo(x);else if(i.includes(f)){const v=[];for(const p of x){if(p.type=="null"){e.nullable=!0;continue}v.push(jo(p))}e[f]=v}else if(a.includes(f)){const v={};for(const[p,_]of Object.entries(x))v[p]=jo(_);e[f]=v}else{if(f==="additionalProperties")continue;e[f]=x}return e}function $f(n){return jo(n)}function Kf(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Xf(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Xo(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=jo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=jo(e.response));return n}function Jo(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function U2(n,e,t,i=1){const a=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:a?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:a?`${t}/${e}`:e}function Bi(n,e){if(typeof e!="string")throw new Error("name must be a string");return U2(n,e,"cachedContents")}function ly(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function ys(n){return jf(n)}function V2(n){return n!=null&&typeof n=="object"&&"name"in n}function H2(n){return n!=null&&typeof n=="object"&&"video"in n}function G2(n){return n!=null&&typeof n=="object"&&"uri"in n}function uy(n){var e;let t;if(V2(n)&&(t=n.name),!(G2(n)&&(t=n.uri,t===void 0))&&!(H2(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const a=t.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${t}`);t=a[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function cy(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function dy(n){for(const e of["models","tunedModels","publisherModels"])if(z2(n,e))return n[e];return[]}function z2(n,e){return n!==null&&typeof n=="object"&&e in n}function j2(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function q2(n,e={}){const t=[],i=new Set;for(const a of n){const l=a.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const f=j2(a,e);f.functionDeclarations&&t.push(...f.functionDeclarations)}return{functionDeclarations:t}}function fy(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,a=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(a>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function W2(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function hy(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const a=t.inlinedResponses;if(!Array.isArray(a)||a.length===0)return n;let l=!1;for(const f of a){if(typeof f!="object"||f===null)continue;const v=f.response;if(typeof v!="object"||v===null)continue;if(v.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Qo(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function py(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function Y2(n){const e={},t=y(n,["responsesFile"]);t!=null&&E(e,["fileName"],t);const i=y(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>I_(f))),E(e,["inlinedResponses"],l)}const a=y(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["inlinedEmbedContentResponses"],l)}return e}function $2(n){const e={},t=y(n,["predictionsFormat"]);t!=null&&E(e,["format"],t);const i=y(n,["gcsDestination","outputUriPrefix"]);i!=null&&E(e,["gcsUri"],i);const a=y(n,["bigqueryDestination","outputUri"]);return a!=null&&E(e,["bigqueryUri"],a),e}function K2(n){const e={},t=y(n,["format"]);t!=null&&E(e,["predictionsFormat"],t);const i=y(n,["gcsUri"]);i!=null&&E(e,["gcsDestination","outputUriPrefix"],i);const a=y(n,["bigqueryUri"]);if(a!=null&&E(e,["bigqueryDestination","outputUri"],a),y(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(y(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(y(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Iu(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata","displayName"]);i!=null&&E(e,["displayName"],i);const a=y(n,["metadata","state"]);a!=null&&E(e,["state"],py(a));const l=y(n,["metadata","createTime"]);l!=null&&E(e,["createTime"],l);const f=y(n,["metadata","endTime"]);f!=null&&E(e,["endTime"],f);const x=y(n,["metadata","updateTime"]);x!=null&&E(e,["updateTime"],x);const v=y(n,["metadata","model"]);v!=null&&E(e,["model"],v);const p=y(n,["metadata","output"]);return p!=null&&E(e,["dest"],Y2(hy(p))),e}function xf(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["displayName"]);i!=null&&E(e,["displayName"],i);const a=y(n,["state"]);a!=null&&E(e,["state"],py(a));const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["createTime"]);f!=null&&E(e,["createTime"],f);const x=y(n,["startTime"]);x!=null&&E(e,["startTime"],x);const v=y(n,["endTime"]);v!=null&&E(e,["endTime"],v);const p=y(n,["updateTime"]);p!=null&&E(e,["updateTime"],p);const _=y(n,["model"]);_!=null&&E(e,["model"],_);const A=y(n,["inputConfig"]);A!=null&&E(e,["src"],X2(A));const b=y(n,["outputConfig"]);b!=null&&E(e,["dest"],$2(hy(b)));const k=y(n,["completionStats"]);return k!=null&&E(e,["completionStats"],k),e}function X2(n){const e={},t=y(n,["instancesFormat"]);t!=null&&E(e,["format"],t);const i=y(n,["gcsSource","uris"]);i!=null&&E(e,["gcsUri"],i);const a=y(n,["bigquerySource","inputUri"]);return a!=null&&E(e,["bigqueryUri"],a),e}function J2(n,e){const t={};if(y(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(y(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(y(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=y(e,["fileName"]);i!=null&&E(t,["fileName"],i);const a=y(e,["inlinedRequests"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>T_(n,f))),E(t,["requests","requests"],l)}return t}function Q2(n){const e={},t=y(n,["format"]);t!=null&&E(e,["instancesFormat"],t);const i=y(n,["gcsUri"]);i!=null&&E(e,["gcsSource","uris"],i);const a=y(n,["bigqueryUri"]);if(a!=null&&E(e,["bigquerySource","inputUri"],a),y(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(y(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Z2(n){const e={},t=y(n,["data"]);if(t!=null&&E(e,["data"],t),y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function e_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function t_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function n_(n){const e={},t=y(n,["content"]);t!=null&&E(e,["content"],t);const i=y(n,["citationMetadata"]);i!=null&&E(e,["citationMetadata"],r_(i));const a=y(n,["tokenCount"]);a!=null&&E(e,["tokenCount"],a);const l=y(n,["finishReason"]);l!=null&&E(e,["finishReason"],l);const f=y(n,["avgLogprobs"]);f!=null&&E(e,["avgLogprobs"],f);const x=y(n,["groundingMetadata"]);x!=null&&E(e,["groundingMetadata"],x);const v=y(n,["index"]);v!=null&&E(e,["index"],v);const p=y(n,["logprobsResult"]);p!=null&&E(e,["logprobsResult"],p);const _=y(n,["safetyRatings"]);if(_!=null){let b=_;Array.isArray(b)&&(b=b.map(k=>k)),E(e,["safetyRatings"],b)}const A=y(n,["urlContextMetadata"]);return A!=null&&E(e,["urlContextMetadata"],A),e}function r_(n){const e={},t=y(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),E(e,["citations"],i)}return e}function gy(n){const e={},t=y(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>D_(l))),E(e,["parts"],a)}const i=y(n,["role"]);return i!=null&&E(e,["role"],i),e}function i_(n,e){const t={},i=y(n,["displayName"]);if(e!==void 0&&i!=null&&E(e,["batch","displayName"],i),y(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function s_(n,e){const t={},i=y(n,["displayName"]);e!==void 0&&i!=null&&E(e,["displayName"],i);const a=y(n,["dest"]);return e!==void 0&&a!=null&&E(e,["outputConfig"],K2(W2(a))),t}function W1(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["src"]);a!=null&&E(t,["batch","inputConfig"],J2(n,fy(n,a)));const l=y(e,["config"]);return l!=null&&i_(l,t),t}function o_(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["model"],wt(n,i));const a=y(e,["src"]);a!=null&&E(t,["inputConfig"],Q2(fy(n,a)));const l=y(e,["config"]);return l!=null&&s_(l,t),t}function a_(n,e){const t={},i=y(n,["displayName"]);return e!==void 0&&i!=null&&E(e,["batch","displayName"],i),t}function l_(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["src"]);a!=null&&E(t,["batch","inputConfig"],g_(n,a));const l=y(e,["config"]);return l!=null&&a_(l,t),t}function u_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function c_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function d_(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["name"]);i!=null&&E(e,["name"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);return l!=null&&E(e,["error"],l),e}function f_(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["name"]);i!=null&&E(e,["name"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);return l!=null&&E(e,["error"],l),e}function h_(n,e){const t={},i=y(e,["contents"]);if(i!=null){let l=Yf(n,i);Array.isArray(l)&&(l=l.map(f=>f)),E(t,["requests[]","request","content"],l)}const a=y(e,["config"]);return a!=null&&(E(t,["_self"],p_(a,t)),c2(t,{"requests[].*":"requests[].request.*"})),t}function p_(n,e){const t={},i=y(n,["taskType"]);e!==void 0&&i!=null&&E(e,["requests[]","taskType"],i);const a=y(n,["title"]);e!==void 0&&a!=null&&E(e,["requests[]","title"],a);const l=y(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&E(e,["requests[]","outputDimensionality"],l),y(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(y(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function g_(n,e){const t={},i=y(e,["fileName"]);i!=null&&E(t,["file_name"],i);const a=y(e,["inlinedRequests"]);return a!=null&&E(t,["requests"],h_(n,a)),t}function m_(n){const e={};if(y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=y(n,["fileUri"]);t!=null&&E(e,["fileUri"],t);const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function y_(n){const e={},t=y(n,["id"]);t!=null&&E(e,["id"],t);const i=y(n,["args"]);i!=null&&E(e,["args"],i);const a=y(n,["name"]);if(a!=null&&E(e,["name"],a),y(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function x_(n){const e={},t=y(n,["mode"]);t!=null&&E(e,["mode"],t);const i=y(n,["allowedFunctionNames"]);if(i!=null&&E(e,["allowedFunctionNames"],i),y(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function v_(n,e,t){const i={},a=y(e,["systemInstruction"]);t!==void 0&&a!=null&&E(t,["systemInstruction"],gy(Yn(a)));const l=y(e,["temperature"]);l!=null&&E(i,["temperature"],l);const f=y(e,["topP"]);f!=null&&E(i,["topP"],f);const x=y(e,["topK"]);x!=null&&E(i,["topK"],x);const v=y(e,["candidateCount"]);v!=null&&E(i,["candidateCount"],v);const p=y(e,["maxOutputTokens"]);p!=null&&E(i,["maxOutputTokens"],p);const _=y(e,["stopSequences"]);_!=null&&E(i,["stopSequences"],_);const A=y(e,["responseLogprobs"]);A!=null&&E(i,["responseLogprobs"],A);const b=y(e,["logprobs"]);b!=null&&E(i,["logprobs"],b);const k=y(e,["presencePenalty"]);k!=null&&E(i,["presencePenalty"],k);const O=y(e,["frequencyPenalty"]);O!=null&&E(i,["frequencyPenalty"],O);const U=y(e,["seed"]);U!=null&&E(i,["seed"],U);const F=y(e,["responseMimeType"]);F!=null&&E(i,["responseMimeType"],F);const W=y(e,["responseSchema"]);W!=null&&E(i,["responseSchema"],$f(W));const $=y(e,["responseJsonSchema"]);if($!=null&&E(i,["responseJsonSchema"],$),y(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(y(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const G=y(e,["safetySettings"]);if(t!==void 0&&G!=null){let Ne=G;Array.isArray(Ne)&&(Ne=Ne.map(We=>O_(We))),E(t,["safetySettings"],Ne)}const J=y(e,["tools"]);if(t!==void 0&&J!=null){let Ne=Jo(J);Array.isArray(Ne)&&(Ne=Ne.map(We=>B_(Xo(We)))),E(t,["tools"],Ne)}const de=y(e,["toolConfig"]);if(t!==void 0&&de!=null&&E(t,["toolConfig"],L_(de)),y(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=y(e,["cachedContent"]);t!==void 0&&ue!=null&&E(t,["cachedContent"],Bi(n,ue));const ee=y(e,["responseModalities"]);ee!=null&&E(i,["responseModalities"],ee);const Te=y(e,["mediaResolution"]);Te!=null&&E(i,["mediaResolution"],Te);const Z=y(e,["speechConfig"]);if(Z!=null&&E(i,["speechConfig"],Kf(Z)),y(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Se=y(e,["thinkingConfig"]);Se!=null&&E(i,["thinkingConfig"],Se);const Pe=y(e,["imageConfig"]);Pe!=null&&E(i,["imageConfig"],A_(Pe));const Ie=y(e,["enableEnhancedCivicAnswers"]);return Ie!=null&&E(i,["enableEnhancedCivicAnswers"],Ie),i}function w_(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["candidates"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(p=>n_(p))),E(e,["candidates"],v)}const a=y(n,["modelVersion"]);a!=null&&E(e,["modelVersion"],a);const l=y(n,["promptFeedback"]);l!=null&&E(e,["promptFeedback"],l);const f=y(n,["responseId"]);f!=null&&E(e,["responseId"],f);const x=y(n,["usageMetadata"]);return x!=null&&E(e,["usageMetadata"],x),e}function E_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function __(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Qo(n,i)),t}function C_(n){const e={};if(y(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=y(n,["enableWidget"]);return t!=null&&E(e,["enableWidget"],t),e}function S_(n){const e={};if(y(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=y(n,["timeRangeFilter"]);return t!=null&&E(e,["timeRangeFilter"],t),e}function A_(n){const e={},t=y(n,["aspectRatio"]);t!=null&&E(e,["aspectRatio"],t);const i=y(n,["imageSize"]);if(i!=null&&E(e,["imageSize"],i),y(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(y(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function T_(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["request","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let x=Vr(a);Array.isArray(x)&&(x=x.map(v=>gy(v))),E(t,["request","contents"],x)}const l=y(e,["metadata"]);l!=null&&E(t,["metadata"],l);const f=y(e,["config"]);return f!=null&&E(t,["request","generationConfig"],v_(n,f,y(t,["request"],{}))),t}function I_(n){const e={},t=y(n,["response"]);t!=null&&E(e,["response"],w_(t));const i=y(n,["error"]);return i!=null&&E(e,["error"],i),e}function b_(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);if(e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),y(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function N_(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);e!==void 0&&a!=null&&E(e,["_query","pageToken"],a);const l=y(n,["filter"]);return e!==void 0&&l!=null&&E(e,["_query","filter"],l),t}function R_(n){const e={},t=y(n,["config"]);return t!=null&&b_(t,e),e}function M_(n){const e={},t=y(n,["config"]);return t!=null&&N_(t,e),e}function k_(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["operations"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>Iu(f))),E(e,["batchJobs"],l)}return e}function P_(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["batchPredictionJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>xf(f))),E(e,["batchJobs"],l)}return e}function D_(n){const e={},t=y(n,["mediaResolution"]);t!=null&&E(e,["mediaResolution"],t);const i=y(n,["codeExecutionResult"]);i!=null&&E(e,["codeExecutionResult"],i);const a=y(n,["executableCode"]);a!=null&&E(e,["executableCode"],a);const l=y(n,["fileData"]);l!=null&&E(e,["fileData"],m_(l));const f=y(n,["functionCall"]);f!=null&&E(e,["functionCall"],y_(f));const x=y(n,["functionResponse"]);x!=null&&E(e,["functionResponse"],x);const v=y(n,["inlineData"]);v!=null&&E(e,["inlineData"],Z2(v));const p=y(n,["text"]);p!=null&&E(e,["text"],p);const _=y(n,["thought"]);_!=null&&E(e,["thought"],_);const A=y(n,["thoughtSignature"]);A!=null&&E(e,["thoughtSignature"],A);const b=y(n,["videoMetadata"]);return b!=null&&E(e,["videoMetadata"],b),e}function O_(n){const e={},t=y(n,["category"]);if(t!=null&&E(e,["category"],t),y(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=y(n,["threshold"]);return i!=null&&E(e,["threshold"],i),e}function L_(n){const e={},t=y(n,["functionCallingConfig"]);t!=null&&E(e,["functionCallingConfig"],x_(t));const i=y(n,["retrievalConfig"]);return i!=null&&E(e,["retrievalConfig"],i),e}function B_(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(A=>A)),E(e,["functionDeclarations"],_)}if(y(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(n,["googleSearchRetrieval"]);i!=null&&E(e,["googleSearchRetrieval"],i);const a=y(n,["computerUse"]);a!=null&&E(e,["computerUse"],a);const l=y(n,["fileSearch"]);l!=null&&E(e,["fileSearch"],l);const f=y(n,["codeExecution"]);if(f!=null&&E(e,["codeExecution"],f),y(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const x=y(n,["googleMaps"]);x!=null&&E(e,["googleMaps"],C_(x));const v=y(n,["googleSearch"]);v!=null&&E(e,["googleSearch"],S_(v));const p=y(n,["urlContext"]);return p!=null&&E(e,["urlContext"],p),e}var Di;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Di||(Di={}));class eo{constructor(e,t,i,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,a)}init(e,t,i){var a,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let f={config:{}};!i||Object.keys(i).length===0?f={config:{}}:typeof i=="object"?f=Object.assign({},i):f=i,f.config&&(f.config.pageToken=t.nextPageToken),this.paramsInternal=f,this.pageInternalSize=(l=(a=f.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class F_ extends Li{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new eo(Di.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=W1(this.apiClient,e),i=t._url,a=Re("{model}:batchGenerateContent",i),x=t.batch.inputConfig.requests,v=x.requests,p=[];for(const _ of v){const A=Object.assign({},_);if(A.systemInstruction){const b=A.systemInstruction;delete A.systemInstruction;const k=A.request;k.systemInstruction=b,A.request=k}p.push(A)}return x.requests=p,delete t.config,delete t._url,delete t._query,{path:a,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},a=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${a}`),i.dest===void 0){const l=this.getGcsUri(e),f=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${a}`;else if(f)i.dest=`${f}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=o_(this.apiClient,e);return x=Re("batchPredictionJobs",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>xf(_))}else{const p=W1(this.apiClient,e);return x=Re("{model}:batchGenerateContent",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>Iu(_))}}async createEmbeddingsInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=l_(this.apiClient,e);return l=Re("{model}:asyncBatchEmbedContent",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>Iu(v))}}async get(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=__(this.apiClient,e);return x=Re("batchPredictionJobs/{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>xf(_))}else{const p=E_(this.apiClient,e);return x=Re("batches/{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>Iu(_))}}async cancel(e){var t,i,a,l;let f="",x={};if(this.apiClient.isVertexAI()){const v=t_(this.apiClient,e);f=Re("batchPredictionJobs/{name}:cancel",v._url),x=v._query,delete v._url,delete v._query,await this.apiClient.request({path:f,queryParams:x,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const v=e_(this.apiClient,e);f=Re("batches/{name}:cancel",v._url),x=v._query,delete v._url,delete v._query,await this.apiClient.request({path:f,queryParams:x,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=M_(e);return x=Re("batchPredictionJobs",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=P_(_),b=new G1;return Object.assign(b,A),b})}else{const p=R_(e);return x=Re("batches",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=k_(_),b=new G1;return Object.assign(b,A),b})}}async delete(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=c_(this.apiClient,e);return x=Re("batchPredictionJobs/{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>f_(_))}else{const p=u_(this.apiClient,e);return x=Re("batches/{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>d_(_))}}}function U_(n){const e={},t=y(n,["data"]);if(t!=null&&E(e,["data"],t),y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function Y1(n){const e={},t=y(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>lC(l))),E(e,["parts"],a)}const i=y(n,["role"]);return i!=null&&E(e,["role"],i),e}function V_(n,e){const t={},i=y(n,["ttl"]);e!==void 0&&i!=null&&E(e,["ttl"],i);const a=y(n,["expireTime"]);e!==void 0&&a!=null&&E(e,["expireTime"],a);const l=y(n,["displayName"]);e!==void 0&&l!=null&&E(e,["displayName"],l);const f=y(n,["contents"]);if(e!==void 0&&f!=null){let _=Vr(f);Array.isArray(_)&&(_=_.map(A=>Y1(A))),E(e,["contents"],_)}const x=y(n,["systemInstruction"]);e!==void 0&&x!=null&&E(e,["systemInstruction"],Y1(Yn(x)));const v=y(n,["tools"]);if(e!==void 0&&v!=null){let _=v;Array.isArray(_)&&(_=_.map(A=>cC(A))),E(e,["tools"],_)}const p=y(n,["toolConfig"]);if(e!==void 0&&p!=null&&E(e,["toolConfig"],uC(p)),y(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function H_(n,e){const t={},i=y(n,["ttl"]);e!==void 0&&i!=null&&E(e,["ttl"],i);const a=y(n,["expireTime"]);e!==void 0&&a!=null&&E(e,["expireTime"],a);const l=y(n,["displayName"]);e!==void 0&&l!=null&&E(e,["displayName"],l);const f=y(n,["contents"]);if(e!==void 0&&f!=null){let A=Vr(f);Array.isArray(A)&&(A=A.map(b=>b)),E(e,["contents"],A)}const x=y(n,["systemInstruction"]);e!==void 0&&x!=null&&E(e,["systemInstruction"],Yn(x));const v=y(n,["tools"]);if(e!==void 0&&v!=null){let A=v;Array.isArray(A)&&(A=A.map(b=>dC(b))),E(e,["tools"],A)}const p=y(n,["toolConfig"]);e!==void 0&&p!=null&&E(e,["toolConfig"],p);const _=y(n,["kmsKeyName"]);return e!==void 0&&_!=null&&E(e,["encryption_spec","kmsKeyName"],_),t}function G_(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["model"],ry(n,i));const a=y(e,["config"]);return a!=null&&V_(a,t),t}function z_(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["model"],ry(n,i));const a=y(e,["config"]);return a!=null&&H_(a,t),t}function j_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Bi(n,i)),t}function q_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Bi(n,i)),t}function W_(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function Y_(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function $_(n){const e={};if(y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=y(n,["fileUri"]);t!=null&&E(e,["fileUri"],t);const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function K_(n){const e={},t=y(n,["id"]);t!=null&&E(e,["id"],t);const i=y(n,["args"]);i!=null&&E(e,["args"],i);const a=y(n,["name"]);if(a!=null&&E(e,["name"],a),y(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function X_(n){const e={},t=y(n,["mode"]);t!=null&&E(e,["mode"],t);const i=y(n,["allowedFunctionNames"]);if(i!=null&&E(e,["allowedFunctionNames"],i),y(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function J_(n){const e={};if(y(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=y(n,["description"]);t!=null&&E(e,["description"],t);const i=y(n,["name"]);i!=null&&E(e,["name"],i);const a=y(n,["parameters"]);a!=null&&E(e,["parameters"],a);const l=y(n,["parametersJsonSchema"]);l!=null&&E(e,["parametersJsonSchema"],l);const f=y(n,["response"]);f!=null&&E(e,["response"],f);const x=y(n,["responseJsonSchema"]);return x!=null&&E(e,["responseJsonSchema"],x),e}function Q_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Bi(n,i)),t}function Z_(n,e){const t={},i=y(e,["name"]);return i!=null&&E(t,["_url","name"],Bi(n,i)),t}function eC(n){const e={};if(y(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=y(n,["enableWidget"]);return t!=null&&E(e,["enableWidget"],t),e}function tC(n){const e={};if(y(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=y(n,["timeRangeFilter"]);return t!=null&&E(e,["timeRangeFilter"],t),e}function nC(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);return e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),t}function rC(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);return e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),t}function iC(n){const e={},t=y(n,["config"]);return t!=null&&nC(t,e),e}function sC(n){const e={},t=y(n,["config"]);return t!=null&&rC(t,e),e}function oC(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["cachedContents"],l)}return e}function aC(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["cachedContents"],l)}return e}function lC(n){const e={},t=y(n,["mediaResolution"]);t!=null&&E(e,["mediaResolution"],t);const i=y(n,["codeExecutionResult"]);i!=null&&E(e,["codeExecutionResult"],i);const a=y(n,["executableCode"]);a!=null&&E(e,["executableCode"],a);const l=y(n,["fileData"]);l!=null&&E(e,["fileData"],$_(l));const f=y(n,["functionCall"]);f!=null&&E(e,["functionCall"],K_(f));const x=y(n,["functionResponse"]);x!=null&&E(e,["functionResponse"],x);const v=y(n,["inlineData"]);v!=null&&E(e,["inlineData"],U_(v));const p=y(n,["text"]);p!=null&&E(e,["text"],p);const _=y(n,["thought"]);_!=null&&E(e,["thought"],_);const A=y(n,["thoughtSignature"]);A!=null&&E(e,["thoughtSignature"],A);const b=y(n,["videoMetadata"]);return b!=null&&E(e,["videoMetadata"],b),e}function uC(n){const e={},t=y(n,["functionCallingConfig"]);t!=null&&E(e,["functionCallingConfig"],X_(t));const i=y(n,["retrievalConfig"]);return i!=null&&E(e,["retrievalConfig"],i),e}function cC(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(A=>A)),E(e,["functionDeclarations"],_)}if(y(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(n,["googleSearchRetrieval"]);i!=null&&E(e,["googleSearchRetrieval"],i);const a=y(n,["computerUse"]);a!=null&&E(e,["computerUse"],a);const l=y(n,["fileSearch"]);l!=null&&E(e,["fileSearch"],l);const f=y(n,["codeExecution"]);if(f!=null&&E(e,["codeExecution"],f),y(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const x=y(n,["googleMaps"]);x!=null&&E(e,["googleMaps"],eC(x));const v=y(n,["googleSearch"]);v!=null&&E(e,["googleSearch"],tC(v));const p=y(n,["urlContext"]);return p!=null&&E(e,["urlContext"],p),e}function dC(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>J_(b))),E(e,["functionDeclarations"],A)}const i=y(n,["retrieval"]);i!=null&&E(e,["retrieval"],i);const a=y(n,["googleSearchRetrieval"]);a!=null&&E(e,["googleSearchRetrieval"],a);const l=y(n,["computerUse"]);if(l!=null&&E(e,["computerUse"],l),y(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=y(n,["codeExecution"]);f!=null&&E(e,["codeExecution"],f);const x=y(n,["enterpriseWebSearch"]);x!=null&&E(e,["enterpriseWebSearch"],x);const v=y(n,["googleMaps"]);v!=null&&E(e,["googleMaps"],v);const p=y(n,["googleSearch"]);p!=null&&E(e,["googleSearch"],p);const _=y(n,["urlContext"]);return _!=null&&E(e,["urlContext"],_),e}function fC(n,e){const t={},i=y(n,["ttl"]);e!==void 0&&i!=null&&E(e,["ttl"],i);const a=y(n,["expireTime"]);return e!==void 0&&a!=null&&E(e,["expireTime"],a),t}function hC(n,e){const t={},i=y(n,["ttl"]);e!==void 0&&i!=null&&E(e,["ttl"],i);const a=y(n,["expireTime"]);return e!==void 0&&a!=null&&E(e,["expireTime"],a),t}function pC(n,e){const t={},i=y(e,["name"]);i!=null&&E(t,["_url","name"],Bi(n,i));const a=y(e,["config"]);return a!=null&&fC(a,t),t}function gC(n,e){const t={},i=y(e,["name"]);i!=null&&E(t,["_url","name"],Bi(n,i));const a=y(e,["config"]);return a!=null&&hC(a,t),t}class mC extends Li{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new eo(Di.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=z_(this.apiClient,e);return x=Re("cachedContents",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>_)}else{const p=G_(this.apiClient,e);return x=Re("cachedContents",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>_)}}async get(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=Z_(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>_)}else{const p=Q_(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>_)}}async delete(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=q_(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=Y_(_),b=new V1;return Object.assign(b,A),b})}else{const p=j_(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=W_(_),b=new V1;return Object.assign(b,A),b})}}async update(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=gC(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>_)}else{const p=pC(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>_)}}async listInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=sC(e);return x=Re("cachedContents",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=aC(_),b=new H1;return Object.assign(b,A),b})}else{const p=iC(e);return x=Re("cachedContents",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=oC(_),b=new H1;return Object.assign(b,A),b})}}}function zu(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t}function $1(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function it(n){return this instanceof it?(this.v=n,this):new it(n)}function ti(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),x("next"),x("throw"),x("return",f),a[Symbol.asyncIterator]=function(){return this},a;function f(k){return function(O){return Promise.resolve(O).then(k,A)}}function x(k,O){i[k]&&(a[k]=function(U){return new Promise(function(F,W){l.push([k,U,F,W])>1||v(k,U)})},O&&(a[k]=O(a[k])))}function v(k,O){try{p(i[k](O))}catch(U){b(l[0][3],U)}}function p(k){k.value instanceof it?Promise.resolve(k.value.v).then(_,A):b(l[0][2],k)}function _(k){v("next",k)}function A(k){v("throw",k)}function b(k,O){k(O),l.shift(),l.length&&v(l[0][0],l[0][1])}}function ni(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof $1=="function"?$1(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(f){return new Promise(function(x,v){f=n[l](f),a(x,v,f.done,f.value)})}}function a(l,f,x,v){Promise.resolve(v).then(function(p){l({value:p,done:x})},f)}}function yC(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:my(t)}function my(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function xC(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function K1(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const a=[];let l=!0;for(;i<t&&n[i].role==="model";)a.push(n[i]),l&&!my(n[i])&&(l=!1),i++;l?e.push(...a):e.pop()}return e}class vC{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new wC(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class wC{constructor(e,t,i,a={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),xC(l)}async sendMessage(e){var t;await this.sendPromise;const i=Yn(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,f,x;const v=await a,p=(f=(l=v.candidates)===null||l===void 0?void 0:l[0])===null||f===void 0?void 0:f.content,_=v.automaticFunctionCallingHistory,A=this.getHistory(!0).length;let b=[];_!=null&&(b=(x=_.slice(A))!==null&&x!==void 0?x:[]);const k=p?[p]:[];this.recordHistory(i,k,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var t;await this.sendPromise;const i=Yn(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?K1(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return ti(this,arguments,function*(){var a,l,f,x,v,p;const _=[];try{for(var A=!0,b=ni(e),k;k=yield it(b.next()),a=k.done,!a;A=!0){x=k.value,A=!1;const O=x;if(yC(O)){const U=(p=(v=O.candidates)===null||v===void 0?void 0:v[0])===null||p===void 0?void 0:p.content;U!==void 0&&_.push(U)}yield yield it(O)}}catch(O){l={error:O}}finally{try{!A&&!a&&(f=b.return)&&(yield it(f.call(b)))}finally{if(l)throw l.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let a=[];t.length>0&&t.every(l=>l.role!==void 0)?a=t:a.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...K1(i)):this.history.push(e),this.history.push(...a)}}class nc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nc.prototype)}}function EC(n){const e={},t=y(n,["file"]);return t!=null&&E(e,["file"],t),e}function _C(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function CC(n){const e={},t=y(n,["name"]);return t!=null&&E(e,["_url","file"],uy(t)),e}function SC(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function AC(n){const e={},t=y(n,["name"]);return t!=null&&E(e,["_url","file"],uy(t)),e}function TC(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);return e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),t}function IC(n){const e={},t=y(n,["config"]);return t!=null&&TC(t,e),e}function bC(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["files"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["files"],l)}return e}class NC extends Li{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new eo(Di.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=IC(e);return l=Re("files",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>{const p=bC(v),_=new P2;return Object.assign(_,p),_})}}async createInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=EC(e);return l=Re("upload/v1beta/files",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=_C(v),_=new D2;return Object.assign(_,p),_})}}async get(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=AC(e);return l=Re("files/{file}",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>v)}}async delete(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=CC(e);return l=Re("files/{file}",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>{const p=SC(v),_=new O2;return Object.assign(_,p),_})}}}function bu(n){const e={},t=y(n,["data"]);if(t!=null&&E(e,["data"],t),y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function RC(n){const e={},t=y(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>WC(l))),E(e,["parts"],a)}const i=y(n,["role"]);return i!=null&&E(e,["role"],i),e}function MC(n){const e={};if(y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=y(n,["fileUri"]);t!=null&&E(e,["fileUri"],t);const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function kC(n){const e={},t=y(n,["id"]);t!=null&&E(e,["id"],t);const i=y(n,["args"]);i!=null&&E(e,["args"],i);const a=y(n,["name"]);if(a!=null&&E(e,["name"],a),y(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function PC(n){const e={};if(y(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=y(n,["description"]);t!=null&&E(e,["description"],t);const i=y(n,["name"]);i!=null&&E(e,["name"],i);const a=y(n,["parameters"]);a!=null&&E(e,["parameters"],a);const l=y(n,["parametersJsonSchema"]);l!=null&&E(e,["parametersJsonSchema"],l);const f=y(n,["response"]);f!=null&&E(e,["response"],f);const x=y(n,["responseJsonSchema"]);return x!=null&&E(e,["responseJsonSchema"],x),e}function DC(n){const e={},t=y(n,["modelSelectionConfig"]);t!=null&&E(e,["modelConfig"],t);const i=y(n,["responseJsonSchema"]);i!=null&&E(e,["responseJsonSchema"],i);const a=y(n,["audioTimestamp"]);a!=null&&E(e,["audioTimestamp"],a);const l=y(n,["candidateCount"]);l!=null&&E(e,["candidateCount"],l);const f=y(n,["enableAffectiveDialog"]);f!=null&&E(e,["enableAffectiveDialog"],f);const x=y(n,["frequencyPenalty"]);x!=null&&E(e,["frequencyPenalty"],x);const v=y(n,["logprobs"]);v!=null&&E(e,["logprobs"],v);const p=y(n,["maxOutputTokens"]);p!=null&&E(e,["maxOutputTokens"],p);const _=y(n,["mediaResolution"]);_!=null&&E(e,["mediaResolution"],_);const A=y(n,["presencePenalty"]);A!=null&&E(e,["presencePenalty"],A);const b=y(n,["responseLogprobs"]);b!=null&&E(e,["responseLogprobs"],b);const k=y(n,["responseMimeType"]);k!=null&&E(e,["responseMimeType"],k);const O=y(n,["responseModalities"]);O!=null&&E(e,["responseModalities"],O);const U=y(n,["responseSchema"]);U!=null&&E(e,["responseSchema"],U);const F=y(n,["routingConfig"]);F!=null&&E(e,["routingConfig"],F);const W=y(n,["seed"]);W!=null&&E(e,["seed"],W);const $=y(n,["speechConfig"]);$!=null&&E(e,["speechConfig"],yy($));const G=y(n,["stopSequences"]);G!=null&&E(e,["stopSequences"],G);const J=y(n,["temperature"]);J!=null&&E(e,["temperature"],J);const de=y(n,["thinkingConfig"]);de!=null&&E(e,["thinkingConfig"],de);const ue=y(n,["topK"]);ue!=null&&E(e,["topK"],ue);const ee=y(n,["topP"]);if(ee!=null&&E(e,["topP"],ee),y(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function OC(n){const e={};if(y(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=y(n,["enableWidget"]);return t!=null&&E(e,["enableWidget"],t),e}function LC(n){const e={};if(y(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=y(n,["timeRangeFilter"]);return t!=null&&E(e,["timeRangeFilter"],t),e}function BC(n,e){const t={},i=y(n,["generationConfig"]);e!==void 0&&i!=null&&E(e,["setup","generationConfig"],i);const a=y(n,["responseModalities"]);e!==void 0&&a!=null&&E(e,["setup","generationConfig","responseModalities"],a);const l=y(n,["temperature"]);e!==void 0&&l!=null&&E(e,["setup","generationConfig","temperature"],l);const f=y(n,["topP"]);e!==void 0&&f!=null&&E(e,["setup","generationConfig","topP"],f);const x=y(n,["topK"]);e!==void 0&&x!=null&&E(e,["setup","generationConfig","topK"],x);const v=y(n,["maxOutputTokens"]);e!==void 0&&v!=null&&E(e,["setup","generationConfig","maxOutputTokens"],v);const p=y(n,["mediaResolution"]);e!==void 0&&p!=null&&E(e,["setup","generationConfig","mediaResolution"],p);const _=y(n,["seed"]);e!==void 0&&_!=null&&E(e,["setup","generationConfig","seed"],_);const A=y(n,["speechConfig"]);e!==void 0&&A!=null&&E(e,["setup","generationConfig","speechConfig"],Xf(A));const b=y(n,["thinkingConfig"]);e!==void 0&&b!=null&&E(e,["setup","generationConfig","thinkingConfig"],b);const k=y(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&E(e,["setup","generationConfig","enableAffectiveDialog"],k);const O=y(n,["systemInstruction"]);e!==void 0&&O!=null&&E(e,["setup","systemInstruction"],RC(Yn(O)));const U=y(n,["tools"]);if(e!==void 0&&U!=null){let ue=Jo(U);Array.isArray(ue)&&(ue=ue.map(ee=>$C(Xo(ee)))),E(e,["setup","tools"],ue)}const F=y(n,["sessionResumption"]);e!==void 0&&F!=null&&E(e,["setup","sessionResumption"],YC(F));const W=y(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&E(e,["setup","inputAudioTranscription"],W);const $=y(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&E(e,["setup","outputAudioTranscription"],$);const G=y(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&E(e,["setup","realtimeInputConfig"],G);const J=y(n,["contextWindowCompression"]);e!==void 0&&J!=null&&E(e,["setup","contextWindowCompression"],J);const de=y(n,["proactivity"]);if(e!==void 0&&de!=null&&E(e,["setup","proactivity"],de),y(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function FC(n,e){const t={},i=y(n,["generationConfig"]);e!==void 0&&i!=null&&E(e,["setup","generationConfig"],DC(i));const a=y(n,["responseModalities"]);e!==void 0&&a!=null&&E(e,["setup","generationConfig","responseModalities"],a);const l=y(n,["temperature"]);e!==void 0&&l!=null&&E(e,["setup","generationConfig","temperature"],l);const f=y(n,["topP"]);e!==void 0&&f!=null&&E(e,["setup","generationConfig","topP"],f);const x=y(n,["topK"]);e!==void 0&&x!=null&&E(e,["setup","generationConfig","topK"],x);const v=y(n,["maxOutputTokens"]);e!==void 0&&v!=null&&E(e,["setup","generationConfig","maxOutputTokens"],v);const p=y(n,["mediaResolution"]);e!==void 0&&p!=null&&E(e,["setup","generationConfig","mediaResolution"],p);const _=y(n,["seed"]);e!==void 0&&_!=null&&E(e,["setup","generationConfig","seed"],_);const A=y(n,["speechConfig"]);e!==void 0&&A!=null&&E(e,["setup","generationConfig","speechConfig"],yy(Xf(A)));const b=y(n,["thinkingConfig"]);e!==void 0&&b!=null&&E(e,["setup","generationConfig","thinkingConfig"],b);const k=y(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&E(e,["setup","generationConfig","enableAffectiveDialog"],k);const O=y(n,["systemInstruction"]);e!==void 0&&O!=null&&E(e,["setup","systemInstruction"],Yn(O));const U=y(n,["tools"]);if(e!==void 0&&U!=null){let ee=Jo(U);Array.isArray(ee)&&(ee=ee.map(Te=>KC(Xo(Te)))),E(e,["setup","tools"],ee)}const F=y(n,["sessionResumption"]);e!==void 0&&F!=null&&E(e,["setup","sessionResumption"],F);const W=y(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&E(e,["setup","inputAudioTranscription"],W);const $=y(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&E(e,["setup","outputAudioTranscription"],$);const G=y(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&E(e,["setup","realtimeInputConfig"],G);const J=y(n,["contextWindowCompression"]);e!==void 0&&J!=null&&E(e,["setup","contextWindowCompression"],J);const de=y(n,["proactivity"]);e!==void 0&&de!=null&&E(e,["setup","proactivity"],de);const ue=y(n,["explicitVadSignal"]);return e!==void 0&&ue!=null&&E(e,["setup","explicitVadSignal"],ue),t}function UC(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["setup","model"],wt(n,i));const a=y(e,["config"]);return a!=null&&E(t,["config"],BC(a,t)),t}function VC(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["setup","model"],wt(n,i));const a=y(e,["config"]);return a!=null&&E(t,["config"],FC(a,t)),t}function HC(n){const e={},t=y(n,["musicGenerationConfig"]);return t!=null&&E(e,["musicGenerationConfig"],t),e}function GC(n){const e={},t=y(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),E(e,["weightedPrompts"],i)}return e}function zC(n){const e={},t=y(n,["media"]);if(t!=null){let p=iy(t);Array.isArray(p)&&(p=p.map(_=>bu(_))),E(e,["mediaChunks"],p)}const i=y(n,["audio"]);i!=null&&E(e,["audio"],bu(oy(i)));const a=y(n,["audioStreamEnd"]);a!=null&&E(e,["audioStreamEnd"],a);const l=y(n,["video"]);l!=null&&E(e,["video"],bu(sy(l)));const f=y(n,["text"]);f!=null&&E(e,["text"],f);const x=y(n,["activityStart"]);x!=null&&E(e,["activityStart"],x);const v=y(n,["activityEnd"]);return v!=null&&E(e,["activityEnd"],v),e}function jC(n){const e={},t=y(n,["media"]);if(t!=null){let p=iy(t);Array.isArray(p)&&(p=p.map(_=>_)),E(e,["mediaChunks"],p)}const i=y(n,["audio"]);i!=null&&E(e,["audio"],oy(i));const a=y(n,["audioStreamEnd"]);a!=null&&E(e,["audioStreamEnd"],a);const l=y(n,["video"]);l!=null&&E(e,["video"],sy(l));const f=y(n,["text"]);f!=null&&E(e,["text"],f);const x=y(n,["activityStart"]);x!=null&&E(e,["activityStart"],x);const v=y(n,["activityEnd"]);return v!=null&&E(e,["activityEnd"],v),e}function qC(n){const e={},t=y(n,["setupComplete"]);t!=null&&E(e,["setupComplete"],t);const i=y(n,["serverContent"]);i!=null&&E(e,["serverContent"],i);const a=y(n,["toolCall"]);a!=null&&E(e,["toolCall"],a);const l=y(n,["toolCallCancellation"]);l!=null&&E(e,["toolCallCancellation"],l);const f=y(n,["usageMetadata"]);f!=null&&E(e,["usageMetadata"],XC(f));const x=y(n,["goAway"]);x!=null&&E(e,["goAway"],x);const v=y(n,["sessionResumptionUpdate"]);v!=null&&E(e,["sessionResumptionUpdate"],v);const p=y(n,["voiceActivityDetectionSignal"]);return p!=null&&E(e,["voiceActivityDetectionSignal"],p),e}function WC(n){const e={},t=y(n,["mediaResolution"]);t!=null&&E(e,["mediaResolution"],t);const i=y(n,["codeExecutionResult"]);i!=null&&E(e,["codeExecutionResult"],i);const a=y(n,["executableCode"]);a!=null&&E(e,["executableCode"],a);const l=y(n,["fileData"]);l!=null&&E(e,["fileData"],MC(l));const f=y(n,["functionCall"]);f!=null&&E(e,["functionCall"],kC(f));const x=y(n,["functionResponse"]);x!=null&&E(e,["functionResponse"],x);const v=y(n,["inlineData"]);v!=null&&E(e,["inlineData"],bu(v));const p=y(n,["text"]);p!=null&&E(e,["text"],p);const _=y(n,["thought"]);_!=null&&E(e,["thought"],_);const A=y(n,["thoughtSignature"]);A!=null&&E(e,["thoughtSignature"],A);const b=y(n,["videoMetadata"]);return b!=null&&E(e,["videoMetadata"],b),e}function YC(n){const e={},t=y(n,["handle"]);if(t!=null&&E(e,["handle"],t),y(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function yy(n){const e={},t=y(n,["voiceConfig"]);t!=null&&E(e,["voiceConfig"],t);const i=y(n,["languageCode"]);if(i!=null&&E(e,["languageCode"],i),y(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function $C(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(A=>A)),E(e,["functionDeclarations"],_)}if(y(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(n,["googleSearchRetrieval"]);i!=null&&E(e,["googleSearchRetrieval"],i);const a=y(n,["computerUse"]);a!=null&&E(e,["computerUse"],a);const l=y(n,["fileSearch"]);l!=null&&E(e,["fileSearch"],l);const f=y(n,["codeExecution"]);if(f!=null&&E(e,["codeExecution"],f),y(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const x=y(n,["googleMaps"]);x!=null&&E(e,["googleMaps"],OC(x));const v=y(n,["googleSearch"]);v!=null&&E(e,["googleSearch"],LC(v));const p=y(n,["urlContext"]);return p!=null&&E(e,["urlContext"],p),e}function KC(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>PC(b))),E(e,["functionDeclarations"],A)}const i=y(n,["retrieval"]);i!=null&&E(e,["retrieval"],i);const a=y(n,["googleSearchRetrieval"]);a!=null&&E(e,["googleSearchRetrieval"],a);const l=y(n,["computerUse"]);if(l!=null&&E(e,["computerUse"],l),y(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=y(n,["codeExecution"]);f!=null&&E(e,["codeExecution"],f);const x=y(n,["enterpriseWebSearch"]);x!=null&&E(e,["enterpriseWebSearch"],x);const v=y(n,["googleMaps"]);v!=null&&E(e,["googleMaps"],v);const p=y(n,["googleSearch"]);p!=null&&E(e,["googleSearch"],p);const _=y(n,["urlContext"]);return _!=null&&E(e,["urlContext"],_),e}function XC(n){const e={},t=y(n,["promptTokenCount"]);t!=null&&E(e,["promptTokenCount"],t);const i=y(n,["cachedContentTokenCount"]);i!=null&&E(e,["cachedContentTokenCount"],i);const a=y(n,["candidatesTokenCount"]);a!=null&&E(e,["responseTokenCount"],a);const l=y(n,["toolUsePromptTokenCount"]);l!=null&&E(e,["toolUsePromptTokenCount"],l);const f=y(n,["thoughtsTokenCount"]);f!=null&&E(e,["thoughtsTokenCount"],f);const x=y(n,["totalTokenCount"]);x!=null&&E(e,["totalTokenCount"],x);const v=y(n,["promptTokensDetails"]);if(v!=null){let k=v;Array.isArray(k)&&(k=k.map(O=>O)),E(e,["promptTokensDetails"],k)}const p=y(n,["cacheTokensDetails"]);if(p!=null){let k=p;Array.isArray(k)&&(k=k.map(O=>O)),E(e,["cacheTokensDetails"],k)}const _=y(n,["candidatesTokensDetails"]);if(_!=null){let k=_;Array.isArray(k)&&(k=k.map(O=>O)),E(e,["responseTokensDetails"],k)}const A=y(n,["toolUsePromptTokensDetails"]);if(A!=null){let k=A;Array.isArray(k)&&(k=k.map(O=>O)),E(e,["toolUsePromptTokensDetails"],k)}const b=y(n,["trafficType"]);return b!=null&&E(e,["trafficType"],b),e}function JC(n){const e={},t=y(n,["data"]);if(t!=null&&E(e,["data"],t),y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function QC(n){const e={},t=y(n,["content"]);t!=null&&E(e,["content"],t);const i=y(n,["citationMetadata"]);i!=null&&E(e,["citationMetadata"],ZC(i));const a=y(n,["tokenCount"]);a!=null&&E(e,["tokenCount"],a);const l=y(n,["finishReason"]);l!=null&&E(e,["finishReason"],l);const f=y(n,["avgLogprobs"]);f!=null&&E(e,["avgLogprobs"],f);const x=y(n,["groundingMetadata"]);x!=null&&E(e,["groundingMetadata"],x);const v=y(n,["index"]);v!=null&&E(e,["index"],v);const p=y(n,["logprobsResult"]);p!=null&&E(e,["logprobsResult"],p);const _=y(n,["safetyRatings"]);if(_!=null){let b=_;Array.isArray(b)&&(b=b.map(k=>k)),E(e,["safetyRatings"],b)}const A=y(n,["urlContextMetadata"]);return A!=null&&E(e,["urlContextMetadata"],A),e}function ZC(n){const e={},t=y(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),E(e,["citations"],i)}return e}function eS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let l=Vr(a);Array.isArray(l)&&(l=l.map(f=>f)),E(t,["contents"],l)}return t}function tS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["tokensInfo"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),E(e,["tokensInfo"],a)}return e}function nS(n){const e={},t=y(n,["values"]);t!=null&&E(e,["values"],t);const i=y(n,["statistics"]);return i!=null&&E(e,["statistics"],rS(i)),e}function rS(n){const e={},t=y(n,["truncated"]);t!=null&&E(e,["truncated"],t);const i=y(n,["token_count"]);return i!=null&&E(e,["tokenCount"],i),e}function rc(n){const e={},t=y(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>fA(l))),E(e,["parts"],a)}const i=y(n,["role"]);return i!=null&&E(e,["role"],i),e}function iS(n){const e={},t=y(n,["controlType"]);t!=null&&E(e,["controlType"],t);const i=y(n,["enableControlImageComputation"]);return i!=null&&E(e,["computeControl"],i),e}function sS(n){const e={};if(y(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(y(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(y(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function oS(n,e){const t={},i=y(n,["systemInstruction"]);e!==void 0&&i!=null&&E(e,["systemInstruction"],Yn(i));const a=y(n,["tools"]);if(e!==void 0&&a!=null){let f=a;Array.isArray(f)&&(f=f.map(x=>_y(x))),E(e,["tools"],f)}const l=y(n,["generationConfig"]);return e!==void 0&&l!=null&&E(e,["generationConfig"],JS(l)),t}function aS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let f=Vr(a);Array.isArray(f)&&(f=f.map(x=>rc(x))),E(t,["contents"],f)}const l=y(e,["config"]);return l!=null&&sS(l),t}function lS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let f=Vr(a);Array.isArray(f)&&(f=f.map(x=>x)),E(t,["contents"],f)}const l=y(e,["config"]);return l!=null&&oS(l,t),t}function uS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["totalTokens"]);i!=null&&E(e,["totalTokens"],i);const a=y(n,["cachedContentTokenCount"]);return a!=null&&E(e,["cachedContentTokenCount"],a),e}function cS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["totalTokens"]);return i!=null&&E(e,["totalTokens"],i),e}function dS(n,e){const t={},i=y(e,["model"]);return i!=null&&E(t,["_url","name"],wt(n,i)),t}function fS(n,e){const t={},i=y(e,["model"]);return i!=null&&E(t,["_url","name"],wt(n,i)),t}function hS(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function pS(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}function gS(n,e){const t={},i=y(n,["outputGcsUri"]);e!==void 0&&i!=null&&E(e,["parameters","storageUri"],i);const a=y(n,["negativePrompt"]);e!==void 0&&a!=null&&E(e,["parameters","negativePrompt"],a);const l=y(n,["numberOfImages"]);e!==void 0&&l!=null&&E(e,["parameters","sampleCount"],l);const f=y(n,["aspectRatio"]);e!==void 0&&f!=null&&E(e,["parameters","aspectRatio"],f);const x=y(n,["guidanceScale"]);e!==void 0&&x!=null&&E(e,["parameters","guidanceScale"],x);const v=y(n,["seed"]);e!==void 0&&v!=null&&E(e,["parameters","seed"],v);const p=y(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&E(e,["parameters","safetySetting"],p);const _=y(n,["personGeneration"]);e!==void 0&&_!=null&&E(e,["parameters","personGeneration"],_);const A=y(n,["includeSafetyAttributes"]);e!==void 0&&A!=null&&E(e,["parameters","includeSafetyAttributes"],A);const b=y(n,["includeRaiReason"]);e!==void 0&&b!=null&&E(e,["parameters","includeRaiReason"],b);const k=y(n,["language"]);e!==void 0&&k!=null&&E(e,["parameters","language"],k);const O=y(n,["outputMimeType"]);e!==void 0&&O!=null&&E(e,["parameters","outputOptions","mimeType"],O);const U=y(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&E(e,["parameters","outputOptions","compressionQuality"],U);const F=y(n,["addWatermark"]);e!==void 0&&F!=null&&E(e,["parameters","addWatermark"],F);const W=y(n,["labels"]);e!==void 0&&W!=null&&E(e,["labels"],W);const $=y(n,["editMode"]);e!==void 0&&$!=null&&E(e,["parameters","editMode"],$);const G=y(n,["baseSteps"]);return e!==void 0&&G!=null&&E(e,["parameters","editConfig","baseSteps"],G),t}function mS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["prompt"]);a!=null&&E(t,["instances[0]","prompt"],a);const l=y(e,["referenceImages"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>xA(v))),E(t,["instances[0]","referenceImages"],x)}const f=y(e,["config"]);return f!=null&&gS(f,t),t}function yS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>ic(l))),E(e,["generatedImages"],a)}return e}function xS(n,e){const t={},i=y(n,["taskType"]);e!==void 0&&i!=null&&E(e,["requests[]","taskType"],i);const a=y(n,["title"]);e!==void 0&&a!=null&&E(e,["requests[]","title"],a);const l=y(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&E(e,["requests[]","outputDimensionality"],l),y(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(y(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function vS(n,e){const t={},i=y(n,["taskType"]);e!==void 0&&i!=null&&E(e,["instances[]","task_type"],i);const a=y(n,["title"]);e!==void 0&&a!=null&&E(e,["instances[]","title"],a);const l=y(n,["outputDimensionality"]);e!==void 0&&l!=null&&E(e,["parameters","outputDimensionality"],l);const f=y(n,["mimeType"]);e!==void 0&&f!=null&&E(e,["instances[]","mimeType"],f);const x=y(n,["autoTruncate"]);return e!==void 0&&x!=null&&E(e,["parameters","autoTruncate"],x),t}function wS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let x=Yf(n,a);Array.isArray(x)&&(x=x.map(v=>v)),E(t,["requests[]","content"],x)}const l=y(e,["config"]);l!=null&&xS(l,t);const f=y(e,["model"]);return f!==void 0&&E(t,["requests[]","model"],wt(n,f)),t}function ES(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let f=Yf(n,a);Array.isArray(f)&&(f=f.map(x=>x)),E(t,["instances[]","content"],f)}const l=y(e,["config"]);return l!=null&&vS(l,t),t}function _S(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["embeddings"],l)}const a=y(n,["metadata"]);return a!=null&&E(e,["metadata"],a),e}function CS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>nS(f))),E(e,["embeddings"],l)}const a=y(n,["metadata"]);return a!=null&&E(e,["metadata"],a),e}function SS(n){const e={},t=y(n,["endpoint"]);t!=null&&E(e,["name"],t);const i=y(n,["deployedModelId"]);return i!=null&&E(e,["deployedModelId"],i),e}function AS(n){const e={};if(y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=y(n,["fileUri"]);t!=null&&E(e,["fileUri"],t);const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function TS(n){const e={},t=y(n,["id"]);t!=null&&E(e,["id"],t);const i=y(n,["args"]);i!=null&&E(e,["args"],i);const a=y(n,["name"]);if(a!=null&&E(e,["name"],a),y(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function IS(n){const e={},t=y(n,["mode"]);t!=null&&E(e,["mode"],t);const i=y(n,["allowedFunctionNames"]);if(i!=null&&E(e,["allowedFunctionNames"],i),y(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function bS(n){const e={};if(y(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=y(n,["description"]);t!=null&&E(e,["description"],t);const i=y(n,["name"]);i!=null&&E(e,["name"],i);const a=y(n,["parameters"]);a!=null&&E(e,["parameters"],a);const l=y(n,["parametersJsonSchema"]);l!=null&&E(e,["parametersJsonSchema"],l);const f=y(n,["response"]);f!=null&&E(e,["response"],f);const x=y(n,["responseJsonSchema"]);return x!=null&&E(e,["responseJsonSchema"],x),e}function NS(n,e,t){const i={},a=y(e,["systemInstruction"]);t!==void 0&&a!=null&&E(t,["systemInstruction"],rc(Yn(a)));const l=y(e,["temperature"]);l!=null&&E(i,["temperature"],l);const f=y(e,["topP"]);f!=null&&E(i,["topP"],f);const x=y(e,["topK"]);x!=null&&E(i,["topK"],x);const v=y(e,["candidateCount"]);v!=null&&E(i,["candidateCount"],v);const p=y(e,["maxOutputTokens"]);p!=null&&E(i,["maxOutputTokens"],p);const _=y(e,["stopSequences"]);_!=null&&E(i,["stopSequences"],_);const A=y(e,["responseLogprobs"]);A!=null&&E(i,["responseLogprobs"],A);const b=y(e,["logprobs"]);b!=null&&E(i,["logprobs"],b);const k=y(e,["presencePenalty"]);k!=null&&E(i,["presencePenalty"],k);const O=y(e,["frequencyPenalty"]);O!=null&&E(i,["frequencyPenalty"],O);const U=y(e,["seed"]);U!=null&&E(i,["seed"],U);const F=y(e,["responseMimeType"]);F!=null&&E(i,["responseMimeType"],F);const W=y(e,["responseSchema"]);W!=null&&E(i,["responseSchema"],$f(W));const $=y(e,["responseJsonSchema"]);if($!=null&&E(i,["responseJsonSchema"],$),y(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(y(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const G=y(e,["safetySettings"]);if(t!==void 0&&G!=null){let Ne=G;Array.isArray(Ne)&&(Ne=Ne.map(We=>vA(We))),E(t,["safetySettings"],Ne)}const J=y(e,["tools"]);if(t!==void 0&&J!=null){let Ne=Jo(J);Array.isArray(Ne)&&(Ne=Ne.map(We=>TA(Xo(We)))),E(t,["tools"],Ne)}const de=y(e,["toolConfig"]);if(t!==void 0&&de!=null&&E(t,["toolConfig"],AA(de)),y(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=y(e,["cachedContent"]);t!==void 0&&ue!=null&&E(t,["cachedContent"],Bi(n,ue));const ee=y(e,["responseModalities"]);ee!=null&&E(i,["responseModalities"],ee);const Te=y(e,["mediaResolution"]);Te!=null&&E(i,["mediaResolution"],Te);const Z=y(e,["speechConfig"]);if(Z!=null&&E(i,["speechConfig"],Kf(Z)),y(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Se=y(e,["thinkingConfig"]);Se!=null&&E(i,["thinkingConfig"],Se);const Pe=y(e,["imageConfig"]);Pe!=null&&E(i,["imageConfig"],nA(Pe));const Ie=y(e,["enableEnhancedCivicAnswers"]);return Ie!=null&&E(i,["enableEnhancedCivicAnswers"],Ie),i}function RS(n,e,t){const i={},a=y(e,["systemInstruction"]);t!==void 0&&a!=null&&E(t,["systemInstruction"],Yn(a));const l=y(e,["temperature"]);l!=null&&E(i,["temperature"],l);const f=y(e,["topP"]);f!=null&&E(i,["topP"],f);const x=y(e,["topK"]);x!=null&&E(i,["topK"],x);const v=y(e,["candidateCount"]);v!=null&&E(i,["candidateCount"],v);const p=y(e,["maxOutputTokens"]);p!=null&&E(i,["maxOutputTokens"],p);const _=y(e,["stopSequences"]);_!=null&&E(i,["stopSequences"],_);const A=y(e,["responseLogprobs"]);A!=null&&E(i,["responseLogprobs"],A);const b=y(e,["logprobs"]);b!=null&&E(i,["logprobs"],b);const k=y(e,["presencePenalty"]);k!=null&&E(i,["presencePenalty"],k);const O=y(e,["frequencyPenalty"]);O!=null&&E(i,["frequencyPenalty"],O);const U=y(e,["seed"]);U!=null&&E(i,["seed"],U);const F=y(e,["responseMimeType"]);F!=null&&E(i,["responseMimeType"],F);const W=y(e,["responseSchema"]);W!=null&&E(i,["responseSchema"],$f(W));const $=y(e,["responseJsonSchema"]);$!=null&&E(i,["responseJsonSchema"],$);const G=y(e,["routingConfig"]);G!=null&&E(i,["routingConfig"],G);const J=y(e,["modelSelectionConfig"]);J!=null&&E(i,["modelConfig"],J);const de=y(e,["safetySettings"]);if(t!==void 0&&de!=null){let ve=de;Array.isArray(ve)&&(ve=ve.map(me=>me)),E(t,["safetySettings"],ve)}const ue=y(e,["tools"]);if(t!==void 0&&ue!=null){let ve=Jo(ue);Array.isArray(ve)&&(ve=ve.map(me=>_y(Xo(me)))),E(t,["tools"],ve)}const ee=y(e,["toolConfig"]);t!==void 0&&ee!=null&&E(t,["toolConfig"],ee);const Te=y(e,["labels"]);t!==void 0&&Te!=null&&E(t,["labels"],Te);const Z=y(e,["cachedContent"]);t!==void 0&&Z!=null&&E(t,["cachedContent"],Bi(n,Z));const Se=y(e,["responseModalities"]);Se!=null&&E(i,["responseModalities"],Se);const Pe=y(e,["mediaResolution"]);Pe!=null&&E(i,["mediaResolution"],Pe);const Ie=y(e,["speechConfig"]);Ie!=null&&E(i,["speechConfig"],Ey(Kf(Ie)));const Ne=y(e,["audioTimestamp"]);Ne!=null&&E(i,["audioTimestamp"],Ne);const We=y(e,["thinkingConfig"]);We!=null&&E(i,["thinkingConfig"],We);const ie=y(e,["imageConfig"]);if(ie!=null&&E(i,["imageConfig"],rA(ie)),y(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function X1(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let f=Vr(a);Array.isArray(f)&&(f=f.map(x=>rc(x))),E(t,["contents"],f)}const l=y(e,["config"]);return l!=null&&E(t,["generationConfig"],NS(n,l,t)),t}function J1(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["contents"]);if(a!=null){let f=Vr(a);Array.isArray(f)&&(f=f.map(x=>x)),E(t,["contents"],f)}const l=y(e,["config"]);return l!=null&&E(t,["generationConfig"],RS(n,l,t)),t}function Q1(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["candidates"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(p=>QC(p))),E(e,["candidates"],v)}const a=y(n,["modelVersion"]);a!=null&&E(e,["modelVersion"],a);const l=y(n,["promptFeedback"]);l!=null&&E(e,["promptFeedback"],l);const f=y(n,["responseId"]);f!=null&&E(e,["responseId"],f);const x=y(n,["usageMetadata"]);return x!=null&&E(e,["usageMetadata"],x),e}function Z1(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(_=>_)),E(e,["candidates"],p)}const a=y(n,["createTime"]);a!=null&&E(e,["createTime"],a);const l=y(n,["modelVersion"]);l!=null&&E(e,["modelVersion"],l);const f=y(n,["promptFeedback"]);f!=null&&E(e,["promptFeedback"],f);const x=y(n,["responseId"]);x!=null&&E(e,["responseId"],x);const v=y(n,["usageMetadata"]);return v!=null&&E(e,["usageMetadata"],v),e}function MS(n,e){const t={};if(y(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=y(n,["numberOfImages"]);e!==void 0&&i!=null&&E(e,["parameters","sampleCount"],i);const a=y(n,["aspectRatio"]);e!==void 0&&a!=null&&E(e,["parameters","aspectRatio"],a);const l=y(n,["guidanceScale"]);if(e!==void 0&&l!=null&&E(e,["parameters","guidanceScale"],l),y(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=y(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&E(e,["parameters","safetySetting"],f);const x=y(n,["personGeneration"]);e!==void 0&&x!=null&&E(e,["parameters","personGeneration"],x);const v=y(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&E(e,["parameters","includeSafetyAttributes"],v);const p=y(n,["includeRaiReason"]);e!==void 0&&p!=null&&E(e,["parameters","includeRaiReason"],p);const _=y(n,["language"]);e!==void 0&&_!=null&&E(e,["parameters","language"],_);const A=y(n,["outputMimeType"]);e!==void 0&&A!=null&&E(e,["parameters","outputOptions","mimeType"],A);const b=y(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&E(e,["parameters","outputOptions","compressionQuality"],b),y(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(y(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=y(n,["imageSize"]);if(e!==void 0&&k!=null&&E(e,["parameters","sampleImageSize"],k),y(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function kS(n,e){const t={},i=y(n,["outputGcsUri"]);e!==void 0&&i!=null&&E(e,["parameters","storageUri"],i);const a=y(n,["negativePrompt"]);e!==void 0&&a!=null&&E(e,["parameters","negativePrompt"],a);const l=y(n,["numberOfImages"]);e!==void 0&&l!=null&&E(e,["parameters","sampleCount"],l);const f=y(n,["aspectRatio"]);e!==void 0&&f!=null&&E(e,["parameters","aspectRatio"],f);const x=y(n,["guidanceScale"]);e!==void 0&&x!=null&&E(e,["parameters","guidanceScale"],x);const v=y(n,["seed"]);e!==void 0&&v!=null&&E(e,["parameters","seed"],v);const p=y(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&E(e,["parameters","safetySetting"],p);const _=y(n,["personGeneration"]);e!==void 0&&_!=null&&E(e,["parameters","personGeneration"],_);const A=y(n,["includeSafetyAttributes"]);e!==void 0&&A!=null&&E(e,["parameters","includeSafetyAttributes"],A);const b=y(n,["includeRaiReason"]);e!==void 0&&b!=null&&E(e,["parameters","includeRaiReason"],b);const k=y(n,["language"]);e!==void 0&&k!=null&&E(e,["parameters","language"],k);const O=y(n,["outputMimeType"]);e!==void 0&&O!=null&&E(e,["parameters","outputOptions","mimeType"],O);const U=y(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&E(e,["parameters","outputOptions","compressionQuality"],U);const F=y(n,["addWatermark"]);e!==void 0&&F!=null&&E(e,["parameters","addWatermark"],F);const W=y(n,["labels"]);e!==void 0&&W!=null&&E(e,["labels"],W);const $=y(n,["imageSize"]);e!==void 0&&$!=null&&E(e,["parameters","sampleImageSize"],$);const G=y(n,["enhancePrompt"]);return e!==void 0&&G!=null&&E(e,["parameters","enhancePrompt"],G),t}function PS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["prompt"]);a!=null&&E(t,["instances[0]","prompt"],a);const l=y(e,["config"]);return l!=null&&MS(l,t),t}function DS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["prompt"]);a!=null&&E(t,["instances[0]","prompt"],a);const l=y(e,["config"]);return l!=null&&kS(l,t),t}function OS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>YS(f))),E(e,["generatedImages"],l)}const a=y(n,["positivePromptSafetyAttributes"]);return a!=null&&E(e,["positivePromptSafetyAttributes"],vy(a)),e}function LS(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>ic(f))),E(e,["generatedImages"],l)}const a=y(n,["positivePromptSafetyAttributes"]);return a!=null&&E(e,["positivePromptSafetyAttributes"],wy(a)),e}function BS(n,e){const t={},i=y(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&E(e,["parameters","sampleCount"],i),y(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=y(n,["durationSeconds"]);if(e!==void 0&&a!=null&&E(e,["parameters","durationSeconds"],a),y(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=y(n,["aspectRatio"]);e!==void 0&&l!=null&&E(e,["parameters","aspectRatio"],l);const f=y(n,["resolution"]);e!==void 0&&f!=null&&E(e,["parameters","resolution"],f);const x=y(n,["personGeneration"]);if(e!==void 0&&x!=null&&E(e,["parameters","personGeneration"],x),y(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const v=y(n,["negativePrompt"]);e!==void 0&&v!=null&&E(e,["parameters","negativePrompt"],v);const p=y(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&E(e,["parameters","enhancePrompt"],p),y(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=y(n,["lastFrame"]);e!==void 0&&_!=null&&E(e,["instances[0]","lastFrame"],sc(_));const A=y(n,["referenceImages"]);if(e!==void 0&&A!=null){let b=A;Array.isArray(b)&&(b=b.map(k=>UA(k))),E(e,["instances[0]","referenceImages"],b)}if(y(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(y(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function FS(n,e){const t={},i=y(n,["numberOfVideos"]);e!==void 0&&i!=null&&E(e,["parameters","sampleCount"],i);const a=y(n,["outputGcsUri"]);e!==void 0&&a!=null&&E(e,["parameters","storageUri"],a);const l=y(n,["fps"]);e!==void 0&&l!=null&&E(e,["parameters","fps"],l);const f=y(n,["durationSeconds"]);e!==void 0&&f!=null&&E(e,["parameters","durationSeconds"],f);const x=y(n,["seed"]);e!==void 0&&x!=null&&E(e,["parameters","seed"],x);const v=y(n,["aspectRatio"]);e!==void 0&&v!=null&&E(e,["parameters","aspectRatio"],v);const p=y(n,["resolution"]);e!==void 0&&p!=null&&E(e,["parameters","resolution"],p);const _=y(n,["personGeneration"]);e!==void 0&&_!=null&&E(e,["parameters","personGeneration"],_);const A=y(n,["pubsubTopic"]);e!==void 0&&A!=null&&E(e,["parameters","pubsubTopic"],A);const b=y(n,["negativePrompt"]);e!==void 0&&b!=null&&E(e,["parameters","negativePrompt"],b);const k=y(n,["enhancePrompt"]);e!==void 0&&k!=null&&E(e,["parameters","enhancePrompt"],k);const O=y(n,["generateAudio"]);e!==void 0&&O!=null&&E(e,["parameters","generateAudio"],O);const U=y(n,["lastFrame"]);e!==void 0&&U!=null&&E(e,["instances[0]","lastFrame"],ri(U));const F=y(n,["referenceImages"]);if(e!==void 0&&F!=null){let G=F;Array.isArray(G)&&(G=G.map(J=>VA(J))),E(e,["instances[0]","referenceImages"],G)}const W=y(n,["mask"]);e!==void 0&&W!=null&&E(e,["instances[0]","mask"],FA(W));const $=y(n,["compressionQuality"]);return e!==void 0&&$!=null&&E(e,["parameters","compressionQuality"],$),t}function US(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response","generateVideoResponse"]);return f!=null&&E(e,["response"],zS(f)),e}function VS(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response"]);return f!=null&&E(e,["response"],jS(f)),e}function HS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["prompt"]);a!=null&&E(t,["instances[0]","prompt"],a);const l=y(e,["image"]);l!=null&&E(t,["instances[0]","image"],sc(l));const f=y(e,["video"]);f!=null&&E(t,["instances[0]","video"],Cy(f));const x=y(e,["source"]);x!=null&&qS(x,t);const v=y(e,["config"]);return v!=null&&BS(v,t),t}function GS(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["prompt"]);a!=null&&E(t,["instances[0]","prompt"],a);const l=y(e,["image"]);l!=null&&E(t,["instances[0]","image"],ri(l));const f=y(e,["video"]);f!=null&&E(t,["instances[0]","video"],Sy(f));const x=y(e,["source"]);x!=null&&WS(x,t);const v=y(e,["config"]);return v!=null&&FS(v,t),t}function zS(n){const e={},t=y(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(f=>KS(f))),E(e,["generatedVideos"],l)}const i=y(n,["raiMediaFilteredCount"]);i!=null&&E(e,["raiMediaFilteredCount"],i);const a=y(n,["raiMediaFilteredReasons"]);return a!=null&&E(e,["raiMediaFilteredReasons"],a),e}function jS(n){const e={},t=y(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(f=>XS(f))),E(e,["generatedVideos"],l)}const i=y(n,["raiMediaFilteredCount"]);i!=null&&E(e,["raiMediaFilteredCount"],i);const a=y(n,["raiMediaFilteredReasons"]);return a!=null&&E(e,["raiMediaFilteredReasons"],a),e}function qS(n,e){const t={},i=y(n,["prompt"]);e!==void 0&&i!=null&&E(e,["instances[0]","prompt"],i);const a=y(n,["image"]);e!==void 0&&a!=null&&E(e,["instances[0]","image"],sc(a));const l=y(n,["video"]);return e!==void 0&&l!=null&&E(e,["instances[0]","video"],Cy(l)),t}function WS(n,e){const t={},i=y(n,["prompt"]);e!==void 0&&i!=null&&E(e,["instances[0]","prompt"],i);const a=y(n,["image"]);e!==void 0&&a!=null&&E(e,["instances[0]","image"],ri(a));const l=y(n,["video"]);return e!==void 0&&l!=null&&E(e,["instances[0]","video"],Sy(l)),t}function YS(n){const e={},t=y(n,["_self"]);t!=null&&E(e,["image"],iA(t));const i=y(n,["raiFilteredReason"]);i!=null&&E(e,["raiFilteredReason"],i);const a=y(n,["_self"]);return a!=null&&E(e,["safetyAttributes"],vy(a)),e}function ic(n){const e={},t=y(n,["_self"]);t!=null&&E(e,["image"],xy(t));const i=y(n,["raiFilteredReason"]);i!=null&&E(e,["raiFilteredReason"],i);const a=y(n,["_self"]);a!=null&&E(e,["safetyAttributes"],wy(a));const l=y(n,["prompt"]);return l!=null&&E(e,["enhancedPrompt"],l),e}function $S(n){const e={},t=y(n,["_self"]);t!=null&&E(e,["mask"],xy(t));const i=y(n,["labels"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),E(e,["labels"],a)}return e}function KS(n){const e={},t=y(n,["video"]);return t!=null&&E(e,["video"],LA(t)),e}function XS(n){const e={},t=y(n,["_self"]);return t!=null&&E(e,["video"],BA(t)),e}function JS(n){const e={},t=y(n,["modelSelectionConfig"]);t!=null&&E(e,["modelConfig"],t);const i=y(n,["responseJsonSchema"]);i!=null&&E(e,["responseJsonSchema"],i);const a=y(n,["audioTimestamp"]);a!=null&&E(e,["audioTimestamp"],a);const l=y(n,["candidateCount"]);l!=null&&E(e,["candidateCount"],l);const f=y(n,["enableAffectiveDialog"]);f!=null&&E(e,["enableAffectiveDialog"],f);const x=y(n,["frequencyPenalty"]);x!=null&&E(e,["frequencyPenalty"],x);const v=y(n,["logprobs"]);v!=null&&E(e,["logprobs"],v);const p=y(n,["maxOutputTokens"]);p!=null&&E(e,["maxOutputTokens"],p);const _=y(n,["mediaResolution"]);_!=null&&E(e,["mediaResolution"],_);const A=y(n,["presencePenalty"]);A!=null&&E(e,["presencePenalty"],A);const b=y(n,["responseLogprobs"]);b!=null&&E(e,["responseLogprobs"],b);const k=y(n,["responseMimeType"]);k!=null&&E(e,["responseMimeType"],k);const O=y(n,["responseModalities"]);O!=null&&E(e,["responseModalities"],O);const U=y(n,["responseSchema"]);U!=null&&E(e,["responseSchema"],U);const F=y(n,["routingConfig"]);F!=null&&E(e,["routingConfig"],F);const W=y(n,["seed"]);W!=null&&E(e,["seed"],W);const $=y(n,["speechConfig"]);$!=null&&E(e,["speechConfig"],Ey($));const G=y(n,["stopSequences"]);G!=null&&E(e,["stopSequences"],G);const J=y(n,["temperature"]);J!=null&&E(e,["temperature"],J);const de=y(n,["thinkingConfig"]);de!=null&&E(e,["thinkingConfig"],de);const ue=y(n,["topK"]);ue!=null&&E(e,["topK"],ue);const ee=y(n,["topP"]);if(ee!=null&&E(e,["topP"],ee),y(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function QS(n,e){const t={},i=y(e,["model"]);return i!=null&&E(t,["_url","name"],wt(n,i)),t}function ZS(n,e){const t={},i=y(e,["model"]);return i!=null&&E(t,["_url","name"],wt(n,i)),t}function eA(n){const e={};if(y(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=y(n,["enableWidget"]);return t!=null&&E(e,["enableWidget"],t),e}function tA(n){const e={};if(y(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=y(n,["timeRangeFilter"]);return t!=null&&E(e,["timeRangeFilter"],t),e}function nA(n){const e={},t=y(n,["aspectRatio"]);t!=null&&E(e,["aspectRatio"],t);const i=y(n,["imageSize"]);if(i!=null&&E(e,["imageSize"],i),y(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(y(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function rA(n){const e={},t=y(n,["aspectRatio"]);t!=null&&E(e,["aspectRatio"],t);const i=y(n,["imageSize"]);i!=null&&E(e,["imageSize"],i);const a=y(n,["outputMimeType"]);a!=null&&E(e,["imageOutputOptions","mimeType"],a);const l=y(n,["outputCompressionQuality"]);return l!=null&&E(e,["imageOutputOptions","compressionQuality"],l),e}function iA(n){const e={},t=y(n,["bytesBase64Encoded"]);t!=null&&E(e,["imageBytes"],ys(t));const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function xy(n){const e={},t=y(n,["gcsUri"]);t!=null&&E(e,["gcsUri"],t);const i=y(n,["bytesBase64Encoded"]);i!=null&&E(e,["imageBytes"],ys(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["mimeType"],a),e}function sc(n){const e={};if(y(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=y(n,["imageBytes"]);t!=null&&E(e,["bytesBase64Encoded"],ys(t));const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function ri(n){const e={},t=y(n,["gcsUri"]);t!=null&&E(e,["gcsUri"],t);const i=y(n,["imageBytes"]);i!=null&&E(e,["bytesBase64Encoded"],ys(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["mimeType"],a),e}function sA(n,e,t){const i={},a=y(e,["pageSize"]);t!==void 0&&a!=null&&E(t,["_query","pageSize"],a);const l=y(e,["pageToken"]);t!==void 0&&l!=null&&E(t,["_query","pageToken"],l);const f=y(e,["filter"]);t!==void 0&&f!=null&&E(t,["_query","filter"],f);const x=y(e,["queryBase"]);return t!==void 0&&x!=null&&E(t,["_url","models_url"],cy(n,x)),i}function oA(n,e,t){const i={},a=y(e,["pageSize"]);t!==void 0&&a!=null&&E(t,["_query","pageSize"],a);const l=y(e,["pageToken"]);t!==void 0&&l!=null&&E(t,["_query","pageToken"],l);const f=y(e,["filter"]);t!==void 0&&f!=null&&E(t,["_query","filter"],f);const x=y(e,["queryBase"]);return t!==void 0&&x!=null&&E(t,["_url","models_url"],cy(n,x)),i}function aA(n,e){const t={},i=y(e,["config"]);return i!=null&&sA(n,i,t),t}function lA(n,e){const t={},i=y(e,["config"]);return i!=null&&oA(n,i,t),t}function uA(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["_self"]);if(a!=null){let l=dy(a);Array.isArray(l)&&(l=l.map(f=>vf(f))),E(e,["models"],l)}return e}function cA(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["_self"]);if(a!=null){let l=dy(a);Array.isArray(l)&&(l=l.map(f=>wf(f))),E(e,["models"],l)}return e}function dA(n){const e={},t=y(n,["maskMode"]);t!=null&&E(e,["maskMode"],t);const i=y(n,["segmentationClasses"]);i!=null&&E(e,["maskClasses"],i);const a=y(n,["maskDilation"]);return a!=null&&E(e,["dilation"],a),e}function vf(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["displayName"]);i!=null&&E(e,["displayName"],i);const a=y(n,["description"]);a!=null&&E(e,["description"],a);const l=y(n,["version"]);l!=null&&E(e,["version"],l);const f=y(n,["_self"]);f!=null&&E(e,["tunedModelInfo"],IA(f));const x=y(n,["inputTokenLimit"]);x!=null&&E(e,["inputTokenLimit"],x);const v=y(n,["outputTokenLimit"]);v!=null&&E(e,["outputTokenLimit"],v);const p=y(n,["supportedGenerationMethods"]);p!=null&&E(e,["supportedActions"],p);const _=y(n,["temperature"]);_!=null&&E(e,["temperature"],_);const A=y(n,["maxTemperature"]);A!=null&&E(e,["maxTemperature"],A);const b=y(n,["topP"]);b!=null&&E(e,["topP"],b);const k=y(n,["topK"]);k!=null&&E(e,["topK"],k);const O=y(n,["thinking"]);return O!=null&&E(e,["thinking"],O),e}function wf(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["displayName"]);i!=null&&E(e,["displayName"],i);const a=y(n,["description"]);a!=null&&E(e,["description"],a);const l=y(n,["versionId"]);l!=null&&E(e,["version"],l);const f=y(n,["deployedModels"]);if(f!=null){let A=f;Array.isArray(A)&&(A=A.map(b=>SS(b))),E(e,["endpoints"],A)}const x=y(n,["labels"]);x!=null&&E(e,["labels"],x);const v=y(n,["_self"]);v!=null&&E(e,["tunedModelInfo"],bA(v));const p=y(n,["defaultCheckpointId"]);p!=null&&E(e,["defaultCheckpointId"],p);const _=y(n,["checkpoints"]);if(_!=null){let A=_;Array.isArray(A)&&(A=A.map(b=>b)),E(e,["checkpoints"],A)}return e}function fA(n){const e={},t=y(n,["mediaResolution"]);t!=null&&E(e,["mediaResolution"],t);const i=y(n,["codeExecutionResult"]);i!=null&&E(e,["codeExecutionResult"],i);const a=y(n,["executableCode"]);a!=null&&E(e,["executableCode"],a);const l=y(n,["fileData"]);l!=null&&E(e,["fileData"],AS(l));const f=y(n,["functionCall"]);f!=null&&E(e,["functionCall"],TS(f));const x=y(n,["functionResponse"]);x!=null&&E(e,["functionResponse"],x);const v=y(n,["inlineData"]);v!=null&&E(e,["inlineData"],JC(v));const p=y(n,["text"]);p!=null&&E(e,["text"],p);const _=y(n,["thought"]);_!=null&&E(e,["thought"],_);const A=y(n,["thoughtSignature"]);A!=null&&E(e,["thoughtSignature"],A);const b=y(n,["videoMetadata"]);return b!=null&&E(e,["videoMetadata"],b),e}function hA(n){const e={},t=y(n,["productImage"]);return t!=null&&E(e,["image"],ri(t)),e}function pA(n,e){const t={},i=y(n,["numberOfImages"]);e!==void 0&&i!=null&&E(e,["parameters","sampleCount"],i);const a=y(n,["baseSteps"]);e!==void 0&&a!=null&&E(e,["parameters","baseSteps"],a);const l=y(n,["outputGcsUri"]);e!==void 0&&l!=null&&E(e,["parameters","storageUri"],l);const f=y(n,["seed"]);e!==void 0&&f!=null&&E(e,["parameters","seed"],f);const x=y(n,["safetyFilterLevel"]);e!==void 0&&x!=null&&E(e,["parameters","safetySetting"],x);const v=y(n,["personGeneration"]);e!==void 0&&v!=null&&E(e,["parameters","personGeneration"],v);const p=y(n,["addWatermark"]);e!==void 0&&p!=null&&E(e,["parameters","addWatermark"],p);const _=y(n,["outputMimeType"]);e!==void 0&&_!=null&&E(e,["parameters","outputOptions","mimeType"],_);const A=y(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&E(e,["parameters","outputOptions","compressionQuality"],A);const b=y(n,["enhancePrompt"]);e!==void 0&&b!=null&&E(e,["parameters","enhancePrompt"],b);const k=y(n,["labels"]);return e!==void 0&&k!=null&&E(e,["labels"],k),t}function gA(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["source"]);a!=null&&yA(a,t);const l=y(e,["config"]);return l!=null&&pA(l,t),t}function mA(n){const e={},t=y(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>ic(a))),E(e,["generatedImages"],i)}return e}function yA(n,e){const t={},i=y(n,["prompt"]);e!==void 0&&i!=null&&E(e,["instances[0]","prompt"],i);const a=y(n,["personImage"]);e!==void 0&&a!=null&&E(e,["instances[0]","personImage","image"],ri(a));const l=y(n,["productImages"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(x=>hA(x))),E(e,["instances[0]","productImages"],f)}return t}function xA(n){const e={},t=y(n,["referenceImage"]);t!=null&&E(e,["referenceImage"],ri(t));const i=y(n,["referenceId"]);i!=null&&E(e,["referenceId"],i);const a=y(n,["referenceType"]);a!=null&&E(e,["referenceType"],a);const l=y(n,["maskImageConfig"]);l!=null&&E(e,["maskImageConfig"],dA(l));const f=y(n,["controlImageConfig"]);f!=null&&E(e,["controlImageConfig"],iS(f));const x=y(n,["styleImageConfig"]);x!=null&&E(e,["styleImageConfig"],x);const v=y(n,["subjectImageConfig"]);return v!=null&&E(e,["subjectImageConfig"],v),e}function vy(n){const e={},t=y(n,["safetyAttributes","categories"]);t!=null&&E(e,["categories"],t);const i=y(n,["safetyAttributes","scores"]);i!=null&&E(e,["scores"],i);const a=y(n,["contentType"]);return a!=null&&E(e,["contentType"],a),e}function wy(n){const e={},t=y(n,["safetyAttributes","categories"]);t!=null&&E(e,["categories"],t);const i=y(n,["safetyAttributes","scores"]);i!=null&&E(e,["scores"],i);const a=y(n,["contentType"]);return a!=null&&E(e,["contentType"],a),e}function vA(n){const e={},t=y(n,["category"]);if(t!=null&&E(e,["category"],t),y(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=y(n,["threshold"]);return i!=null&&E(e,["threshold"],i),e}function wA(n){const e={},t=y(n,["image"]);return t!=null&&E(e,["image"],ri(t)),e}function EA(n,e){const t={},i=y(n,["mode"]);e!==void 0&&i!=null&&E(e,["parameters","mode"],i);const a=y(n,["maxPredictions"]);e!==void 0&&a!=null&&E(e,["parameters","maxPredictions"],a);const l=y(n,["confidenceThreshold"]);e!==void 0&&l!=null&&E(e,["parameters","confidenceThreshold"],l);const f=y(n,["maskDilation"]);e!==void 0&&f!=null&&E(e,["parameters","maskDilation"],f);const x=y(n,["binaryColorThreshold"]);e!==void 0&&x!=null&&E(e,["parameters","binaryColorThreshold"],x);const v=y(n,["labels"]);return e!==void 0&&v!=null&&E(e,["labels"],v),t}function _A(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["source"]);a!=null&&SA(a,t);const l=y(e,["config"]);return l!=null&&EA(l,t),t}function CA(n){const e={},t=y(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>$S(a))),E(e,["generatedMasks"],i)}return e}function SA(n,e){const t={},i=y(n,["prompt"]);e!==void 0&&i!=null&&E(e,["instances[0]","prompt"],i);const a=y(n,["image"]);e!==void 0&&a!=null&&E(e,["instances[0]","image"],ri(a));const l=y(n,["scribbleImage"]);return e!==void 0&&l!=null&&E(e,["instances[0]","scribble"],wA(l)),t}function Ey(n){const e={},t=y(n,["voiceConfig"]);t!=null&&E(e,["voiceConfig"],t);const i=y(n,["languageCode"]);if(i!=null&&E(e,["languageCode"],i),y(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function AA(n){const e={},t=y(n,["functionCallingConfig"]);t!=null&&E(e,["functionCallingConfig"],IS(t));const i=y(n,["retrievalConfig"]);return i!=null&&E(e,["retrievalConfig"],i),e}function TA(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(A=>A)),E(e,["functionDeclarations"],_)}if(y(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(n,["googleSearchRetrieval"]);i!=null&&E(e,["googleSearchRetrieval"],i);const a=y(n,["computerUse"]);a!=null&&E(e,["computerUse"],a);const l=y(n,["fileSearch"]);l!=null&&E(e,["fileSearch"],l);const f=y(n,["codeExecution"]);if(f!=null&&E(e,["codeExecution"],f),y(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const x=y(n,["googleMaps"]);x!=null&&E(e,["googleMaps"],eA(x));const v=y(n,["googleSearch"]);v!=null&&E(e,["googleSearch"],tA(v));const p=y(n,["urlContext"]);return p!=null&&E(e,["urlContext"],p),e}function _y(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>bS(b))),E(e,["functionDeclarations"],A)}const i=y(n,["retrieval"]);i!=null&&E(e,["retrieval"],i);const a=y(n,["googleSearchRetrieval"]);a!=null&&E(e,["googleSearchRetrieval"],a);const l=y(n,["computerUse"]);if(l!=null&&E(e,["computerUse"],l),y(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=y(n,["codeExecution"]);f!=null&&E(e,["codeExecution"],f);const x=y(n,["enterpriseWebSearch"]);x!=null&&E(e,["enterpriseWebSearch"],x);const v=y(n,["googleMaps"]);v!=null&&E(e,["googleMaps"],v);const p=y(n,["googleSearch"]);p!=null&&E(e,["googleSearch"],p);const _=y(n,["urlContext"]);return _!=null&&E(e,["urlContext"],_),e}function IA(n){const e={},t=y(n,["baseModel"]);t!=null&&E(e,["baseModel"],t);const i=y(n,["createTime"]);i!=null&&E(e,["createTime"],i);const a=y(n,["updateTime"]);return a!=null&&E(e,["updateTime"],a),e}function bA(n){const e={},t=y(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&E(e,["baseModel"],t);const i=y(n,["createTime"]);i!=null&&E(e,["createTime"],i);const a=y(n,["updateTime"]);return a!=null&&E(e,["updateTime"],a),e}function NA(n,e){const t={},i=y(n,["displayName"]);e!==void 0&&i!=null&&E(e,["displayName"],i);const a=y(n,["description"]);e!==void 0&&a!=null&&E(e,["description"],a);const l=y(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&E(e,["defaultCheckpointId"],l),t}function RA(n,e){const t={},i=y(n,["displayName"]);e!==void 0&&i!=null&&E(e,["displayName"],i);const a=y(n,["description"]);e!==void 0&&a!=null&&E(e,["description"],a);const l=y(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&E(e,["defaultCheckpointId"],l),t}function MA(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","name"],wt(n,i));const a=y(e,["config"]);return a!=null&&NA(a,t),t}function kA(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["config"]);return a!=null&&RA(a,t),t}function PA(n,e){const t={},i=y(n,["outputGcsUri"]);e!==void 0&&i!=null&&E(e,["parameters","storageUri"],i);const a=y(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&E(e,["parameters","safetySetting"],a);const l=y(n,["personGeneration"]);e!==void 0&&l!=null&&E(e,["parameters","personGeneration"],l);const f=y(n,["includeRaiReason"]);e!==void 0&&f!=null&&E(e,["parameters","includeRaiReason"],f);const x=y(n,["outputMimeType"]);e!==void 0&&x!=null&&E(e,["parameters","outputOptions","mimeType"],x);const v=y(n,["outputCompressionQuality"]);e!==void 0&&v!=null&&E(e,["parameters","outputOptions","compressionQuality"],v);const p=y(n,["enhanceInputImage"]);e!==void 0&&p!=null&&E(e,["parameters","upscaleConfig","enhanceInputImage"],p);const _=y(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&E(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const A=y(n,["labels"]);e!==void 0&&A!=null&&E(e,["labels"],A);const b=y(n,["numberOfImages"]);e!==void 0&&b!=null&&E(e,["parameters","sampleCount"],b);const k=y(n,["mode"]);return e!==void 0&&k!=null&&E(e,["parameters","mode"],k),t}function DA(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["_url","model"],wt(n,i));const a=y(e,["image"]);a!=null&&E(t,["instances[0]","image"],ri(a));const l=y(e,["upscaleFactor"]);l!=null&&E(t,["parameters","upscaleConfig","upscaleFactor"],l);const f=y(e,["config"]);return f!=null&&PA(f,t),t}function OA(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>ic(l))),E(e,["generatedImages"],a)}return e}function LA(n){const e={},t=y(n,["uri"]);t!=null&&E(e,["uri"],t);const i=y(n,["encodedVideo"]);i!=null&&E(e,["videoBytes"],ys(i));const a=y(n,["encoding"]);return a!=null&&E(e,["mimeType"],a),e}function BA(n){const e={},t=y(n,["gcsUri"]);t!=null&&E(e,["uri"],t);const i=y(n,["bytesBase64Encoded"]);i!=null&&E(e,["videoBytes"],ys(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["mimeType"],a),e}function FA(n){const e={},t=y(n,["image"]);t!=null&&E(e,["_self"],ri(t));const i=y(n,["maskMode"]);return i!=null&&E(e,["maskMode"],i),e}function UA(n){const e={},t=y(n,["image"]);t!=null&&E(e,["image"],sc(t));const i=y(n,["referenceType"]);return i!=null&&E(e,["referenceType"],i),e}function VA(n){const e={},t=y(n,["image"]);t!=null&&E(e,["image"],ri(t));const i=y(n,["referenceType"]);return i!=null&&E(e,["referenceType"],i),e}function Cy(n){const e={},t=y(n,["uri"]);t!=null&&E(e,["uri"],t);const i=y(n,["videoBytes"]);i!=null&&E(e,["encodedVideo"],ys(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["encoding"],a),e}function Sy(n){const e={},t=y(n,["uri"]);t!=null&&E(e,["gcsUri"],t);const i=y(n,["videoBytes"]);i!=null&&E(e,["bytesBase64Encoded"],ys(i));const a=y(n,["mimeType"]);return a!=null&&E(e,["mimeType"],a),e}function HA(n,e){const t={},i=y(n,["displayName"]);return e!==void 0&&i!=null&&E(e,["displayName"],i),t}function GA(n){const e={},t=y(n,["config"]);return t!=null&&HA(t,e),e}function zA(n,e){const t={},i=y(n,["force"]);return e!==void 0&&i!=null&&E(e,["_query","force"],i),t}function jA(n){const e={},t=y(n,["name"]);t!=null&&E(e,["_url","name"],t);const i=y(n,["config"]);return i!=null&&zA(i,e),e}function qA(n){const e={},t=y(n,["name"]);return t!=null&&E(e,["_url","name"],t),e}function WA(n,e){const t={},i=y(n,["customMetadata"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["customMetadata"],l)}const a=y(n,["chunkingConfig"]);return e!==void 0&&a!=null&&E(e,["chunkingConfig"],a),t}function YA(n){const e={},t=y(n,["name"]);t!=null&&E(e,["name"],t);const i=y(n,["metadata"]);i!=null&&E(e,["metadata"],i);const a=y(n,["done"]);a!=null&&E(e,["done"],a);const l=y(n,["error"]);l!=null&&E(e,["error"],l);const f=y(n,["response"]);return f!=null&&E(e,["response"],KA(f)),e}function $A(n){const e={},t=y(n,["fileSearchStoreName"]);t!=null&&E(e,["_url","file_search_store_name"],t);const i=y(n,["fileName"]);i!=null&&E(e,["fileName"],i);const a=y(n,["config"]);return a!=null&&WA(a,e),e}function KA(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["parent"]);i!=null&&E(e,["parent"],i);const a=y(n,["documentName"]);return a!=null&&E(e,["documentName"],a),e}function XA(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);return e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),t}function JA(n){const e={},t=y(n,["config"]);return t!=null&&XA(t,e),e}function QA(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["fileSearchStores"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["fileSearchStores"],l)}return e}function Ay(n,e){const t={},i=y(n,["mimeType"]);e!==void 0&&i!=null&&E(e,["mimeType"],i);const a=y(n,["displayName"]);e!==void 0&&a!=null&&E(e,["displayName"],a);const l=y(n,["customMetadata"]);if(e!==void 0&&l!=null){let x=l;Array.isArray(x)&&(x=x.map(v=>v)),E(e,["customMetadata"],x)}const f=y(n,["chunkingConfig"]);return e!==void 0&&f!=null&&E(e,["chunkingConfig"],f),t}function ZA(n){const e={},t=y(n,["fileSearchStoreName"]);t!=null&&E(e,["_url","file_search_store_name"],t);const i=y(n,["config"]);return i!=null&&Ay(i,e),e}function eT(n){const e={},t=y(n,["sdkHttpResponse"]);return t!=null&&E(e,["sdkHttpResponse"],t),e}const tT="Content-Type",nT="X-Server-Timeout",rT="User-Agent",Ef="x-goog-api-client",iT="1.33.0",sT=`google-genai-sdk/${iT}`,oT="v1beta1",aT="v1beta";class lT{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:oT,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:aT,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const a=[this.getRequestUrlInternal(t)];return i&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[f,x]of Object.entries(e.queryParams))a.searchParams.append(f,String(x));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,a.toString(),e.abortSignal),this.unaryApiCall(a,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[a,l]of Object.entries(t))typeof l=="object"?i[a]=Object.assign(Object.assign({},i[a]),l):l!==void 0&&(i[a]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,i);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,a.toString(),e.abortSignal),this.streamApiCall(a,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,a){if(t&&t.timeout||a){const l=new AbortController,f=l.signal;if(t.timeout&&t?.timeout>0){const x=setTimeout(()=>l.abort(),t.timeout);x&&typeof x.unref=="function"&&x.unref()}a&&a.addEventListener("abort",()=>{l.abort()}),e.signal=f}return t&&t.extraBody!==null&&uT(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await eg(a),new mf(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await eg(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){return ti(this,arguments,function*(){var i;const a=(i=e?.body)===null||i===void 0?void 0:i.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let f="";const x="data:",v=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:_}=yield it(a.read());if(p){if(f.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const A=l.decode(_,{stream:!0});try{const O=JSON.parse(A);if("error"in O){const U=JSON.parse(JSON.stringify(O.error)),F=U.status,W=U.code,$=`got status: ${F}. ${JSON.stringify(O)}`;if(W>=400&&W<600)throw new nc({message:$,status:W})}}catch(O){if(O.name==="ApiError")throw O}f+=A;let b=-1,k=0;for(;;){b=-1,k=0;for(const F of v){const W=f.indexOf(F);W!==-1&&(b===-1||W<b)&&(b=W,k=F.length)}if(b===-1)break;const O=f.substring(0,b);f=f.substring(b+k);const U=O.trim();if(U.startsWith(x)){const F=U.substring(x.length).trim();try{const W=new Response(F,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield it(new mf(W))}catch(W){throw new Error(`exception parsing stream chunk ${F}. ${W}`)}}}}}finally{a.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=sT+" "+this.clientOptions.userAgentExtra;return e[rT]=t,e[Ef]=t,e[tT]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[a,l]of Object.entries(e.headers))i.append(a,l);e.timeout&&e.timeout>0&&i.append(nT,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,f=await l.stat(e);a.sizeBytes=String(f.size);const x=(i=t?.mimeType)!==null&&i!==void 0?i:f.type;if(x===void 0||x==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=x;const v={file:a},p=this.getFileName(e),_=Re("upload/v1beta/files",v._url),A=await this.fetchUploadUrl(_,a.sizeBytes,a.mimeType,p,v,t?.httpOptions);return l.upload(e,A,this)}async uploadFileToFileSearchStore(e,t,i){var a;const l=this.clientOptions.uploader,f=await l.stat(t),x=String(f.size),v=(a=i?.mimeType)!==null&&a!==void 0?a:f.type;if(v===void 0||v==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),A={};i!=null&&Ay(i,A);const b=await this.fetchUploadUrl(p,x,v,_,A,i?.httpOptions);return l.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,a,l,f){var x;let v={};f?v=f:v={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},a?{"X-Goog-Upload-File-Name":a}:{})};const p=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:v});if(!p||!p?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(x=p?.headers)===null||x===void 0?void 0:x["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function eg(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=JSON.stringify(i);throw t>=400&&t<600?new nc({message:a,status:t}):new Error(a)}}function uT(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,f){const x=Object.assign({},l);for(const v in f)if(Object.prototype.hasOwnProperty.call(f,v)){const p=f[v],_=x[v];p&&typeof p=="object"&&!Array.isArray(p)&&_&&typeof _=="object"&&!Array.isArray(_)?x[v]=i(_,p):(_&&p&&typeof _!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${v}". Original type: ${typeof _}, New type: ${typeof p}. Overwriting.`),x[v]=p)}return x}const a=i(t,e);n.body=JSON.stringify(a)}const cT="mcp_used/unknown";let dT=!1;function Ty(n){for(const e of n)if(fT(e)||typeof e=="object"&&"inputSchema"in e)return!0;return dT}function Iy(n){var e;const t=(e=n[Ef])!==null&&e!==void 0?e:"";n[Ef]=(t+` ${cT}`).trimStart()}function fT(n){return n!==null&&typeof n=="object"&&n instanceof Jf}function hT(n){return ti(this,arguments,function*(t,i=100){let a,l=0;for(;l<i;){const f=yield it(t.listTools({cursor:a}));for(const x of f.tools)yield yield it(x),l++;if(!f.nextCursor)break;a=f.nextCursor}})}class Jf{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Jf(e,t)}async initialize(){var e,t,i,a;if(this.mcpTools.length>0)return;const l={},f=[];for(const _ of this.mcpClients)try{for(var x=!0,v=(t=void 0,ni(hT(_))),p;p=await v.next(),e=p.done,!e;x=!0){a=p.value,x=!1;const A=a;f.push(A);const b=A.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=_}}catch(A){t={error:A}}finally{try{!x&&!e&&(i=v.return)&&await i.call(v)}finally{if(t)throw t.error}}this.mcpTools=f,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),q2(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const f=await a.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:f.isError?{error:f}:f}})}return t}}async function pT(n,e,t){const i=new B2;let a;t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),Object.assign(i,a),e(i)}class gT{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),f=xT(this.apiClient.getDefaultHeaders()),x=this.apiClient.getApiKey(),v=`${a}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${x}`;let p=()=>{};const _=new Promise(G=>{p=G}),A=e.callbacks,b=function(){p({})},k=this.apiClient,O={onopen:b,onmessage:G=>{pT(k,A.onmessage,G)},onerror:(t=A?.onerror)!==null&&t!==void 0?t:function(G){},onclose:(i=A?.onclose)!==null&&i!==void 0?i:function(G){}},U=this.webSocketFactory.create(v,yT(f),O);U.connect(),await _;const $={setup:{model:wt(this.apiClient,e.model)}};return U.send(JSON.stringify($)),new mT(U,this.apiClient)}}class mT{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=GC(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=HC(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Fo.PLAY)}pause(){this.sendPlaybackControl(Fo.PAUSE)}stop(){this.sendPlaybackControl(Fo.STOP)}resetContext(){this.sendPlaybackControl(Fo.RESET_CONTEXT)}close(){this.conn.close()}}function yT(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function xT(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}const vT="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function wT(n,e,t){const i=new L2;let a;t.data instanceof Blob?a=await t.data.text():t.data instanceof ArrayBuffer?a=new TextDecoder().decode(t.data):a=t.data;const l=JSON.parse(a);if(n.isVertexAI()){const f=qC(l);Object.assign(i,f)}else Object.assign(i,l);e(i)}class ET{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new gT(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,a,l,f,x;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const v=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let _;const A=this.apiClient.getHeaders();e.config&&e.config.tools&&Ty(e.config.tools)&&Iy(A);const b=AT(A);if(this.apiClient.isVertexAI())_=`${v}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,_);else{const Z=this.apiClient.getApiKey();let Se="BidiGenerateContent",Pe="key";Z?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Se="BidiGenerateContentConstrained",Pe="access_token"),_=`${v}/ws/google.ai.generativelanguage.${p}.GenerativeService.${Se}?${Pe}=${Z}`}let k=()=>{};const O=new Promise(Z=>{k=Z}),U=e.callbacks,F=function(){var Z;(Z=U?.onopen)===null||Z===void 0||Z.call(U),k({})},W=this.apiClient,$={onopen:F,onmessage:Z=>{wT(W,U.onmessage,Z)},onerror:(t=U?.onerror)!==null&&t!==void 0?t:function(Z){},onclose:(i=U?.onclose)!==null&&i!==void 0?i:function(Z){}},G=this.webSocketFactory.create(_,ST(b),$);G.connect(),await O;let J=wt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&J.startsWith("publishers/")){const Z=this.apiClient.getProject(),Se=this.apiClient.getLocation();J=`projects/${Z}/locations/${Se}/`+J}let de={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Vu.AUDIO]}:e.config.responseModalities=[Vu.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ue=(x=(f=e.config)===null||f===void 0?void 0:f.tools)!==null&&x!==void 0?x:[],ee=[];for(const Z of ue)if(this.isCallableTool(Z)){const Se=Z;ee.push(await Se.tool())}else ee.push(Z);ee.length>0&&(e.config.tools=ee);const Te={model:J,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?de=VC(this.apiClient,Te):de=UC(this.apiClient,Te),delete de.config,G.send(JSON.stringify(de)),new CT(G,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const _T={turnComplete:!0};class CT{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Vr(t.turns),e.isVertexAI()||(i=i.map(a=>rc(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(vT)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},_T),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:jC(e)}:t={realtimeInput:zC(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function ST(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function AT(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}const tg=10;function ng(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const f of(t=n?.tools)!==null&&t!==void 0?t:[])if(qo(f)){a=!0;break}if(!a)return!0;const l=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function qo(n){return"callTool"in n&&typeof n.callTool=="function"}function TT(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(a=>qo(a)))!==null&&i!==void 0?i:!1}function rg(n){var e;const t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,a)=>{if(qo(i))return;const l=i;l.functionDeclarations&&l.functionDeclarations.length>0&&t.push(a)}),t}function ig(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class IT extends Li{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,a,l,f,x;const v=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!TT(t)||ng(t.config))return await this.generateContentInternal(v);const p=rg(t);if(p.length>0){const U=p.map(F=>`tools[${F}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${U}.`)}let _,A;const b=Vr(v.contents),k=(l=(a=(i=v.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&l!==void 0?l:tg;let O=0;for(;O<k&&(_=await this.generateContentInternal(v),!(!_.functionCalls||_.functionCalls.length===0));){const U=_.candidates[0].content,F=[];for(const W of(x=(f=t.config)===null||f===void 0?void 0:f.tools)!==null&&x!==void 0?x:[])if(qo(W)){const G=await W.callTool(_.functionCalls);F.push(...G)}O++,A={role:"user",parts:F},v.contents=Vr(v.contents),v.contents.push(U),v.contents.push(A),ig(v.config)&&(b.push(U),b.push(A))}return ig(v.config)&&(_.automaticFunctionCallingHistory=b),_},this.generateContentStream=async t=>{var i,a,l,f,x;if(this.maybeMoveToResponseJsonSchem(t),ng(t.config)){const A=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(A)}const v=rg(t);if(v.length>0){const A=v.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${A}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(l=(a=(i=t?.config)===null||i===void 0?void 0:i.toolConfig)===null||a===void 0?void 0:a.functionCallingConfig)===null||l===void 0?void 0:l.streamFunctionCallArguments,_=(x=(f=t?.config)===null||f===void 0?void 0:f.automaticFunctionCalling)===null||x===void 0?void 0:x.disable;if(p&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var a;let l;const f=[];if(i?.generatedImages)for(const v of i.generatedImages)v&&v?.safetyAttributes&&((a=v?.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=v?.safetyAttributes:f.push(v);let x;return l?x={generatedImages:f,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:x={generatedImages:f,sdkHttpResponse:i.sdkHttpResponse},x}),this.list=async t=>{var i;const f={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!f.config.queryBase){if(!((i=f.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");f.config.filter="labels.tune-type:*"}return new eo(Di.PAGED_ITEM_MODELS,x=>this.listInternal(x),await this.listInternal(f),f)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(a)},this.generateVideos=async t=>{var i,a,l,f,x,v;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((a=t.video)===null||a===void 0)&&a.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((f=(l=t.source)===null||l===void 0?void 0:l.video)===null||f===void 0)&&f.uri&&(!((v=(x=t.source)===null||x===void 0?void 0:x.video)===null||v===void 0)&&v.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,a;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const f=await Promise.all(l.map(async v=>qo(v)?await v.tool():v)),x={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:f})};if(x.config.tools=f,e.config&&e.config.tools&&Ty(e.config.tools)){const v=(a=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&a!==void 0?a:{};let p=Object.assign({},v);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Iy(p),x.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return x}async initAfcToolsMap(e){var t,i,a;const l=new Map;for(const f of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(qo(f)){const x=f,v=await x.tool();for(const p of(a=v.functionDeclarations)!==null&&a!==void 0?a:[]){if(!p.name)throw new Error("Function declaration name is required.");if(l.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);l.set(p.name,x)}}return l}async processAfcStream(e){var t,i,a;const l=(a=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:tg;let f=!1,x=0;const v=await this.initAfcToolsMap(e);return(function(p,_,A){return ti(this,arguments,function*(){for(var b,k,O,U,F,W;x<l;){f&&(x++,f=!1);const de=yield it(p.processParamsMaybeAddMcpUsage(A)),ue=yield it(p.generateContentStreamInternal(de)),ee=[],Te=[];try{for(var $=!0,G=(k=void 0,ni(ue)),J;J=yield it(G.next()),b=J.done,!b;$=!0){U=J.value,$=!1;const Z=U;if(yield yield it(Z),Z.candidates&&(!((F=Z.candidates[0])===null||F===void 0)&&F.content)){Te.push(Z.candidates[0].content);for(const Se of(W=Z.candidates[0].content.parts)!==null&&W!==void 0?W:[])if(x<l&&Se.functionCall){if(!Se.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(Se.functionCall.name)){const Pe=yield it(_.get(Se.functionCall.name).callTool([Se.functionCall]));ee.push(...Pe)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${Se.functionCall.name}`)}}}}catch(Z){k={error:Z}}finally{try{!$&&!b&&(O=G.return)&&(yield it(O.call(G)))}finally{if(k)throw k.error}}if(ee.length>0){f=!0;const Z=new za;Z.candidates=[{content:{role:"user",parts:ee}}],yield yield it(Z);const Se=[];Se.push(...Te),Se.push({role:"user",parts:ee});const Pe=Vr(A.contents).concat(Se);A.contents=Pe}else break}})})(this,v,e)}async generateContentInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=J1(this.apiClient,e);return x=Re("{model}:generateContent",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=Z1(_),b=new za;return Object.assign(b,A),b})}else{const p=X1(this.apiClient,e);return x=Re("{model}:generateContent",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=Q1(_),b=new za;return Object.assign(b,A),b})}}async generateContentStreamInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=J1(this.apiClient,e);return x=Re("{model}:streamGenerateContent?alt=sse",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.requestStream({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),f.then(function(A){return ti(this,arguments,function*(){var b,k,O,U;try{for(var F=!0,W=ni(A),$;$=yield it(W.next()),b=$.done,!b;F=!0){U=$.value,F=!1;const G=U,J=Z1(yield it(G.json()));J.sdkHttpResponse={headers:G.headers};const de=new za;Object.assign(de,J),yield yield it(de)}}catch(G){k={error:G}}finally{try{!F&&!b&&(O=W.return)&&(yield it(O.call(W)))}finally{if(k)throw k.error}}})})}else{const p=X1(this.apiClient,e);return x=Re("{model}:streamGenerateContent?alt=sse",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.requestStream({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),f.then(function(A){return ti(this,arguments,function*(){var b,k,O,U;try{for(var F=!0,W=ni(A),$;$=yield it(W.next()),b=$.done,!b;F=!0){U=$.value,F=!1;const G=U,J=Q1(yield it(G.json()));J.sdkHttpResponse={headers:G.headers};const de=new za;Object.assign(de,J),yield yield it(de)}}catch(G){k={error:G}}finally{try{!F&&!b&&(O=W.return)&&(yield it(O.call(W)))}finally{if(k)throw k.error}}})})}}async embedContent(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=ES(this.apiClient,e);return x=Re("{model}:predict",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=CS(_),b=new P1;return Object.assign(b,A),b})}else{const p=wS(this.apiClient,e);return x=Re("{model}:batchEmbedContents",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=_S(_),b=new P1;return Object.assign(b,A),b})}}async generateImagesInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=DS(this.apiClient,e);return x=Re("{model}:predict",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=LS(_),b=new D1;return Object.assign(b,A),b})}else{const p=PS(this.apiClient,e);return x=Re("{model}:predict",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=OS(_),b=new D1;return Object.assign(b,A),b})}}async editImageInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=mS(this.apiClient,e);return l=Re("{model}:predict",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>{const p=yS(v),_=new A2;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=DA(this.apiClient,e);return l=Re("{model}:predict",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>{const p=OA(v),_=new T2;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=gA(this.apiClient,e);return l=Re("{model}:predict",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=mA(v),_=new I2;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=_A(this.apiClient,e);return l=Re("{model}:predict",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=CA(v),_=new b2;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=ZS(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>wf(_))}else{const p=QS(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>vf(_))}}async listInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=lA(this.apiClient,e);return x=Re("{models_url}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=cA(_),b=new O1;return Object.assign(b,A),b})}else{const p=aA(this.apiClient,e);return x=Re("{models_url}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=uA(_),b=new O1;return Object.assign(b,A),b})}}async update(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=kA(this.apiClient,e);return x=Re("{model}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>wf(_))}else{const p=MA(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>vf(_))}}async delete(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=fS(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=pS(_),b=new L1;return Object.assign(b,A),b})}else{const p=dS(this.apiClient,e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=hS(_),b=new L1;return Object.assign(b,A),b})}}async countTokens(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=lS(this.apiClient,e);return x=Re("{model}:countTokens",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=cS(_),b=new B1;return Object.assign(b,A),b})}else{const p=aS(this.apiClient,e);return x=Re("{model}:countTokens",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=uS(_),b=new B1;return Object.assign(b,A),b})}}async computeTokens(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=eS(this.apiClient,e);return l=Re("{model}:computeTokens",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>{const p=tS(v),_=new N2;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=GS(this.apiClient,e);return x=Re("{model}:predictLongRunning",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f.then(_=>{const A=VS(_),b=new Hu;return Object.assign(b,A),b})}else{const p=HS(this.apiClient,e);return x=Re("{model}:predictLongRunning",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f.then(_=>{const A=US(_),b=new Hu;return Object.assign(b,A),b})}}}class bT extends Li{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=v2(e);return x=Re("{operationName}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),f}else{const p=x2(e);return x=Re("{operationName}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json()),f}}async fetchPredictVideosOperationInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=d2(e);return l=Re("{resourceName}:fetchPredictOperation",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}function NT(n){const e={},t=y(n,["data"]);if(t!=null&&E(e,["data"],t),y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function RT(n){const e={},t=y(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>UT(l))),E(e,["parts"],a)}const i=y(n,["role"]);return i!=null&&E(e,["role"],i),e}function MT(n,e,t){const i={},a=y(e,["expireTime"]);t!==void 0&&a!=null&&E(t,["expireTime"],a);const l=y(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&E(t,["newSessionExpireTime"],l);const f=y(e,["uses"]);t!==void 0&&f!=null&&E(t,["uses"],f);const x=y(e,["liveConnectConstraints"]);t!==void 0&&x!=null&&E(t,["bidiGenerateContentSetup"],FT(n,x));const v=y(e,["lockAdditionalFields"]);return t!==void 0&&v!=null&&E(t,["fieldMask"],v),i}function kT(n,e){const t={},i=y(e,["config"]);return i!=null&&E(t,["config"],MT(n,i,t)),t}function PT(n){const e={};if(y(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=y(n,["fileUri"]);t!=null&&E(e,["fileUri"],t);const i=y(n,["mimeType"]);return i!=null&&E(e,["mimeType"],i),e}function DT(n){const e={},t=y(n,["id"]);t!=null&&E(e,["id"],t);const i=y(n,["args"]);i!=null&&E(e,["args"],i);const a=y(n,["name"]);if(a!=null&&E(e,["name"],a),y(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(y(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function OT(n){const e={};if(y(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=y(n,["enableWidget"]);return t!=null&&E(e,["enableWidget"],t),e}function LT(n){const e={};if(y(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(y(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=y(n,["timeRangeFilter"]);return t!=null&&E(e,["timeRangeFilter"],t),e}function BT(n,e){const t={},i=y(n,["generationConfig"]);e!==void 0&&i!=null&&E(e,["setup","generationConfig"],i);const a=y(n,["responseModalities"]);e!==void 0&&a!=null&&E(e,["setup","generationConfig","responseModalities"],a);const l=y(n,["temperature"]);e!==void 0&&l!=null&&E(e,["setup","generationConfig","temperature"],l);const f=y(n,["topP"]);e!==void 0&&f!=null&&E(e,["setup","generationConfig","topP"],f);const x=y(n,["topK"]);e!==void 0&&x!=null&&E(e,["setup","generationConfig","topK"],x);const v=y(n,["maxOutputTokens"]);e!==void 0&&v!=null&&E(e,["setup","generationConfig","maxOutputTokens"],v);const p=y(n,["mediaResolution"]);e!==void 0&&p!=null&&E(e,["setup","generationConfig","mediaResolution"],p);const _=y(n,["seed"]);e!==void 0&&_!=null&&E(e,["setup","generationConfig","seed"],_);const A=y(n,["speechConfig"]);e!==void 0&&A!=null&&E(e,["setup","generationConfig","speechConfig"],Xf(A));const b=y(n,["thinkingConfig"]);e!==void 0&&b!=null&&E(e,["setup","generationConfig","thinkingConfig"],b);const k=y(n,["enableAffectiveDialog"]);e!==void 0&&k!=null&&E(e,["setup","generationConfig","enableAffectiveDialog"],k);const O=y(n,["systemInstruction"]);e!==void 0&&O!=null&&E(e,["setup","systemInstruction"],RT(Yn(O)));const U=y(n,["tools"]);if(e!==void 0&&U!=null){let ue=Jo(U);Array.isArray(ue)&&(ue=ue.map(ee=>HT(Xo(ee)))),E(e,["setup","tools"],ue)}const F=y(n,["sessionResumption"]);e!==void 0&&F!=null&&E(e,["setup","sessionResumption"],VT(F));const W=y(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&E(e,["setup","inputAudioTranscription"],W);const $=y(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&E(e,["setup","outputAudioTranscription"],$);const G=y(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&E(e,["setup","realtimeInputConfig"],G);const J=y(n,["contextWindowCompression"]);e!==void 0&&J!=null&&E(e,["setup","contextWindowCompression"],J);const de=y(n,["proactivity"]);if(e!==void 0&&de!=null&&E(e,["setup","proactivity"],de),y(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function FT(n,e){const t={},i=y(e,["model"]);i!=null&&E(t,["setup","model"],wt(n,i));const a=y(e,["config"]);return a!=null&&E(t,["config"],BT(a,t)),t}function UT(n){const e={},t=y(n,["mediaResolution"]);t!=null&&E(e,["mediaResolution"],t);const i=y(n,["codeExecutionResult"]);i!=null&&E(e,["codeExecutionResult"],i);const a=y(n,["executableCode"]);a!=null&&E(e,["executableCode"],a);const l=y(n,["fileData"]);l!=null&&E(e,["fileData"],PT(l));const f=y(n,["functionCall"]);f!=null&&E(e,["functionCall"],DT(f));const x=y(n,["functionResponse"]);x!=null&&E(e,["functionResponse"],x);const v=y(n,["inlineData"]);v!=null&&E(e,["inlineData"],NT(v));const p=y(n,["text"]);p!=null&&E(e,["text"],p);const _=y(n,["thought"]);_!=null&&E(e,["thought"],_);const A=y(n,["thoughtSignature"]);A!=null&&E(e,["thoughtSignature"],A);const b=y(n,["videoMetadata"]);return b!=null&&E(e,["videoMetadata"],b),e}function VT(n){const e={},t=y(n,["handle"]);if(t!=null&&E(e,["handle"],t),y(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function HT(n){const e={},t=y(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(A=>A)),E(e,["functionDeclarations"],_)}if(y(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=y(n,["googleSearchRetrieval"]);i!=null&&E(e,["googleSearchRetrieval"],i);const a=y(n,["computerUse"]);a!=null&&E(e,["computerUse"],a);const l=y(n,["fileSearch"]);l!=null&&E(e,["fileSearch"],l);const f=y(n,["codeExecution"]);if(f!=null&&E(e,["codeExecution"],f),y(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const x=y(n,["googleMaps"]);x!=null&&E(e,["googleMaps"],OT(x));const v=y(n,["googleSearch"]);v!=null&&E(e,["googleSearch"],LT(v));const p=y(n,["urlContext"]);return p!=null&&E(e,["urlContext"],p),e}function GT(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const a=Object.keys(i).map(l=>`${t}.${l}`);e.push(...a)}else e.push(t)}return e.join(",")}function zT(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const a=n.fieldMask;if(t){const l=GT(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)l?n.fieldMask=l:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const f=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let x=[];a.length>0&&(x=a.map(p=>f.includes(p)?`generationConfig.${p}`:p));const v=[];l&&v.push(l),x.length>0&&v.push(...x),v.length>0?n.fieldMask=v.join(","):delete n.fieldMask}else delete n.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?n.fieldMask=a.join(","):delete n.fieldMask;return n}class jT extends Li{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const x=kT(this.apiClient,e);l=Re("auth_tokens",x._url),f=x._query,delete x.config,delete x._url,delete x._query;const v=zT(x,e.config);return a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(v),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),a.then(p=>p)}}}function qT(n,e){const t={},i=y(n,["force"]);return e!==void 0&&i!=null&&E(e,["_query","force"],i),t}function WT(n){const e={},t=y(n,["name"]);t!=null&&E(e,["_url","name"],t);const i=y(n,["config"]);return i!=null&&qT(i,e),e}function YT(n){const e={},t=y(n,["name"]);return t!=null&&E(e,["_url","name"],t),e}function $T(n,e){const t={},i=y(n,["pageSize"]);e!==void 0&&i!=null&&E(e,["_query","pageSize"],i);const a=y(n,["pageToken"]);return e!==void 0&&a!=null&&E(e,["_query","pageToken"],a),t}function KT(n){const e={},t=y(n,["parent"]);t!=null&&E(e,["_url","parent"],t);const i=y(n,["config"]);return i!=null&&$T(i,e),e}function XT(n){const e={},t=y(n,["sdkHttpResponse"]);t!=null&&E(e,["sdkHttpResponse"],t);const i=y(n,["nextPageToken"]);i!=null&&E(e,["nextPageToken"],i);const a=y(n,["documents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(f=>f)),E(e,["documents"],l)}return e}class JT extends Li{constructor(e){super(),this.apiClient=e,this.list=async t=>new eo(Di.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=YT(e);return l=Re("{name}",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>v)}}async delete(e){var t,i;let a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=WT(e);a=Re("{name}",f._url),l=f._query,delete f._url,delete f._query,await this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=KT(e);return l=Re("{parent}/documents",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=XT(v),_=new R2;return Object.assign(_,p),_})}}}class QT extends Li{constructor(e,t=new JT(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new eo(Di.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=GA(e);return l=Re("fileSearchStores",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>v)}}async get(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=qA(e);return l=Re("{name}",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>v)}}async delete(e){var t,i;let a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=jA(e);a=Re("{name}",f._url),l=f._query,delete f._url,delete f._query,await this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=JA(e);return l=Re("fileSearchStores",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=QA(v),_=new M2;return Object.assign(_,p),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=ZA(e);return l=Re("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=eT(v),_=new k2;return Object.assign(_,p),_})}}async importFile(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=$A(e);return l=Re("{file_search_store_name}:importFile",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),a.then(v=>{const p=YA(v),_=new qf;return Object.assign(_,p),_})}}}let by=function(){const{crypto:n}=globalThis;if(n?.randomUUID)return by=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const ZT=()=>by();function _f(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Cf=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class Hr extends Error{}class Zn extends Hr{constructor(e,t,i,a){super(`${Zn.makeMessage(e,t,i)}`),this.status=e,this.headers=a,this.error=t}static makeMessage(e,t,i){const a=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,t,i,a){if(!e||!a)return new oc({message:i,cause:Cf(t)});const l=t;return e===400?new Ry(e,l,i,a):e===401?new My(e,l,i,a):e===403?new ky(e,l,i,a):e===404?new Py(e,l,i,a):e===409?new Dy(e,l,i,a):e===422?new Oy(e,l,i,a):e===429?new Ly(e,l,i,a):e>=500?new By(e,l,i,a):new Zn(e,l,i,a)}}class Sf extends Zn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class oc extends Zn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ny extends oc{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Ry extends Zn{}class My extends Zn{}class ky extends Zn{}class Py extends Zn{}class Dy extends Zn{}class Oy extends Zn{}class Ly extends Zn{}class By extends Zn{}const eI=/^[a-z][a-z0-9+.-]*:/i,tI=n=>eI.test(n);let Af=n=>(Af=Array.isArray,Af(n));const nI=Af;let rI=nI;const sg=rI;function iI(n){if(!n)return!0;for(const e in n)return!1;return!0}function sI(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const oI=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Hr(`${n} must be an integer`);if(e<0)throw new Hr(`${n} must be a positive integer`);return e},aI=n=>{try{return JSON.parse(n)}catch{return}};const lI=n=>new Promise(e=>setTimeout(e,n));const Bo="0.0.1";function uI(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const cI=()=>{var n,e,t,i,a;const l=uI();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bo,"X-Stainless-OS":ag(Deno.build.os),"X-Stainless-Arch":og(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bo,"X-Stainless-OS":ag((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":og((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(a=globalThis.process.version)!==null&&a!==void 0?a:"unknown"};const f=dI();return f?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${f.browser}`,"X-Stainless-Runtime-Version":f.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Bo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function dI(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const a=i[1]||0,l=i[2]||0,f=i[3]||0;return{browser:e,version:`${a}.${l}.${f}`}}}return null}const og=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",ag=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let xu;const fI=()=>xu??(xu=cI());function hI(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Fy(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function pI(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Fy({start(){},async pull(t){const{done:i,value:a}=await e.next();i?t.close():t.enqueue(a)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Uy(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function gI(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),a=i.cancel();i.releaseLock(),await a}const mI=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const Vy=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function qd(n,e,t){return Vy(),new File(n,e??"unknown_file",t)}function yI(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const xI=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";const Hy=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",vI=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Hy(n),wI=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function EI(n,e,t){if(Vy(),n=await n,vI(n))return n instanceof File?n:qd([await n.arrayBuffer()],n.name);if(wI(n)){const a=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),qd(await Tf(a),e,t)}const i=await Tf(n);if(e||(e=yI(n)),!t?.type){const a=i.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof a=="string"&&(t=Object.assign(Object.assign({},t),{type:a}))}return qd(i,e,t)}async function Tf(n){var e,t,i,a,l;let f=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)f.push(n);else if(Hy(n))f.push(n instanceof Blob?n:await n.arrayBuffer());else if(xI(n))try{for(var x=!0,v=ni(n),p;p=await v.next(),e=p.done,!e;x=!0){a=p.value,x=!1;const _=a;f.push(...await Tf(_))}}catch(_){t={error:_}}finally{try{!x&&!e&&(i=v.return)&&await i.call(v)}finally{if(t)throw t.error}}else{const _=(l=n?.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${_?`; constructor: ${_}`:""}${_I(n)}`)}return f}function _I(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}class Gy{constructor(e){this._client=e}}Gy._key=[];function zy(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const lg=Object.freeze(Object.create(null)),CI=(n=zy)=>(function(t,...i){if(t.length===1)return t[0];let a=!1;const l=[],f=t.reduce((_,A,b)=>{var k,O,U;/[?#]/.test(A)&&(a=!0);const F=i[b];let W=(a?encodeURIComponent:n)(""+F);return b!==i.length&&(F==null||typeof F=="object"&&F.toString===((U=Object.getPrototypeOf((O=Object.getPrototypeOf((k=F.hasOwnProperty)!==null&&k!==void 0?k:lg))!==null&&O!==void 0?O:lg))===null||U===void 0?void 0:U.toString))&&(W=F+"",l.push({start:_.length+A.length,length:W.length,error:`Value of type ${Object.prototype.toString.call(F).slice(8,-1)} is not a valid path parameter`})),_+A+(b===i.length?"":W)},""),x=f.split(/[?#]/,1)[0],v=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=v.exec(x))!==null;)l.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(l.sort((_,A)=>_.start-A.start),l.length>0){let _=0;const A=l.reduce((b,k)=>{const O=" ".repeat(k.start-_),U="^".repeat(k.length);return _=k.start+k.length,b+O+U},"");throw new Hr(`Path parameters result in path with invalid segments:
${l.map(b=>b.error).join(`
`)}
${f}
${A}`)}return f}),vu=CI(zy);class jy extends Gy{create(e,t){var i;const{api_version:a=this._client.apiVersion}=e,l=zu(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new Hr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new Hr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(vu`/${a}/interactions`,Object.assign(Object.assign({body:l},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:a=this._client.apiVersion}=t??{};return this._client.delete(vu`/${a}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:a=this._client.apiVersion}=t??{};return this._client.post(vu`/${a}/interactions/${e}/cancel`,i)}get(e,t={},i){var a;const l=t??{},{api_version:f=this._client.apiVersion}=l,x=zu(l,["api_version"]);return this._client.get(vu`/${f}/interactions/${e}`,Object.assign(Object.assign({query:x},i),{stream:(a=t?.stream)!==null&&a!==void 0?a:!1}))}}jy._key=Object.freeze(["interactions"]);class qy extends jy{}function SI(n){let e=0;for(const a of n)e+=a.length;const t=new Uint8Array(e);let i=0;for(const a of n)t.set(a,i),i+=a.length;return t}let wu;function Qf(n){let e;return(wu??(e=new globalThis.TextEncoder,wu=e.encode.bind(e)))(n)}let Eu;function ug(n){let e;return(Eu??(e=new globalThis.TextDecoder,Eu=e.decode.bind(e)))(n)}class ac{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Qf(e):e;this.buffer=SI([this.buffer,t]);const i=[];let a;for(;(a=AI(this.buffer,this.carriageReturnIndex))!=null;){if(a.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=a.index;continue}if(this.carriageReturnIndex!=null&&(a.index!==this.carriageReturnIndex+1||a.carriage)){i.push(ug(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?a.preceding-1:a.preceding,f=ug(this.buffer.subarray(0,l));i.push(f),this.buffer=this.buffer.subarray(a.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}ac.NEWLINE_CHARS=new Set([`
`,"\r"]);ac.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function AI(n,e){for(let a=e??0;a<n.length;a++){if(n[a]===10)return{preceding:a,index:a+1,carriage:!1};if(n[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function TI(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}const ju={off:0,error:200,warn:300,info:400,debug:500},cg=(n,e,t)=>{if(n){if(sI(ju,n))return n;Jn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(ju))}`)}};function $a(){}function _u(n,e,t){return!e||ju[n]>ju[t]?$a:e[n].bind(e)}const II={error:$a,warn:$a,info:$a,debug:$a};let dg=new WeakMap;function Jn(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return II;const a=dg.get(t);if(a&&a[0]===i)return a[1];const l={error:_u("error",t,i),warn:_u("warn",t,i),info:_u("info",t,i),debug:_u("debug",t,i)};return dg.set(t,[i,l]),l}const Ks=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);class Uo{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let a=!1;const l=i?Jn(i):console;function f(){return ti(this,arguments,function*(){var v,p,_,A;if(a)throw new Hr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let b=!1;try{try{for(var k=!0,O=ni(bI(e,t)),U;U=yield it(O.next()),v=U.done,!v;k=!0){A=U.value,k=!1;const F=A;if(!b)if(F.data.startsWith("[DONE]")){b=!0;continue}else try{yield yield it(JSON.parse(F.data))}catch(W){throw l.error("Could not parse message into JSON:",F.data),l.error("From chunk:",F.raw),W}}}catch(F){p={error:F}}finally{try{!k&&!v&&(_=O.return)&&(yield it(_.call(O)))}finally{if(p)throw p.error}}b=!0}catch(F){if(_f(F))return yield it(void 0);throw F}finally{b||t.abort()}})}return new Uo(f,t,i)}static fromReadableStream(e,t,i){let a=!1;function l(){return ti(this,arguments,function*(){var v,p,_,A;const b=new ac,k=Uy(e);try{for(var O=!0,U=ni(k),F;F=yield it(U.next()),v=F.done,!v;O=!0){A=F.value,O=!1;const W=A;for(const $ of b.decode(W))yield yield it($)}}catch(W){p={error:W}}finally{try{!O&&!v&&(_=U.return)&&(yield it(_.call(U)))}finally{if(p)throw p.error}}for(const W of b.flush())yield yield it(W)})}function f(){return ti(this,arguments,function*(){var v,p,_,A;if(a)throw new Hr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let b=!1;try{try{for(var k=!0,O=ni(l()),U;U=yield it(O.next()),v=U.done,!v;k=!0){A=U.value,k=!1;const F=A;b||F&&(yield yield it(JSON.parse(F)))}}catch(F){p={error:F}}finally{try{!k&&!v&&(_=O.return)&&(yield it(_.call(O)))}finally{if(p)throw p.error}}b=!0}catch(F){if(_f(F))return yield it(void 0);throw F}finally{b||t.abort()}})}return new Uo(f,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),a=l=>({next:()=>{if(l.length===0){const f=i.next();e.push(f),t.push(f)}return l.shift()}});return[new Uo(()=>a(e),this.controller,this.client),new Uo(()=>a(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Fy({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:l}=await t.next();if(l)return i.close();const f=Qf(JSON.stringify(a)+`
`);i.enqueue(f)}catch(a){i.error(a)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function bI(n,e){return ti(this,arguments,function*(){var i,a,l,f;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Hr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Hr("Attempted to iterate over a response with no body");const x=new RI,v=new ac,p=Uy(n.body);try{for(var _=!0,A=ni(NI(p)),b;b=yield it(A.next()),i=b.done,!i;_=!0){f=b.value,_=!1;const k=f;for(const O of v.decode(k)){const U=x.decode(O);U&&(yield yield it(U))}}}catch(k){a={error:k}}finally{try{!_&&!i&&(l=A.return)&&(yield it(l.call(A)))}finally{if(a)throw a.error}}for(const k of v.flush()){const O=x.decode(k);O&&(yield yield it(O))}})}function NI(n){return ti(this,arguments,function*(){var t,i,a,l;let f=new Uint8Array;try{for(var x=!0,v=ni(n),p;p=yield it(v.next()),t=p.done,!t;x=!0){l=p.value,x=!1;const _=l;if(_==null)continue;const A=_ instanceof ArrayBuffer?new Uint8Array(_):typeof _=="string"?Qf(_):_;let b=new Uint8Array(f.length+A.length);b.set(f),b.set(A,f.length),f=b;let k;for(;(k=TI(f))!==-1;)yield yield it(f.slice(0,k)),f=f.slice(k)}}catch(_){i={error:_}}finally{try{!x&&!t&&(a=v.return)&&(yield it(a.call(v)))}finally{if(i)throw i.error}}f.length>0&&(yield yield it(f))})}class RI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,a]=MI(e,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function MI(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function kI(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:a,startTime:l}=e,f=await(async()=>{var x;if(e.options.stream)return Jn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Uo.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const v=t.headers.get("content-type"),p=(x=v?.split(";")[0])===null||x===void 0?void 0:x.trim();return p?.includes("application/json")||p?.endsWith("+json")?await t.json():await t.text()})();return Jn(n).debug(`[${i}] response parsed`,Ks({retryOfRequestLogID:a,url:t.url,status:t.status,body:f,durationMs:Date.now()-l})),f}class Zf extends Promise{constructor(e,t,i=kI){super(a=>{a(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new Zf(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const Wy=Symbol("brand.privateNullableHeaders");function*PI(n){if(!n)return;if(Wy in n){const{values:i,nulls:a}=n;yield*i.entries();for(const l of a)yield[l,null];return}let e=!1,t;n instanceof Headers?t=n.entries():sg(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const a=i[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const l=sg(i[1])?i[1]:[i[1]];let f=!1;for(const x of l)x!==void 0&&(e&&!f&&(f=!0,yield[a,null]),yield[a,x])}}const Wd=n=>{const e=new Headers,t=new Set;for(const i of n){const a=new Set;for(const[l,f]of PI(i)){const x=l.toLowerCase();a.has(x)||(e.delete(l),a.add(x)),f===null?(e.delete(l),t.add(x)):(e.append(l,f),t.delete(x))}}return{[Wy]:!0,values:e,nulls:t}};const Yd=n=>{var e,t,i,a,l,f;if(typeof globalThis.process<"u")return(i=(t=(e=s2)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(f=(l=(a=globalThis.Deno.env)===null||a===void 0?void 0:a.get)===null||l===void 0?void 0:l.call(a,n))===null||f===void 0?void 0:f.trim()};var Yy;class lc{constructor(e){var t,i,a,l,f,x,v,p=e===void 0?{}:e,{baseURL:_=Yd("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:A=(t=Yd("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:b="v1beta"}=p,k=zu(p,["baseURL","apiKey","apiVersion"]);const O=Object.assign(Object.assign({apiKey:A,apiVersion:b},k),{baseURL:_||"https://generativelanguage.googleapis.com"});this.baseURL=O.baseURL,this.timeout=(i=O.timeout)!==null&&i!==void 0?i:lc.DEFAULT_TIMEOUT,this.logger=(a=O.logger)!==null&&a!==void 0?a:console;const U="warn";this.logLevel=U,this.logLevel=(f=(l=cg(O.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:cg(Yd("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&f!==void 0?f:U,this.fetchOptions=O.fetchOptions,this.maxRetries=(x=O.maxRetries)!==null&&x!==void 0?x:2,this.fetch=(v=O.fetch)!==null&&v!==void 0?v:hI(),this.encoder=mI,this._options=O,this.apiKey=A,this.apiVersion=b}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){if(this.apiKey!=null)return Wd([{"x-goog-api-key":this.apiKey}])}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new Hr(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Bo}`}defaultIdempotencyKey(){return`stainless-node-retry-${ZT()}`}makeStatusError(e,t,i,a){return Zn.generate(e,t,i,a)}buildURL(e,t,i){const a=!this.baseURLOverridden()&&i||this.baseURL,l=tI(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),f=this.defaultQuery();return iI(f)||(t=Object.assign(Object.assign({},f),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(l.search=this.stringifyQuery(t)),l.toString()}async prepareOptions(e){}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(a=>Object.assign({method:e,path:t},a)))}request(e,t=null){return new Zf(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var a,l,f;const x=await e,v=(a=x.maxRetries)!==null&&a!==void 0?a:this.maxRetries;t==null&&(t=v),await this.prepareOptions(x);const{req:p,url:_,timeout:A}=await this.buildRequest(x,{retryCount:v-t});await this.prepareRequest(p,{url:_,options:x});const b="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),k=i===void 0?"":`, retryOf: ${i}`,O=Date.now();if(Jn(this).debug(`[${b}] sending request`,Ks({retryOfRequestLogID:i,method:x.method,url:_,options:x,headers:p.headers})),!((l=x.signal)===null||l===void 0)&&l.aborted)throw new Sf;const U=new AbortController,F=await this.fetchWithTimeout(_,p,A,U).catch(Cf),W=Date.now();if(F instanceof globalThis.Error){const G=`retrying, ${t} attempts remaining`;if(!((f=x.signal)===null||f===void 0)&&f.aborted)throw new Sf;const J=_f(F)||/timed? ?out/i.test(String(F)+("cause"in F?String(F.cause):""));if(t)return Jn(this).info(`[${b}] connection ${J?"timed out":"failed"} - ${G}`),Jn(this).debug(`[${b}] connection ${J?"timed out":"failed"} (${G})`,Ks({retryOfRequestLogID:i,url:_,durationMs:W-O,message:F.message})),this.retryRequest(x,t,i??b);throw Jn(this).info(`[${b}] connection ${J?"timed out":"failed"} - error; no more retries left`),Jn(this).debug(`[${b}] connection ${J?"timed out":"failed"} (error; no more retries left)`,Ks({retryOfRequestLogID:i,url:_,durationMs:W-O,message:F.message})),J?new Ny:new oc({cause:F})}const $=`[${b}${k}] ${p.method} ${_} ${F.ok?"succeeded":"failed"} with status ${F.status} in ${W-O}ms`;if(!F.ok){const G=await this.shouldRetry(F);if(t&&G){const Z=`retrying, ${t} attempts remaining`;return await gI(F.body),Jn(this).info(`${$} - ${Z}`),Jn(this).debug(`[${b}] response error (${Z})`,Ks({retryOfRequestLogID:i,url:F.url,status:F.status,headers:F.headers,durationMs:W-O})),this.retryRequest(x,t,i??b,F.headers)}const J=G?"error; no more retries left":"error; not retryable";Jn(this).info(`${$} - ${J}`);const de=await F.text().catch(Z=>Cf(Z).message),ue=aI(de),ee=ue?void 0:de;throw Jn(this).debug(`[${b}] response error (${J})`,Ks({retryOfRequestLogID:i,url:F.url,status:F.status,headers:F.headers,message:ee,durationMs:Date.now()-O})),this.makeStatusError(F.status,ue,ee,F.headers)}return Jn(this).info($),Jn(this).debug(`[${b}] response start`,Ks({retryOfRequestLogID:i,url:F.url,status:F.status,headers:F.headers,durationMs:W-O})),{response:F,options:x,controller:U,requestLogID:b,retryOfRequestLogID:i,startTime:O}}async fetchWithTimeout(e,t,i,a){const l=t||{},{signal:f,method:x}=l,v=zu(l,["signal","method"]);f&&f.addEventListener("abort",()=>a.abort());const p=setTimeout(()=>a.abort(),i),_=globalThis.ReadableStream&&v.body instanceof globalThis.ReadableStream||typeof v.body=="object"&&v.body!==null&&Symbol.asyncIterator in v.body,A=Object.assign(Object.assign(Object.assign({signal:a.signal},_?{duplex:"half"}:{}),{method:"GET"}),v);x&&(A.method=x.toUpperCase());try{return await this.fetch.call(void 0,e,A)}finally{clearTimeout(p)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,a){var l;let f;const x=a?.get("retry-after-ms");if(x){const p=parseFloat(x);Number.isNaN(p)||(f=p)}const v=a?.get("retry-after");if(v&&!f){const p=parseFloat(v);Number.isNaN(p)?f=Date.parse(v)-Date.now():f=p*1e3}if(!(f&&0<=f&&f<60*1e3)){const p=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(t,p)}return await lI(f),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const l=t-e,f=Math.min(.5*Math.pow(2,l),8),x=1-Math.random()*.25;return f*x*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,a,l;const f=Object.assign({},e),{method:x,path:v,query:p,defaultBaseURL:_}=f,A=this.buildURL(v,p,_);"timeout"in f&&oI("timeout",f.timeout),f.timeout=(i=f.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:b,body:k}=this.buildBody({options:f}),O=await this.buildHeaders({options:e,method:x,bodyHeaders:b,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:x,headers:O},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&k instanceof globalThis.ReadableStream&&{duplex:"half"}),k&&{body:k}),(a=this.fetchOptions)!==null&&a!==void 0?a:{}),(l=f.fetchOptions)!==null&&l!==void 0?l:{}),url:A,timeout:f.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:a}){let l={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const f=Wd([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),fI()),await this.authHeaders(e),this._options.defaultHeaders,i,e.headers]);return this.validateHeaders(f),f.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=Wd([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:pI(e)}:this.encoder({body:e,headers:i})}}lc.DEFAULT_TIMEOUT=6e4;class Nn extends lc{constructor(){super(...arguments),this.interactions=new qy(this)}}Yy=Nn;Nn.GeminiNextGenAPIClient=Yy;Nn.GeminiNextGenAPIClientError=Hr;Nn.APIError=Zn;Nn.APIConnectionError=oc;Nn.APIConnectionTimeoutError=Ny;Nn.APIUserAbortError=Sf;Nn.NotFoundError=Py;Nn.ConflictError=Dy;Nn.RateLimitError=Ly;Nn.BadRequestError=Ry;Nn.AuthenticationError=My;Nn.InternalServerError=By;Nn.PermissionDeniedError=ky;Nn.UnprocessableEntityError=Oy;Nn.toFile=EI;Nn.Interactions=qy;function DI(n,e){const t={},i=y(n,["name"]);return i!=null&&E(t,["_url","name"],i),t}function OI(n,e){const t={},i=y(n,["name"]);return i!=null&&E(t,["_url","name"],i),t}function LI(n,e){const t={},i=y(n,["sdkHttpResponse"]);return i!=null&&E(t,["sdkHttpResponse"],i),t}function BI(n,e){const t={},i=y(n,["sdkHttpResponse"]);return i!=null&&E(t,["sdkHttpResponse"],i),t}function FI(n,e,t){const i={};if(y(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=y(n,["tunedModelDisplayName"]);if(e!==void 0&&a!=null&&E(e,["displayName"],a),y(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=y(n,["epochCount"]);e!==void 0&&l!=null&&E(e,["tuningTask","hyperparameters","epochCount"],l);const f=y(n,["learningRateMultiplier"]);if(f!=null&&E(i,["tuningTask","hyperparameters","learningRateMultiplier"],f),y(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(y(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(y(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const x=y(n,["batchSize"]);e!==void 0&&x!=null&&E(e,["tuningTask","hyperparameters","batchSize"],x);const v=y(n,["learningRate"]);if(e!==void 0&&v!=null&&E(e,["tuningTask","hyperparameters","learningRate"],v),y(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(y(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function UI(n,e,t){const i={};let a=y(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const k=y(n,["validationDataset"]);e!==void 0&&k!=null&&E(e,["supervisedTuningSpec"],fg(k))}else if(a==="PREFERENCE_TUNING"){const k=y(n,["validationDataset"]);e!==void 0&&k!=null&&E(e,["preferenceOptimizationSpec"],fg(k))}const l=y(n,["tunedModelDisplayName"]);e!==void 0&&l!=null&&E(e,["tunedModelDisplayName"],l);const f=y(n,["description"]);e!==void 0&&f!=null&&E(e,["description"],f);let x=y(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const k=y(n,["epochCount"]);e!==void 0&&k!=null&&E(e,["supervisedTuningSpec","hyperParameters","epochCount"],k)}else if(x==="PREFERENCE_TUNING"){const k=y(n,["epochCount"]);e!==void 0&&k!=null&&E(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],k)}let v=y(t,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const k=y(n,["learningRateMultiplier"]);e!==void 0&&k!=null&&E(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],k)}else if(v==="PREFERENCE_TUNING"){const k=y(n,["learningRateMultiplier"]);e!==void 0&&k!=null&&E(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],k)}let p=y(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const k=y(n,["exportLastCheckpointOnly"]);e!==void 0&&k!=null&&E(e,["supervisedTuningSpec","exportLastCheckpointOnly"],k)}else if(p==="PREFERENCE_TUNING"){const k=y(n,["exportLastCheckpointOnly"]);e!==void 0&&k!=null&&E(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],k)}let _=y(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const k=y(n,["adapterSize"]);e!==void 0&&k!=null&&E(e,["supervisedTuningSpec","hyperParameters","adapterSize"],k)}else if(_==="PREFERENCE_TUNING"){const k=y(n,["adapterSize"]);e!==void 0&&k!=null&&E(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],k)}if(y(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(y(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const A=y(n,["labels"]);e!==void 0&&A!=null&&E(e,["labels"],A);const b=y(n,["beta"]);return e!==void 0&&b!=null&&E(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),i}function VI(n,e){const t={},i=y(n,["baseModel"]);i!=null&&E(t,["baseModel"],i);const a=y(n,["preTunedModel"]);a!=null&&E(t,["preTunedModel"],a);const l=y(n,["trainingDataset"]);l!=null&&JI(l);const f=y(n,["config"]);return f!=null&&FI(f,t),t}function HI(n,e){const t={},i=y(n,["baseModel"]);i!=null&&E(t,["baseModel"],i);const a=y(n,["preTunedModel"]);a!=null&&E(t,["preTunedModel"],a);const l=y(n,["trainingDataset"]);l!=null&&QI(l,t,e);const f=y(n,["config"]);return f!=null&&UI(f,t,e),t}function GI(n,e){const t={},i=y(n,["name"]);return i!=null&&E(t,["_url","name"],i),t}function zI(n,e){const t={},i=y(n,["name"]);return i!=null&&E(t,["_url","name"],i),t}function jI(n,e,t){const i={},a=y(n,["pageSize"]);e!==void 0&&a!=null&&E(e,["_query","pageSize"],a);const l=y(n,["pageToken"]);e!==void 0&&l!=null&&E(e,["_query","pageToken"],l);const f=y(n,["filter"]);return e!==void 0&&f!=null&&E(e,["_query","filter"],f),i}function qI(n,e,t){const i={},a=y(n,["pageSize"]);e!==void 0&&a!=null&&E(e,["_query","pageSize"],a);const l=y(n,["pageToken"]);e!==void 0&&l!=null&&E(e,["_query","pageToken"],l);const f=y(n,["filter"]);return e!==void 0&&f!=null&&E(e,["_query","filter"],f),i}function WI(n,e){const t={},i=y(n,["config"]);return i!=null&&jI(i,t),t}function YI(n,e){const t={},i=y(n,["config"]);return i!=null&&qI(i,t),t}function $I(n,e){const t={},i=y(n,["sdkHttpResponse"]);i!=null&&E(t,["sdkHttpResponse"],i);const a=y(n,["nextPageToken"]);a!=null&&E(t,["nextPageToken"],a);const l=y(n,["tunedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(x=>$y(x))),E(t,["tuningJobs"],f)}return t}function KI(n,e){const t={},i=y(n,["sdkHttpResponse"]);i!=null&&E(t,["sdkHttpResponse"],i);const a=y(n,["nextPageToken"]);a!=null&&E(t,["nextPageToken"],a);const l=y(n,["tuningJobs"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(x=>If(x))),E(t,["tuningJobs"],f)}return t}function XI(n,e){const t={},i=y(n,["name"]);i!=null&&E(t,["model"],i);const a=y(n,["name"]);return a!=null&&E(t,["endpoint"],a),t}function JI(n,e){const t={};if(y(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(y(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=y(n,["examples"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),E(t,["examples","examples"],a)}return t}function QI(n,e,t){const i={};let a=y(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const f=y(n,["gcsUri"]);e!==void 0&&f!=null&&E(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(a==="PREFERENCE_TUNING"){const f=y(n,["gcsUri"]);e!==void 0&&f!=null&&E(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}let l=y(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const f=y(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&E(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(l==="PREFERENCE_TUNING"){const f=y(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&E(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}if(y(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function $y(n,e){const t={},i=y(n,["sdkHttpResponse"]);i!=null&&E(t,["sdkHttpResponse"],i);const a=y(n,["name"]);a!=null&&E(t,["name"],a);const l=y(n,["state"]);l!=null&&E(t,["state"],ly(l));const f=y(n,["createTime"]);f!=null&&E(t,["createTime"],f);const x=y(n,["tuningTask","startTime"]);x!=null&&E(t,["startTime"],x);const v=y(n,["tuningTask","completeTime"]);v!=null&&E(t,["endTime"],v);const p=y(n,["updateTime"]);p!=null&&E(t,["updateTime"],p);const _=y(n,["description"]);_!=null&&E(t,["description"],_);const A=y(n,["baseModel"]);A!=null&&E(t,["baseModel"],A);const b=y(n,["_self"]);return b!=null&&E(t,["tunedModel"],XI(b)),t}function If(n,e){const t={},i=y(n,["sdkHttpResponse"]);i!=null&&E(t,["sdkHttpResponse"],i);const a=y(n,["name"]);a!=null&&E(t,["name"],a);const l=y(n,["state"]);l!=null&&E(t,["state"],ly(l));const f=y(n,["createTime"]);f!=null&&E(t,["createTime"],f);const x=y(n,["startTime"]);x!=null&&E(t,["startTime"],x);const v=y(n,["endTime"]);v!=null&&E(t,["endTime"],v);const p=y(n,["updateTime"]);p!=null&&E(t,["updateTime"],p);const _=y(n,["error"]);_!=null&&E(t,["error"],_);const A=y(n,["description"]);A!=null&&E(t,["description"],A);const b=y(n,["baseModel"]);b!=null&&E(t,["baseModel"],b);const k=y(n,["tunedModel"]);k!=null&&E(t,["tunedModel"],k);const O=y(n,["preTunedModel"]);O!=null&&E(t,["preTunedModel"],O);const U=y(n,["supervisedTuningSpec"]);U!=null&&E(t,["supervisedTuningSpec"],U);const F=y(n,["preferenceOptimizationSpec"]);F!=null&&E(t,["preferenceOptimizationSpec"],F);const W=y(n,["tuningDataStats"]);W!=null&&E(t,["tuningDataStats"],W);const $=y(n,["encryptionSpec"]);$!=null&&E(t,["encryptionSpec"],$);const G=y(n,["partnerModelTuningSpec"]);G!=null&&E(t,["partnerModelTuningSpec"],G);const J=y(n,["customBaseModel"]);J!=null&&E(t,["customBaseModel"],J);const de=y(n,["experiment"]);de!=null&&E(t,["experiment"],de);const ue=y(n,["labels"]);ue!=null&&E(t,["labels"],ue);const ee=y(n,["outputUri"]);ee!=null&&E(t,["outputUri"],ee);const Te=y(n,["pipelineJob"]);Te!=null&&E(t,["pipelineJob"],Te);const Z=y(n,["serviceAccount"]);Z!=null&&E(t,["serviceAccount"],Z);const Se=y(n,["tunedModelDisplayName"]);Se!=null&&E(t,["tunedModelDisplayName"],Se);const Pe=y(n,["veoTuningSpec"]);return Pe!=null&&E(t,["veoTuningSpec"],Pe),t}function ZI(n,e){const t={},i=y(n,["sdkHttpResponse"]);i!=null&&E(t,["sdkHttpResponse"],i);const a=y(n,["name"]);a!=null&&E(t,["name"],a);const l=y(n,["metadata"]);l!=null&&E(t,["metadata"],l);const f=y(n,["done"]);f!=null&&E(t,["done"],f);const x=y(n,["error"]);return x!=null&&E(t,["error"],x),t}function fg(n,e){const t={},i=y(n,["gcsUri"]);i!=null&&E(t,["validationDatasetUri"],i);const a=y(n,["vertexDatasetResource"]);return a!=null&&E(t,["validationDatasetUri"],a),t}class eb extends Li{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new eo(Di.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const a={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(a.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:a});return l.baseModel=void 0,await this.tuneInternal(l)}else{const a=Object.assign({},t);return await this.tuneInternal(a)}else{const a=Object.assign({},t),l=await this.tuneMldevInternal(a);let f="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?f=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(f=l.name.split("/operations/")[0]),{name:f,state:gf.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=zI(e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>If(_))}else{const p=GI(e);return x=Re("{name}",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>$y(_))}}async listInternal(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=YI(e);return x=Re("tuningJobs",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=KI(_),b=new F1;return Object.assign(b,A),b})}else{const p=WI(e);return x=Re("tunedModels",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=$I(_),b=new F1;return Object.assign(b,A),b})}}async cancel(e){var t,i,a,l;let f,x="",v={};if(this.apiClient.isVertexAI()){const p=OI(e);return x=Re("{name}:cancel",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=BI(_),b=new U1;return Object.assign(b,A),b})}else{const p=DI(e);return x=Re("{name}:cancel",p._url),v=p._query,delete p._url,delete p._query,f=this.apiClient.request({path:x,queryParams:v,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(_=>_.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:_.headers},b})),f.then(_=>{const A=LI(_),b=new U1;return Object.assign(b,A),b})}}async tuneInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI()){const x=HI(e,e);return l=Re("tuningJobs",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>If(v))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let a,l="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const x=VI(e);return l=Re("tunedModels",x._url),f=x._query,delete x._url,delete x._query,a=this.apiClient.request({path:l,queryParams:f,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:v.headers},_})),a.then(v=>ZI(v))}}}class tb{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const nb=1024*1024*8,rb=3,ib=1e3,sb=2,qu="x-goog-upload-status";async function ob(n,e,t){var i;const a=await Ky(n,e,t),l=await a?.json();if(((i=a?.headers)===null||i===void 0?void 0:i[qu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return l.file}async function ab(n,e,t){var i;const a=await Ky(n,e,t),l=await a?.json();if(((i=a?.headers)===null||i===void 0?void 0:i[qu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const f=ny(l),x=new Wf;return Object.assign(x,f),x}async function Ky(n,e,t){var i,a;let l=0,f=0,x=new mf(new Response),v="upload";for(l=n.size;f<l;){const p=Math.min(nb,l-f),_=n.slice(f,f+p);f+p>=l&&(v+=", finalize");let A=0,b=ib;for(;A<rb&&(x=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":String(f),"Content-Length":String(p)}}}),!(!((i=x?.headers)===null||i===void 0)&&i[qu]));)A++,await ub(b),b=b*sb;if(f+=p,((a=x?.headers)===null||a===void 0?void 0:a[qu])!=="active")break;if(l<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return x}async function lb(n){return{size:n.size,type:n.type}}function ub(n){return new Promise(e=>setTimeout(e,n))}class cb{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ob(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ab(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lb(e)}}class db{create(e,t,i){return new fb(e,t,i)}}class fb{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const hg="x-goog-api-key";class hb{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(hg)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(hg,this.apiKey)}}}const pb="gl-node/";class gb{get interactions(){if(this._interactions!==void 0)return this._interactions;if(console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions."),this.vertexai)throw new Error("This version of the GenAI SDK does not support Vertex AI API for interactions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Nn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=u2(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const a=new hb(this.apiKey);this.apiClient=new lT({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:pb+"web",uploader:new cb,downloader:new tb}),this.models=new IT(this.apiClient),this.live=new ET(this.apiClient,a,new db),this.batches=new F_(this.apiClient),this.chats=new vC(this.models,this.apiClient),this.caches=new mC(this.apiClient),this.files=new NC(this.apiClient),this.operations=new bT(this.apiClient),this.authTokens=new jT(this.apiClient),this.tunings=new eb(this.apiClient),this.fileSearchStores=new QT(this.apiClient)}}const mb={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_GEMINI_API_KEY:"",VITE_SUPABASE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1hYmpsaGpsa2VlaGFjenhyZ2N5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4Mzg5MDMsImV4cCI6MjA4MTQxNDkwM30.eHuUAZMQ9eGffxCwYwOczhzZuRksv41QoUaIulebpT4",VITE_SUPABASE_URL:"https://mabjlhjlkeehaczxrgcy.supabase.co"},yb=()=>{},pg=yb();let bf=null;if(pg)try{bf=new gb({apiKey:pg})}catch(n){console.error("Error initializing Gemini:",n)}else console.warn("VITE_GEMINI_API_KEY no encontrada. El chat funcionar en modo DEMO.");const xb=async(n,e)=>{if(!bf)return await new Promise(l=>setTimeout(l,800)),n.toLowerCase().includes("precio")||n.toLowerCase().includes("valor")?"Nuestros cortes parten desde $19.990. Los decants de perfumes tienen precios variados, por ejemplo Good Girl 5ml a $8.990. Te gustara ver el catlogo completo?":n.toLowerCase().includes("domicilio")||n.toLowerCase().includes("casa")?"S! Vamos a tu domicilio en Santiago Centro y uoa por un recargo de $3.000 adicional. Llevamos todo lo necesario para tu cambio de look.":n.toLowerCase().includes("hola")||n.toLowerCase().includes("buenos")?"Hola! Bienvenid@ a Tus3B Style. Soy tu asistente virtual (Modo Demo). Puedo ayudarte con precios, zonas de cobertura y recomendaciones de perfumes.":"Gracias por tu mensaje. Como estoy en Modo Demo (sin API Key configurada), mis respuestas son limitadas. Te sugiero contactarnos directamente por WhatsApp para una atencin personalizada.";const t=Kd.map(l=>`- ${l.brand} ${l.name}: ${l.description}. Notas: ${l.notes.join(", ")}. Precio 5ml: ${l.price5ml}, 10ml: ${l.price10ml}.`).join(`
`),i=ja.map(l=>`- ${l.name}: ${l.description}. Precio: ${l.price}. Incluye: ${l.includes.join(", ")}.`).join(`
`),a=`
    Eres "StyleBot", un asistente experto en belleza y perfumera para la tienda "Tus3B Style" en Chile.
    
    Tus objetivos:
    1. Recomendar perfumes de nuestro catlogo basndote en los gustos del usuario (dulce, fresco, para noche, etc).
    2. Informar sobre nuestro servicio de corte y brushing ($19.990) y el recargo a domicilio ($3.000 para Santiago/uoa).
    
    Contexto del Catlogo de Perfumes:
    ${t}

    Contexto de Servicios de Peluquera:
    ${i}

    Reglas:
    - S amable, sofisticado pero cercano.
    - Responde en espaol de Chile.
    - Si te preguntan por un perfume que NO est en la lista, di amablemente que no lo tienes pero sugiere uno similar del catlogo.
    - Mantn las respuestas breves (mximo 3 oraciones).
    - Anima al usuario a reservar o comprar.
  `;try{return(await bf.models.generateContent({model:"gemini-1.5-flash",contents:[{role:"user",parts:[{text:a+`

 Historial de chat:
`+e.join(`
`)+`

Usuario: `+n}]}]})).text||"Lo siento, no pude procesar tu solicitud."}catch(l){return console.error("Error calling Gemini:",l),"Hubo un error al conectar con el asistente. Por favor intenta ms tarde."}},vb=()=>{const[n,e]=Je.useState(!1),[t,i]=Je.useState([{role:"bot",text:"Hola! Soy tu asistente de estilo. Buscas un perfume especial o tienes dudas sobre el corte a domicilio?"}]),[a,l]=Je.useState(""),[f,x]=Je.useState(!1),v=Je.useRef(null),p=()=>{v.current?.scrollIntoView({behavior:"smooth"})};Je.useEffect(()=>{p()},[t,n]);const _=async()=>{if(!a.trim()||f)return;const b=a;i(U=>[...U,{role:"user",text:b}]),l(""),x(!0);const k=t.map(U=>`${U.role==="user"?"Usuario":"Bot"}: ${U.text}`),O=await xb(b,k);i(U=>[...U,{role:"bot",text:O}]),x(!1)},A=b=>{b.key==="Enter"&&_()};return M.jsxs(M.Fragment,{children:[M.jsx("button",{onClick:()=>e(!n),className:`fixed bottom-6 right-6 z-50 p-4 rounded-full shadow-2xl transition-all duration-300 hover:scale-110 flex items-center justify-center ${n?"bg-stone-800 rotate-90":"bg-stone-900 rotate-0"}`,children:n?M.jsx(Ju,{color:"white"}):M.jsx($d,{color:"white"})}),n&&M.jsxs("div",{className:"fixed bottom-24 right-6 w-80 sm:w-96 bg-white rounded-2xl shadow-2xl border border-stone-200 z-50 flex flex-col overflow-hidden animate-in slide-in-from-bottom-10 fade-in duration-300 h-[500px]",children:[M.jsxs("div",{className:"bg-stone-900 p-4 flex items-center space-x-3",children:[M.jsx("div",{className:"bg-stone-700 p-2 rounded-full",children:M.jsx($d,{size:16,className:"text-yellow-400"})}),M.jsxs("div",{children:[M.jsx("h3",{className:"text-white font-serif font-bold",children:"Asistente Tus3B"}),M.jsx("p",{className:"text-stone-400 text-xs",children:"Te ayudo a elegir tu estilo"})]})]}),M.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-stone-50",children:[t.map((b,k)=>M.jsx("div",{className:`flex ${b.role==="user"?"justify-end":"justify-start"}`,children:M.jsx("div",{className:`max-w-[80%] p-3 rounded-2xl text-sm ${b.role==="user"?"bg-stone-800 text-white rounded-br-none":"bg-white text-stone-800 border border-stone-200 rounded-bl-none shadow-sm"}`,children:b.text})},k)),f&&M.jsx("div",{className:"flex justify-start",children:M.jsxs("div",{className:"bg-white p-3 rounded-2xl rounded-bl-none border border-stone-200 shadow-sm flex items-center space-x-2",children:[M.jsx(Nu,{size:16,className:"animate-spin text-stone-400"}),M.jsx("span",{className:"text-xs text-stone-400",children:"Escribiendo..."})]})}),M.jsx("div",{ref:v})]}),M.jsxs("div",{className:"p-3 bg-white border-t border-stone-100 flex items-center gap-2",children:[M.jsx("input",{type:"text",value:a,onChange:b=>l(b.target.value),onKeyDown:A,placeholder:"Pregunta por perfumes o cortes...",className:"flex-1 text-sm border-none focus:ring-0 bg-stone-100 rounded-full px-4 py-2 text-stone-800 placeholder-stone-400"}),M.jsx("button",{onClick:_,disabled:f||!a.trim(),className:"p-2 bg-stone-900 text-white rounded-full hover:bg-stone-700 disabled:opacity-50 transition",children:M.jsx(Dv,{size:16})})]})]})]})},wb=({isHomeService:n,onGoHome:e,onGoCatalog:t})=>(Je.useEffect(()=>{window.scrollTo(0,0)},[]),M.jsx("div",{className:"min-h-[70vh] flex items-center justify-center p-4 fade-in",children:M.jsxs("div",{className:"bg-white p-8 md:p-12 rounded-3xl shadow-2xl border border-stone-100 max-w-2xl w-full text-center relative overflow-hidden",children:[M.jsx("div",{className:"absolute -top-20 -right-20 w-64 h-64 bg-green-50 rounded-full opacity-50 blur-3xl pointer-events-none"}),M.jsx("div",{className:"absolute -bottom-20 -left-20 w-64 h-64 bg-amber-50 rounded-full opacity-50 blur-3xl pointer-events-none"}),M.jsxs("div",{className:"relative z-10",children:[M.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-green-100 text-green-600 rounded-full mb-6 shadow-sm animate-in zoom-in spin-in-12 duration-700",children:M.jsx(Pg,{size:40,strokeWidth:2.5})}),M.jsx("h2",{className:"serif text-4xl text-stone-900 mb-3",children:"Reserva Confirmada!"}),M.jsx("p",{className:"text-xl text-stone-600 font-light mb-8",children:"Gracias por tu confianza!"}),!n&&M.jsxs("div",{className:"bg-stone-50 p-6 rounded-2xl mb-8 border border-stone-100 transform transition hover:scale-105 duration-300",children:[M.jsxs("h3",{className:"text-xs font-bold text-stone-400 uppercase tracking-widest mb-3 flex items-center justify-center gap-2",children:[M.jsx(Og,{size:14})," Direccin del Servicio"]}),M.jsx("p",{className:"text-xl font-medium text-stone-800",children:"Diagonal Vicua Mackenna 2004"}),M.jsx("p",{className:"text-lg text-stone-600",children:"Torre B, Santiago"})]}),M.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-8",children:[M.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 px-8 py-4 bg-stone-100 text-stone-700 rounded-xl font-bold hover:bg-stone-200 transition-colors w-full sm:w-auto",children:[M.jsx(Sv,{size:20}),"Regresar al Inicio"]}),M.jsxs("button",{onClick:t,className:"flex items-center justify-center gap-2 px-8 py-4 bg-stone-900 text-white rounded-xl font-bold hover:bg-stone-800 transition-transform hover:-translate-y-1 shadow-lg w-full sm:w-auto",children:[M.jsx(Xu,{size:20}),M.jsxs("span",{children:["Venta de Perfumes ",M.jsx("span",{className:"block text-[10px] font-normal opacity-80 leading-none mt-0.5",children:"Formatos 5ml y 10ml"})]})]})]})]})]})})),Eb=()=>M.jsx("section",{className:"py-24 bg-white",children:M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[M.jsxs("div",{className:"text-center mb-16",children:[M.jsx("span",{className:"text-sm font-bold tracking-widest text-stone-500 uppercase",children:"Testimonios"}),M.jsx("h2",{className:"serif text-4xl md:text-5xl mt-3 text-stone-900",children:"Lo que dicen nuestras clientas"})]}),M.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:qv.map(n=>M.jsxs("div",{className:"bg-stone-50 p-8 rounded-sm hover:shadow-lg transition-shadow duration-300 relative",children:[M.jsx(Mv,{className:"absolute top-6 right-6 text-stone-200",size:40}),M.jsx("div",{className:"flex space-x-1 mb-4 text-amber-500",children:[...Array(5)].map((e,t)=>M.jsx(Df,{size:16,fill:t<n.rating?"currentColor":"none",className:t<n.rating?"text-amber-500":"text-stone-300"},t))}),M.jsxs("p",{className:"text-stone-600 italic mb-6 leading-relaxed relative z-10",children:['"',n.comment,'"']}),M.jsxs("div",{className:"flex justify-between items-end border-t border-stone-200 pt-4",children:[M.jsxs("div",{children:[M.jsx("h4",{className:"font-bold text-stone-900",children:n.name}),M.jsx("span",{className:"text-xs text-stone-400 font-medium",children:"Cliente Verificado"})]}),M.jsx("span",{className:"text-xs text-stone-400",children:n.date})]})]},n.id))})]})});var _b=Object.defineProperty,Wu=Object.getOwnPropertySymbols,Xy=Object.prototype.hasOwnProperty,Jy=Object.prototype.propertyIsEnumerable,gg=(n,e,t)=>e in n?_b(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Nf=(n,e)=>{for(var t in e||(e={}))Xy.call(e,t)&&gg(n,t,e[t]);if(Wu)for(var t of Wu(e))Jy.call(e,t)&&gg(n,t,e[t]);return n},Rf=(n,e)=>{var t={};for(var i in n)Xy.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Wu)for(var i of Wu(n))e.indexOf(i)<0&&Jy.call(n,i)&&(t[i]=n[i]);return t};var Zs;(n=>{const e=class ht{constructor(v,p,_,A){if(this.version=v,this.errorCorrectionLevel=p,this.modules=[],this.isFunction=[],v<ht.MIN_VERSION||v>ht.MAX_VERSION)throw new RangeError("Version value out of range");if(A<-1||A>7)throw new RangeError("Mask value out of range");this.size=v*4+17;let b=[];for(let O=0;O<this.size;O++)b.push(!1);for(let O=0;O<this.size;O++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const k=this.addEccAndInterleave(_);if(this.drawCodewords(k),A==-1){let O=1e9;for(let U=0;U<8;U++){this.applyMask(U),this.drawFormatBits(U);const F=this.getPenaltyScore();F<O&&(A=U,O=F),this.applyMask(U)}}a(0<=A&&A<=7),this.mask=A,this.applyMask(A),this.drawFormatBits(A),this.isFunction=[]}static encodeText(v,p){const _=n.QrSegment.makeSegments(v);return ht.encodeSegments(_,p)}static encodeBinary(v,p){const _=n.QrSegment.makeBytes(v);return ht.encodeSegments([_],p)}static encodeSegments(v,p,_=1,A=40,b=-1,k=!0){if(!(ht.MIN_VERSION<=_&&_<=A&&A<=ht.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let O,U;for(O=_;;O++){const G=ht.getNumDataCodewords(O,p)*8,J=f.getTotalBits(v,O);if(J<=G){U=J;break}if(O>=A)throw new RangeError("Data too long")}for(const G of[ht.Ecc.MEDIUM,ht.Ecc.QUARTILE,ht.Ecc.HIGH])k&&U<=ht.getNumDataCodewords(O,G)*8&&(p=G);let F=[];for(const G of v){t(G.mode.modeBits,4,F),t(G.numChars,G.mode.numCharCountBits(O),F);for(const J of G.getData())F.push(J)}a(F.length==U);const W=ht.getNumDataCodewords(O,p)*8;a(F.length<=W),t(0,Math.min(4,W-F.length),F),t(0,(8-F.length%8)%8,F),a(F.length%8==0);for(let G=236;F.length<W;G^=253)t(G,8,F);let $=[];for(;$.length*8<F.length;)$.push(0);return F.forEach((G,J)=>$[J>>>3]|=G<<7-(J&7)),new ht(O,p,$,b)}getModule(v,p){return 0<=v&&v<this.size&&0<=p&&p<this.size&&this.modules[p][v]}getModules(){return this.modules}drawFunctionPatterns(){for(let _=0;_<this.size;_++)this.setFunctionModule(6,_,_%2==0),this.setFunctionModule(_,6,_%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const v=this.getAlignmentPatternPositions(),p=v.length;for(let _=0;_<p;_++)for(let A=0;A<p;A++)_==0&&A==0||_==0&&A==p-1||_==p-1&&A==0||this.drawAlignmentPattern(v[_],v[A]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(v){const p=this.errorCorrectionLevel.formatBits<<3|v;let _=p;for(let b=0;b<10;b++)_=_<<1^(_>>>9)*1335;const A=(p<<10|_)^21522;a(A>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,i(A,b));this.setFunctionModule(8,7,i(A,6)),this.setFunctionModule(8,8,i(A,7)),this.setFunctionModule(7,8,i(A,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,i(A,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,i(A,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,i(A,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let v=this.version;for(let _=0;_<12;_++)v=v<<1^(v>>>11)*7973;const p=this.version<<12|v;a(p>>>18==0);for(let _=0;_<18;_++){const A=i(p,_),b=this.size-11+_%3,k=Math.floor(_/3);this.setFunctionModule(b,k,A),this.setFunctionModule(k,b,A)}}drawFinderPattern(v,p){for(let _=-4;_<=4;_++)for(let A=-4;A<=4;A++){const b=Math.max(Math.abs(A),Math.abs(_)),k=v+A,O=p+_;0<=k&&k<this.size&&0<=O&&O<this.size&&this.setFunctionModule(k,O,b!=2&&b!=4)}}drawAlignmentPattern(v,p){for(let _=-2;_<=2;_++)for(let A=-2;A<=2;A++)this.setFunctionModule(v+A,p+_,Math.max(Math.abs(A),Math.abs(_))!=1)}setFunctionModule(v,p,_){this.modules[p][v]=_,this.isFunction[p][v]=!0}addEccAndInterleave(v){const p=this.version,_=this.errorCorrectionLevel;if(v.length!=ht.getNumDataCodewords(p,_))throw new RangeError("Invalid argument");const A=ht.NUM_ERROR_CORRECTION_BLOCKS[_.ordinal][p],b=ht.ECC_CODEWORDS_PER_BLOCK[_.ordinal][p],k=Math.floor(ht.getNumRawDataModules(p)/8),O=A-k%A,U=Math.floor(k/A);let F=[];const W=ht.reedSolomonComputeDivisor(b);for(let G=0,J=0;G<A;G++){let de=v.slice(J,J+U-b+(G<O?0:1));J+=de.length;const ue=ht.reedSolomonComputeRemainder(de,W);G<O&&de.push(0),F.push(de.concat(ue))}let $=[];for(let G=0;G<F[0].length;G++)F.forEach((J,de)=>{(G!=U-b||de>=O)&&$.push(J[G])});return a($.length==k),$}drawCodewords(v){if(v.length!=Math.floor(ht.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let p=0;for(let _=this.size-1;_>=1;_-=2){_==6&&(_=5);for(let A=0;A<this.size;A++)for(let b=0;b<2;b++){const k=_-b,U=(_+1&2)==0?this.size-1-A:A;!this.isFunction[U][k]&&p<v.length*8&&(this.modules[U][k]=i(v[p>>>3],7-(p&7)),p++)}}a(p==v.length*8)}applyMask(v){if(v<0||v>7)throw new RangeError("Mask value out of range");for(let p=0;p<this.size;p++)for(let _=0;_<this.size;_++){let A;switch(v){case 0:A=(_+p)%2==0;break;case 1:A=p%2==0;break;case 2:A=_%3==0;break;case 3:A=(_+p)%3==0;break;case 4:A=(Math.floor(_/3)+Math.floor(p/2))%2==0;break;case 5:A=_*p%2+_*p%3==0;break;case 6:A=(_*p%2+_*p%3)%2==0;break;case 7:A=((_+p)%2+_*p%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[p][_]&&A&&(this.modules[p][_]=!this.modules[p][_])}}getPenaltyScore(){let v=0;for(let b=0;b<this.size;b++){let k=!1,O=0,U=[0,0,0,0,0,0,0];for(let F=0;F<this.size;F++)this.modules[b][F]==k?(O++,O==5?v+=ht.PENALTY_N1:O>5&&v++):(this.finderPenaltyAddHistory(O,U),k||(v+=this.finderPenaltyCountPatterns(U)*ht.PENALTY_N3),k=this.modules[b][F],O=1);v+=this.finderPenaltyTerminateAndCount(k,O,U)*ht.PENALTY_N3}for(let b=0;b<this.size;b++){let k=!1,O=0,U=[0,0,0,0,0,0,0];for(let F=0;F<this.size;F++)this.modules[F][b]==k?(O++,O==5?v+=ht.PENALTY_N1:O>5&&v++):(this.finderPenaltyAddHistory(O,U),k||(v+=this.finderPenaltyCountPatterns(U)*ht.PENALTY_N3),k=this.modules[F][b],O=1);v+=this.finderPenaltyTerminateAndCount(k,O,U)*ht.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let k=0;k<this.size-1;k++){const O=this.modules[b][k];O==this.modules[b][k+1]&&O==this.modules[b+1][k]&&O==this.modules[b+1][k+1]&&(v+=ht.PENALTY_N2)}let p=0;for(const b of this.modules)p=b.reduce((k,O)=>k+(O?1:0),p);const _=this.size*this.size,A=Math.ceil(Math.abs(p*20-_*10)/_)-1;return a(0<=A&&A<=9),v+=A*ht.PENALTY_N4,a(0<=v&&v<=2568888),v}getAlignmentPatternPositions(){if(this.version==1)return[];{const v=Math.floor(this.version/7)+2,p=this.version==32?26:Math.ceil((this.version*4+4)/(v*2-2))*2;let _=[6];for(let A=this.size-7;_.length<v;A-=p)_.splice(1,0,A);return _}}static getNumRawDataModules(v){if(v<ht.MIN_VERSION||v>ht.MAX_VERSION)throw new RangeError("Version number out of range");let p=(16*v+128)*v+64;if(v>=2){const _=Math.floor(v/7)+2;p-=(25*_-10)*_-55,v>=7&&(p-=36)}return a(208<=p&&p<=29648),p}static getNumDataCodewords(v,p){return Math.floor(ht.getNumRawDataModules(v)/8)-ht.ECC_CODEWORDS_PER_BLOCK[p.ordinal][v]*ht.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][v]}static reedSolomonComputeDivisor(v){if(v<1||v>255)throw new RangeError("Degree out of range");let p=[];for(let A=0;A<v-1;A++)p.push(0);p.push(1);let _=1;for(let A=0;A<v;A++){for(let b=0;b<p.length;b++)p[b]=ht.reedSolomonMultiply(p[b],_),b+1<p.length&&(p[b]^=p[b+1]);_=ht.reedSolomonMultiply(_,2)}return p}static reedSolomonComputeRemainder(v,p){let _=p.map(A=>0);for(const A of v){const b=A^_.shift();_.push(0),p.forEach((k,O)=>_[O]^=ht.reedSolomonMultiply(k,b))}return _}static reedSolomonMultiply(v,p){if(v>>>8||p>>>8)throw new RangeError("Byte out of range");let _=0;for(let A=7;A>=0;A--)_=_<<1^(_>>>7)*285,_^=(p>>>A&1)*v;return a(_>>>8==0),_}finderPenaltyCountPatterns(v){const p=v[1];a(p<=this.size*3);const _=p>0&&v[2]==p&&v[3]==p*3&&v[4]==p&&v[5]==p;return(_&&v[0]>=p*4&&v[6]>=p?1:0)+(_&&v[6]>=p*4&&v[0]>=p?1:0)}finderPenaltyTerminateAndCount(v,p,_){return v&&(this.finderPenaltyAddHistory(p,_),p=0),p+=this.size,this.finderPenaltyAddHistory(p,_),this.finderPenaltyCountPatterns(_)}finderPenaltyAddHistory(v,p){p[0]==0&&(v+=this.size),p.pop(),p.unshift(v)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=e;function t(x,v,p){if(v<0||v>31||x>>>v)throw new RangeError("Value out of range");for(let _=v-1;_>=0;_--)p.push(x>>>_&1)}function i(x,v){return(x>>>v&1)!=0}function a(x){if(!x)throw new Error("Assertion error")}const l=class en{constructor(v,p,_){if(this.mode=v,this.numChars=p,this.bitData=_,p<0)throw new RangeError("Invalid argument");this.bitData=_.slice()}static makeBytes(v){let p=[];for(const _ of v)t(_,8,p);return new en(en.Mode.BYTE,v.length,p)}static makeNumeric(v){if(!en.isNumeric(v))throw new RangeError("String contains non-numeric characters");let p=[];for(let _=0;_<v.length;){const A=Math.min(v.length-_,3);t(parseInt(v.substring(_,_+A),10),A*3+1,p),_+=A}return new en(en.Mode.NUMERIC,v.length,p)}static makeAlphanumeric(v){if(!en.isAlphanumeric(v))throw new RangeError("String contains unencodable characters in alphanumeric mode");let p=[],_;for(_=0;_+2<=v.length;_+=2){let A=en.ALPHANUMERIC_CHARSET.indexOf(v.charAt(_))*45;A+=en.ALPHANUMERIC_CHARSET.indexOf(v.charAt(_+1)),t(A,11,p)}return _<v.length&&t(en.ALPHANUMERIC_CHARSET.indexOf(v.charAt(_)),6,p),new en(en.Mode.ALPHANUMERIC,v.length,p)}static makeSegments(v){return v==""?[]:en.isNumeric(v)?[en.makeNumeric(v)]:en.isAlphanumeric(v)?[en.makeAlphanumeric(v)]:[en.makeBytes(en.toUtf8ByteArray(v))]}static makeEci(v){let p=[];if(v<0)throw new RangeError("ECI assignment value out of range");if(v<128)t(v,8,p);else if(v<16384)t(2,2,p),t(v,14,p);else if(v<1e6)t(6,3,p),t(v,21,p);else throw new RangeError("ECI assignment value out of range");return new en(en.Mode.ECI,0,p)}static isNumeric(v){return en.NUMERIC_REGEX.test(v)}static isAlphanumeric(v){return en.ALPHANUMERIC_REGEX.test(v)}getData(){return this.bitData.slice()}static getTotalBits(v,p){let _=0;for(const A of v){const b=A.mode.numCharCountBits(p);if(A.numChars>=1<<b)return 1/0;_+=4+b+A.bitData.length}return _}static toUtf8ByteArray(v){v=encodeURI(v);let p=[];for(let _=0;_<v.length;_++)v.charAt(_)!="%"?p.push(v.charCodeAt(_)):(p.push(parseInt(v.substring(_+1,_+3),16)),_+=2);return p}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let f=l;n.QrSegment=l})(Zs||(Zs={}));(n=>{(e=>{const t=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(n.QrCode||(n.QrCode={}))})(Zs||(Zs={}));(n=>{(e=>{const t=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(n.QrSegment||(n.QrSegment={}))})(Zs||(Zs={}));var Vo=Zs;var Cb={L:Vo.QrCode.Ecc.LOW,M:Vo.QrCode.Ecc.MEDIUM,Q:Vo.QrCode.Ecc.QUARTILE,H:Vo.QrCode.Ecc.HIGH},Qy=128,Zy="L",ex="#FFFFFF",tx="#000000",nx=!1,rx=1,Sb=4,Ab=0,Tb=.1;function ix(n,e=0){const t=[];return n.forEach(function(i,a){let l=null;i.forEach(function(f,x){if(!f&&l!==null){t.push(`M${l+e} ${a+e}h${x-l}v1H${l+e}z`),l=null;return}if(x===i.length-1){if(!f)return;l===null?t.push(`M${x+e},${a+e} h1v1H${x+e}z`):t.push(`M${l+e},${a+e} h${x+1-l}v1H${l+e}z`);return}f&&l===null&&(l=x)})}),t.join("")}function sx(n,e){return n.slice().map((t,i)=>i<e.y||i>=e.y+e.h?t:t.map((a,l)=>l<e.x||l>=e.x+e.w?a:!1))}function Ib(n,e,t,i){if(i==null)return null;const a=n.length+t*2,l=Math.floor(e*Tb),f=a/e,x=(i.width||l)*f,v=(i.height||l)*f,p=i.x==null?n.length/2-x/2:i.x*f,_=i.y==null?n.length/2-v/2:i.y*f,A=i.opacity==null?1:i.opacity;let b=null;if(i.excavate){let O=Math.floor(p),U=Math.floor(_),F=Math.ceil(x+p-O),W=Math.ceil(v+_-U);b={x:O,y:U,w:F,h:W}}const k=i.crossOrigin;return{x:p,y:_,h:v,w:x,excavation:b,opacity:A,crossOrigin:k}}function bb(n,e){return e!=null?Math.max(Math.floor(e),0):n?Sb:Ab}function ox({value:n,level:e,minVersion:t,includeMargin:i,marginSize:a,imageSettings:l,size:f,boostLevel:x}){let v=nn.useMemo(()=>{const O=(Array.isArray(n)?n:[n]).reduce((U,F)=>(U.push(...Vo.QrSegment.makeSegments(F)),U),[]);return Vo.QrCode.encodeSegments(O,Cb[e],t,void 0,void 0,x)},[n,e,t,x]);const{cells:p,margin:_,numCells:A,calculatedImageSettings:b}=nn.useMemo(()=>{let k=v.getModules();const O=bb(i,a),U=k.length+O*2,F=Ib(k,f,O,l);return{cells:k,margin:O,numCells:U,calculatedImageSettings:F}},[v,f,l,i,a]);return{qrcode:v,margin:_,cells:p,numCells:A,calculatedImageSettings:b}}var Nb=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),Rb=nn.forwardRef(function(e,t){const i=e,{value:a,size:l=Qy,level:f=Zy,bgColor:x=ex,fgColor:v=tx,includeMargin:p=nx,minVersion:_=rx,boostLevel:A,marginSize:b,imageSettings:k}=i,U=Rf(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:F}=U,W=Rf(U,["style"]),$=k?.src,G=nn.useRef(null),J=nn.useRef(null),de=nn.useCallback(We=>{G.current=We,typeof t=="function"?t(We):t&&(t.current=We)},[t]),[ue,ee]=nn.useState(!1),{margin:Te,cells:Z,numCells:Se,calculatedImageSettings:Pe}=ox({value:a,level:f,minVersion:_,boostLevel:A,includeMargin:p,marginSize:b,imageSettings:k,size:l});nn.useEffect(()=>{if(G.current!=null){const We=G.current,ie=We.getContext("2d");if(!ie)return;let ve=Z;const me=J.current,pe=Pe!=null&&me!==null&&me.complete&&me.naturalHeight!==0&&me.naturalWidth!==0;pe&&Pe.excavation!=null&&(ve=sx(Z,Pe.excavation));const be=window.devicePixelRatio||1;We.height=We.width=l*be;const we=l/Se*be;ie.scale(we,we),ie.fillStyle=x,ie.fillRect(0,0,Se,Se),ie.fillStyle=v,Nb?ie.fill(new Path2D(ix(ve,Te))):Z.forEach(function(X,le){X.forEach(function(qe,De){qe&&ie.fillRect(De+Te,le+Te,1,1)})}),Pe&&(ie.globalAlpha=Pe.opacity),pe&&ie.drawImage(me,Pe.x+Te,Pe.y+Te,Pe.w,Pe.h)}}),nn.useEffect(()=>{ee(!1)},[$]);const Ie=Nf({height:l,width:l},F);let Ne=null;return $!=null&&(Ne=nn.createElement("img",{src:$,key:$,style:{display:"none"},onLoad:()=>{ee(!0)},ref:J,crossOrigin:Pe?.crossOrigin})),nn.createElement(nn.Fragment,null,nn.createElement("canvas",Nf({style:Ie,height:l,width:l,ref:de,role:"img"},W)),Ne)});Rb.displayName="QRCodeCanvas";var ax=nn.forwardRef(function(e,t){const i=e,{value:a,size:l=Qy,level:f=Zy,bgColor:x=ex,fgColor:v=tx,includeMargin:p=nx,minVersion:_=rx,boostLevel:A,title:b,marginSize:k,imageSettings:O}=i,U=Rf(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:F,cells:W,numCells:$,calculatedImageSettings:G}=ox({value:a,level:f,minVersion:_,boostLevel:A,includeMargin:p,marginSize:k,imageSettings:O,size:l});let J=W,de=null;O!=null&&G!=null&&(G.excavation!=null&&(J=sx(W,G.excavation)),de=nn.createElement("image",{href:O.src,height:G.h,width:G.w,x:G.x+F,y:G.y+F,preserveAspectRatio:"none",opacity:G.opacity,crossOrigin:G.crossOrigin}));const ue=ix(J,F);return nn.createElement("svg",Nf({height:l,width:l,viewBox:`0 0 ${$} ${$}`,ref:t,role:"img"},U),!!b&&nn.createElement("title",null,b),nn.createElement("path",{fill:x,d:`M0,0 h${$}v${$}H0z`,shapeRendering:"crispEdges"}),nn.createElement("path",{fill:v,d:ue,shapeRendering:"crispEdges"}),de)});ax.displayName="QRCodeSVG";const Mb=({clientName:n,token:e,visits:t,nextReward:i,tier:a="Silver"})=>{const[l,f]=Je.useState(!1),v=(p=>{switch(p){case"Diamante":return{name:"Diamante",color:"from-blue-400 to-purple-600"};case"Gold":return{name:"Gold",color:"from-amber-300 to-amber-600"};default:return{name:"Silver",color:"from-stone-400 to-stone-600"}}})(a);return M.jsxs("div",{className:"perspective-1000 w-full max-w-sm mx-auto h-56 cursor-pointer group",onClick:()=>f(!l),children:[M.jsxs("div",{className:`relative w-full h-full duration-700 preserve-3d transition-all ${l?"rotate-y-180":""}`,children:[M.jsxs("div",{className:"absolute inset-0 backface-hidden w-full h-full rounded-2xl p-6 shadow-2xl overflow-hidden bg-stone-900 border border-stone-800 flex flex-col justify-between",children:[M.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${v.color} opacity-20 rounded-full blur-3xl -mr-10 -mt-10`}),M.jsxs("div",{className:"relative z-10 flex justify-between items-start",children:[M.jsxs("div",{children:[M.jsx("h3",{className:"text-amber-500 font-serif italic text-lg opacity-80",children:"Tus3B Club"}),M.jsx("p",{className:"text-white font-bold text-xl tracking-wide mt-1",children:n||"Miembro Exclusivo"})]}),M.jsx("div",{className:"px-3 py-1 rounded-full border border-white/10 bg-white/5 backdrop-blur-md",children:M.jsx("span",{className:`bg-clip-text text-transparent bg-gradient-to-r ${v.color} font-bold text-xs uppercase tracking-wider`,children:v.name})})]}),M.jsxs("div",{className:"relative z-10",children:[M.jsxs("div",{className:"flex justify-between items-end mb-2",children:[M.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((p,_)=>M.jsx(Df,{size:16,className:`${_<t%5?"text-amber-400 fill-amber-400":"text-stone-700"}`},_))}),M.jsxs("div",{className:"text-right",children:[M.jsx("p",{className:"text-stone-400 text-xs",children:"Prxima recompensa"}),M.jsxs("p",{className:"text-white font-mono",children:[5-t%5," visitas"]})]})]}),M.jsx("div",{className:"w-full bg-stone-800 h-1 rounded-full overflow-hidden",children:M.jsx("div",{className:`h-full bg-gradient-to-r ${v.color}`,style:{width:`${t%5/5*100}%`}})})]}),M.jsx("div",{className:"absolute bottom-4 right-4 animate-pulse",children:M.jsx(kv,{size:14,className:"text-stone-600"})})]}),M.jsxs("div",{className:"absolute inset-0 backface-hidden w-full h-full bg-white rounded-2xl p-6 shadow-xl rotate-y-180 flex flex-col items-center justify-center border-2 border-amber-500",children:[M.jsx("div",{className:"bg-white p-2 rounded-lg",children:M.jsx(ax,{value:e,size:150,level:"H"})}),M.jsxs("p",{className:"mt-4 text-stone-900 font-bold tracking-widest text-xs",children:[e.slice(0,8),"..."]}),M.jsx("p",{className:"text-xs text-stone-500 mt-1 uppercase",children:"Escanea para sumar puntos"})]})]}),M.jsx("style",{children:`
        .perspective-1000 { perspective: 1000px; }
        .preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
      `})]})},kb=()=>{const[n,e]=Je.useState(""),[t,i]=Je.useState(!1),[a,l]=Je.useState(null),[f,x]=Je.useState([]),v=async p=>{p&&p.preventDefault();const A=new URLSearchParams(window.location.search).get("token");if(!(!A&&n.length<8)){i(!0);try{let b=Qn.from("clients").select("*");A?b=b.eq("member_token",A):b=b.eq("phone",n);const{data:k,error:O}=await b.single(),{data:U}=await Qn.from("rewards").select("*").eq("is_active",!0);if(U&&x(U),O&&O.code!=="PGRST116"){console.error("Error fetching loyalty:",O),A||alert("Hubo un error al consultar. Intenta de nuevo."),i(!1);return}k?l({visits:k.visits,referrals:k.referrals,nextReward:5,token:k.member_token,tier:k.tier,hair_service_count:k.hair_service_count||0,discount_5th_visit_available:k.discount_5th_visit_available,free_cut_available:k.free_cut_available}):A||l({visits:0,referrals:0,nextReward:5,token:"new-client",tier:"Silver",hair_service_count:0})}catch(b){console.error("Unexpected error:",b)}finally{i(!1)}}};return nn.useEffect(()=>{new URLSearchParams(window.location.search).get("token")&&v()},[]),M.jsxs("div",{className:"bg-gradient-to-br from-stone-900 to-stone-800 rounded-3xl p-8 text-white relative overflow-hidden shadow-2xl",children:[M.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-purple-500 rounded-full blur-[60px] opacity-30"}),M.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-amber-500 rounded-full blur-[60px] opacity-30"}),M.jsxs("div",{className:"relative z-10 text-center",children:[M.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white/10 rounded-2xl mb-6 backdrop-blur-sm border border-white/10",children:M.jsx(Dg,{size:32,className:"text-amber-400"})}),M.jsx("h3",{className:"serif text-3xl mb-2",children:"Club Fidelidad"}),M.jsx("p",{className:"text-stone-300 font-light mb-8 max-w-sm mx-auto",children:"Tu preferencia tiene recompensas. Acumula visitas y gana descuentos exclusivos."}),a?M.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-500 mb-8",children:[M.jsx(Mb,{clientName:a.name||"Miembro Exclusivo",token:a.token||"pending-token",visits:a.visits,nextReward:5,tier:a.tier}),M.jsxs("div",{className:"text-center mt-6",children:[M.jsxs("div",{className:"mb-6 bg-white/5 p-4 rounded-xl border border-purple-500/20",children:[M.jsxs("h4",{className:"text-purple-300 font-bold mb-3 flex items-center justify-center gap-2",children:[M.jsx(Pf,{size:18}),"Peluquera & Estilo"]}),M.jsxs("div",{className:"mb-4",children:[M.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[M.jsx("span",{className:"text-stone-300",children:"Desc. 10% (Cada 5)"}),M.jsx("span",{className:a.discount_5th_visit_available?"text-green-400 font-bold":"text-stone-400",children:a.discount_5th_visit_available?"DISPONIBLE!":`${(a.hair_service_count||0)%5} / 5`})]}),M.jsx("div",{className:"h-2 bg-stone-700 rounded-full overflow-hidden",children:M.jsx("div",{className:`h-full ${a.discount_5th_visit_available?"bg-green-500":"bg-purple-500"}`,style:{width:a.discount_5th_visit_available?"100%":`${(a.hair_service_count||0)%5*20}%`}})})]}),M.jsxs("div",{children:[M.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[M.jsx("span",{className:"text-stone-300",children:"Corte Gratis (Cada 10)"}),M.jsx("span",{className:a.free_cut_available?"text-amber-400 font-bold":"text-stone-400",children:a.free_cut_available?"CANJEAR!":`${(a.hair_service_count||0)%10} / 10`})]}),M.jsx("div",{className:"h-2 bg-stone-700 rounded-full overflow-hidden",children:M.jsx("div",{className:`h-full ${a.free_cut_available?"bg-amber-500":"bg-purple-400/60"}`,style:{width:a.free_cut_available?"100%":`${(a.hair_service_count||0)%10*10}%`}})})]})]}),M.jsx("p",{className:"text-sm text-stone-300 mb-4",children:a.visits>=5?"Felicidades! Tienes un descuento disponible.":`Te faltan ${5-a.visits} visitas para tu recompensa.`}),M.jsx("button",{onClick:()=>l(null),className:"text-sm text-stone-400 hover:text-white underline decoration-stone-600 underline-offset-4",children:"Consultar otro nmero"})]})]}):M.jsxs("form",{onSubmit:v,className:"max-w-xs mx-auto",children:[M.jsxs("div",{className:"relative",children:[M.jsx("input",{type:"tel",value:n,onChange:p=>e(p.target.value),placeholder:"Ingresa tu telfono...",className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 pl-10 text-white placeholder-stone-400 focus:outline-none focus:ring-2 focus:ring-amber-400 transition"}),M.jsx(Bg,{size:18,className:"absolute left-3 top-3.5 text-stone-400"})]}),M.jsx("button",{type:"submit",disabled:t||n.length<8,className:"w-full mt-4 bg-white text-stone-900 font-bold py-3 rounded-xl hover:bg-amber-50 transition flex justify-center items-center disabled:opacity-50 disabled:cursor-not-allowed",children:t?M.jsx(Nu,{className:"animate-spin"}):"Consultar Puntos"})]}),M.jsxs("div",{className:"mt-8 pt-8 border-t border-white/10 text-left space-y-3",children:[M.jsx("h3",{className:"serif text-xl mb-4 text-center",children:"Canjes Disponibles"}),M.jsx("div",{className:"grid grid-cols-1 gap-3",children:f.length>0?f.map(p=>{const _=p.allowed_perfume_segment==="arab",A=(a?.visits||0)>=p.cost_visits;return M.jsx("div",{className:`bg-white/5 p-4 rounded-xl border ${A?"border-amber-500/50":"border-white/5"} relative`,children:M.jsxs("div",{className:"flex justify-between items-start",children:[M.jsxs("div",{children:[M.jsxs("h4",{className:"font-bold text-white text-sm flex items-center gap-1",children:[p.name,_&&M.jsx("span",{className:"text-amber-400 text-xs",children:"*"})]}),M.jsx("p",{className:"text-xs text-stone-400 mt-0.5",children:p.description}),_&&M.jsx("p",{className:"text-[10px] text-amber-500/80 italic mt-1",children:"* Vlido solo para perfumera rabe"})]}),M.jsxs("div",{className:"text-right",children:[M.jsxs("span",{className:`block font-mono font-bold ${A?"text-amber-400":"text-stone-500"}`,children:[p.cost_visits," PTS"]}),A&&M.jsx("button",{className:"text-[10px] bg-amber-500 text-stone-900 px-2 py-0.5 rounded mt-1 font-bold hover:bg-amber-400 transition",onClick:()=>alert("Solicita este canje en caja mostrando tu QR"),children:"CANJEAR"})]})]})},p.id)}):M.jsxs("div",{className:"flex items-start gap-4",children:[M.jsx("div",{className:"bg-amber-500/20 p-2 rounded-lg text-amber-400 mt-1",children:M.jsx(Df,{size:16})}),M.jsxs("div",{children:[M.jsx("h4",{className:"font-bold text-white text-sm",children:"5ta Visita con Descuento"}),M.jsx("p",{className:"text-xs text-stone-400 mt-0.5",children:"Completa 4 visitas y la 5ta tiene un precio especial."})]})]})})]})]})]})};var Le;(function(n){n[n.QR_CODE=0]="QR_CODE",n[n.AZTEC=1]="AZTEC",n[n.CODABAR=2]="CODABAR",n[n.CODE_39=3]="CODE_39",n[n.CODE_93=4]="CODE_93",n[n.CODE_128=5]="CODE_128",n[n.DATA_MATRIX=6]="DATA_MATRIX",n[n.MAXICODE=7]="MAXICODE",n[n.ITF=8]="ITF",n[n.EAN_13=9]="EAN_13",n[n.EAN_8=10]="EAN_8",n[n.PDF_417=11]="PDF_417",n[n.RSS_14=12]="RSS_14",n[n.RSS_EXPANDED=13]="RSS_EXPANDED",n[n.UPC_A=14]="UPC_A",n[n.UPC_E=15]="UPC_E",n[n.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Le||(Le={}));var mg=new Map([[Le.QR_CODE,"QR_CODE"],[Le.AZTEC,"AZTEC"],[Le.CODABAR,"CODABAR"],[Le.CODE_39,"CODE_39"],[Le.CODE_93,"CODE_93"],[Le.CODE_128,"CODE_128"],[Le.DATA_MATRIX,"DATA_MATRIX"],[Le.MAXICODE,"MAXICODE"],[Le.ITF,"ITF"],[Le.EAN_13,"EAN_13"],[Le.EAN_8,"EAN_8"],[Le.PDF_417,"PDF_417"],[Le.RSS_14,"RSS_14"],[Le.RSS_EXPANDED,"RSS_EXPANDED"],[Le.UPC_A,"UPC_A"],[Le.UPC_E,"UPC_E"],[Le.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),yg;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.URL=1]="URL"})(yg||(yg={}));function Pb(n){return Object.values(Le).includes(n)}var ms;(function(n){n[n.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",n[n.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(ms||(ms={}));var ei=(function(){function n(){}return n.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",n.SCAN_DEFAULT_FPS=2,n.DEFAULT_DISABLE_FLIP=!1,n.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,n.DEFAULT_SUPPORTED_SCAN_TYPE=[ms.SCAN_TYPE_CAMERA,ms.SCAN_TYPE_FILE],n})(),lx=(function(){function n(e,t){this.format=e,this.formatName=t}return n.prototype.toString=function(){return this.formatName},n.create=function(e){if(!mg.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new n(e,mg.get(e))},n})(),xg=(function(){function n(){}return n.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},n.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},n})(),Mf;(function(n){n[n.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",n[n.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",n[n.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Mf||(Mf={}));var ux=(function(){function n(){}return n.createFrom=function(e){return{errorMessage:e,type:Mf.UNKWOWN_ERROR}},n})(),cx=(function(){function n(e){this.verbose=e}return n.prototype.log=function(e){this.verbose&&console.log(e)},n.prototype.warn=function(e){this.verbose&&console.warn(e)},n.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},n.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},n})();function gi(n){return typeof n>"u"||n===null}function Db(n,e,t){return n>t?t:n<e?e:n}var Ho=(function(){function n(){}return n.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},n.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},n.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},n.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},n.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},n.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},n.scannerPaused=function(){return"Scanner paused"},n})(),Mt=(function(){function n(){}return n.scanningStatus=function(){return"Scanning"},n.idleStatus=function(){return"Idle"},n.errorStatus=function(){return"Error"},n.permissionStatus=function(){return"Permission"},n.noCameraFoundErrorStatus=function(){return"No Cameras"},n.lastMatch=function(e){return"Last Match: ".concat(e)},n.codeScannerTitle=function(){return"Code Scanner"},n.cameraPermissionTitle=function(){return"Request Camera Permissions"},n.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},n.noCameraFound=function(){return"No camera found"},n.scanButtonStopScanningText=function(){return"Stop Scanning"},n.scanButtonStartScanningText=function(){return"Start Scanning"},n.torchOnButton=function(){return"Switch On Torch"},n.torchOffButton=function(){return"Switch Off Torch"},n.torchOnFailedMessage=function(){return"Failed to turn on torch"},n.torchOffFailedMessage=function(){return"Failed to turn off torch"},n.scanButtonScanningStarting=function(){return"Launching Camera..."},n.textIfCameraScanSelected=function(){return"Scan an Image File"},n.textIfFileScanSelected=function(){return"Scan using camera directly"},n.selectCamera=function(){return"Select Camera"},n.fileSelectionChooseImage=function(){return"Choose Image"},n.fileSelectionChooseAnother=function(){return"Choose Another"},n.fileSelectionNoImageSelected=function(){return"No image choosen"},n.anonymousCameraPrefix=function(){return"Anonymous Camera"},n.dragAndDropMessage=function(){return"Or drop an image to scan"},n.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},n.zoom=function(){return"zoom"},n.loadingImage=function(){return"Loading image..."},n.cameraScanAltText=function(){return"Camera based scan"},n.fileScanAltText=function(){return"Fule based scan"},n})(),vg=(function(){function n(){}return n.poweredBy=function(){return"Powered by "},n.reportIssues=function(){return"Report issues"},n})(),dx=(function(){function n(){}return n.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var i=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(a),f=Object.keys(e),x=0,v=f;x<v.length;x++){var p=v[x];if(l.has(p))return t.logError("".concat(p," is not supported videoConstaints."),!0),!1}return!0},n})(),Ka={exports:{}},Ob=Ka.exports,wg;function Lb(){return wg||(wg=1,(function(n,e){(function(t,i){i(e)})(Ob,(function(t){function i(P){return P==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,r){P.__proto__=r}||function(P,r){for(var o in r)r.hasOwnProperty(o)&&(P[o]=r[o])};function l(P,r){a(P,r);function o(){this.constructor=P}P.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}function f(P,r){var o=Object.setPrototypeOf;o?o(P,r):P.__proto__=r}function x(P,r){r===void 0&&(r=P.constructor);var o=Error.captureStackTrace;o&&o(P,r)}var v=(function(P){l(r,P);function r(o){var u=this.constructor,d=P.call(this,o)||this;return Object.defineProperty(d,"name",{value:u.name,enumerable:!1}),f(d,u.prototype),x(d),d}return r})(Error);class p extends v{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}p.kind="Exception";class _ extends p{}_.kind="ArgumentException";class A extends p{}A.kind="IllegalArgumentException";class b{constructor(r){if(this.binarizer=r,r===null)throw new A("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,o){return this.binarizer.getBlackRow(r,o)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,o,u,d){const h=this.binarizer.getLuminanceSource().crop(r,o,u,d);return new b(this.binarizer.createBinarizer(h))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new b(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new b(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class k extends p{static getChecksumInstance(){return new k}}k.kind="ChecksumException";class O{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class U{static arraycopy(r,o,u,d,h){for(;h--;)u[d++]=r[o++]}static currentTimeMillis(){return Date.now()}}class F extends p{}F.kind="IndexOutOfBoundsException";class W extends F{constructor(r=void 0,o=void 0){super(o),this.index=r,this.message=o}}W.kind="ArrayIndexOutOfBoundsException";class ${static fill(r,o){for(let u=0,d=r.length;u<d;u++)r[u]=o}static fillWithin(r,o,u,d){$.rangeCheck(r.length,o,u);for(let h=o;h<u;h++)r[h]=d}static rangeCheck(r,o,u){if(o>u)throw new A("fromIndex("+o+") > toIndex("+u+")");if(o<0)throw new W(o);if(u>r)throw new W(u)}static asList(...r){return r}static create(r,o,u){return Array.from({length:r}).map(h=>Array.from({length:o}).fill(u))}static createInt32Array(r,o,u){return Array.from({length:r}).map(h=>Int32Array.from({length:o}).fill(u))}static equals(r,o){if(!r||!o||!r.length||!o.length||r.length!==o.length)return!1;for(let u=0,d=r.length;u<d;u++)if(r[u]!==o[u])return!1;return!0}static hashCode(r){if(r===null)return 0;let o=1;for(const u of r)o=31*o+u;return o}static fillUint8Array(r,o){for(let u=0;u!==r.length;u++)r[u]=o}static copyOf(r,o){return r.slice(0,o)}static copyOfUint8Array(r,o){if(r.length<=o){const u=new Uint8Array(o);return u.set(r),u}return r.slice(0,o)}static copyOfRange(r,o,u){const d=u-o,h=new Int32Array(d);return U.arraycopy(r,o,h,0,d),h}static binarySearch(r,o,u){u===void 0&&(u=$.numberComparator);let d=0,h=r.length-1;for(;d<=h;){const g=h+d>>1,w=u(o,r[g]);if(w>0)d=g+1;else if(w<0)h=g-1;else return g}return-d-1}static numberComparator(r,o){return r-o}}class G{static numberOfTrailingZeros(r){let o;if(r===0)return 32;let u=31;return o=r<<16,o!==0&&(u-=16,r=o),o=r<<8,o!==0&&(u-=8,r=o),o=r<<4,o!==0&&(u-=4,r=o),o=r<<2,o!==0&&(u-=2,r=o),u-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let o=1;return r>>>16||(o+=16,r<<=16),r>>>24||(o+=8,r<<=8),r>>>28||(o+=4,r<<=4),r>>>30||(o+=2,r<<=2),o-=r>>>31,o}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,o){return Math.trunc(r/o)}static parseInt(r,o=void 0){return parseInt(r,o)}}G.MIN_VALUE_32_BITS=-2147483648,G.MAX_VALUE=Number.MAX_SAFE_INTEGER;class J{constructor(r,o){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,o==null?this.bits=J.makeArray(r):this.bits=o)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const o=J.makeArray(r);U.arraycopy(this.bits,0,o,0,this.bits.length),this.bits=o}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const o=this.size;if(r>=o)return o;const u=this.bits;let d=Math.floor(r/32),h=u[d];h&=~((1<<(r&31))-1);const g=u.length;for(;h===0;){if(++d===g)return o;h=u[d]}const w=d*32+G.numberOfTrailingZeros(h);return w>o?o:w}getNextUnset(r){const o=this.size;if(r>=o)return o;const u=this.bits;let d=Math.floor(r/32),h=~u[d];h&=~((1<<(r&31))-1);const g=u.length;for(;h===0;){if(++d===g)return o;h=~u[d]}const w=d*32+G.numberOfTrailingZeros(h);return w>o?o:w}setBulk(r,o){this.bits[Math.floor(r/32)]=o}setRange(r,o){if(o<r||r<0||o>this.size)throw new A;if(o===r)return;o--;const u=Math.floor(r/32),d=Math.floor(o/32),h=this.bits;for(let g=u;g<=d;g++){const w=g>u?0:r&31,T=(2<<(g<d?31:o&31))-(1<<w);h[g]|=T}}clear(){const r=this.bits.length,o=this.bits;for(let u=0;u<r;u++)o[u]=0}isRange(r,o,u){if(o<r||r<0||o>this.size)throw new A;if(o===r)return!0;o--;const d=Math.floor(r/32),h=Math.floor(o/32),g=this.bits;for(let w=d;w<=h;w++){const S=w>d?0:r&31,R=(2<<(w<h?31:o&31))-(1<<S)&4294967295;if((g[w]&R)!==(u?R:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,o){if(o<0||o>32)throw new A("Num bits must be between 0 and 32");this.ensureCapacity(this.size+o);for(let u=o;u>0;u--)this.appendBit((r>>u-1&1)===1)}appendBitArray(r){const o=r.size;this.ensureCapacity(this.size+o);for(let u=0;u<o;u++)this.appendBit(r.get(u))}xor(r){if(this.size!==r.size)throw new A("Sizes don't match");const o=this.bits;for(let u=0,d=o.length;u<d;u++)o[u]^=r.bits[u]}toBytes(r,o,u,d){for(let h=0;h<d;h++){let g=0;for(let w=0;w<8;w++)this.get(r)&&(g|=1<<7-w),r++;o[u+h]=g}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),o=Math.floor((this.size-1)/32),u=o+1,d=this.bits;for(let h=0;h<u;h++){let g=d[h];g=g>>1&1431655765|(g&1431655765)<<1,g=g>>2&858993459|(g&858993459)<<2,g=g>>4&252645135|(g&252645135)<<4,g=g>>8&16711935|(g&16711935)<<8,g=g>>16&65535|(g&65535)<<16,r[o-h]=g}if(this.size!==u*32){const h=u*32-this.size;let g=r[0]>>>h;for(let w=1;w<u;w++){const S=r[w];g|=S<<32-h,r[w-1]=g,g=S>>>h}r[u-1]=g}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof J))return!1;const o=r;return this.size===o.size&&$.equals(this.bits,o.bits)}hashCode(){return 31*this.size+$.hashCode(this.bits)}toString(){let r="";for(let o=0,u=this.size;o<u;o++)(o&7)===0&&(r+=" "),r+=this.get(o)?"X":".";return r}clone(){return new J(this.size,this.bits.slice())}}var de;(function(P){P[P.OTHER=0]="OTHER",P[P.PURE_BARCODE=1]="PURE_BARCODE",P[P.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",P[P.TRY_HARDER=3]="TRY_HARDER",P[P.CHARACTER_SET=4]="CHARACTER_SET",P[P.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",P[P.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",P[P.ASSUME_GS1=7]="ASSUME_GS1",P[P.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",P[P.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",P[P.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(de||(de={}));var ue=de;class ee extends p{static getFormatInstance(){return new ee}}ee.kind="FormatException";var Te;(function(P){P[P.Cp437=0]="Cp437",P[P.ISO8859_1=1]="ISO8859_1",P[P.ISO8859_2=2]="ISO8859_2",P[P.ISO8859_3=3]="ISO8859_3",P[P.ISO8859_4=4]="ISO8859_4",P[P.ISO8859_5=5]="ISO8859_5",P[P.ISO8859_6=6]="ISO8859_6",P[P.ISO8859_7=7]="ISO8859_7",P[P.ISO8859_8=8]="ISO8859_8",P[P.ISO8859_9=9]="ISO8859_9",P[P.ISO8859_10=10]="ISO8859_10",P[P.ISO8859_11=11]="ISO8859_11",P[P.ISO8859_13=12]="ISO8859_13",P[P.ISO8859_14=13]="ISO8859_14",P[P.ISO8859_15=14]="ISO8859_15",P[P.ISO8859_16=15]="ISO8859_16",P[P.SJIS=16]="SJIS",P[P.Cp1250=17]="Cp1250",P[P.Cp1251=18]="Cp1251",P[P.Cp1252=19]="Cp1252",P[P.Cp1256=20]="Cp1256",P[P.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",P[P.UTF8=22]="UTF8",P[P.ASCII=23]="ASCII",P[P.Big5=24]="Big5",P[P.GB18030=25]="GB18030",P[P.EUC_KR=26]="EUC_KR"})(Te||(Te={}));class Z{constructor(r,o,u,...d){this.valueIdentifier=r,this.name=u,typeof o=="number"?this.values=Int32Array.from([o]):this.values=o,this.otherEncodingNames=d,Z.VALUE_IDENTIFIER_TO_ECI.set(r,this),Z.NAME_TO_ECI.set(u,this);const h=this.values;for(let g=0,w=h.length;g!==w;g++){const S=h[g];Z.VALUES_TO_ECI.set(S,this)}for(const g of d)Z.NAME_TO_ECI.set(g,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new ee("incorect value");const o=Z.VALUES_TO_ECI.get(r);if(o===void 0)throw new ee("incorect value");return o}static getCharacterSetECIByName(r){const o=Z.NAME_TO_ECI.get(r);if(o===void 0)throw new ee("incorect value");return o}equals(r){if(!(r instanceof Z))return!1;const o=r;return this.getName()===o.getName()}}Z.VALUE_IDENTIFIER_TO_ECI=new Map,Z.VALUES_TO_ECI=new Map,Z.NAME_TO_ECI=new Map,Z.Cp437=new Z(Te.Cp437,Int32Array.from([0,2]),"Cp437"),Z.ISO8859_1=new Z(Te.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),Z.ISO8859_2=new Z(Te.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),Z.ISO8859_3=new Z(Te.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),Z.ISO8859_4=new Z(Te.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),Z.ISO8859_5=new Z(Te.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),Z.ISO8859_6=new Z(Te.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),Z.ISO8859_7=new Z(Te.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),Z.ISO8859_8=new Z(Te.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),Z.ISO8859_9=new Z(Te.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),Z.ISO8859_10=new Z(Te.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),Z.ISO8859_11=new Z(Te.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),Z.ISO8859_13=new Z(Te.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),Z.ISO8859_14=new Z(Te.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),Z.ISO8859_15=new Z(Te.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),Z.ISO8859_16=new Z(Te.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),Z.SJIS=new Z(Te.SJIS,20,"SJIS","Shift_JIS"),Z.Cp1250=new Z(Te.Cp1250,21,"Cp1250","windows-1250"),Z.Cp1251=new Z(Te.Cp1251,22,"Cp1251","windows-1251"),Z.Cp1252=new Z(Te.Cp1252,23,"Cp1252","windows-1252"),Z.Cp1256=new Z(Te.Cp1256,24,"Cp1256","windows-1256"),Z.UnicodeBigUnmarked=new Z(Te.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),Z.UTF8=new Z(Te.UTF8,26,"UTF8","UTF-8"),Z.ASCII=new Z(Te.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),Z.Big5=new Z(Te.Big5,28,"Big5"),Z.GB18030=new Z(Te.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),Z.EUC_KR=new Z(Te.EUC_KR,30,"EUC_KR","EUC-KR");class Se extends p{}Se.kind="UnsupportedOperationException";class Pe{static decode(r,o){const u=this.encodingName(o);return this.customDecoder?this.customDecoder(r,u):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(u)?this.decodeFallback(r,u):new TextDecoder(u).decode(r)}static shouldDecodeOnFallback(r){return!Pe.isBrowser()&&r==="ISO-8859-1"}static encode(r,o){const u=this.encodingName(o);return this.customEncoder?this.customEncoder(r,u):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof Z?r:Z.getCharacterSetECIByName(r)}static decodeFallback(r,o){const u=this.encodingCharacterSet(o);if(Pe.isDecodeFallbackSupported(u)){let d="";for(let h=0,g=r.length;h<g;h++){let w=r[h].toString(16);w.length<2&&(w="0"+w),d+="%"+w}return decodeURIComponent(d)}if(u.equals(Z.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new Se(`Encoding ${this.encodingName(o)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(Z.UTF8)||r.equals(Z.ISO8859_1)||r.equals(Z.ASCII)}static encodeFallback(r){const u=btoa(unescape(encodeURIComponent(r))).split(""),d=[];for(let h=0;h<u.length;h++)d.push(u[h].charCodeAt(0));return new Uint8Array(d)}}class Ie{static castAsNonUtf8Char(r,o=null){const u=o?o.getName():this.ISO88591;return Pe.decode(new Uint8Array([r]),u)}static guessEncoding(r,o){if(o!=null&&o.get(ue.CHARACTER_SET)!==void 0)return o.get(ue.CHARACTER_SET).toString();const u=r.length;let d=!0,h=!0,g=!0,w=0,S=0,T=0,R=0,D=0,B=0,H=0,j=0,Y=0,Q=0,se=0;const xe=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let Ee=0;Ee<u&&(d||h||g);Ee++){const he=r[Ee]&255;g&&(w>0?(he&128)===0?g=!1:w--:(he&128)!==0&&((he&64)===0?g=!1:(w++,(he&32)===0?S++:(w++,(he&16)===0?T++:(w++,(he&8)===0?R++:g=!1))))),d&&(he>127&&he<160?d=!1:he>159&&(he<192||he===215||he===247)&&se++),h&&(D>0?he<64||he===127||he>252?h=!1:D--:he===128||he===160||he>239?h=!1:he>160&&he<224?(B++,j=0,H++,H>Y&&(Y=H)):he>127?(D++,H=0,j++,j>Q&&(Q=j)):(H=0,j=0))}return g&&w>0&&(g=!1),h&&D>0&&(h=!1),g&&(xe||S+T+R>0)?Ie.UTF8:h&&(Ie.ASSUME_SHIFT_JIS||Y>=3||Q>=3)?Ie.SHIFT_JIS:d&&h?Y===2&&B===2||se*10>=u?Ie.SHIFT_JIS:Ie.ISO88591:d?Ie.ISO88591:h?Ie.SHIFT_JIS:g?Ie.UTF8:Ie.PLATFORM_DEFAULT_ENCODING}static format(r,...o){let u=-1;function d(g,w,S,T,R,D){if(g==="%%")return"%";if(o[++u]===void 0)return;g=T?parseInt(T.substr(1)):void 0;let B=R?parseInt(R.substr(1)):void 0,H;switch(D){case"s":H=o[u];break;case"c":H=o[u][0];break;case"f":H=parseFloat(o[u]).toFixed(g);break;case"p":H=parseFloat(o[u]).toPrecision(g);break;case"e":H=parseFloat(o[u]).toExponential(g);break;case"x":H=parseInt(o[u]).toString(B||16);break;case"d":H=parseFloat(parseInt(o[u],B||10).toPrecision(g)).toFixed(0);break}H=typeof H=="object"?JSON.stringify(H):(+H).toString(B);let j=parseInt(S),Y=S&&S[0]+""=="0"?"0":" ";for(;H.length<j;)H=w!==void 0?H+Y:Y+H;return H}let h=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(h,d)}static getBytes(r,o){return Pe.encode(r,o)}static getCharCode(r,o=0){return r.charCodeAt(o)}static getCharAt(r){return String.fromCharCode(r)}}Ie.SHIFT_JIS=Z.SJIS.getName(),Ie.GB2312="GB2312",Ie.ISO88591=Z.ISO8859_1.getName(),Ie.EUC_JP="EUC_JP",Ie.UTF8=Z.UTF8.getName(),Ie.PLATFORM_DEFAULT_ENCODING=Ie.UTF8,Ie.ASSUME_SHIFT_JIS=!1;class Ne{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=Ie.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,o,u){for(let d=o;o<o+u;d++)this.append(r[d]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,o){this.value=this.value.substr(0,r)+o+this.value.substr(r+1)}substring(r,o){return this.value.substring(r,o)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,o){this.value=this.value.substr(0,r)+o+this.value.substr(r+o.length)}}class We{constructor(r,o,u,d){if(this.width=r,this.height=o,this.rowSize=u,this.bits=d,o==null&&(o=r),this.height=o,r<1||o<1)throw new A("Both dimensions must be greater than 0");u==null&&(u=Math.floor((r+31)/32)),this.rowSize=u,d==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const o=r.length,u=r[0].length,d=new We(u,o);for(let h=0;h<o;h++){const g=r[h];for(let w=0;w<u;w++)g[w]&&d.set(w,h)}return d}static parseFromString(r,o,u){if(r===null)throw new A("stringRepresentation cannot be null");const d=new Array(r.length);let h=0,g=0,w=-1,S=0,T=0;for(;T<r.length;)if(r.charAt(T)===`
`||r.charAt(T)==="\r"){if(h>g){if(w===-1)w=h-g;else if(h-g!==w)throw new A("row lengths do not match");g=h,S++}T++}else if(r.substring(T,T+o.length)===o)T+=o.length,d[h]=!0,h++;else if(r.substring(T,T+u.length)===u)T+=u.length,d[h]=!1,h++;else throw new A("illegal character encountered: "+r.substring(T));if(h>g){if(w===-1)w=h-g;else if(h-g!==w)throw new A("row lengths do not match");S++}const R=new We(w,S);for(let D=0;D<h;D++)d[D]&&R.set(Math.floor(D%w),Math.floor(D/w));return R}get(r,o){const u=o*this.rowSize+Math.floor(r/32);return(this.bits[u]>>>(r&31)&1)!==0}set(r,o){const u=o*this.rowSize+Math.floor(r/32);this.bits[u]|=1<<(r&31)&4294967295}unset(r,o){const u=o*this.rowSize+Math.floor(r/32);this.bits[u]&=~(1<<(r&31)&4294967295)}flip(r,o){const u=o*this.rowSize+Math.floor(r/32);this.bits[u]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new A("input matrix dimensions do not match");const o=new J(Math.floor(this.width/32)+1),u=this.rowSize,d=this.bits;for(let h=0,g=this.height;h<g;h++){const w=h*u,S=r.getRow(h,o).getBitArray();for(let T=0;T<u;T++)d[w+T]^=S[T]}}clear(){const r=this.bits,o=r.length;for(let u=0;u<o;u++)r[u]=0}setRegion(r,o,u,d){if(o<0||r<0)throw new A("Left and top must be nonnegative");if(d<1||u<1)throw new A("Height and width must be at least 1");const h=r+u,g=o+d;if(g>this.height||h>this.width)throw new A("The region must fit inside the matrix");const w=this.rowSize,S=this.bits;for(let T=o;T<g;T++){const R=T*w;for(let D=r;D<h;D++)S[R+Math.floor(D/32)]|=1<<(D&31)&4294967295}}getRow(r,o){o==null||o.getSize()<this.width?o=new J(this.width):o.clear();const u=this.rowSize,d=this.bits,h=r*u;for(let g=0;g<u;g++)o.setBulk(g*32,d[h+g]);return o}setRow(r,o){U.arraycopy(o.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),o=this.getHeight();let u=new J(r),d=new J(r);for(let h=0,g=Math.floor((o+1)/2);h<g;h++)u=this.getRow(h,u),d=this.getRow(o-1-h,d),u.reverse(),d.reverse(),this.setRow(h,d),this.setRow(o-1-h,u)}getEnclosingRectangle(){const r=this.width,o=this.height,u=this.rowSize,d=this.bits;let h=r,g=o,w=-1,S=-1;for(let T=0;T<o;T++)for(let R=0;R<u;R++){const D=d[T*u+R];if(D!==0){if(T<g&&(g=T),T>S&&(S=T),R*32<h){let B=0;for(;(D<<31-B&4294967295)===0;)B++;R*32+B<h&&(h=R*32+B)}if(R*32+31>w){let B=31;for(;!(D>>>B);)B--;R*32+B>w&&(w=R*32+B)}}}return w<h||S<g?null:Int32Array.from([h,g,w-h+1,S-g+1])}getTopLeftOnBit(){const r=this.rowSize,o=this.bits;let u=0;for(;u<o.length&&o[u]===0;)u++;if(u===o.length)return null;const d=u/r;let h=u%r*32;const g=o[u];let w=0;for(;(g<<31-w&4294967295)===0;)w++;return h+=w,Int32Array.from([h,d])}getBottomRightOnBit(){const r=this.rowSize,o=this.bits;let u=o.length-1;for(;u>=0&&o[u]===0;)u--;if(u<0)return null;const d=Math.floor(u/r);let h=Math.floor(u%r)*32;const g=o[u];let w=31;for(;!(g>>>w);)w--;return h+=w,Int32Array.from([h,d])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof We))return!1;const o=r;return this.width===o.width&&this.height===o.height&&this.rowSize===o.rowSize&&$.equals(this.bits,o.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+$.hashCode(this.bits),r}toString(r="X ",o="  ",u=`
`){return this.buildToString(r,o,u)}buildToString(r,o,u){let d=new Ne;for(let h=0,g=this.height;h<g;h++){for(let w=0,S=this.width;w<S;w++)d.append(this.get(w,h)?r:o);d.append(u)}return d.toString()}clone(){return new We(this.width,this.height,this.rowSize,this.bits.slice())}}class ie extends p{static getNotFoundInstance(){return new ie}}ie.kind="NotFoundException";class ve extends O{constructor(r){super(r),this.luminances=ve.EMPTY,this.buckets=new Int32Array(ve.LUMINANCE_BUCKETS)}getBlackRow(r,o){const u=this.getLuminanceSource(),d=u.getWidth();o==null||o.getSize()<d?o=new J(d):o.clear(),this.initArrays(d);const h=u.getRow(r,this.luminances),g=this.buckets;for(let S=0;S<d;S++)g[(h[S]&255)>>ve.LUMINANCE_SHIFT]++;const w=ve.estimateBlackPoint(g);if(d<3)for(let S=0;S<d;S++)(h[S]&255)<w&&o.set(S);else{let S=h[0]&255,T=h[1]&255;for(let R=1;R<d-1;R++){const D=h[R+1]&255;(T*4-S-D)/2<w&&o.set(R),S=T,T=D}}return o}getBlackMatrix(){const r=this.getLuminanceSource(),o=r.getWidth(),u=r.getHeight(),d=new We(o,u);this.initArrays(o);const h=this.buckets;for(let S=1;S<5;S++){const T=Math.floor(u*S/5),R=r.getRow(T,this.luminances),D=Math.floor(o*4/5);for(let B=Math.floor(o/5);B<D;B++){const H=R[B]&255;h[H>>ve.LUMINANCE_SHIFT]++}}const g=ve.estimateBlackPoint(h),w=r.getMatrix();for(let S=0;S<u;S++){const T=S*o;for(let R=0;R<o;R++)(w[T+R]&255)<g&&d.set(R,S)}return d}createBinarizer(r){return new ve(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const o=this.buckets;for(let u=0;u<ve.LUMINANCE_BUCKETS;u++)o[u]=0}static estimateBlackPoint(r){const o=r.length;let u=0,d=0,h=0;for(let R=0;R<o;R++)r[R]>h&&(d=R,h=r[R]),r[R]>u&&(u=r[R]);let g=0,w=0;for(let R=0;R<o;R++){const D=R-d,B=r[R]*D*D;B>w&&(g=R,w=B)}if(d>g){const R=d;d=g,g=R}if(g-d<=o/16)throw new ie;let S=g-1,T=-1;for(let R=g-1;R>d;R--){const D=R-d,B=D*D*(g-R)*(u-r[R]);B>T&&(S=R,T=B)}return S<<ve.LUMINANCE_SHIFT}}ve.LUMINANCE_BITS=5,ve.LUMINANCE_SHIFT=8-ve.LUMINANCE_BITS,ve.LUMINANCE_BUCKETS=1<<ve.LUMINANCE_BITS,ve.EMPTY=Uint8ClampedArray.from([0]);class me extends ve{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),o=r.getWidth(),u=r.getHeight();if(o>=me.MINIMUM_DIMENSION&&u>=me.MINIMUM_DIMENSION){const d=r.getMatrix();let h=o>>me.BLOCK_SIZE_POWER;(o&me.BLOCK_SIZE_MASK)!==0&&h++;let g=u>>me.BLOCK_SIZE_POWER;(u&me.BLOCK_SIZE_MASK)!==0&&g++;const w=me.calculateBlackPoints(d,h,g,o,u),S=new We(o,u);me.calculateThresholdForBlock(d,h,g,o,u,w,S),this.matrix=S}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new me(r)}static calculateThresholdForBlock(r,o,u,d,h,g,w){const S=h-me.BLOCK_SIZE,T=d-me.BLOCK_SIZE;for(let R=0;R<u;R++){let D=R<<me.BLOCK_SIZE_POWER;D>S&&(D=S);const B=me.cap(R,2,u-3);for(let H=0;H<o;H++){let j=H<<me.BLOCK_SIZE_POWER;j>T&&(j=T);const Y=me.cap(H,2,o-3);let Q=0;for(let xe=-2;xe<=2;xe++){const Ee=g[B+xe];Q+=Ee[Y-2]+Ee[Y-1]+Ee[Y]+Ee[Y+1]+Ee[Y+2]}const se=Q/25;me.thresholdBlock(r,j,D,se,d,w)}}}static cap(r,o,u){return r<o?o:r>u?u:r}static thresholdBlock(r,o,u,d,h,g){for(let w=0,S=u*h+o;w<me.BLOCK_SIZE;w++,S+=h)for(let T=0;T<me.BLOCK_SIZE;T++)(r[S+T]&255)<=d&&g.set(o+T,u+w)}static calculateBlackPoints(r,o,u,d,h){const g=h-me.BLOCK_SIZE,w=d-me.BLOCK_SIZE,S=new Array(u);for(let T=0;T<u;T++){S[T]=new Int32Array(o);let R=T<<me.BLOCK_SIZE_POWER;R>g&&(R=g);for(let D=0;D<o;D++){let B=D<<me.BLOCK_SIZE_POWER;B>w&&(B=w);let H=0,j=255,Y=0;for(let se=0,xe=R*d+B;se<me.BLOCK_SIZE;se++,xe+=d){for(let Ee=0;Ee<me.BLOCK_SIZE;Ee++){const he=r[xe+Ee]&255;H+=he,he<j&&(j=he),he>Y&&(Y=he)}if(Y-j>me.MIN_DYNAMIC_RANGE)for(se++,xe+=d;se<me.BLOCK_SIZE;se++,xe+=d)for(let Ee=0;Ee<me.BLOCK_SIZE;Ee++)H+=r[xe+Ee]&255}let Q=H>>me.BLOCK_SIZE_POWER*2;if(Y-j<=me.MIN_DYNAMIC_RANGE&&(Q=j/2,T>0&&D>0)){const se=(S[T-1][D]+2*S[T][D-1]+S[T-1][D-1])/4;j<se&&(Q=se)}S[T][D]=Q}}return S}}me.BLOCK_SIZE_POWER=3,me.BLOCK_SIZE=1<<me.BLOCK_SIZE_POWER,me.BLOCK_SIZE_MASK=me.BLOCK_SIZE-1,me.MINIMUM_DIMENSION=me.BLOCK_SIZE*5,me.MIN_DYNAMIC_RANGE=24;class pe{constructor(r,o){this.width=r,this.height=o}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,o,u,d){throw new Se("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Se("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Se("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let o=new Ne;for(let u=0;u<this.height;u++){const d=this.getRow(u,r);for(let h=0;h<this.width;h++){const g=d[h]&255;let w;g<64?w="#":g<128?w="+":g<192?w=".":w=" ",o.append(w)}o.append(`
`)}return o.toString()}}class be extends pe{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,o){const u=this.delegate.getRow(r,o),d=this.getWidth();for(let h=0;h<d;h++)u[h]=255-(u[h]&255);return u}getMatrix(){const r=this.delegate.getMatrix(),o=this.getWidth()*this.getHeight(),u=new Uint8ClampedArray(o);for(let d=0;d<o;d++)u[d]=255-(r[d]&255);return u}isCropSupported(){return this.delegate.isCropSupported()}crop(r,o,u,d){return new be(this.delegate.crop(r,o,u,d))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new be(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new be(this.delegate.rotateCounterClockwise45())}}class we extends pe{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=we.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const o=r.getContext("2d").getImageData(0,0,r.width,r.height);return we.toGrayscaleBuffer(o.data,r.width,r.height)}static toGrayscaleBuffer(r,o,u){const d=new Uint8ClampedArray(o*u);for(let h=0,g=0,w=r.length;h<w;h+=4,g++){let S;if(r[h+3]===0)S=255;else{const R=r[h],D=r[h+1],B=r[h+2];S=306*R+601*D+117*B+512>>10}d[g]=S}return d}getRow(r,o){if(r<0||r>=this.getHeight())throw new A("Requested row is outside the image: "+r);const u=this.getWidth(),d=r*u;return o===null?o=this.buffer.slice(d,d+u):(o.length<u&&(o=new Uint8ClampedArray(u)),o.set(this.buffer.slice(d,d+u))),o}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,o,u,d){return super.crop(r,o,u,d),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const o=this.getTempCanvasElement(),u=o.getContext("2d"),d=r*we.DEGREE_TO_RADIANS,h=this.canvas.width,g=this.canvas.height,w=Math.ceil(Math.abs(Math.cos(d))*h+Math.abs(Math.sin(d))*g),S=Math.ceil(Math.abs(Math.sin(d))*h+Math.abs(Math.cos(d))*g);return o.width=w,o.height=S,u.translate(w/2,S/2),u.rotate(d),u.drawImage(this.canvas,h/-2,g/-2),this.buffer=we.makeBufferFromCanvasImageData(o),this}invert(){return new be(this)}}we.DEGREE_TO_RADIANS=Math.PI/180;class X{constructor(r,o,u){this.deviceId=r,this.label=o,this.kind="videoinput",this.groupId=u||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var le=(globalThis||au||self||window||void 0)&&(globalThis||au||self||window||void 0).__awaiter||function(P,r,o,u){function d(h){return h instanceof o?h:new o(function(g){g(h)})}return new(o||(o=Promise))(function(h,g){function w(R){try{T(u.next(R))}catch(D){g(D)}}function S(R){try{T(u.throw(R))}catch(D){g(D)}}function T(R){R.done?h(R.value):d(R.value).then(w,S)}T((u=u.apply(P,r||[])).next())})};class qe{constructor(r,o=500,u){this.reader=r,this.timeBetweenScansMillis=o,this._hints=u,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return le(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),o=[];for(const u of r){const d=u.kind==="video"?"videoinput":u.kind;if(d!=="videoinput")continue;const h=u.deviceId||u.id,g=u.label||`Video device ${o.length+1}`,w=u.groupId,S={deviceId:h,label:g,kind:d,groupId:w};o.push(S)}return o})}getVideoInputDevices(){return le(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(o=>new X(o.deviceId,o.label))})}findDeviceById(r){return le(this,void 0,void 0,function*(){const o=yield this.listVideoInputDevices();return o?o.find(u=>u.deviceId===r):null})}decodeFromInputVideoDevice(r,o){return le(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,o)})}decodeOnceFromVideoDevice(r,o){return le(this,void 0,void 0,function*(){this.reset();let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeOnceFromConstraints(d,o)})}decodeOnceFromConstraints(r,o){return le(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(u,o)})}decodeOnceFromStream(r,o){return le(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,o);return yield this.decodeOnce(u)})}decodeFromInputVideoDeviceContinuously(r,o,u){return le(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,o,u)})}decodeFromVideoDevice(r,o,u){return le(this,void 0,void 0,function*(){let d;r?d={deviceId:{exact:r}}:d={facingMode:"environment"};const h={video:d};return yield this.decodeFromConstraints(h,o,u)})}decodeFromConstraints(r,o,u){return le(this,void 0,void 0,function*(){const d=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(d,o,u)})}decodeFromStream(r,o,u){return le(this,void 0,void 0,function*(){this.reset();const d=yield this.attachStreamToVideo(r,o);return yield this.decodeContinuously(d,u)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,o){return le(this,void 0,void 0,function*(){const u=this.prepareVideoElement(o);return this.addVideoSource(u,r),this.videoElement=u,this.stream=r,yield this.playVideoOnLoadAsync(u),u})}playVideoOnLoadAsync(r){return new Promise((o,u)=>this.playVideoOnLoad(r,()=>o()))}playVideoOnLoad(r,o){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",o),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return le(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,o){const u=document.getElementById(r);if(!u)throw new _(`element with id '${r}' not found`);if(u.nodeName.toLowerCase()!==o.toLowerCase())throw new _(`element with id '${r}' must be an ${o} element`);return u}decodeFromImage(r,o){if(!r&&!o)throw new _("either imageElement with a src set or an url must be provided");return o&&!r?this.decodeFromImageUrl(o):this.decodeFromImageElement(r)}decodeFromVideo(r,o){if(!r&&!o)throw new _("Either an element with a src set or an URL must be provided");return o&&!r?this.decodeFromVideoUrl(o):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,o,u){if(r===void 0&&o===void 0)throw new _("Either an element with a src set or an URL must be provided");return o&&!r?this.decodeFromVideoUrlContinuously(o,u):this.decodeFromVideoElementContinuously(r,u)}decodeFromImageElement(r){if(!r)throw new _("An image element must be provided.");this.reset();const o=this.prepareImageElement(r);this.imageElement=o;let u;return this.isImageLoaded(o)?u=this.decodeOnce(o,!1,!0):u=this._decodeOnLoadImage(o),u}decodeFromVideoElement(r){const o=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(o)}decodeFromVideoElementContinuously(r,o){const u=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(u,o)}_decodeFromVideoElementSetup(r){if(!r)throw new _("A video element must be provided.");this.reset();const o=this.prepareVideoElement(r);return this.videoElement=o,o}decodeFromImageUrl(r){if(!r)throw new _("An URL must be provided.");this.reset();const o=this.prepareImageElement();this.imageElement=o;const u=this._decodeOnLoadImage(o);return o.src=r,u}decodeFromVideoUrl(r){if(!r)throw new _("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),u=this.decodeFromVideoElement(o);return o.src=r,u}decodeFromVideoUrlContinuously(r,o){if(!r)throw new _("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),d=this.decodeFromVideoElementContinuously(u,o);return u.src=r,d}_decodeOnLoadImage(r){return new Promise((o,u)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(o,u),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return le(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,o){return le(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,o)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let o;return typeof r>"u"&&(o=document.createElement("img"),o.width=200,o.height=200),typeof r=="string"&&(o=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(o=r),o}prepareVideoElement(r){let o;return!r&&typeof document<"u"&&(o=document.createElement("video"),o.width=200,o.height=200),typeof r=="string"&&(o=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(o=r),o.setAttribute("autoplay","true"),o.setAttribute("muted","true"),o.setAttribute("playsinline","true"),o}decodeOnce(r,o=!0,u=!0){this._stopAsyncDecode=!1;const d=(h,g)=>{if(this._stopAsyncDecode){g(new ie("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const w=this.decode(r);h(w)}catch(w){const S=o&&w instanceof ie,R=(w instanceof k||w instanceof ee)&&u;if(S||R)return setTimeout(d,this._timeBetweenDecodingAttempts,h,g);g(w)}};return new Promise((h,g)=>d(h,g))}decodeContinuously(r,o){this._stopContinuousDecode=!1;const u=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const d=this.decode(r);o(d,null),setTimeout(u,this.timeBetweenScansMillis)}catch(d){o(null,d);const h=d instanceof k||d instanceof ee,g=d instanceof ie;(h||g)&&setTimeout(u,this._timeBetweenDecodingAttempts)}};u()}decode(r){const o=this.createBinaryBitmap(r);return this.decodeBitmap(o)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,o,u){o||(o={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),u||(u=this.captureCanvasContext),u.drawImage(r,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}drawImageOnCanvas(r,o,u=this.captureCanvasContext){o||(o={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),u||(u=this.captureCanvasContext),u.drawImage(r,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const o=this.getCaptureCanvas(r),u=new we(o),d=new me(u);return new b(d)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const u=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=u}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const o=this.createCaptureCanvas(r);this.captureCanvas=o}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const o=document.createElement("canvas");let u,d;return typeof r<"u"&&(r instanceof HTMLVideoElement?(u=r.videoWidth,d=r.videoHeight):r instanceof HTMLImageElement&&(u=r.naturalWidth||r.width,d=r.naturalHeight||r.height)),o.style.width=u+"px",o.style.height=d+"px",o.width=u,o.height=d,o}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,o){try{r.srcObject=o}catch{r.src=URL.createObjectURL(o)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class De{constructor(r,o,u=o==null?0:8*o.length,d,h,g=U.currentTimeMillis()){this.text=r,this.rawBytes=o,this.numBits=u,this.resultPoints=d,this.format=h,this.timestamp=g,this.text=r,this.rawBytes=o,u==null?this.numBits=o==null?0:8*o.length:this.numBits=u,this.resultPoints=d,this.format=h,this.resultMetadata=null,g==null?this.timestamp=U.currentTimeMillis():this.timestamp=g}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,o){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,o)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const o=this.resultPoints;if(o===null)this.resultPoints=r;else if(r!==null&&r.length>0){const u=new Array(o.length+r.length);U.arraycopy(o,0,u,0,o.length),U.arraycopy(r,0,u,o.length,r.length),this.resultPoints=u}}getTimestamp(){return this.timestamp}toString(){return this.text}}var at;(function(P){P[P.AZTEC=0]="AZTEC",P[P.CODABAR=1]="CODABAR",P[P.CODE_39=2]="CODE_39",P[P.CODE_93=3]="CODE_93",P[P.CODE_128=4]="CODE_128",P[P.DATA_MATRIX=5]="DATA_MATRIX",P[P.EAN_8=6]="EAN_8",P[P.EAN_13=7]="EAN_13",P[P.ITF=8]="ITF",P[P.MAXICODE=9]="MAXICODE",P[P.PDF_417=10]="PDF_417",P[P.QR_CODE=11]="QR_CODE",P[P.RSS_14=12]="RSS_14",P[P.RSS_EXPANDED=13]="RSS_EXPANDED",P[P.UPC_A=14]="UPC_A",P[P.UPC_E=15]="UPC_E",P[P.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(at||(at={}));var Ce=at,St;(function(P){P[P.OTHER=0]="OTHER",P[P.ORIENTATION=1]="ORIENTATION",P[P.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",P[P.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",P[P.ISSUE_NUMBER=4]="ISSUE_NUMBER",P[P.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",P[P.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",P[P.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",P[P.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",P[P.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",P[P.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(St||(St={}));var Ze=St;class At{constructor(r,o,u,d,h=-1,g=-1){this.rawBytes=r,this.text=o,this.byteSegments=u,this.ecLevel=d,this.structuredAppendSequenceNumber=h,this.structuredAppendParity=g,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class pn{exp(r){return this.expTable[r]}log(r){if(r===0)throw new A;return this.logTable[r]}static addOrSubtract(r,o){return r^o}}class gn{constructor(r,o){if(o.length===0)throw new A;this.field=r;const u=o.length;if(u>1&&o[0]===0){let d=1;for(;d<u&&o[d]===0;)d++;d===u?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(u-d),U.arraycopy(o,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const o=this.coefficients;let u;if(r===1){u=0;for(let g=0,w=o.length;g!==w;g++){const S=o[g];u=pn.addOrSubtract(u,S)}return u}u=o[0];const d=o.length,h=this.field;for(let g=1;g<d;g++)u=pn.addOrSubtract(h.multiply(r,u),o[g]);return u}addOrSubtract(r){if(!this.field.equals(r.field))throw new A("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let o=this.coefficients,u=r.coefficients;if(o.length>u.length){const g=o;o=u,u=g}let d=new Int32Array(u.length);const h=u.length-o.length;U.arraycopy(u,0,d,0,h);for(let g=h;g<u.length;g++)d[g]=pn.addOrSubtract(o[g-h],u[g]);return new gn(this.field,d)}multiply(r){if(!this.field.equals(r.field))throw new A("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const o=this.coefficients,u=o.length,d=r.coefficients,h=d.length,g=new Int32Array(u+h-1),w=this.field;for(let S=0;S<u;S++){const T=o[S];for(let R=0;R<h;R++)g[S+R]=pn.addOrSubtract(g[S+R],w.multiply(T,d[R]))}return new gn(w,g)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const o=this.coefficients.length,u=this.field,d=new Int32Array(o),h=this.coefficients;for(let g=0;g<o;g++)d[g]=u.multiply(h[g],r);return new gn(u,d)}multiplyByMonomial(r,o){if(r<0)throw new A;if(o===0)return this.field.getZero();const u=this.coefficients,d=u.length,h=new Int32Array(d+r),g=this.field;for(let w=0;w<d;w++)h[w]=g.multiply(u[w],o);return new gn(g,h)}divide(r){if(!this.field.equals(r.field))throw new A("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new A("Divide by 0");const o=this.field;let u=o.getZero(),d=this;const h=r.getCoefficient(r.getDegree()),g=o.inverse(h);for(;d.getDegree()>=r.getDegree()&&!d.isZero();){const w=d.getDegree()-r.getDegree(),S=o.multiply(d.getCoefficient(d.getDegree()),g),T=r.multiplyByMonomial(w,S),R=o.buildMonomial(w,S);u=u.addOrSubtract(R),d=d.addOrSubtract(T)}return[u,d]}toString(){let r="";for(let o=this.getDegree();o>=0;o--){let u=this.getCoefficient(o);if(u!==0){if(u<0?(r+=" - ",u=-u):r.length>0&&(r+=" + "),o===0||u!==1){const d=this.field.log(u);d===0?r+="1":d===1?r+="a":(r+="a^",r+=d)}o!==0&&(o===1?r+="x":(r+="x^",r+=o))}}return r}}class xs extends p{}xs.kind="ArithmeticException";class pt extends pn{constructor(r,o,u){super(),this.primitive=r,this.size=o,this.generatorBase=u;const d=new Int32Array(o);let h=1;for(let w=0;w<o;w++)d[w]=h,h*=2,h>=o&&(h^=r,h&=o-1);this.expTable=d;const g=new Int32Array(o);for(let w=0;w<o-1;w++)g[d[w]]=w;this.logTable=g,this.zero=new gn(this,Int32Array.from([0])),this.one=new gn(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,o){if(r<0)throw new A;if(o===0)return this.zero;const u=new Int32Array(r+1);return u[0]=o,new gn(this,u)}inverse(r){if(r===0)throw new xs;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,o){return r===0||o===0?0:this.expTable[(this.logTable[r]+this.logTable[o])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+G.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}pt.AZTEC_DATA_12=new pt(4201,4096,1),pt.AZTEC_DATA_10=new pt(1033,1024,1),pt.AZTEC_DATA_6=new pt(67,64,1),pt.AZTEC_PARAM=new pt(19,16,1),pt.QR_CODE_FIELD_256=new pt(285,256,0),pt.DATA_MATRIX_FIELD_256=new pt(301,256,1),pt.AZTEC_DATA_8=pt.DATA_MATRIX_FIELD_256,pt.MAXICODE_FIELD_64=pt.AZTEC_DATA_6;class ii extends p{}ii.kind="ReedSolomonException";class fr extends p{}fr.kind="IllegalStateException";class Fi{constructor(r){this.field=r}decode(r,o){const u=this.field,d=new gn(u,r),h=new Int32Array(o);let g=!0;for(let H=0;H<o;H++){const j=d.evaluateAt(u.exp(H+u.getGeneratorBase()));h[h.length-1-H]=j,j!==0&&(g=!1)}if(g)return;const w=new gn(u,h),S=this.runEuclideanAlgorithm(u.buildMonomial(o,1),w,o),T=S[0],R=S[1],D=this.findErrorLocations(T),B=this.findErrorMagnitudes(R,D);for(let H=0;H<D.length;H++){const j=r.length-1-u.log(D[H]);if(j<0)throw new ii("Bad error location");r[j]=pt.addOrSubtract(r[j],B[H])}}runEuclideanAlgorithm(r,o,u){if(r.getDegree()<o.getDegree()){const H=r;r=o,o=H}const d=this.field;let h=r,g=o,w=d.getZero(),S=d.getOne();for(;g.getDegree()>=(u/2|0);){let H=h,j=w;if(h=g,w=S,h.isZero())throw new ii("r_{i-1} was zero");g=H;let Y=d.getZero();const Q=h.getCoefficient(h.getDegree()),se=d.inverse(Q);for(;g.getDegree()>=h.getDegree()&&!g.isZero();){const xe=g.getDegree()-h.getDegree(),Ee=d.multiply(g.getCoefficient(g.getDegree()),se);Y=Y.addOrSubtract(d.buildMonomial(xe,Ee)),g=g.addOrSubtract(h.multiplyByMonomial(xe,Ee))}if(S=Y.multiply(w).addOrSubtract(j),g.getDegree()>=h.getDegree())throw new fr("Division algorithm failed to reduce polynomial?")}const T=S.getCoefficient(0);if(T===0)throw new ii("sigmaTilde(0) was zero");const R=d.inverse(T),D=S.multiplyScalar(R),B=g.multiplyScalar(R);return[D,B]}findErrorLocations(r){const o=r.getDegree();if(o===1)return Int32Array.from([r.getCoefficient(1)]);const u=new Int32Array(o);let d=0;const h=this.field;for(let g=1;g<h.getSize()&&d<o;g++)r.evaluateAt(g)===0&&(u[d]=h.inverse(g),d++);if(d!==o)throw new ii("Error locator degree does not match number of roots");return u}findErrorMagnitudes(r,o){const u=o.length,d=new Int32Array(u),h=this.field;for(let g=0;g<u;g++){const w=h.inverse(o[g]);let S=1;for(let T=0;T<u;T++)if(g!==T){const R=h.multiply(o[T],w),D=(R&1)===0?R|1:R&-2;S=h.multiply(S,D)}d[g]=h.multiply(r.evaluateAt(w),h.inverse(S)),h.getGeneratorBase()!==0&&(d[g]=h.multiply(d[g],w))}return d}}var rn;(function(P){P[P.UPPER=0]="UPPER",P[P.LOWER=1]="LOWER",P[P.MIXED=2]="MIXED",P[P.DIGIT=3]="DIGIT",P[P.PUNCT=4]="PUNCT",P[P.BINARY=5]="BINARY"})(rn||(rn={}));class Nt{decode(r){this.ddata=r;let o=r.getBits(),u=this.extractBits(o),d=this.correctBits(u),h=Nt.convertBoolArrayToByteArray(d),g=Nt.getEncodedData(d),w=new At(h,g,null,null);return w.setNumBits(d.length),w}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let o=r.length,u=rn.UPPER,d=rn.UPPER,h="",g=0;for(;g<o;)if(d===rn.BINARY){if(o-g<5)break;let w=Nt.readCode(r,g,5);if(g+=5,w===0){if(o-g<11)break;w=Nt.readCode(r,g,11)+31,g+=11}for(let S=0;S<w;S++){if(o-g<8){g=o;break}const T=Nt.readCode(r,g,8);h+=Ie.castAsNonUtf8Char(T),g+=8}d=u}else{let w=d===rn.DIGIT?4:5;if(o-g<w)break;let S=Nt.readCode(r,g,w);g+=w;let T=Nt.getCharacter(d,S);T.startsWith("CTRL_")?(u=d,d=Nt.getTable(T.charAt(5)),T.charAt(6)==="L"&&(u=d)):(h+=T,d=u)}return h}static getTable(r){switch(r){case"L":return rn.LOWER;case"P":return rn.PUNCT;case"M":return rn.MIXED;case"D":return rn.DIGIT;case"B":return rn.BINARY;case"U":default:return rn.UPPER}}static getCharacter(r,o){switch(r){case rn.UPPER:return Nt.UPPER_TABLE[o];case rn.LOWER:return Nt.LOWER_TABLE[o];case rn.MIXED:return Nt.MIXED_TABLE[o];case rn.PUNCT:return Nt.PUNCT_TABLE[o];case rn.DIGIT:return Nt.DIGIT_TABLE[o];default:throw new fr("Bad table")}}correctBits(r){let o,u;this.ddata.getNbLayers()<=2?(u=6,o=pt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(u=8,o=pt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(u=10,o=pt.AZTEC_DATA_10):(u=12,o=pt.AZTEC_DATA_12);let d=this.ddata.getNbDatablocks(),h=r.length/u;if(h<d)throw new ee;let g=r.length%u,w=new Int32Array(h);for(let B=0;B<h;B++,g+=u)w[B]=Nt.readCode(r,g,u);try{new Fi(o).decode(w,h-d)}catch(B){throw new ee(B)}let S=(1<<u)-1,T=0;for(let B=0;B<d;B++){let H=w[B];if(H===0||H===S)throw new ee;(H===1||H===S-1)&&T++}let R=new Array(d*u-T),D=0;for(let B=0;B<d;B++){let H=w[B];if(H===1||H===S-1)R.fill(H>1,D,D+u-1),D+=u-1;else for(let j=u-1;j>=0;--j)R[D++]=(H&1<<j)!==0}return R}extractBits(r){let o=this.ddata.isCompact(),u=this.ddata.getNbLayers(),d=(o?11:14)+u*4,h=new Int32Array(d),g=new Array(this.totalBitsInLayer(u,o));if(o)for(let w=0;w<h.length;w++)h[w]=w;else{let w=d+1+2*G.truncDivision(G.truncDivision(d,2)-1,15),S=d/2,T=G.truncDivision(w,2);for(let R=0;R<S;R++){let D=R+G.truncDivision(R,15);h[S-R-1]=T-D-1,h[S+R]=T+D+1}}for(let w=0,S=0;w<u;w++){let T=(u-w)*4+(o?9:12),R=w*2,D=d-1-R;for(let B=0;B<T;B++){let H=B*2;for(let j=0;j<2;j++)g[S+H+j]=r.get(h[R+j],h[R+B]),g[S+2*T+H+j]=r.get(h[R+B],h[D-j]),g[S+4*T+H+j]=r.get(h[D-j],h[D-B]),g[S+6*T+H+j]=r.get(h[D-B],h[R+j])}S+=T*8}return g}static readCode(r,o,u){let d=0;for(let h=o;h<o+u;h++)d<<=1,r[h]&&(d|=1);return d}static readByte(r,o){let u=r.length-o;return u>=8?Nt.readCode(r,o,8):Nt.readCode(r,o,u)<<8-u}static convertBoolArrayToByteArray(r){let o=new Uint8Array((r.length+7)/8);for(let u=0;u<o.length;u++)o[u]=Nt.readByte(r,8*u);return o}totalBitsInLayer(r,o){return((o?88:112)+16*r)*r}}Nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Nt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class dt{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,o,u,d){const h=r-u,g=o-d;return Math.sqrt(h*h+g*g)}static sum(r){let o=0;for(let u=0,d=r.length;u!==d;u++){const h=r[u];o+=h}return o}}class si{static floatToIntBits(r){return r}}si.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Oe{constructor(r,o){this.x=r,this.y=o}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof Oe){const o=r;return this.x===o.x&&this.y===o.y}return!1}hashCode(){return 31*si.floatToIntBits(this.x)+si.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const o=this.distance(r[0],r[1]),u=this.distance(r[1],r[2]),d=this.distance(r[0],r[2]);let h,g,w;if(u>=o&&u>=d?(g=r[0],h=r[1],w=r[2]):d>=u&&d>=o?(g=r[1],h=r[0],w=r[2]):(g=r[2],h=r[0],w=r[1]),this.crossProductZ(h,g,w)<0){const S=h;h=w,w=S}r[0]=h,r[1]=g,r[2]=w}static distance(r,o){return dt.distance(r.x,r.y,o.x,o.y)}static crossProductZ(r,o,u){const d=o.x,h=o.y;return(u.x-d)*(r.y-h)-(u.y-h)*(r.x-d)}}class Ui{constructor(r,o){this.bits=r,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class Zo extends Ui{constructor(r,o,u,d,h){super(r,o),this.compact=u,this.nbDatablocks=d,this.nbLayers=h}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class br{constructor(r,o,u,d){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),o==null&&(o=br.INIT_SIZE),u==null&&(u=r.getWidth()/2|0),d==null&&(d=r.getHeight()/2|0);const h=o/2|0;if(this.leftInit=u-h,this.rightInit=u+h,this.upInit=d-h,this.downInit=d+h,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ie}detect(){let r=this.leftInit,o=this.rightInit,u=this.upInit,d=this.downInit,h=!1,g=!0,w=!1,S=!1,T=!1,R=!1,D=!1;const B=this.width,H=this.height;for(;g;){g=!1;let j=!0;for(;(j||!S)&&o<B;)j=this.containsBlackPoint(u,d,o,!1),j?(o++,g=!0,S=!0):S||o++;if(o>=B){h=!0;break}let Y=!0;for(;(Y||!T)&&d<H;)Y=this.containsBlackPoint(r,o,d,!0),Y?(d++,g=!0,T=!0):T||d++;if(d>=H){h=!0;break}let Q=!0;for(;(Q||!R)&&r>=0;)Q=this.containsBlackPoint(u,d,r,!1),Q?(r--,g=!0,R=!0):R||r--;if(r<0){h=!0;break}let se=!0;for(;(se||!D)&&u>=0;)se=this.containsBlackPoint(r,o,u,!0),se?(u--,g=!0,D=!0):D||u--;if(u<0){h=!0;break}g&&(w=!0)}if(!h&&w){const j=o-r;let Y=null;for(let Ee=1;Y===null&&Ee<j;Ee++)Y=this.getBlackPointOnSegment(r,d-Ee,r+Ee,d);if(Y==null)throw new ie;let Q=null;for(let Ee=1;Q===null&&Ee<j;Ee++)Q=this.getBlackPointOnSegment(r,u+Ee,r+Ee,u);if(Q==null)throw new ie;let se=null;for(let Ee=1;se===null&&Ee<j;Ee++)se=this.getBlackPointOnSegment(o,u+Ee,o-Ee,u);if(se==null)throw new ie;let xe=null;for(let Ee=1;xe===null&&Ee<j;Ee++)xe=this.getBlackPointOnSegment(o,d-Ee,o-Ee,d);if(xe==null)throw new ie;return this.centerEdges(xe,Y,se,Q)}else throw new ie}getBlackPointOnSegment(r,o,u,d){const h=dt.round(dt.distance(r,o,u,d)),g=(u-r)/h,w=(d-o)/h,S=this.image;for(let T=0;T<h;T++){const R=dt.round(r+T*g),D=dt.round(o+T*w);if(S.get(R,D))return new Oe(R,D)}return null}centerEdges(r,o,u,d){const h=r.getX(),g=r.getY(),w=o.getX(),S=o.getY(),T=u.getX(),R=u.getY(),D=d.getX(),B=d.getY(),H=br.CORR;return h<this.width/2?[new Oe(D-H,B+H),new Oe(w+H,S+H),new Oe(T-H,R-H),new Oe(h+H,g-H)]:[new Oe(D+H,B+H),new Oe(w+H,S-H),new Oe(T-H,R+H),new Oe(h-H,g-H)]}containsBlackPoint(r,o,u,d){const h=this.image;if(d){for(let g=r;g<=o;g++)if(h.get(g,u))return!0}else for(let g=r;g<=o;g++)if(h.get(u,g))return!0;return!1}}br.INIT_SIZE=10,br.CORR=1;class to{static checkAndNudgePoints(r,o){const u=r.getWidth(),d=r.getHeight();let h=!0;for(let g=0;g<o.length&&h;g+=2){const w=Math.floor(o[g]),S=Math.floor(o[g+1]);if(w<-1||w>u||S<-1||S>d)throw new ie;h=!1,w===-1?(o[g]=0,h=!0):w===u&&(o[g]=u-1,h=!0),S===-1?(o[g+1]=0,h=!0):S===d&&(o[g+1]=d-1,h=!0)}h=!0;for(let g=o.length-2;g>=0&&h;g-=2){const w=Math.floor(o[g]),S=Math.floor(o[g+1]);if(w<-1||w>u||S<-1||S>d)throw new ie;h=!1,w===-1?(o[g]=0,h=!0):w===u&&(o[g]=u-1,h=!0),S===-1?(o[g+1]=0,h=!0):S===d&&(o[g+1]=d-1,h=!0)}}}class er{constructor(r,o,u,d,h,g,w,S,T){this.a11=r,this.a21=o,this.a31=u,this.a12=d,this.a22=h,this.a32=g,this.a13=w,this.a23=S,this.a33=T}static quadrilateralToQuadrilateral(r,o,u,d,h,g,w,S,T,R,D,B,H,j,Y,Q){const se=er.quadrilateralToSquare(r,o,u,d,h,g,w,S);return er.squareToQuadrilateral(T,R,D,B,H,j,Y,Q).times(se)}transformPoints(r){const o=r.length,u=this.a11,d=this.a12,h=this.a13,g=this.a21,w=this.a22,S=this.a23,T=this.a31,R=this.a32,D=this.a33;for(let B=0;B<o;B+=2){const H=r[B],j=r[B+1],Y=h*H+S*j+D;r[B]=(u*H+g*j+T)/Y,r[B+1]=(d*H+w*j+R)/Y}}transformPointsWithValues(r,o){const u=this.a11,d=this.a12,h=this.a13,g=this.a21,w=this.a22,S=this.a23,T=this.a31,R=this.a32,D=this.a33,B=r.length;for(let H=0;H<B;H++){const j=r[H],Y=o[H],Q=h*j+S*Y+D;r[H]=(u*j+g*Y+T)/Q,o[H]=(d*j+w*Y+R)/Q}}static squareToQuadrilateral(r,o,u,d,h,g,w,S){const T=r-u+h-w,R=o-d+g-S;if(T===0&&R===0)return new er(u-r,h-u,r,d-o,g-d,o,0,0,1);{const D=u-h,B=w-h,H=d-g,j=S-g,Y=D*j-B*H,Q=(T*j-B*R)/Y,se=(D*R-T*H)/Y;return new er(u-r+Q*u,w-r+se*w,r,d-o+Q*d,S-o+se*S,o,Q,se,1)}}static quadrilateralToSquare(r,o,u,d,h,g,w,S){return er.squareToQuadrilateral(r,o,u,d,h,g,w,S).buildAdjoint()}buildAdjoint(){return new er(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new er(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class no extends to{sampleGrid(r,o,u,d,h,g,w,S,T,R,D,B,H,j,Y,Q,se,xe,Ee){const he=er.quadrilateralToQuadrilateral(d,h,g,w,S,T,R,D,B,H,j,Y,Q,se,xe,Ee);return this.sampleGridWithTransform(r,o,u,he)}sampleGridWithTransform(r,o,u,d){if(o<=0||u<=0)throw new ie;const h=new We(o,u),g=new Float32Array(2*o);for(let w=0;w<u;w++){const S=g.length,T=w+.5;for(let R=0;R<S;R+=2)g[R]=R/2+.5,g[R+1]=T;d.transformPoints(g),to.checkAndNudgePoints(r,g);try{for(let R=0;R<S;R+=2)r.get(Math.floor(g[R]),Math.floor(g[R+1]))&&h.set(R/2,w)}catch{throw new ie}}return h}}class hr{static setGridSampler(r){hr.gridSampler=r}static getInstance(){return hr.gridSampler}}hr.gridSampler=new no;class Cn{constructor(r,o){this.x=r,this.y=o}toResultPoint(){return new Oe(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Vi{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let o=this.getMatrixCenter(),u=this.getBullsEyeCorners(o);if(r){let g=u[0];u[0]=u[2],u[2]=g}this.extractParameters(u);let d=this.sampleGrid(this.image,u[this.shift%4],u[(this.shift+1)%4],u[(this.shift+2)%4],u[(this.shift+3)%4]),h=this.getMatrixCornerPoints(u);return new Zo(d,h,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new ie;let o=2*this.nbCenterLayers,u=new Int32Array([this.sampleLine(r[0],r[1],o),this.sampleLine(r[1],r[2],o),this.sampleLine(r[2],r[3],o),this.sampleLine(r[3],r[0],o)]);this.shift=this.getRotation(u,o);let d=0;for(let g=0;g<4;g++){let w=u[(this.shift+g)%4];this.compact?(d<<=7,d+=w>>1&127):(d<<=10,d+=(w>>2&992)+(w>>1&31))}let h=this.getCorrectedParameterData(d,this.compact);this.compact?(this.nbLayers=(h>>6)+1,this.nbDataBlocks=(h&63)+1):(this.nbLayers=(h>>11)+1,this.nbDataBlocks=(h&2047)+1)}getRotation(r,o){let u=0;r.forEach((d,h,g)=>{let w=(d>>o-2<<1)+(d&1);u=(u<<3)+w}),u=((u&1)<<11)+(u>>1);for(let d=0;d<4;d++)if(G.bitCount(u^this.EXPECTED_CORNER_BITS[d])<=2)return d;throw new ie}getCorrectedParameterData(r,o){let u,d;o?(u=7,d=2):(u=10,d=4);let h=u-d,g=new Int32Array(u);for(let S=u-1;S>=0;--S)g[S]=r&15,r>>=4;try{new Fi(pt.AZTEC_PARAM).decode(g,h)}catch{throw new ie}let w=0;for(let S=0;S<d;S++)w=(w<<4)+g[S];return w}getBullsEyeCorners(r){let o=r,u=r,d=r,h=r,g=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let D=this.getFirstDifferent(o,g,1,-1),B=this.getFirstDifferent(u,g,1,1),H=this.getFirstDifferent(d,g,-1,1),j=this.getFirstDifferent(h,g,-1,-1);if(this.nbCenterLayers>2){let Y=this.distancePoint(j,D)*this.nbCenterLayers/(this.distancePoint(h,o)*(this.nbCenterLayers+2));if(Y<.75||Y>1.25||!this.isWhiteOrBlackRectangle(D,B,H,j))break}o=D,u=B,d=H,h=j,g=!g}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ie;this.compact=this.nbCenterLayers===5;let w=new Oe(o.getX()+.5,o.getY()-.5),S=new Oe(u.getX()+.5,u.getY()+.5),T=new Oe(d.getX()-.5,d.getY()+.5),R=new Oe(h.getX()-.5,h.getY()-.5);return this.expandSquare([w,S,T,R],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,o,u,d;try{let w=new br(this.image).detect();r=w[0],o=w[1],u=w[2],d=w[3]}catch{let S=this.image.getWidth()/2,T=this.image.getHeight()/2;r=this.getFirstDifferent(new Cn(S+7,T-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new Cn(S+7,T+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new Cn(S-7,T+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new Cn(S-7,T-7),!1,-1,-1).toResultPoint()}let h=dt.round((r.getX()+d.getX()+o.getX()+u.getX())/4),g=dt.round((r.getY()+d.getY()+o.getY()+u.getY())/4);try{let w=new br(this.image,15,h,g).detect();r=w[0],o=w[1],u=w[2],d=w[3]}catch{r=this.getFirstDifferent(new Cn(h+7,g-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new Cn(h+7,g+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new Cn(h-7,g+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new Cn(h-7,g-7),!1,-1,-1).toResultPoint()}return h=dt.round((r.getX()+d.getX()+o.getX()+u.getX())/4),g=dt.round((r.getY()+d.getY()+o.getY()+u.getY())/4),new Cn(h,g)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,o,u,d,h){let g=hr.getInstance(),w=this.getDimension(),S=w/2-this.nbCenterLayers,T=w/2+this.nbCenterLayers;return g.sampleGrid(r,w,w,S,S,T,S,T,T,S,T,o.getX(),o.getY(),u.getX(),u.getY(),d.getX(),d.getY(),h.getX(),h.getY())}sampleLine(r,o,u){let d=0,h=this.distanceResultPoint(r,o),g=h/u,w=r.getX(),S=r.getY(),T=g*(o.getX()-r.getX())/h,R=g*(o.getY()-r.getY())/h;for(let D=0;D<u;D++)this.image.get(dt.round(w+D*T),dt.round(S+D*R))&&(d|=1<<u-D-1);return d}isWhiteOrBlackRectangle(r,o,u,d){let h=3;r=new Cn(r.getX()-h,r.getY()+h),o=new Cn(o.getX()-h,o.getY()-h),u=new Cn(u.getX()+h,u.getY()-h),d=new Cn(d.getX()+h,d.getY()+h);let g=this.getColor(d,r);if(g===0)return!1;let w=this.getColor(r,o);return w!==g||(w=this.getColor(o,u),w!==g)?!1:(w=this.getColor(u,d),w===g)}getColor(r,o){let u=this.distancePoint(r,o),d=(o.getX()-r.getX())/u,h=(o.getY()-r.getY())/u,g=0,w=r.getX(),S=r.getY(),T=this.image.get(r.getX(),r.getY()),R=Math.ceil(u);for(let B=0;B<R;B++)w+=d,S+=h,this.image.get(dt.round(w),dt.round(S))!==T&&g++;let D=g/u;return D>.1&&D<.9?0:D<=.1===T?1:-1}getFirstDifferent(r,o,u,d){let h=r.getX()+u,g=r.getY()+d;for(;this.isValid(h,g)&&this.image.get(h,g)===o;)h+=u,g+=d;for(h-=u,g-=d;this.isValid(h,g)&&this.image.get(h,g)===o;)h+=u;for(h-=u;this.isValid(h,g)&&this.image.get(h,g)===o;)g+=d;return g-=d,new Cn(h,g)}expandSquare(r,o,u){let d=u/(2*o),h=r[0].getX()-r[2].getX(),g=r[0].getY()-r[2].getY(),w=(r[0].getX()+r[2].getX())/2,S=(r[0].getY()+r[2].getY())/2,T=new Oe(w+d*h,S+d*g),R=new Oe(w-d*h,S-d*g);h=r[1].getX()-r[3].getX(),g=r[1].getY()-r[3].getY(),w=(r[1].getX()+r[3].getX())/2,S=(r[1].getY()+r[3].getY())/2;let D=new Oe(w+d*h,S+d*g),B=new Oe(w-d*h,S-d*g);return[T,D,R,B]}isValid(r,o){return r>=0&&r<this.image.getWidth()&&o>0&&o<this.image.getHeight()}isValidPoint(r){let o=dt.round(r.getX()),u=dt.round(r.getY());return this.isValid(o,u)}distancePoint(r,o){return dt.distance(r.getX(),r.getY(),o.getX(),o.getY())}distanceResultPoint(r,o){return dt.distance(r.getX(),r.getY(),o.getX(),o.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(G.truncDivision(this.nbLayers-4,8)+1)+15}}class oi{decode(r,o=null){let u=null,d=new Vi(r.getBlackMatrix()),h=null,g=null;try{let R=d.detectMirror(!1);h=R.getPoints(),this.reportFoundResultPoints(o,h),g=new Nt().decode(R)}catch(R){u=R}if(g==null)try{let R=d.detectMirror(!0);h=R.getPoints(),this.reportFoundResultPoints(o,h),g=new Nt().decode(R)}catch(R){throw u??R}let w=new De(g.getText(),g.getRawBytes(),g.getNumBits(),h,Ce.AZTEC,U.currentTimeMillis()),S=g.getByteSegments();S!=null&&w.putMetadata(Ze.BYTE_SEGMENTS,S);let T=g.getECLevel();return T!=null&&w.putMetadata(Ze.ERROR_CORRECTION_LEVEL,T),w}reportFoundResultPoints(r,o){if(r!=null){let u=r.get(ue.NEED_RESULT_POINT_CALLBACK);u!=null&&o.forEach((d,h,g)=>{u.foundPossibleResultPoint(d)})}}reset(){}}class uc extends qe{constructor(r=500){super(new oi,r)}}class Yt{decode(r,o){try{return this.doDecode(r,o)}catch{if(o&&o.get(ue.TRY_HARDER)===!0&&r.isRotateSupported()){const h=r.rotateCounterClockwise(),g=this.doDecode(h,o),w=g.getResultMetadata();let S=270;w!==null&&w.get(Ze.ORIENTATION)===!0&&(S=S+w.get(Ze.ORIENTATION)%360),g.putMetadata(Ze.ORIENTATION,S);const T=g.getResultPoints();if(T!==null){const R=h.getHeight();for(let D=0;D<T.length;D++)T[D]=new Oe(R-T[D].getY()-1,T[D].getX())}return g}else throw new ie}}reset(){}doDecode(r,o){const u=r.getWidth(),d=r.getHeight();let h=new J(u);const g=o&&o.get(ue.TRY_HARDER)===!0,w=Math.max(1,d>>(g?8:5));let S;g?S=d:S=15;const T=Math.trunc(d/2);for(let R=0;R<S;R++){const D=Math.trunc((R+1)/2),B=(R&1)===0,H=T+w*(B?D:-D);if(H<0||H>=d)break;try{h=r.getBlackRow(H,h)}catch{continue}for(let j=0;j<2;j++){if(j===1&&(h.reverse(),o&&o.get(ue.NEED_RESULT_POINT_CALLBACK)===!0)){const Y=new Map;o.forEach((Q,se)=>Y.set(se,Q)),Y.delete(ue.NEED_RESULT_POINT_CALLBACK),o=Y}try{const Y=this.decodeRow(H,h,o);if(j===1){Y.putMetadata(Ze.ORIENTATION,180);const Q=Y.getResultPoints();Q!==null&&(Q[0]=new Oe(u-Q[0].getX()-1,Q[0].getY()),Q[1]=new Oe(u-Q[1].getX()-1,Q[1].getY()))}return Y}catch{}}}throw new ie}static recordPattern(r,o,u){const d=u.length;for(let T=0;T<d;T++)u[T]=0;const h=r.getSize();if(o>=h)throw new ie;let g=!r.get(o),w=0,S=o;for(;S<h;){if(r.get(S)!==g)u[w]++;else{if(++w===d)break;u[w]=1,g=!g}S++}if(!(w===d||w===d-1&&S===h))throw new ie}static recordPatternInReverse(r,o,u){let d=u.length,h=r.get(o);for(;o>0&&d>=0;)r.get(--o)!==h&&(d--,h=!h);if(d>=0)throw new ie;Yt.recordPattern(r,o+1,u)}static patternMatchVariance(r,o,u){const d=r.length;let h=0,g=0;for(let T=0;T<d;T++)h+=r[T],g+=o[T];if(h<g)return Number.POSITIVE_INFINITY;const w=h/g;u*=w;let S=0;for(let T=0;T<d;T++){const R=r[T],D=o[T]*w,B=R>D?R-D:D-R;if(B>u)return Number.POSITIVE_INFINITY;S+=B}return S/h}}class Ae extends Yt{static findStartPattern(r){const o=r.getSize(),u=r.getNextSet(0);let d=0,h=Int32Array.from([0,0,0,0,0,0]),g=u,w=!1;const S=6;for(let T=u;T<o;T++)if(r.get(T)!==w)h[d]++;else{if(d===S-1){let R=Ae.MAX_AVG_VARIANCE,D=-1;for(let B=Ae.CODE_START_A;B<=Ae.CODE_START_C;B++){const H=Yt.patternMatchVariance(h,Ae.CODE_PATTERNS[B],Ae.MAX_INDIVIDUAL_VARIANCE);H<R&&(R=H,D=B)}if(D>=0&&r.isRange(Math.max(0,g-(T-g)/2),g,!1))return Int32Array.from([g,T,D]);g+=h[0]+h[1],h=h.slice(2,h.length-1),h[d-1]=0,h[d]=0,d--}else d++;h[d]=1,w=!w}throw new ie}static decodeCode(r,o,u){Yt.recordPattern(r,u,o);let d=Ae.MAX_AVG_VARIANCE,h=-1;for(let g=0;g<Ae.CODE_PATTERNS.length;g++){const w=Ae.CODE_PATTERNS[g],S=this.patternMatchVariance(o,w,Ae.MAX_INDIVIDUAL_VARIANCE);S<d&&(d=S,h=g)}if(h>=0)return h;throw new ie}decodeRow(r,o,u){const d=u&&u.get(ue.ASSUME_GS1)===!0,h=Ae.findStartPattern(o),g=h[2];let w=0;const S=new Uint8Array(20);S[w++]=g;let T;switch(g){case Ae.CODE_START_A:T=Ae.CODE_CODE_A;break;case Ae.CODE_START_B:T=Ae.CODE_CODE_B;break;case Ae.CODE_START_C:T=Ae.CODE_CODE_C;break;default:throw new ee}let R=!1,D=!1,B="",H=h[0],j=h[1];const Y=Int32Array.from([0,0,0,0,0,0]);let Q=0,se=0,xe=g,Ee=0,he=!0,lt=!1,nt=!1;for(;!R;){const qr=D;switch(D=!1,Q=se,se=Ae.decodeCode(o,Y,j),S[w++]=se,se!==Ae.CODE_STOP&&(he=!0),se!==Ae.CODE_STOP&&(Ee++,xe+=Ee*se),H=j,j+=Y.reduce((Ji,wa)=>Ji+wa,0),se){case Ae.CODE_START_A:case Ae.CODE_START_B:case Ae.CODE_START_C:throw new ee}switch(T){case Ae.CODE_CODE_A:if(se<64)nt===lt?B+=String.fromCharCode(32+se):B+=String.fromCharCode(32+se+128),nt=!1;else if(se<96)nt===lt?B+=String.fromCharCode(se-64):B+=String.fromCharCode(se+64),nt=!1;else switch(se!==Ae.CODE_STOP&&(he=!1),se){case Ae.CODE_FNC_1:d&&(B.length===0?B+="]C1":B+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_A:!lt&&nt?(lt=!0,nt=!1):lt&&nt?(lt=!1,nt=!1):nt=!0;break;case Ae.CODE_SHIFT:D=!0,T=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_B:T=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_C:T=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:R=!0;break}break;case Ae.CODE_CODE_B:if(se<96)nt===lt?B+=String.fromCharCode(32+se):B+=String.fromCharCode(32+se+128),nt=!1;else switch(se!==Ae.CODE_STOP&&(he=!1),se){case Ae.CODE_FNC_1:d&&(B.length===0?B+="]C1":B+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_B:!lt&&nt?(lt=!0,nt=!1):lt&&nt?(lt=!1,nt=!1):nt=!0;break;case Ae.CODE_SHIFT:D=!0,T=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_A:T=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_C:T=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:R=!0;break}break;case Ae.CODE_CODE_C:if(se<100)se<10&&(B+="0"),B+=se;else switch(se!==Ae.CODE_STOP&&(he=!1),se){case Ae.CODE_FNC_1:d&&(B.length===0?B+="]C1":B+="");break;case Ae.CODE_CODE_A:T=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_B:T=Ae.CODE_CODE_B;break;case Ae.CODE_STOP:R=!0;break}break}qr&&(T=T===Ae.CODE_CODE_A?Ae.CODE_CODE_B:Ae.CODE_CODE_A)}const Hn=j-H;if(j=o.getNextUnset(j),!o.isRange(j,Math.min(o.getSize(),j+(j-H)/2),!1))throw new ie;if(xe-=Ee*Q,xe%103!==Q)throw new k;const wr=B.length;if(wr===0)throw new ie;wr>0&&he&&(T===Ae.CODE_CODE_C?B=B.substring(0,wr-2):B=B.substring(0,wr-1));const ln=(h[1]+h[0])/2,Ct=H+Hn/2,$t=S.length,Pn=new Uint8Array($t);for(let qr=0;qr<$t;qr++)Pn[qr]=S[qr];const _i=[new Oe(ln,r),new Oe(Ct,r)];return new De(B,Pn,0,_i,Ce.CODE_128,new Date().getTime())}}Ae.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ae.MAX_AVG_VARIANCE=.25,Ae.MAX_INDIVIDUAL_VARIANCE=.7,Ae.CODE_SHIFT=98,Ae.CODE_CODE_C=99,Ae.CODE_CODE_B=100,Ae.CODE_CODE_A=101,Ae.CODE_FNC_1=102,Ae.CODE_FNC_2=97,Ae.CODE_FNC_3=96,Ae.CODE_FNC_4_A=101,Ae.CODE_FNC_4_B=100,Ae.CODE_START_A=103,Ae.CODE_START_B=104,Ae.CODE_START_C=105,Ae.CODE_STOP=106;class sn extends Yt{constructor(r=!1,o=!1){super(),this.usingCheckDigit=r,this.extendedMode=o,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,o,u){let d=this.counters;d.fill(0),this.decodeRowResult="";let h=sn.findAsteriskPattern(o,d),g=o.getNextSet(h[1]),w=o.getSize(),S,T;do{sn.recordPattern(o,g,d);let Y=sn.toNarrowWidePattern(d);if(Y<0)throw new ie;S=sn.patternToChar(Y),this.decodeRowResult+=S,T=g;for(let Q of d)g+=Q;g=o.getNextSet(g)}while(S!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let R=0;for(let Y of d)R+=Y;let D=g-T-R;if(g!==w&&D*2<R)throw new ie;if(this.usingCheckDigit){let Y=this.decodeRowResult.length-1,Q=0;for(let se=0;se<Y;se++)Q+=sn.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(se));if(this.decodeRowResult.charAt(Y)!==sn.ALPHABET_STRING.charAt(Q%43))throw new k;this.decodeRowResult=this.decodeRowResult.substring(0,Y)}if(this.decodeRowResult.length===0)throw new ie;let B;this.extendedMode?B=sn.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;let H=(h[1]+h[0])/2,j=T+R/2;return new De(B,null,0,[new Oe(H,r),new Oe(j,r)],Ce.CODE_39,new Date().getTime())}static findAsteriskPattern(r,o){let u=r.getSize(),d=r.getNextSet(0),h=0,g=d,w=!1,S=o.length;for(let T=d;T<u;T++)if(r.get(T)!==w)o[h]++;else{if(h===S-1){if(this.toNarrowWidePattern(o)===sn.ASTERISK_ENCODING&&r.isRange(Math.max(0,g-Math.floor((T-g)/2)),g,!1))return[g,T];g+=o[0]+o[1],o.copyWithin(0,2,2+h-1),o[h-1]=0,o[h]=0,h--}else h++;o[h]=1,w=!w}throw new ie}static toNarrowWidePattern(r){let o=r.length,u=0,d;do{let h=2147483647;for(let S of r)S<h&&S>u&&(h=S);u=h,d=0;let g=0,w=0;for(let S=0;S<o;S++){let T=r[S];T>u&&(w|=1<<o-1-S,d++,g+=T)}if(d===3){for(let S=0;S<o&&d>0;S++){let T=r[S];if(T>u&&(d--,T*2>=g))return-1}return w}}while(d>3);return-1}static patternToChar(r){for(let o=0;o<sn.CHARACTER_ENCODINGS.length;o++)if(sn.CHARACTER_ENCODINGS[o]===r)return sn.ALPHABET_STRING.charAt(o);if(r===sn.ASTERISK_ENCODING)return"*";throw new ie}static decodeExtended(r){let o=r.length,u="";for(let d=0;d<o;d++){let h=r.charAt(d);if(h==="+"||h==="$"||h==="%"||h==="/"){let g=r.charAt(d+1),w="\0";switch(h){case"+":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)+32);else throw new ee;break;case"$":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)-64);else throw new ee;break;case"%":if(g>="A"&&g<="E")w=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")w=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")w=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")w="\0";else if(g==="V")w="@";else if(g==="W")w="`";else if(g==="X"||g==="Y"||g==="Z")w="";else throw new ee;break;case"/":if(g>="A"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")w=":";else throw new ee;break}u+=w,d++}else u+=h}return u}}sn.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",sn.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],sn.ASTERISK_ENCODING=148;class _t extends Yt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,o,u){let d=this.decodeStart(o),h=this.decodeEnd(o),g=new Ne;_t.decodeMiddle(o,d[1],h[0],g);let w=g.toString(),S=null;u!=null&&(S=u.get(ue.ALLOWED_LENGTHS)),S==null&&(S=_t.DEFAULT_ALLOWED_LENGTHS);let T=w.length,R=!1,D=0;for(let j of S){if(T===j){R=!0;break}j>D&&(D=j)}if(!R&&T>D&&(R=!0),!R)throw new ee;const B=[new Oe(d[1],r),new Oe(h[0],r)];return new De(w,null,0,B,Ce.ITF,new Date().getTime())}static decodeMiddle(r,o,u,d){let h=new Int32Array(10),g=new Int32Array(5),w=new Int32Array(5);for(h.fill(0),g.fill(0),w.fill(0);o<u;){Yt.recordPattern(r,o,h);for(let T=0;T<5;T++){let R=2*T;g[T]=h[R],w[T]=h[R+1]}let S=_t.decodeDigit(g);d.append(S.toString()),S=this.decodeDigit(w),d.append(S.toString()),h.forEach(function(T){o+=T})}}decodeStart(r){let o=_t.skipWhiteSpace(r),u=_t.findGuardPattern(r,o,_t.START_PATTERN);return this.narrowLineWidth=(u[1]-u[0])/4,this.validateQuietZone(r,u[0]),u}validateQuietZone(r,o){let u=this.narrowLineWidth*10;u=u<o?u:o;for(let d=o-1;u>0&&d>=0&&!r.get(d);d--)u--;if(u!==0)throw new ie}static skipWhiteSpace(r){const o=r.getSize(),u=r.getNextSet(0);if(u===o)throw new ie;return u}decodeEnd(r){r.reverse();try{let o=_t.skipWhiteSpace(r),u;try{u=_t.findGuardPattern(r,o,_t.END_PATTERN_REVERSED[0])}catch(h){h instanceof ie&&(u=_t.findGuardPattern(r,o,_t.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,u[0]);let d=u[0];return u[0]=r.getSize()-u[1],u[1]=r.getSize()-d,u}finally{r.reverse()}}static findGuardPattern(r,o,u){let d=u.length,h=new Int32Array(d),g=r.getSize(),w=!1,S=0,T=o;h.fill(0);for(let R=o;R<g;R++)if(r.get(R)!==w)h[S]++;else{if(S===d-1){if(Yt.patternMatchVariance(h,u,_t.MAX_INDIVIDUAL_VARIANCE)<_t.MAX_AVG_VARIANCE)return[T,R];T+=h[0]+h[1],U.arraycopy(h,2,h,0,S-1),h[S-1]=0,h[S]=0,S--}else S++;h[S]=1,w=!w}throw new ie}static decodeDigit(r){let o=_t.MAX_AVG_VARIANCE,u=-1,d=_t.PATTERNS.length;for(let h=0;h<d;h++){let g=_t.PATTERNS[h],w=Yt.patternMatchVariance(r,g,_t.MAX_INDIVIDUAL_VARIANCE);w<o?(o=w,u=h):w===o&&(u=-1)}if(u>=0)return u%10;throw new ie}}_t.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],_t.MAX_AVG_VARIANCE=.38,_t.MAX_INDIVIDUAL_VARIANCE=.5,_t.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],_t.START_PATTERN=Int32Array.from([1,1,1,1]),_t.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ot extends Yt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let o=!1,u,d=0,h=Int32Array.from([0,0,0]);for(;!o;){h=Int32Array.from([0,0,0]),u=Ot.findGuardPattern(r,d,!1,this.START_END_PATTERN,h);let g=u[0];d=u[1];let w=g-(d-g);w>=0&&(o=r.isRange(w,g,!1))}return u}static checkChecksum(r){return Ot.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let o=r.length;if(o===0)return!1;let u=parseInt(r.charAt(o-1),10);return Ot.getStandardUPCEANChecksum(r.substring(0,o-1))===u}static getStandardUPCEANChecksum(r){let o=r.length,u=0;for(let d=o-1;d>=0;d-=2){let h=r.charAt(d).charCodeAt(0)-48;if(h<0||h>9)throw new ee;u+=h}u*=3;for(let d=o-2;d>=0;d-=2){let h=r.charAt(d).charCodeAt(0)-48;if(h<0||h>9)throw new ee;u+=h}return(1e3-u)%10}static decodeEnd(r,o){return Ot.findGuardPattern(r,o,!1,Ot.START_END_PATTERN,new Int32Array(Ot.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,o,u,d){return this.findGuardPattern(r,o,u,d,new Int32Array(d.length))}static findGuardPattern(r,o,u,d,h){let g=r.getSize();o=u?r.getNextUnset(o):r.getNextSet(o);let w=0,S=o,T=d.length,R=u;for(let D=o;D<g;D++)if(r.get(D)!==R)h[w]++;else{if(w===T-1){if(Yt.patternMatchVariance(h,d,Ot.MAX_INDIVIDUAL_VARIANCE)<Ot.MAX_AVG_VARIANCE)return Int32Array.from([S,D]);S+=h[0]+h[1];let B=h.slice(2,h.length-1);for(let H=0;H<w-1;H++)h[H]=B[H];h[w-1]=0,h[w]=0,w--}else w++;h[w]=1,R=!R}throw new ie}static decodeDigit(r,o,u,d){this.recordPattern(r,u,o);let h=this.MAX_AVG_VARIANCE,g=-1,w=d.length;for(let S=0;S<w;S++){let T=d[S],R=Yt.patternMatchVariance(o,T,Ot.MAX_INDIVIDUAL_VARIANCE);R<h&&(h=R,g=S)}if(g>=0)return g;throw new ie}}Ot.MAX_AVG_VARIANCE=.48,Ot.MAX_INDIVIDUAL_VARIANCE=.7,Ot.START_END_PATTERN=Int32Array.from([1,1,1]),Ot.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ot.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ot.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class yi{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,o,u){let d=this.decodeRowStringBuffer,h=this.decodeMiddle(o,u,d),g=d.toString(),w=yi.parseExtensionString(g),S=[new Oe((u[0]+u[1])/2,r),new Oe(h,r)],T=new De(g,null,0,S,Ce.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&T.putAllMetadata(w),T}decodeMiddle(r,o,u){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let h=r.getSize(),g=o[1],w=0;for(let T=0;T<5&&g<h;T++){let R=Ot.decodeDigit(r,d,g,Ot.L_AND_G_PATTERNS);u+=String.fromCharCode(48+R%10);for(let D of d)g+=D;R>=10&&(w|=1<<4-T),T!==4&&(g=r.getNextSet(g),g=r.getNextUnset(g))}if(u.length!==5)throw new ie;let S=this.determineCheckDigit(w);if(yi.extensionChecksum(u.toString())!==S)throw new ie;return g}static extensionChecksum(r){let o=r.length,u=0;for(let d=o-2;d>=0;d-=2)u+=r.charAt(d).charCodeAt(0)-48;u*=3;for(let d=o-1;d>=0;d-=2)u+=r.charAt(d).charCodeAt(0)-48;return u*=3,u%10}determineCheckDigit(r){for(let o=0;o<10;o++)if(r===this.CHECK_DIGIT_ENCODINGS[o])return o;throw new ie}static parseExtensionString(r){if(r.length!==5)return null;let o=yi.parseExtension5String(r);return o==null?null:new Map([[Ze.SUGGESTED_PRICE,o]])}static parseExtension5String(r){let o;switch(r.charAt(0)){case"0":o="";break;case"5":o="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}o="";break;default:o="";break}let u=parseInt(r.substring(1)),d=(u/100).toString(),h=u%100,g=h<10?"0"+h:h.toString();return o+d+"."+g}}class vs{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,o,u){let d=this.decodeRowStringBuffer,h=this.decodeMiddle(o,u,d),g=d.toString(),w=vs.parseExtensionString(g),S=[new Oe((u[0]+u[1])/2,r),new Oe(h,r)],T=new De(g,null,0,S,Ce.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&T.putAllMetadata(w),T}decodeMiddle(r,o,u){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let h=r.getSize(),g=o[1],w=0;for(let S=0;S<2&&g<h;S++){let T=Ot.decodeDigit(r,d,g,Ot.L_AND_G_PATTERNS);u+=String.fromCharCode(48+T%10);for(let R of d)g+=R;T>=10&&(w|=1<<1-S),S!==1&&(g=r.getNextSet(g),g=r.getNextUnset(g))}if(u.length!==2)throw new ie;if(parseInt(u.toString())%4!==w)throw new ie;return g}static parseExtensionString(r){return r.length!==2?null:new Map([[Ze.ISSUE_NUMBER,parseInt(r)]])}}class ro{static decodeRow(r,o,u){let d=Ot.findGuardPattern(o,u,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new yi().decodeRow(r,o,d)}catch{return new vs().decodeRow(r,o,d)}}}ro.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class ut extends Ot{constructor(){super(),this.decodeRowStringBuffer="",ut.L_AND_G_PATTERNS=ut.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let o=ut.L_PATTERNS[r-10],u=new Int32Array(o.length);for(let d=0;d<o.length;d++)u[d]=o[o.length-d-1];ut.L_AND_G_PATTERNS[r]=u}}decodeRow(r,o,u){let d=ut.findStartGuardPattern(o),h=u==null?null:u.get(ue.NEED_RESULT_POINT_CALLBACK);if(h!=null){const he=new Oe((d[0]+d[1])/2,r);h.foundPossibleResultPoint(he)}let g=this.decodeMiddle(o,d,this.decodeRowStringBuffer),w=g.rowOffset,S=g.resultString;if(h!=null){const he=new Oe(w,r);h.foundPossibleResultPoint(he)}let T=this.decodeEnd(o,w);if(h!=null){const he=new Oe((T[0]+T[1])/2,r);h.foundPossibleResultPoint(he)}let R=T[1],D=R+(R-T[0]);if(D>=o.getSize()||!o.isRange(R,D,!1))throw new ie;let B=S.toString();if(B.length<8)throw new ee;if(!ut.checkChecksum(B))throw new k;let H=(d[1]+d[0])/2,j=(T[1]+T[0])/2,Y=this.getBarcodeFormat(),Q=[new Oe(H,r),new Oe(j,r)],se=new De(B,null,0,Q,Y,new Date().getTime()),xe=0;try{let he=ro.decodeRow(r,o,T[1]);se.putMetadata(Ze.UPC_EAN_EXTENSION,he.getText()),se.putAllMetadata(he.getResultMetadata()),se.addResultPoints(he.getResultPoints()),xe=he.getText().length}catch{}let Ee=u==null?null:u.get(ue.ALLOWED_EAN_EXTENSIONS);if(Ee!=null){let he=!1;for(let lt in Ee)if(xe.toString()===lt){he=!0;break}if(!he)throw new ie}return se}decodeEnd(r,o){return ut.findGuardPattern(r,o,!1,ut.START_END_PATTERN,new Int32Array(ut.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return ut.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let o=r.length;if(o===0)return!1;let u=parseInt(r.charAt(o-1),10);return ut.getStandardUPCEANChecksum(r.substring(0,o-1))===u}static getStandardUPCEANChecksum(r){let o=r.length,u=0;for(let d=o-1;d>=0;d-=2){let h=r.charAt(d).charCodeAt(0)-48;if(h<0||h>9)throw new ee;u+=h}u*=3;for(let d=o-2;d>=0;d-=2){let h=r.charAt(d).charCodeAt(0)-48;if(h<0||h>9)throw new ee;u+=h}return(1e3-u)%10}}class tr extends ut{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,o,u){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let h=r.getSize(),g=o[1],w=0;for(let T=0;T<6&&g<h;T++){let R=ut.decodeDigit(r,d,g,ut.L_AND_G_PATTERNS);u+=String.fromCharCode(48+R%10);for(let D of d)g+=D;R>=10&&(w|=1<<5-T)}u=tr.determineFirstDigit(u,w),g=ut.findGuardPattern(r,g,!0,ut.MIDDLE_PATTERN,new Int32Array(ut.MIDDLE_PATTERN.length).fill(0))[1];for(let T=0;T<6&&g<h;T++){let R=ut.decodeDigit(r,d,g,ut.L_PATTERNS);u+=String.fromCharCode(48+R);for(let D of d)g+=D}return{rowOffset:g,resultString:u}}getBarcodeFormat(){return Ce.EAN_13}static determineFirstDigit(r,o){for(let u=0;u<10;u++)if(o===this.FIRST_DIGIT_ENCODINGS[u])return r=String.fromCharCode(48+u)+r,r;throw new ie}}tr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ea extends ut{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,o,u){const d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let h=r.getSize(),g=o[1];for(let S=0;S<4&&g<h;S++){let T=ut.decodeDigit(r,d,g,ut.L_PATTERNS);u+=String.fromCharCode(48+T);for(let R of d)g+=R}g=ut.findGuardPattern(r,g,!0,ut.MIDDLE_PATTERN,new Int32Array(ut.MIDDLE_PATTERN.length).fill(0))[1];for(let S=0;S<4&&g<h;S++){let T=ut.decodeDigit(r,d,g,ut.L_PATTERNS);u+=String.fromCharCode(48+T);for(let R of d)g+=R}return{rowOffset:g,resultString:u}}getBarcodeFormat(){return Ce.EAN_8}}class ta extends ut{constructor(){super(...arguments),this.ean13Reader=new tr}getBarcodeFormat(){return Ce.UPC_A}decode(r,o){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,o,u){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,o,u))}decodeMiddle(r,o,u){return this.ean13Reader.decodeMiddle(r,o,u)}maybeReturnResult(r){let o=r.getText();if(o.charAt(0)==="0"){let u=new De(o.substring(1),null,null,r.getResultPoints(),Ce.UPC_A);return r.getResultMetadata()!=null&&u.putAllMetadata(r.getResultMetadata()),u}else throw new ie}reset(){this.ean13Reader.reset()}}class nr extends ut{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,o,u){const d=this.decodeMiddleCounters.map(T=>T);d[0]=0,d[1]=0,d[2]=0,d[3]=0;const h=r.getSize();let g=o[1],w=0;for(let T=0;T<6&&g<h;T++){const R=nr.decodeDigit(r,d,g,nr.L_AND_G_PATTERNS);u+=String.fromCharCode(48+R%10);for(let D of d)g+=D;R>=10&&(w|=1<<5-T)}let S=nr.determineNumSysAndCheckDigit(u,w);return{rowOffset:g,resultString:S}}decodeEnd(r,o){return nr.findGuardPatternWithoutCounters(r,o,!0,nr.MIDDLE_END_PATTERN)}checkChecksum(r){return ut.checkChecksum(nr.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,o){for(let u=0;u<=1;u++)for(let d=0;d<10;d++)if(o===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[u][d]){let h=String.fromCharCode(48+u),g=String.fromCharCode(48+d);return h+r+g}throw ie.getNotFoundInstance()}getBarcodeFormat(){return Ce.UPC_E}static convertUPCEtoUPCA(r){const o=r.slice(1,7).split("").map(h=>h.charCodeAt(0)),u=new Ne;u.append(r.charAt(0));let d=o[5];switch(d){case 0:case 1:case 2:u.appendChars(o,0,2),u.append(d),u.append("0000"),u.appendChars(o,2,3);break;case 3:u.appendChars(o,0,3),u.append("00000"),u.appendChars(o,3,2);break;case 4:u.appendChars(o,0,4),u.append("00000"),u.append(o[4]);break;default:u.appendChars(o,0,5),u.append("0000"),u.append(d);break}return r.length>=8&&u.append(r.charAt(7)),u.toString()}}nr.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),nr.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class io extends Yt{constructor(r){super();let o=r==null?null:r.get(ue.POSSIBLE_FORMATS),u=[];i(o)?(u.push(new tr),u.push(new ta),u.push(new ea),u.push(new nr)):(o.indexOf(Ce.EAN_13)>-1&&u.push(new tr),o.indexOf(Ce.UPC_A)>-1&&u.push(new ta),o.indexOf(Ce.EAN_8)>-1&&u.push(new ea),o.indexOf(Ce.UPC_E)>-1&&u.push(new nr)),this.readers=u}decodeRow(r,o,u){for(let d of this.readers)try{const h=d.decodeRow(r,o,u),g=h.getBarcodeFormat()===Ce.EAN_13&&h.getText().charAt(0)==="0",w=u==null?null:u.get(ue.POSSIBLE_FORMATS),S=w==null||w.includes(Ce.UPC_A);if(g&&S){const T=h.getRawBytes(),R=new De(h.getText().substring(1),T,T?T.length:null,h.getResultPoints(),Ce.UPC_A);return R.putAllMetadata(h.getResultMetadata()),R}return h}catch{}throw new ie}reset(){for(let r of this.readers)r.reset()}}class mn extends Yt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,o){for(let u=0;u<o.length;u++)if(Yt.patternMatchVariance(r,o[u],mn.MAX_INDIVIDUAL_VARIANCE)<mn.MAX_AVG_VARIANCE)return u;throw new ie}static count(r){return dt.sum(new Int32Array(r))}static increment(r,o){let u=0,d=o[0];for(let h=1;h<r.length;h++)o[h]>d&&(d=o[h],u=h);r[u]++}static decrement(r,o){let u=0,d=o[0];for(let h=1;h<r.length;h++)o[h]<d&&(d=o[h],u=h);r[u]--}static isFinderPattern(r){let o=r[0]+r[1],u=o+r[2]+r[3],d=o/u;if(d>=mn.MIN_FINDER_PATTERN_RATIO&&d<=mn.MAX_FINDER_PATTERN_RATIO){let h=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;for(let w of r)w>g&&(g=w),w<h&&(h=w);return g<10*h}return!1}}mn.MAX_AVG_VARIANCE=.2,mn.MAX_INDIVIDUAL_VARIANCE=.45,mn.MIN_FINDER_PATTERN_RATIO=9.5/12,mn.MAX_FINDER_PATTERN_RATIO=12.5/14;class ai{constructor(r,o){this.value=r,this.checksumPortion=o}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof ai))return!1;const o=r;return this.value===o.value&&this.checksumPortion===o.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class ws{constructor(r,o,u,d,h){this.value=r,this.startEnd=o,this.value=r,this.startEnd=o,this.resultPoints=new Array,this.resultPoints.push(new Oe(u,h)),this.resultPoints.push(new Oe(d,h))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof ws))return!1;const o=r;return this.value===o.value}hashCode(){return this.value}}class Fn{constructor(){}static getRSSvalue(r,o,u){let d=0;for(let S of r)d+=S;let h=0,g=0,w=r.length;for(let S=0;S<w-1;S++){let T;for(T=1,g|=1<<S;T<r[S];T++,g&=~(1<<S)){let R=Fn.combins(d-T-1,w-S-2);if(u&&g===0&&d-T-(w-S-1)>=w-S-1&&(R-=Fn.combins(d-T-(w-S),w-S-2)),w-S-1>1){let D=0;for(let B=d-T-(w-S-2);B>o;B--)D+=Fn.combins(d-T-B-1,w-S-3);R-=D*(w-1-S)}else d-T>o&&R--;h+=R}d-=T}return h}static combins(r,o){let u,d;r-o>o?(d=o,u=r-o):(d=r-o,u=o);let h=1,g=1;for(let w=r;w>u;w--)h*=w,g<=d&&(h/=g,g++);for(;g<=d;)h/=g,g++;return h}}class na{static buildBitArray(r){let o=r.length*2-1;r[r.length-1].getRightChar()==null&&(o-=1);let u=12*o,d=new J(u),h=0,w=r[0].getRightChar().getValue();for(let S=11;S>=0;--S)(w&1<<S)!=0&&d.set(h),h++;for(let S=1;S<r.length;++S){let T=r[S],R=T.getLeftChar().getValue();for(let D=11;D>=0;--D)(R&1<<D)!=0&&d.set(h),h++;if(T.getRightChar()!=null){let D=T.getRightChar().getValue();for(let B=11;B>=0;--B)(D&1<<B)!=0&&d.set(h),h++}}return d}}class pr{constructor(r,o){o?this.decodedInformation=null:(this.finished=r,this.decodedInformation=o)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class ra{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class cn extends ra{constructor(r,o){super(r),this.value=o}getValue(){return this.value}isFNC1(){return this.value===cn.FNC1}}cn.FNC1="$";class Nr extends ra{constructor(r,o,u){super(r),u?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=o}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Rn extends ra{constructor(r,o,u){if(super(r),o<0||o>10||u<0||u>10)throw new ee;this.firstDigit=o,this.secondDigit=u}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Rn.FNC1}isSecondDigitFNC1(){return this.secondDigit===Rn.FNC1}isAnyFNC1(){return this.firstDigit===Rn.FNC1||this.secondDigit===Rn.FNC1}}Rn.FNC1=10;class Me{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new ie;let o=r.substring(0,2);for(let h of Me.TWO_DIGIT_DATA_LENGTH)if(h[0]===o)return h[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(2,h[2],r):Me.processFixedAI(2,h[1],r);if(r.length<3)throw new ie;let u=r.substring(0,3);for(let h of Me.THREE_DIGIT_DATA_LENGTH)if(h[0]===u)return h[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(3,h[2],r):Me.processFixedAI(3,h[1],r);for(let h of Me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(h[0]===u)return h[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(4,h[2],r):Me.processFixedAI(4,h[1],r);if(r.length<4)throw new ie;let d=r.substring(0,4);for(let h of Me.FOUR_DIGIT_DATA_LENGTH)if(h[0]===d)return h[1]===Me.VARIABLE_LENGTH?Me.processVariableAI(4,h[2],r):Me.processFixedAI(4,h[1],r);throw new ie}static processFixedAI(r,o,u){if(u.length<r)throw new ie;let d=u.substring(0,r);if(u.length<r+o)throw new ie;let h=u.substring(r,r+o),g=u.substring(r+o),w="("+d+")"+h,S=Me.parseFieldsInGeneralPurpose(g);return S==null?w:w+S}static processVariableAI(r,o,u){let d=u.substring(0,r),h;u.length<r+o?h=u.length:h=r+o;let g=u.substring(r,h),w=u.substring(h),S="("+d+")"+g,T=Me.parseFieldsInGeneralPurpose(w);return T==null?S:S+T}}Me.VARIABLE_LENGTH=[],Me.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Me.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Me.VARIABLE_LENGTH,20],["22",Me.VARIABLE_LENGTH,29],["30",Me.VARIABLE_LENGTH,8],["37",Me.VARIABLE_LENGTH,8],["90",Me.VARIABLE_LENGTH,30],["91",Me.VARIABLE_LENGTH,30],["92",Me.VARIABLE_LENGTH,30],["93",Me.VARIABLE_LENGTH,30],["94",Me.VARIABLE_LENGTH,30],["95",Me.VARIABLE_LENGTH,30],["96",Me.VARIABLE_LENGTH,30],["97",Me.VARIABLE_LENGTH,3],["98",Me.VARIABLE_LENGTH,30],["99",Me.VARIABLE_LENGTH,30]],Me.THREE_DIGIT_DATA_LENGTH=[["240",Me.VARIABLE_LENGTH,30],["241",Me.VARIABLE_LENGTH,30],["242",Me.VARIABLE_LENGTH,6],["250",Me.VARIABLE_LENGTH,30],["251",Me.VARIABLE_LENGTH,30],["253",Me.VARIABLE_LENGTH,17],["254",Me.VARIABLE_LENGTH,20],["400",Me.VARIABLE_LENGTH,30],["401",Me.VARIABLE_LENGTH,30],["402",17],["403",Me.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Me.VARIABLE_LENGTH,20],["421",Me.VARIABLE_LENGTH,15],["422",3],["423",Me.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Me.VARIABLE_LENGTH,15],["391",Me.VARIABLE_LENGTH,18],["392",Me.VARIABLE_LENGTH,15],["393",Me.VARIABLE_LENGTH,18],["703",Me.VARIABLE_LENGTH,30]],Me.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Me.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Me.VARIABLE_LENGTH,20],["8003",Me.VARIABLE_LENGTH,30],["8004",Me.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Me.VARIABLE_LENGTH,30],["8008",Me.VARIABLE_LENGTH,12],["8018",18],["8020",Me.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Me.VARIABLE_LENGTH,70],["8200",Me.VARIABLE_LENGTH,70]];class Hi{constructor(r){this.buffer=new Ne,this.information=r}decodeAllCodes(r,o){let u=o,d=null;do{let h=this.decodeGeneralPurposeField(u,d),g=Me.parseFieldsInGeneralPurpose(h.getNewString());if(g!=null&&r.append(g),h.isRemaining()?d=""+h.getRemainingValue():d=null,u===h.getNewPosition())break;u=h.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let o=r;o<r+3;++o)if(this.information.get(o))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let h=this.extractNumericValueFromBitArray(r,4);return h===0?new Rn(this.information.getSize(),Rn.FNC1,Rn.FNC1):new Rn(this.information.getSize(),h-1,Rn.FNC1)}let o=this.extractNumericValueFromBitArray(r,7),u=(o-8)/11,d=(o-8)%11;return new Rn(r+7,u,d)}extractNumericValueFromBitArray(r,o){return Hi.extractNumericValueFromBitArray(this.information,r,o)}static extractNumericValueFromBitArray(r,o,u){let d=0;for(let h=0;h<u;++h)r.get(o+h)&&(d|=1<<u-h-1);return d}decodeGeneralPurposeField(r,o){this.buffer.setLengthToZero(),o!=null&&this.buffer.append(o),this.current.setPosition(r);let u=this.parseBlocks();return u!=null&&u.isRemaining()?new Nr(this.current.getPosition(),this.buffer.toString(),u.getRemainingValue()):new Nr(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,o;do{let u=this.current.getPosition();if(this.current.isAlpha()?(o=this.parseAlphaBlock(),r=o.isFinished()):this.current.isIsoIec646()?(o=this.parseIsoIec646Block(),r=o.isFinished()):(o=this.parseNumericBlock(),r=o.isFinished()),!(u!==this.current.getPosition())&&!r)break}while(!r);return o.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let o;return r.isSecondDigitFNC1()?o=new Nr(this.current.getPosition(),this.buffer.toString()):o=new Nr(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new pr(!0,o)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let o=new Nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,o)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new pr(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let o=new Nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,o)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new pr(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let o=new Nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,o)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new pr(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,5);if(o>=5&&o<16)return!0;if(r+7>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,7);if(u>=64&&u<116)return!0;if(r+8>this.information.getSize())return!1;let d=this.extractNumericValueFromBitArray(r,8);return d>=232&&d<253}decodeIsoIec646(r){let o=this.extractNumericValueFromBitArray(r,5);if(o===15)return new cn(r+5,cn.FNC1);if(o>=5&&o<15)return new cn(r+5,"0"+(o-5));let u=this.extractNumericValueFromBitArray(r,7);if(u>=64&&u<90)return new cn(r+7,""+(u+1));if(u>=90&&u<116)return new cn(r+7,""+(u+7));let d=this.extractNumericValueFromBitArray(r,8),h;switch(d){case 232:h="!";break;case 233:h='"';break;case 234:h="%";break;case 235:h="&";break;case 236:h="'";break;case 237:h="(";break;case 238:h=")";break;case 239:h="*";break;case 240:h="+";break;case 241:h=",";break;case 242:h="-";break;case 243:h=".";break;case 244:h="/";break;case 245:h=":";break;case 246:h=";";break;case 247:h="<";break;case 248:h="=";break;case 249:h=">";break;case 250:h="?";break;case 251:h="_";break;case 252:h=" ";break;default:throw new ee}return new cn(r+8,h)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,5);if(o>=5&&o<16)return!0;if(r+6>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,6);return u>=16&&u<63}decodeAlphanumeric(r){let o=this.extractNumericValueFromBitArray(r,5);if(o===15)return new cn(r+5,cn.FNC1);if(o>=5&&o<15)return new cn(r+5,"0"+(o-5));let u=this.extractNumericValueFromBitArray(r,6);if(u>=32&&u<58)return new cn(r+6,""+(u+33));let d;switch(u){case 58:d="*";break;case 59:d=",";break;case 60:d="-";break;case 61:d=".";break;case 62:d="/";break;default:throw new fr("Decoding invalid alphanumeric value: "+u)}return new cn(r+6,d)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let o=0;o<5&&o+r<this.information.getSize();++o)if(o===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+o))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let o=r;o<r+3;++o)if(this.information.get(o))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let o=0;o<4&&o+r<this.information.getSize();++o)if(this.information.get(r+o))return!1;return!0}}class ia{constructor(r){this.information=r,this.generalDecoder=new Hi(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Un extends ia{constructor(r){super(r)}encodeCompressedGtin(r,o){r.append("(01)");let u=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,o,u)}encodeCompressedGtinWithoutAI(r,o,u){for(let d=0;d<4;++d){let h=this.getGeneralDecoder().extractNumericValueFromBitArray(o+10*d,10);h/100===0&&r.append("0"),h/10===0&&r.append("0"),r.append(h)}Un.appendCheckDigit(r,u)}static appendCheckDigit(r,o){let u=0;for(let d=0;d<13;d++){let h=r.charAt(d+o).charCodeAt(0)-48;u+=(d&1)===0?3*h:h}u=10-u%10,u===10&&(u=0),r.append(u)}}Un.GTIN_SIZE=40;class rr extends Un{constructor(r){super(r)}parseInformation(){let r=new Ne;r.append("(01)");let o=r.length(),u=this.getGeneralDecoder().extractNumericValueFromBitArray(rr.HEADER_SIZE,4);return r.append(u),this.encodeCompressedGtinWithoutAI(r,rr.HEADER_SIZE+4,o),this.getGeneralDecoder().decodeAllCodes(r,rr.HEADER_SIZE+44)}}rr.HEADER_SIZE=4;class Es extends ia{constructor(r){super(r)}parseInformation(){let r=new Ne;return this.getGeneralDecoder().decodeAllCodes(r,Es.HEADER_SIZE)}}Es.HEADER_SIZE=5;class _s extends Un{constructor(r){super(r)}encodeCompressedWeight(r,o,u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(o,u);this.addWeightCode(r,d);let h=this.checkWeight(d),g=1e5;for(let w=0;w<5;++w)h/g===0&&r.append("0"),g/=10;r.append(h)}}class Rr extends _s{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=Rr.HEADER_SIZE+_s.GTIN_SIZE+Rr.WEIGHT_SIZE)throw new ie;let r=new Ne;return this.encodeCompressedGtin(r,Rr.HEADER_SIZE),this.encodeCompressedWeight(r,Rr.HEADER_SIZE+_s.GTIN_SIZE,Rr.WEIGHT_SIZE),r.toString()}}Rr.HEADER_SIZE=5,Rr.WEIGHT_SIZE=15;class tl extends Rr{constructor(r){super(r)}addWeightCode(r,o){r.append("(3103)")}checkWeight(r){return r}}class nl extends Rr{constructor(r){super(r)}addWeightCode(r,o){o<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class gr extends Un{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<gr.HEADER_SIZE+Un.GTIN_SIZE)throw new ie;let r=new Ne;this.encodeCompressedGtin(r,gr.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(gr.HEADER_SIZE+Un.GTIN_SIZE,gr.LAST_DIGIT_SIZE);r.append("(392"),r.append(o),r.append(")");let u=this.getGeneralDecoder().decodeGeneralPurposeField(gr.HEADER_SIZE+Un.GTIN_SIZE+gr.LAST_DIGIT_SIZE,null);return r.append(u.getNewString()),r.toString()}}gr.HEADER_SIZE=8,gr.LAST_DIGIT_SIZE=2;class Sn extends Un{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Sn.HEADER_SIZE+Un.GTIN_SIZE)throw new ie;let r=new Ne;this.encodeCompressedGtin(r,Sn.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(Sn.HEADER_SIZE+Un.GTIN_SIZE,Sn.LAST_DIGIT_SIZE);r.append("(393"),r.append(o),r.append(")");let u=this.getGeneralDecoder().extractNumericValueFromBitArray(Sn.HEADER_SIZE+Un.GTIN_SIZE+Sn.LAST_DIGIT_SIZE,Sn.FIRST_THREE_DIGITS_SIZE);u/100==0&&r.append("0"),u/10==0&&r.append("0"),r.append(u);let d=this.getGeneralDecoder().decodeGeneralPurposeField(Sn.HEADER_SIZE+Un.GTIN_SIZE+Sn.LAST_DIGIT_SIZE+Sn.FIRST_THREE_DIGITS_SIZE,null);return r.append(d.getNewString()),r.toString()}}Sn.HEADER_SIZE=8,Sn.LAST_DIGIT_SIZE=2,Sn.FIRST_THREE_DIGITS_SIZE=10;class Lt extends _s{constructor(r,o,u){super(r),this.dateCode=u,this.firstAIdigits=o}parseInformation(){if(this.getInformation().getSize()!=Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE+Lt.DATE_SIZE)throw new ie;let r=new Ne;return this.encodeCompressedGtin(r,Lt.HEADER_SIZE),this.encodeCompressedWeight(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE,Lt.WEIGHT_SIZE),this.encodeCompressedDate(r,Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,o){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(o,Lt.DATE_SIZE);if(u==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let d=u%32;u/=32;let h=u%12+1;u/=12;let g=u;g/10==0&&r.append("0"),r.append(g),h/10==0&&r.append("0"),r.append(h),d/10==0&&r.append("0"),r.append(d)}addWeightCode(r,o){r.append("("),r.append(this.firstAIdigits),r.append(o/1e5),r.append(")")}checkWeight(r){return r%1e5}}Lt.HEADER_SIZE=8,Lt.WEIGHT_SIZE=20,Lt.DATE_SIZE=16;function rl(P){try{if(P.get(1))return new rr(P);if(!P.get(2))return new Es(P);switch(Hi.extractNumericValueFromBitArray(P,1,4)){case 4:return new tl(P);case 5:return new nl(P)}switch(Hi.extractNumericValueFromBitArray(P,1,5)){case 12:return new gr(P);case 13:return new Sn(P)}switch(Hi.extractNumericValueFromBitArray(P,1,7)){case 56:return new Lt(P,"310","11");case 57:return new Lt(P,"320","11");case 58:return new Lt(P,"310","13");case 59:return new Lt(P,"320","13");case 60:return new Lt(P,"310","15");case 61:return new Lt(P,"320","15");case 62:return new Lt(P,"310","17");case 63:return new Lt(P,"320","17")}}catch(r){throw console.log(r),new fr("unknown decoder: "+P)}}class Tt{constructor(r,o,u,d){this.leftchar=r,this.rightchar=o,this.finderpattern=u,this.maybeLast=d}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,o){return r instanceof Tt?Tt.equalsOrNull(r.leftchar,o.leftchar)&&Tt.equalsOrNull(r.rightchar,o.rightchar)&&Tt.equalsOrNull(r.finderpattern,o.finderpattern):!1}static equalsOrNull(r,o){return r===null?o===null:Tt.equals(r,o)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class sa{constructor(r,o,u){this.pairs=r,this.rowNumber=o,this.wasReversed=u}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,o){return r instanceof sa?this.checkEqualitity(r,o)&&r.wasReversed===o.wasReversed:!1}checkEqualitity(r,o){if(!r||!o)return;let u;return r.forEach((d,h)=>{o.forEach(g=>{d.getLeftChar().getValue()===g.getLeftChar().getValue()&&d.getRightChar().getValue()===g.getRightChar().getValue()&&d.getFinderPatter().getValue()===g.getFinderPatter().getValue()&&(u=!0)})}),u}}class ce extends mn{constructor(r){super(...arguments),this.pairs=new Array(ce.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,o,u){this.pairs.length=0,this.startFromEven=!1;try{return ce.constructResult(this.decodeRow2pairs(r,o))}catch(d){this.verbose&&console.log(d)}return this.pairs.length=0,this.startFromEven=!0,ce.constructResult(this.decodeRow2pairs(r,o))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,o){let u=!1;for(;!u;)try{this.pairs.push(this.retrieveNextPair(o,this.pairs,r))}catch(h){if(h instanceof ie){if(!this.pairs.length)throw new ie;u=!0}}if(this.checkChecksum())return this.pairs;let d;if(this.rows.length?d=!0:d=!1,this.storeRow(r,!1),d){let h=this.checkRowsBoolean(!1);if(h!=null||(h=this.checkRowsBoolean(!0),h!=null))return h}throw new ie}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let o=null;try{o=this.checkRows(new Array,0)}catch(u){this.verbose&&console.log(u)}return r&&(this.rows=this.rows.reverse()),o}checkRows(r,o){for(let u=o;u<this.rows.length;u++){let d=this.rows[u];this.pairs.length=0;for(let g of r)this.pairs.push(g.getPairs());if(this.pairs.push(d.getPairs()),!ce.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let h=new Array(r);h.push(d);try{return this.checkRows(h,u+1)}catch(g){this.verbose&&console.log(g)}}throw new ie}static isValidSequence(r){for(let o of ce.FINDER_PATTERN_SEQUENCES){if(r.length>o.length)continue;let u=!0;for(let d=0;d<r.length;d++)if(r[d].getFinderPattern().getValue()!=o[d]){u=!1;break}if(u)return!0}return!1}storeRow(r,o){let u=0,d=!1,h=!1;for(;u<this.rows.length;){let g=this.rows[u];if(g.getRowNumber()>r){h=g.isEquivalent(this.pairs);break}d=g.isEquivalent(this.pairs),u++}h||d||ce.isPartialRow(this.pairs,this.rows)||(this.rows.push(u,new sa(this.pairs,r,o)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,o){for(let u of o)if(u.getPairs().length!==r.length){for(let d of u.getPairs())for(let h of r)if(Tt.equals(d,h))break}}static isPartialRow(r,o){for(let u of o){let d=!0;for(let h of r){let g=!1;for(let w of u.getPairs())if(h.equals(w)){g=!0;break}if(!g){d=!1;break}}if(d)return!0}return!1}getRows(){return this.rows}static constructResult(r){let o=na.buildBitArray(r),d=rl(o).parseInformation(),h=r[0].getFinderPattern().getResultPoints(),g=r[r.length-1].getFinderPattern().getResultPoints(),w=[h[0],h[1],g[0],g[1]];return new De(d,null,null,w,Ce.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),o=r.getLeftChar(),u=r.getRightChar();if(u==null)return!1;let d=u.getChecksumPortion(),h=2;for(let w=1;w<this.pairs.size();++w){let S=this.pairs.get(w);d+=S.getLeftChar().getChecksumPortion(),h++;let T=S.getRightChar();T!=null&&(d+=T.getChecksumPortion(),h++)}return d%=211,211*(h-4)+d==o.getValue()}static getNextSecondBar(r,o){let u;return r.get(o)?(u=r.getNextUnset(o),u=r.getNextSet(u)):(u=r.getNextSet(o),u=r.getNextUnset(u)),u}retrieveNextPair(r,o,u){let d=o.length%2==0;this.startFromEven&&(d=!d);let h,g=!0,w=-1;do this.findNextPair(r,o,w),h=this.parseFoundFinderPattern(r,u,d),h==null?w=ce.getNextSecondBar(r,this.startEnd[0]):g=!1;while(g);let S=this.decodeDataCharacter(r,h,d,!0);if(!this.isEmptyPair(o)&&o[o.length-1].mustBeLast())throw new ie;let T;try{T=this.decodeDataCharacter(r,h,d,!1)}catch(R){T=null,this.verbose&&console.log(R)}return new Tt(S,T,h,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,o,u){let d=this.getDecodeFinderCounters();d[0]=0,d[1]=0,d[2]=0,d[3]=0;let h=r.getSize(),g;u>=0?g=u:this.isEmptyPair(o)?g=0:g=o[o.length-1].getFinderPattern().getStartEnd()[1];let w=o.length%2!=0;this.startFromEven&&(w=!w);let S=!1;for(;g<h&&(S=!r.get(g),!!S);)g++;let T=0,R=g;for(let D=g;D<h;D++)if(r.get(D)!=S)d[T]++;else{if(T==3){if(w&&ce.reverseCounters(d),ce.isFinderPattern(d)){this.startEnd[0]=R,this.startEnd[1]=D;return}w&&ce.reverseCounters(d),R+=d[0]+d[1],d[0]=d[2],d[1]=d[3],d[2]=0,d[3]=0,T--}else T++;d[T]=1,S=!S}throw new ie}static reverseCounters(r){let o=r.length;for(let u=0;u<o/2;++u){let d=r[u];r[u]=r[o-u-1],r[o-u-1]=d}}parseFoundFinderPattern(r,o,u){let d,h,g;if(u){let T=this.startEnd[0]-1;for(;T>=0&&!r.get(T);)T--;T++,d=this.startEnd[0]-T,h=T,g=this.startEnd[1]}else h=this.startEnd[0],g=r.getNextUnset(this.startEnd[1]+1),d=g-this.startEnd[1];let w=this.getDecodeFinderCounters();U.arraycopy(w,0,w,1,w.length-1),w[0]=d;let S;try{S=this.parseFinderValue(w,ce.FINDER_PATTERNS)}catch{return null}return new ws(S,[h,g],h,g,o)}decodeDataCharacter(r,o,u,d){let h=this.getDataCharacterCounters();for(let Ct=0;Ct<h.length;Ct++)h[Ct]=0;if(d)ce.recordPatternInReverse(r,o.getStartEnd()[0],h);else{ce.recordPattern(r,o.getStartEnd()[1],h);for(let Ct=0,$t=h.length-1;Ct<$t;Ct++,$t--){let Pn=h[Ct];h[Ct]=h[$t],h[$t]=Pn}}let g=17,w=dt.sum(new Int32Array(h))/g,S=(o.getStartEnd()[1]-o.getStartEnd()[0])/15;if(Math.abs(w-S)/S>.3)throw new ie;let T=this.getOddCounts(),R=this.getEvenCounts(),D=this.getOddRoundingErrors(),B=this.getEvenRoundingErrors();for(let Ct=0;Ct<h.length;Ct++){let $t=1*h[Ct]/w,Pn=$t+.5;if(Pn<1){if($t<.3)throw new ie;Pn=1}else if(Pn>8){if($t>8.7)throw new ie;Pn=8}let _i=Ct/2;(Ct&1)==0?(T[_i]=Pn,D[_i]=$t-Pn):(R[_i]=Pn,B[_i]=$t-Pn)}this.adjustOddEvenCounts(g);let H=4*o.getValue()+(u?0:2)+(d?0:1)-1,j=0,Y=0;for(let Ct=T.length-1;Ct>=0;Ct--){if(ce.isNotA1left(o,u,d)){let $t=ce.WEIGHTS[H][2*Ct];Y+=T[Ct]*$t}j+=T[Ct]}let Q=0;for(let Ct=R.length-1;Ct>=0;Ct--)if(ce.isNotA1left(o,u,d)){let $t=ce.WEIGHTS[H][2*Ct+1];Q+=R[Ct]*$t}let se=Y+Q;if((j&1)!=0||j>13||j<4)throw new ie;let xe=(13-j)/2,Ee=ce.SYMBOL_WIDEST[xe],he=9-Ee,lt=Fn.getRSSvalue(T,Ee,!0),nt=Fn.getRSSvalue(R,he,!1),Hn=ce.EVEN_TOTAL_SUBSET[xe],wr=ce.GSUM[xe],ln=lt*Hn+nt+wr;return new ai(ln,se)}static isNotA1left(r,o,u){return!(r.getValue()==0&&o&&u)}adjustOddEvenCounts(r){let o=dt.sum(new Int32Array(this.getOddCounts())),u=dt.sum(new Int32Array(this.getEvenCounts())),d=!1,h=!1;o>13?h=!0:o<4&&(d=!0);let g=!1,w=!1;u>13?w=!0:u<4&&(g=!0);let S=o+u-r,T=(o&1)==1,R=(u&1)==0;if(S==1)if(T){if(R)throw new ie;h=!0}else{if(!R)throw new ie;w=!0}else if(S==-1)if(T){if(R)throw new ie;d=!0}else{if(!R)throw new ie;g=!0}else if(S==0){if(T){if(!R)throw new ie;o<u?(d=!0,w=!0):(h=!0,g=!0)}else if(R)throw new ie}else throw new ie;if(d){if(h)throw new ie;ce.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(h&&ce.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(w)throw new ie;ce.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&ce.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ce.SYMBOL_WIDEST=[7,5,4,3,1],ce.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ce.GSUM=[0,348,1388,2948,3988],ce.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ce.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ce.FINDER_PAT_A=0,ce.FINDER_PAT_B=1,ce.FINDER_PAT_C=2,ce.FINDER_PAT_D=3,ce.FINDER_PAT_E=4,ce.FINDER_PAT_F=5,ce.FINDER_PATTERN_SEQUENCES=[[ce.FINDER_PAT_A,ce.FINDER_PAT_A],[ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B],[ce.FINDER_PAT_A,ce.FINDER_PAT_C,ce.FINDER_PAT_B,ce.FINDER_PAT_D],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_C],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_D,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_D],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_E],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F]],ce.MAX_PAIRS=11;class il extends ai{constructor(r,o,u){super(r,o),this.count=0,this.finderPattern=u}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Pt extends mn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,o,u){const d=this.decodePair(o,!1,r,u);Pt.addOrTally(this.possibleLeftPairs,d),o.reverse();let h=this.decodePair(o,!0,r,u);Pt.addOrTally(this.possibleRightPairs,h),o.reverse();for(let g of this.possibleLeftPairs)if(g.getCount()>1){for(let w of this.possibleRightPairs)if(w.getCount()>1&&Pt.checkChecksum(g,w))return Pt.constructResult(g,w)}throw new ie}static addOrTally(r,o){if(o==null)return;let u=!1;for(let d of r)if(d.getValue()===o.getValue()){d.incrementCount(),u=!0;break}u||r.push(o)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,o){let u=4537077*r.getValue()+o.getValue(),d=new String(u).toString(),h=new Ne;for(let T=13-d.length;T>0;T--)h.append("0");h.append(d);let g=0;for(let T=0;T<13;T++){let R=h.charAt(T).charCodeAt(0)-48;g+=(T&1)===0?3*R:R}g=10-g%10,g===10&&(g=0),h.append(g.toString());let w=r.getFinderPattern().getResultPoints(),S=o.getFinderPattern().getResultPoints();return new De(h.toString(),null,0,[w[0],w[1],S[0],S[1]],Ce.RSS_14,new Date().getTime())}static checkChecksum(r,o){let u=(r.getChecksumPortion()+16*o.getChecksumPortion())%79,d=9*r.getFinderPattern().getValue()+o.getFinderPattern().getValue();return d>72&&d--,d>8&&d--,u===d}decodePair(r,o,u,d){try{let h=this.findFinderPattern(r,o),g=this.parseFoundFinderPattern(r,u,o,h),w=d==null?null:d.get(ue.NEED_RESULT_POINT_CALLBACK);if(w!=null){let R=(h[0]+h[1])/2;o&&(R=r.getSize()-1-R),w.foundPossibleResultPoint(new Oe(R,u))}let S=this.decodeDataCharacter(r,g,!0),T=this.decodeDataCharacter(r,g,!1);return new il(1597*S.getValue()+T.getValue(),S.getChecksumPortion()+4*T.getChecksumPortion(),g)}catch{return null}}decodeDataCharacter(r,o,u){let d=this.getDataCharacterCounters();for(let Q=0;Q<d.length;Q++)d[Q]=0;if(u)Yt.recordPatternInReverse(r,o.getStartEnd()[0],d);else{Yt.recordPattern(r,o.getStartEnd()[1]+1,d);for(let Q=0,se=d.length-1;Q<se;Q++,se--){let xe=d[Q];d[Q]=d[se],d[se]=xe}}let h=u?16:15,g=dt.sum(new Int32Array(d))/h,w=this.getOddCounts(),S=this.getEvenCounts(),T=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let Q=0;Q<d.length;Q++){let se=d[Q]/g,xe=Math.floor(se+.5);xe<1?xe=1:xe>8&&(xe=8);let Ee=Math.floor(Q/2);(Q&1)===0?(w[Ee]=xe,T[Ee]=se-xe):(S[Ee]=xe,R[Ee]=se-xe)}this.adjustOddEvenCounts(u,h);let D=0,B=0;for(let Q=w.length-1;Q>=0;Q--)B*=9,B+=w[Q],D+=w[Q];let H=0,j=0;for(let Q=S.length-1;Q>=0;Q--)H*=9,H+=S[Q],j+=S[Q];let Y=B+3*H;if(u){if((D&1)!==0||D>12||D<4)throw new ie;let Q=(12-D)/2,se=Pt.OUTSIDE_ODD_WIDEST[Q],xe=9-se,Ee=Fn.getRSSvalue(w,se,!1),he=Fn.getRSSvalue(S,xe,!0),lt=Pt.OUTSIDE_EVEN_TOTAL_SUBSET[Q],nt=Pt.OUTSIDE_GSUM[Q];return new ai(Ee*lt+he+nt,Y)}else{if((j&1)!==0||j>10||j<4)throw new ie;let Q=(10-j)/2,se=Pt.INSIDE_ODD_WIDEST[Q],xe=9-se,Ee=Fn.getRSSvalue(w,se,!0),he=Fn.getRSSvalue(S,xe,!1),lt=Pt.INSIDE_ODD_TOTAL_SUBSET[Q],nt=Pt.INSIDE_GSUM[Q];return new ai(he*lt+Ee+nt,Y)}}findFinderPattern(r,o){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=r.getSize(),h=!1,g=0;for(;g<d&&(h=!r.get(g),o!==h);)g++;let w=0,S=g;for(let T=g;T<d;T++)if(r.get(T)!==h)u[w]++;else{if(w===3){if(mn.isFinderPattern(u))return[S,T];S+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,w--}else w++;u[w]=1,h=!h}throw new ie}parseFoundFinderPattern(r,o,u,d){let h=r.get(d[0]),g=d[0]-1;for(;g>=0&&h!==r.get(g);)g--;g++;const w=d[0]-g,S=this.getDecodeFinderCounters(),T=new Int32Array(S.length);U.arraycopy(S,0,T,1,S.length-1),T[0]=w;const R=this.parseFinderValue(T,Pt.FINDER_PATTERNS);let D=g,B=d[1];return u&&(D=r.getSize()-1-D,B=r.getSize()-1-B),new ws(R,[g,d[1]],D,B,o)}adjustOddEvenCounts(r,o){let u=dt.sum(new Int32Array(this.getOddCounts())),d=dt.sum(new Int32Array(this.getEvenCounts())),h=!1,g=!1,w=!1,S=!1;r?(u>12?g=!0:u<4&&(h=!0),d>12?S=!0:d<4&&(w=!0)):(u>11?g=!0:u<5&&(h=!0),d>10?S=!0:d<4&&(w=!0));let T=u+d-o,R=(u&1)===(r?1:0),D=(d&1)===1;if(T===1)if(R){if(D)throw new ie;g=!0}else{if(!D)throw new ie;S=!0}else if(T===-1)if(R){if(D)throw new ie;h=!0}else{if(!D)throw new ie;w=!0}else if(T===0){if(R){if(!D)throw new ie;u<d?(h=!0,S=!0):(g=!0,w=!0)}else if(D)throw new ie}else throw new ie;if(h){if(g)throw new ie;mn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&mn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(S)throw new ie;mn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}S&&mn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Pt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Pt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Pt.OUTSIDE_GSUM=[0,161,961,2015,2715],Pt.INSIDE_GSUM=[0,336,1036,1516],Pt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Pt.INSIDE_ODD_WIDEST=[2,4,6,8],Pt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Gi extends Yt{constructor(r,o){super(),this.readers=[],this.verbose=o===!0;const u=r?r.get(ue.POSSIBLE_FORMATS):null,d=r&&r.get(ue.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;u?((u.includes(Ce.EAN_13)||u.includes(Ce.UPC_A)||u.includes(Ce.EAN_8)||u.includes(Ce.UPC_E))&&this.readers.push(new io(r)),u.includes(Ce.CODE_39)&&this.readers.push(new sn(d)),u.includes(Ce.CODE_128)&&this.readers.push(new Ae),u.includes(Ce.ITF)&&this.readers.push(new _t),u.includes(Ce.RSS_14)&&this.readers.push(new Pt),u.includes(Ce.RSS_EXPANDED)&&this.readers.push(new ce(this.verbose))):(this.readers.push(new io(r)),this.readers.push(new sn),this.readers.push(new io(r)),this.readers.push(new Ae),this.readers.push(new _t),this.readers.push(new Pt),this.readers.push(new ce(this.verbose)))}decodeRow(r,o,u){for(let d=0;d<this.readers.length;d++)try{return this.readers[d].decodeRow(r,o,u)}catch{}throw new ie}reset(){this.readers.forEach(r=>r.reset())}}class sl extends qe{constructor(r=500,o){super(new Gi(o),r,o)}}class mt{constructor(r,o,u){this.ecCodewords=r,this.ecBlocks=[o],u&&this.ecBlocks.push(u)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class st{constructor(r,o){this.count=r,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ft{constructor(r,o,u,d,h,g){this.versionNumber=r,this.symbolSizeRows=o,this.symbolSizeColumns=u,this.dataRegionSizeRows=d,this.dataRegionSizeColumns=h,this.ecBlocks=g;let w=0;const S=g.getECCodewords(),T=g.getECBlocks();for(let R of T)w+=R.getCount()*(R.getDataCodewords()+S);this.totalCodewords=w}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,o){if((r&1)!==0||(o&1)!==0)throw new ee;for(let u of ft.VERSIONS)if(u.symbolSizeRows===r&&u.symbolSizeColumns===o)return u;throw new ee}toString(){return""+this.versionNumber}static buildVersions(){return[new ft(1,10,10,8,8,new mt(5,new st(1,3))),new ft(2,12,12,10,10,new mt(7,new st(1,5))),new ft(3,14,14,12,12,new mt(10,new st(1,8))),new ft(4,16,16,14,14,new mt(12,new st(1,12))),new ft(5,18,18,16,16,new mt(14,new st(1,18))),new ft(6,20,20,18,18,new mt(18,new st(1,22))),new ft(7,22,22,20,20,new mt(20,new st(1,30))),new ft(8,24,24,22,22,new mt(24,new st(1,36))),new ft(9,26,26,24,24,new mt(28,new st(1,44))),new ft(10,32,32,14,14,new mt(36,new st(1,62))),new ft(11,36,36,16,16,new mt(42,new st(1,86))),new ft(12,40,40,18,18,new mt(48,new st(1,114))),new ft(13,44,44,20,20,new mt(56,new st(1,144))),new ft(14,48,48,22,22,new mt(68,new st(1,174))),new ft(15,52,52,24,24,new mt(42,new st(2,102))),new ft(16,64,64,14,14,new mt(56,new st(2,140))),new ft(17,72,72,16,16,new mt(36,new st(4,92))),new ft(18,80,80,18,18,new mt(48,new st(4,114))),new ft(19,88,88,20,20,new mt(56,new st(4,144))),new ft(20,96,96,22,22,new mt(68,new st(4,174))),new ft(21,104,104,24,24,new mt(56,new st(6,136))),new ft(22,120,120,18,18,new mt(68,new st(6,175))),new ft(23,132,132,20,20,new mt(62,new st(8,163))),new ft(24,144,144,22,22,new mt(62,new st(8,156),new st(2,155))),new ft(25,8,18,6,16,new mt(7,new st(1,5))),new ft(26,8,32,6,14,new mt(11,new st(1,10))),new ft(27,12,26,10,24,new mt(14,new st(1,16))),new ft(28,12,36,10,16,new mt(18,new st(1,22))),new ft(29,16,36,14,16,new mt(24,new st(1,32))),new ft(30,16,48,14,22,new mt(28,new st(1,49)))]}}ft.VERSIONS=ft.buildVersions();class $n{constructor(r){const o=r.getHeight();if(o<8||o>144||(o&1)!==0)throw new ee;this.version=$n.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new We(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const o=r.getHeight(),u=r.getWidth();return ft.getVersionForDimensions(o,u)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let o=0,u=4,d=0;const h=this.mappingBitMatrix.getHeight(),g=this.mappingBitMatrix.getWidth();let w=!1,S=!1,T=!1,R=!1;do if(u===h&&d===0&&!w)r[o++]=this.readCorner1(h,g)&255,u-=2,d+=2,w=!0;else if(u===h-2&&d===0&&(g&3)!==0&&!S)r[o++]=this.readCorner2(h,g)&255,u-=2,d+=2,S=!0;else if(u===h+4&&d===2&&(g&7)===0&&!T)r[o++]=this.readCorner3(h,g)&255,u-=2,d+=2,T=!0;else if(u===h-2&&d===0&&(g&7)===4&&!R)r[o++]=this.readCorner4(h,g)&255,u-=2,d+=2,R=!0;else{do u<h&&d>=0&&!this.readMappingMatrix.get(d,u)&&(r[o++]=this.readUtah(u,d,h,g)&255),u-=2,d+=2;while(u>=0&&d<g);u+=1,d+=3;do u>=0&&d<g&&!this.readMappingMatrix.get(d,u)&&(r[o++]=this.readUtah(u,d,h,g)&255),u+=2,d-=2;while(u<h&&d>=0);u+=3,d+=1}while(u<h||d<g);if(o!==this.version.getTotalCodewords())throw new ee;return r}readModule(r,o,u,d){return r<0&&(r+=u,o+=4-(u+4&7)),o<0&&(o+=d,r+=4-(d+4&7)),this.readMappingMatrix.set(o,r),this.mappingBitMatrix.get(o,r)}readUtah(r,o,u,d){let h=0;return this.readModule(r-2,o-2,u,d)&&(h|=1),h<<=1,this.readModule(r-2,o-1,u,d)&&(h|=1),h<<=1,this.readModule(r-1,o-2,u,d)&&(h|=1),h<<=1,this.readModule(r-1,o-1,u,d)&&(h|=1),h<<=1,this.readModule(r-1,o,u,d)&&(h|=1),h<<=1,this.readModule(r,o-2,u,d)&&(h|=1),h<<=1,this.readModule(r,o-1,u,d)&&(h|=1),h<<=1,this.readModule(r,o,u,d)&&(h|=1),h}readCorner1(r,o){let u=0;return this.readModule(r-1,0,r,o)&&(u|=1),u<<=1,this.readModule(r-1,1,r,o)&&(u|=1),u<<=1,this.readModule(r-1,2,r,o)&&(u|=1),u<<=1,this.readModule(0,o-2,r,o)&&(u|=1),u<<=1,this.readModule(0,o-1,r,o)&&(u|=1),u<<=1,this.readModule(1,o-1,r,o)&&(u|=1),u<<=1,this.readModule(2,o-1,r,o)&&(u|=1),u<<=1,this.readModule(3,o-1,r,o)&&(u|=1),u}readCorner2(r,o){let u=0;return this.readModule(r-3,0,r,o)&&(u|=1),u<<=1,this.readModule(r-2,0,r,o)&&(u|=1),u<<=1,this.readModule(r-1,0,r,o)&&(u|=1),u<<=1,this.readModule(0,o-4,r,o)&&(u|=1),u<<=1,this.readModule(0,o-3,r,o)&&(u|=1),u<<=1,this.readModule(0,o-2,r,o)&&(u|=1),u<<=1,this.readModule(0,o-1,r,o)&&(u|=1),u<<=1,this.readModule(1,o-1,r,o)&&(u|=1),u}readCorner3(r,o){let u=0;return this.readModule(r-1,0,r,o)&&(u|=1),u<<=1,this.readModule(r-1,o-1,r,o)&&(u|=1),u<<=1,this.readModule(0,o-3,r,o)&&(u|=1),u<<=1,this.readModule(0,o-2,r,o)&&(u|=1),u<<=1,this.readModule(0,o-1,r,o)&&(u|=1),u<<=1,this.readModule(1,o-3,r,o)&&(u|=1),u<<=1,this.readModule(1,o-2,r,o)&&(u|=1),u<<=1,this.readModule(1,o-1,r,o)&&(u|=1),u}readCorner4(r,o){let u=0;return this.readModule(r-3,0,r,o)&&(u|=1),u<<=1,this.readModule(r-2,0,r,o)&&(u|=1),u<<=1,this.readModule(r-1,0,r,o)&&(u|=1),u<<=1,this.readModule(0,o-2,r,o)&&(u|=1),u<<=1,this.readModule(0,o-1,r,o)&&(u|=1),u<<=1,this.readModule(1,o-1,r,o)&&(u|=1),u<<=1,this.readModule(2,o-1,r,o)&&(u|=1),u<<=1,this.readModule(3,o-1,r,o)&&(u|=1),u}extractDataRegion(r){const o=this.version.getSymbolSizeRows(),u=this.version.getSymbolSizeColumns();if(r.getHeight()!==o)throw new A("Dimension of bitMatrix must match the version size");const d=this.version.getDataRegionSizeRows(),h=this.version.getDataRegionSizeColumns(),g=o/d|0,w=u/h|0,S=g*d,T=w*h,R=new We(T,S);for(let D=0;D<g;++D){const B=D*d;for(let H=0;H<w;++H){const j=H*h;for(let Y=0;Y<d;++Y){const Q=D*(d+2)+1+Y,se=B+Y;for(let xe=0;xe<h;++xe){const Ee=H*(h+2)+1+xe;if(r.get(Ee,Q)){const he=j+xe;R.set(he,se)}}}}}return R}}class oa{constructor(r,o){this.numDataCodewords=r,this.codewords=o}static getDataBlocks(r,o){const u=o.getECBlocks();let d=0;const h=u.getECBlocks();for(let Y of h)d+=Y.getCount();const g=new Array(d);let w=0;for(let Y of h)for(let Q=0;Q<Y.getCount();Q++){const se=Y.getDataCodewords(),xe=u.getECCodewords()+se;g[w++]=new oa(se,new Uint8Array(xe))}const T=g[0].codewords.length-u.getECCodewords(),R=T-1;let D=0;for(let Y=0;Y<R;Y++)for(let Q=0;Q<w;Q++)g[Q].codewords[Y]=r[D++];const B=o.getVersionNumber()===24,H=B?8:w;for(let Y=0;Y<H;Y++)g[Y].codewords[T-1]=r[D++];const j=g[0].codewords.length;for(let Y=T;Y<j;Y++)for(let Q=0;Q<w;Q++){const se=B?(Q+8)%w:Q,xe=B&&se>7?Y-1:Y;g[se].codewords[xe]=r[D++]}if(D!==r.length)throw new A;return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class aa{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new A(""+r);let o=0,u=this.bitOffset,d=this.byteOffset;const h=this.bytes;if(u>0){const g=8-u,w=r<g?r:g,S=g-w,T=255>>8-w<<S;o=(h[d]&T)>>S,r-=w,u+=w,u===8&&(u=0,d++)}if(r>0){for(;r>=8;)o=o<<8|h[d]&255,d++,r-=8;if(r>0){const g=8-r,w=255>>g<<g;o=o<<r|(h[d]&w)>>g,u+=r}}return this.bitOffset=u,this.byteOffset=d,o}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var on;(function(P){P[P.PAD_ENCODE=0]="PAD_ENCODE",P[P.ASCII_ENCODE=1]="ASCII_ENCODE",P[P.C40_ENCODE=2]="C40_ENCODE",P[P.TEXT_ENCODE=3]="TEXT_ENCODE",P[P.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",P[P.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",P[P.BASE256_ENCODE=6]="BASE256_ENCODE"})(on||(on={}));class mr{static decode(r){const o=new aa(r),u=new Ne,d=new Ne,h=new Array;let g=on.ASCII_ENCODE;do if(g===on.ASCII_ENCODE)g=this.decodeAsciiSegment(o,u,d);else{switch(g){case on.C40_ENCODE:this.decodeC40Segment(o,u);break;case on.TEXT_ENCODE:this.decodeTextSegment(o,u);break;case on.ANSIX12_ENCODE:this.decodeAnsiX12Segment(o,u);break;case on.EDIFACT_ENCODE:this.decodeEdifactSegment(o,u);break;case on.BASE256_ENCODE:this.decodeBase256Segment(o,u,h);break;default:throw new ee}g=on.ASCII_ENCODE}while(g!==on.PAD_ENCODE&&o.available()>0);return d.length()>0&&u.append(d.toString()),new At(r,u.toString(),h.length===0?null:h,null)}static decodeAsciiSegment(r,o,u){let d=!1;do{let h=r.readBits(8);if(h===0)throw new ee;if(h<=128)return d&&(h+=128),o.append(String.fromCharCode(h-1)),on.ASCII_ENCODE;if(h===129)return on.PAD_ENCODE;if(h<=229){const g=h-130;g<10&&o.append("0"),o.append(""+g)}else switch(h){case 230:return on.C40_ENCODE;case 231:return on.BASE256_ENCODE;case 232:o.append("");break;case 233:case 234:break;case 235:d=!0;break;case 236:o.append("[)>05"),u.insert(0,"");break;case 237:o.append("[)>06"),u.insert(0,"");break;case 238:return on.ANSIX12_ENCODE;case 239:return on.TEXT_ENCODE;case 240:return on.EDIFACT_ENCODE;case 241:break;default:if(h!==254||r.available()!==0)throw new ee;break}}while(r.available()>0);return on.ASCII_ENCODE}static decodeC40Segment(r,o){let u=!1;const d=[];let h=0;do{if(r.available()===8)return;const g=r.readBits(8);if(g===254)return;this.parseTwoBytes(g,r.readBits(8),d);for(let w=0;w<3;w++){const S=d[w];switch(h){case 0:if(S<3)h=S+1;else if(S<this.C40_BASIC_SET_CHARS.length){const T=this.C40_BASIC_SET_CHARS[S];u?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),u=!1):o.append(T)}else throw new ee;break;case 1:u?(o.append(String.fromCharCode(S+128)),u=!1):o.append(String.fromCharCode(S)),h=0;break;case 2:if(S<this.C40_SHIFT2_SET_CHARS.length){const T=this.C40_SHIFT2_SET_CHARS[S];u?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),u=!1):o.append(T)}else switch(S){case 27:o.append("");break;case 30:u=!0;break;default:throw new ee}h=0;break;case 3:u?(o.append(String.fromCharCode(S+224)),u=!1):o.append(String.fromCharCode(S+96)),h=0;break;default:throw new ee}}}while(r.available()>0)}static decodeTextSegment(r,o){let u=!1,d=[],h=0;do{if(r.available()===8)return;const g=r.readBits(8);if(g===254)return;this.parseTwoBytes(g,r.readBits(8),d);for(let w=0;w<3;w++){const S=d[w];switch(h){case 0:if(S<3)h=S+1;else if(S<this.TEXT_BASIC_SET_CHARS.length){const T=this.TEXT_BASIC_SET_CHARS[S];u?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),u=!1):o.append(T)}else throw new ee;break;case 1:u?(o.append(String.fromCharCode(S+128)),u=!1):o.append(String.fromCharCode(S)),h=0;break;case 2:if(S<this.TEXT_SHIFT2_SET_CHARS.length){const T=this.TEXT_SHIFT2_SET_CHARS[S];u?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),u=!1):o.append(T)}else switch(S){case 27:o.append("");break;case 30:u=!0;break;default:throw new ee}h=0;break;case 3:if(S<this.TEXT_SHIFT3_SET_CHARS.length){const T=this.TEXT_SHIFT3_SET_CHARS[S];u?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),u=!1):o.append(T),h=0}else throw new ee;break;default:throw new ee}}}while(r.available()>0)}static decodeAnsiX12Segment(r,o){const u=[];do{if(r.available()===8)return;const d=r.readBits(8);if(d===254)return;this.parseTwoBytes(d,r.readBits(8),u);for(let h=0;h<3;h++){const g=u[h];switch(g){case 0:o.append("\r");break;case 1:o.append("*");break;case 2:o.append(">");break;case 3:o.append(" ");break;default:if(g<14)o.append(String.fromCharCode(g+44));else if(g<40)o.append(String.fromCharCode(g+51));else throw new ee;break}}}while(r.available()>0)}static parseTwoBytes(r,o,u){let d=(r<<8)+o-1,h=Math.floor(d/1600);u[0]=h,d-=h*1600,h=Math.floor(d/40),u[1]=h,u[2]=d-h*40}static decodeEdifactSegment(r,o){do{if(r.available()<=16)return;for(let u=0;u<4;u++){let d=r.readBits(6);if(d===31){const h=8-r.getBitOffset();h!==8&&r.readBits(h);return}(d&32)===0&&(d|=64),o.append(String.fromCharCode(d))}}while(r.available()>0)}static decodeBase256Segment(r,o,u){let d=1+r.getByteOffset();const h=this.unrandomize255State(r.readBits(8),d++);let g;if(h===0?g=r.available()/8|0:h<250?g=h:g=250*(h-249)+this.unrandomize255State(r.readBits(8),d++),g<0)throw new ee;const w=new Uint8Array(g);for(let S=0;S<g;S++){if(r.available()<8)throw new ee;w[S]=this.unrandomize255State(r.readBits(8),d++)}u.push(w);try{o.append(Pe.decode(w,Ie.ISO88591))}catch(S){throw new fr("Platform does not support required encoding: "+S.message)}}static unrandomize255State(r,o){const u=149*o%255+1,d=r-u;return d>=0?d:d+256}}mr.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],mr.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],mr.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],mr.TEXT_SHIFT2_SET_CHARS=mr.C40_SHIFT2_SET_CHARS,mr.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class so{constructor(){this.rsDecoder=new Fi(pt.DATA_MATRIX_FIELD_256)}decode(r){const o=new $n(r),u=o.getVersion(),d=o.readCodewords(),h=oa.getDataBlocks(d,u);let g=0;for(let T of h)g+=T.getNumDataCodewords();const w=new Uint8Array(g),S=h.length;for(let T=0;T<S;T++){const R=h[T],D=R.getCodewords(),B=R.getNumDataCodewords();this.correctErrors(D,B);for(let H=0;H<B;H++)w[H*S+T]=D[H]}return mr.decode(w)}correctErrors(r,o){const u=new Int32Array(r);try{this.rsDecoder.decode(u,r.length-o)}catch{throw new k}for(let d=0;d<o;d++)r[d]=u[d]}}class Dt{constructor(r){this.image=r,this.rectangleDetector=new br(this.image)}detect(){const r=this.rectangleDetector.detect();let o=this.detectSolid1(r);if(o=this.detectSolid2(o),o[3]=this.correctTopRight(o),!o[3])throw new ie;o=this.shiftToModuleCenter(o);const u=o[0],d=o[1],h=o[2],g=o[3];let w=this.transitionsBetween(u,g)+1,S=this.transitionsBetween(h,g)+1;(w&1)===1&&(w+=1),(S&1)===1&&(S+=1),4*w<7*S&&4*S<7*w&&(w=S=Math.max(w,S));let T=Dt.sampleGrid(this.image,u,d,h,g,w,S);return new Ui(T,[u,d,h,g])}static shiftPoint(r,o,u){let d=(o.getX()-r.getX())/(u+1),h=(o.getY()-r.getY())/(u+1);return new Oe(r.getX()+d,r.getY()+h)}static moveAway(r,o,u){let d=r.getX(),h=r.getY();return d<o?d-=1:d+=1,h<u?h-=1:h+=1,new Oe(d,h)}detectSolid1(r){let o=r[0],u=r[1],d=r[3],h=r[2],g=this.transitionsBetween(o,u),w=this.transitionsBetween(u,d),S=this.transitionsBetween(d,h),T=this.transitionsBetween(h,o),R=g,D=[h,o,u,d];return R>w&&(R=w,D[0]=o,D[1]=u,D[2]=d,D[3]=h),R>S&&(R=S,D[0]=u,D[1]=d,D[2]=h,D[3]=o),R>T&&(D[0]=d,D[1]=h,D[2]=o,D[3]=u),D}detectSolid2(r){let o=r[0],u=r[1],d=r[2],h=r[3],g=this.transitionsBetween(o,h),w=Dt.shiftPoint(u,d,(g+1)*4),S=Dt.shiftPoint(d,u,(g+1)*4),T=this.transitionsBetween(w,o),R=this.transitionsBetween(S,h);return T<R?(r[0]=o,r[1]=u,r[2]=d,r[3]=h):(r[0]=u,r[1]=d,r[2]=h,r[3]=o),r}correctTopRight(r){let o=r[0],u=r[1],d=r[2],h=r[3],g=this.transitionsBetween(o,h),w=this.transitionsBetween(u,h),S=Dt.shiftPoint(o,u,(w+1)*4),T=Dt.shiftPoint(d,u,(g+1)*4);g=this.transitionsBetween(S,h),w=this.transitionsBetween(T,h);let R=new Oe(h.getX()+(d.getX()-u.getX())/(g+1),h.getY()+(d.getY()-u.getY())/(g+1)),D=new Oe(h.getX()+(o.getX()-u.getX())/(w+1),h.getY()+(o.getY()-u.getY())/(w+1));if(!this.isValid(R))return this.isValid(D)?D:null;if(!this.isValid(D))return R;let B=this.transitionsBetween(S,R)+this.transitionsBetween(T,R),H=this.transitionsBetween(S,D)+this.transitionsBetween(T,D);return B>H?R:D}shiftToModuleCenter(r){let o=r[0],u=r[1],d=r[2],h=r[3],g=this.transitionsBetween(o,h)+1,w=this.transitionsBetween(d,h)+1,S=Dt.shiftPoint(o,u,w*4),T=Dt.shiftPoint(d,u,g*4);g=this.transitionsBetween(S,h)+1,w=this.transitionsBetween(T,h)+1,(g&1)===1&&(g+=1),(w&1)===1&&(w+=1);let R=(o.getX()+u.getX()+d.getX()+h.getX())/4,D=(o.getY()+u.getY()+d.getY()+h.getY())/4;o=Dt.moveAway(o,R,D),u=Dt.moveAway(u,R,D),d=Dt.moveAway(d,R,D),h=Dt.moveAway(h,R,D);let B,H;return S=Dt.shiftPoint(o,u,w*4),S=Dt.shiftPoint(S,h,g*4),B=Dt.shiftPoint(u,o,w*4),B=Dt.shiftPoint(B,d,g*4),T=Dt.shiftPoint(d,h,w*4),T=Dt.shiftPoint(T,u,g*4),H=Dt.shiftPoint(h,d,w*4),H=Dt.shiftPoint(H,o,g*4),[S,B,T,H]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,o,u,d,h,g,w){return hr.getInstance().sampleGrid(r,g,w,.5,.5,g-.5,.5,g-.5,w-.5,.5,w-.5,o.getX(),o.getY(),h.getX(),h.getY(),d.getX(),d.getY(),u.getX(),u.getY())}transitionsBetween(r,o){let u=Math.trunc(r.getX()),d=Math.trunc(r.getY()),h=Math.trunc(o.getX()),g=Math.trunc(o.getY()),w=Math.abs(g-d)>Math.abs(h-u);if(w){let Y=u;u=d,d=Y,Y=h,h=g,g=Y}let S=Math.abs(h-u),T=Math.abs(g-d),R=-S/2,D=d<g?1:-1,B=u<h?1:-1,H=0,j=this.image.get(w?d:u,w?u:d);for(let Y=u,Q=d;Y!==h;Y+=B){let se=this.image.get(w?Q:Y,w?Y:Q);if(se!==j&&(H++,j=se),R+=T,R>0){if(Q===g)break;Q+=D,R-=S}}return H}}class yr{constructor(){this.decoder=new so}decode(r,o=null){let u,d;if(o!=null&&o.has(ue.PURE_BARCODE)){const T=yr.extractPureBits(r.getBlackMatrix());u=this.decoder.decode(T),d=yr.NO_POINTS}else{const T=new Dt(r.getBlackMatrix()).detect();u=this.decoder.decode(T.getBits()),d=T.getPoints()}const h=u.getRawBytes(),g=new De(u.getText(),h,8*h.length,d,Ce.DATA_MATRIX,U.currentTimeMillis()),w=u.getByteSegments();w!=null&&g.putMetadata(Ze.BYTE_SEGMENTS,w);const S=u.getECLevel();return S!=null&&g.putMetadata(Ze.ERROR_CORRECTION_LEVEL,S),g}reset(){}static extractPureBits(r){const o=r.getTopLeftOnBit(),u=r.getBottomRightOnBit();if(o==null||u==null)throw new ie;const d=this.moduleSize(o,r);let h=o[1];const g=u[1];let w=o[0];const T=(u[0]-w+1)/d,R=(g-h+1)/d;if(T<=0||R<=0)throw new ie;const D=d/2;h+=D,w+=D;const B=new We(T,R);for(let H=0;H<R;H++){const j=h+H*d;for(let Y=0;Y<T;Y++)r.get(w+Y*d,j)&&B.set(Y,H)}return B}static moduleSize(r,o){const u=o.getWidth();let d=r[0];const h=r[1];for(;d<u&&o.get(d,h);)d++;if(d===u)throw new ie;const g=d-r[0];if(g===0)throw new ie;return g}}yr.NO_POINTS=[];class cc extends qe{constructor(r=500){super(new yr,r)}}var zi;(function(P){P[P.L=0]="L",P[P.M=1]="M",P[P.Q=2]="Q",P[P.H=3]="H"})(zi||(zi={}));class It{constructor(r,o,u){this.value=r,this.stringValue=o,this.bits=u,It.FOR_BITS.set(u,this),It.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return It.L;case"M":return It.M;case"Q":return It.Q;case"H":return It.H;default:throw new _(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof It))return!1;const o=r;return this.value===o.value}static forBits(r){if(r<0||r>=It.FOR_BITS.size)throw new A;return It.FOR_BITS.get(r)}}It.FOR_BITS=new Map,It.FOR_VALUE=new Map,It.L=new It(zi.L,"L",1),It.M=new It(zi.M,"M",0),It.Q=new It(zi.Q,"Q",3),It.H=new It(zi.H,"H",2);class yn{constructor(r){this.errorCorrectionLevel=It.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,o){return G.bitCount(r^o)}static decodeFormatInformation(r,o){const u=yn.doDecodeFormatInformation(r,o);return u!==null?u:yn.doDecodeFormatInformation(r^yn.FORMAT_INFO_MASK_QR,o^yn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,o){let u=Number.MAX_SAFE_INTEGER,d=0;for(const h of yn.FORMAT_INFO_DECODE_LOOKUP){const g=h[0];if(g===r||g===o)return new yn(h[1]);let w=yn.numBitsDiffering(r,g);w<u&&(d=h[1],u=w),r!==o&&(w=yn.numBitsDiffering(o,g),w<u&&(d=h[1],u=w))}return u<=3?new yn(d):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof yn))return!1;const o=r;return this.errorCorrectionLevel===o.errorCorrectionLevel&&this.dataMask===o.dataMask}}yn.FORMAT_INFO_MASK_QR=21522,yn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class te{constructor(r,...o){this.ecCodewordsPerBlock=r,this.ecBlocks=o}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const o=this.ecBlocks;for(const u of o)r+=u.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class V{constructor(r,o){this.count=r,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ze{constructor(r,o,...u){this.versionNumber=r,this.alignmentPatternCenters=o,this.ecBlocks=u;let d=0;const h=u[0].getECCodewordsPerBlock(),g=u[0].getECBlocks();for(const w of g)d+=w.getCount()*(w.getDataCodewords()+h);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new ee;try{return this.getVersionForNumber((r-17)/4)}catch{throw new ee}}static getVersionForNumber(r){if(r<1||r>40)throw new A;return ze.VERSIONS[r-1]}static decodeVersionInformation(r){let o=Number.MAX_SAFE_INTEGER,u=0;for(let d=0;d<ze.VERSION_DECODE_INFO.length;d++){const h=ze.VERSION_DECODE_INFO[d];if(h===r)return ze.getVersionForNumber(d+7);const g=yn.numBitsDiffering(r,h);g<o&&(u=d+7,o=g)}return o<=3?ze.getVersionForNumber(u):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),o=new We(r);o.setRegion(0,0,9,9),o.setRegion(r-8,0,8,9),o.setRegion(0,r-8,9,8);const u=this.alignmentPatternCenters.length;for(let d=0;d<u;d++){const h=this.alignmentPatternCenters[d]-2;for(let g=0;g<u;g++)d===0&&(g===0||g===u-1)||d===u-1&&g===0||o.setRegion(this.alignmentPatternCenters[g]-2,h,5,5)}return o.setRegion(6,9,1,r-17),o.setRegion(9,6,r-17,1),this.versionNumber>6&&(o.setRegion(r-11,0,3,6),o.setRegion(0,r-11,6,3)),o}toString(){return""+this.versionNumber}}ze.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ze.VERSIONS=[new ze(1,new Int32Array(0),new te(7,new V(1,19)),new te(10,new V(1,16)),new te(13,new V(1,13)),new te(17,new V(1,9))),new ze(2,Int32Array.from([6,18]),new te(10,new V(1,34)),new te(16,new V(1,28)),new te(22,new V(1,22)),new te(28,new V(1,16))),new ze(3,Int32Array.from([6,22]),new te(15,new V(1,55)),new te(26,new V(1,44)),new te(18,new V(2,17)),new te(22,new V(2,13))),new ze(4,Int32Array.from([6,26]),new te(20,new V(1,80)),new te(18,new V(2,32)),new te(26,new V(2,24)),new te(16,new V(4,9))),new ze(5,Int32Array.from([6,30]),new te(26,new V(1,108)),new te(24,new V(2,43)),new te(18,new V(2,15),new V(2,16)),new te(22,new V(2,11),new V(2,12))),new ze(6,Int32Array.from([6,34]),new te(18,new V(2,68)),new te(16,new V(4,27)),new te(24,new V(4,19)),new te(28,new V(4,15))),new ze(7,Int32Array.from([6,22,38]),new te(20,new V(2,78)),new te(18,new V(4,31)),new te(18,new V(2,14),new V(4,15)),new te(26,new V(4,13),new V(1,14))),new ze(8,Int32Array.from([6,24,42]),new te(24,new V(2,97)),new te(22,new V(2,38),new V(2,39)),new te(22,new V(4,18),new V(2,19)),new te(26,new V(4,14),new V(2,15))),new ze(9,Int32Array.from([6,26,46]),new te(30,new V(2,116)),new te(22,new V(3,36),new V(2,37)),new te(20,new V(4,16),new V(4,17)),new te(24,new V(4,12),new V(4,13))),new ze(10,Int32Array.from([6,28,50]),new te(18,new V(2,68),new V(2,69)),new te(26,new V(4,43),new V(1,44)),new te(24,new V(6,19),new V(2,20)),new te(28,new V(6,15),new V(2,16))),new ze(11,Int32Array.from([6,30,54]),new te(20,new V(4,81)),new te(30,new V(1,50),new V(4,51)),new te(28,new V(4,22),new V(4,23)),new te(24,new V(3,12),new V(8,13))),new ze(12,Int32Array.from([6,32,58]),new te(24,new V(2,92),new V(2,93)),new te(22,new V(6,36),new V(2,37)),new te(26,new V(4,20),new V(6,21)),new te(28,new V(7,14),new V(4,15))),new ze(13,Int32Array.from([6,34,62]),new te(26,new V(4,107)),new te(22,new V(8,37),new V(1,38)),new te(24,new V(8,20),new V(4,21)),new te(22,new V(12,11),new V(4,12))),new ze(14,Int32Array.from([6,26,46,66]),new te(30,new V(3,115),new V(1,116)),new te(24,new V(4,40),new V(5,41)),new te(20,new V(11,16),new V(5,17)),new te(24,new V(11,12),new V(5,13))),new ze(15,Int32Array.from([6,26,48,70]),new te(22,new V(5,87),new V(1,88)),new te(24,new V(5,41),new V(5,42)),new te(30,new V(5,24),new V(7,25)),new te(24,new V(11,12),new V(7,13))),new ze(16,Int32Array.from([6,26,50,74]),new te(24,new V(5,98),new V(1,99)),new te(28,new V(7,45),new V(3,46)),new te(24,new V(15,19),new V(2,20)),new te(30,new V(3,15),new V(13,16))),new ze(17,Int32Array.from([6,30,54,78]),new te(28,new V(1,107),new V(5,108)),new te(28,new V(10,46),new V(1,47)),new te(28,new V(1,22),new V(15,23)),new te(28,new V(2,14),new V(17,15))),new ze(18,Int32Array.from([6,30,56,82]),new te(30,new V(5,120),new V(1,121)),new te(26,new V(9,43),new V(4,44)),new te(28,new V(17,22),new V(1,23)),new te(28,new V(2,14),new V(19,15))),new ze(19,Int32Array.from([6,30,58,86]),new te(28,new V(3,113),new V(4,114)),new te(26,new V(3,44),new V(11,45)),new te(26,new V(17,21),new V(4,22)),new te(26,new V(9,13),new V(16,14))),new ze(20,Int32Array.from([6,34,62,90]),new te(28,new V(3,107),new V(5,108)),new te(26,new V(3,41),new V(13,42)),new te(30,new V(15,24),new V(5,25)),new te(28,new V(15,15),new V(10,16))),new ze(21,Int32Array.from([6,28,50,72,94]),new te(28,new V(4,116),new V(4,117)),new te(26,new V(17,42)),new te(28,new V(17,22),new V(6,23)),new te(30,new V(19,16),new V(6,17))),new ze(22,Int32Array.from([6,26,50,74,98]),new te(28,new V(2,111),new V(7,112)),new te(28,new V(17,46)),new te(30,new V(7,24),new V(16,25)),new te(24,new V(34,13))),new ze(23,Int32Array.from([6,30,54,78,102]),new te(30,new V(4,121),new V(5,122)),new te(28,new V(4,47),new V(14,48)),new te(30,new V(11,24),new V(14,25)),new te(30,new V(16,15),new V(14,16))),new ze(24,Int32Array.from([6,28,54,80,106]),new te(30,new V(6,117),new V(4,118)),new te(28,new V(6,45),new V(14,46)),new te(30,new V(11,24),new V(16,25)),new te(30,new V(30,16),new V(2,17))),new ze(25,Int32Array.from([6,32,58,84,110]),new te(26,new V(8,106),new V(4,107)),new te(28,new V(8,47),new V(13,48)),new te(30,new V(7,24),new V(22,25)),new te(30,new V(22,15),new V(13,16))),new ze(26,Int32Array.from([6,30,58,86,114]),new te(28,new V(10,114),new V(2,115)),new te(28,new V(19,46),new V(4,47)),new te(28,new V(28,22),new V(6,23)),new te(30,new V(33,16),new V(4,17))),new ze(27,Int32Array.from([6,34,62,90,118]),new te(30,new V(8,122),new V(4,123)),new te(28,new V(22,45),new V(3,46)),new te(30,new V(8,23),new V(26,24)),new te(30,new V(12,15),new V(28,16))),new ze(28,Int32Array.from([6,26,50,74,98,122]),new te(30,new V(3,117),new V(10,118)),new te(28,new V(3,45),new V(23,46)),new te(30,new V(4,24),new V(31,25)),new te(30,new V(11,15),new V(31,16))),new ze(29,Int32Array.from([6,30,54,78,102,126]),new te(30,new V(7,116),new V(7,117)),new te(28,new V(21,45),new V(7,46)),new te(30,new V(1,23),new V(37,24)),new te(30,new V(19,15),new V(26,16))),new ze(30,Int32Array.from([6,26,52,78,104,130]),new te(30,new V(5,115),new V(10,116)),new te(28,new V(19,47),new V(10,48)),new te(30,new V(15,24),new V(25,25)),new te(30,new V(23,15),new V(25,16))),new ze(31,Int32Array.from([6,30,56,82,108,134]),new te(30,new V(13,115),new V(3,116)),new te(28,new V(2,46),new V(29,47)),new te(30,new V(42,24),new V(1,25)),new te(30,new V(23,15),new V(28,16))),new ze(32,Int32Array.from([6,34,60,86,112,138]),new te(30,new V(17,115)),new te(28,new V(10,46),new V(23,47)),new te(30,new V(10,24),new V(35,25)),new te(30,new V(19,15),new V(35,16))),new ze(33,Int32Array.from([6,30,58,86,114,142]),new te(30,new V(17,115),new V(1,116)),new te(28,new V(14,46),new V(21,47)),new te(30,new V(29,24),new V(19,25)),new te(30,new V(11,15),new V(46,16))),new ze(34,Int32Array.from([6,34,62,90,118,146]),new te(30,new V(13,115),new V(6,116)),new te(28,new V(14,46),new V(23,47)),new te(30,new V(44,24),new V(7,25)),new te(30,new V(59,16),new V(1,17))),new ze(35,Int32Array.from([6,30,54,78,102,126,150]),new te(30,new V(12,121),new V(7,122)),new te(28,new V(12,47),new V(26,48)),new te(30,new V(39,24),new V(14,25)),new te(30,new V(22,15),new V(41,16))),new ze(36,Int32Array.from([6,24,50,76,102,128,154]),new te(30,new V(6,121),new V(14,122)),new te(28,new V(6,47),new V(34,48)),new te(30,new V(46,24),new V(10,25)),new te(30,new V(2,15),new V(64,16))),new ze(37,Int32Array.from([6,28,54,80,106,132,158]),new te(30,new V(17,122),new V(4,123)),new te(28,new V(29,46),new V(14,47)),new te(30,new V(49,24),new V(10,25)),new te(30,new V(24,15),new V(46,16))),new ze(38,Int32Array.from([6,32,58,84,110,136,162]),new te(30,new V(4,122),new V(18,123)),new te(28,new V(13,46),new V(32,47)),new te(30,new V(48,24),new V(14,25)),new te(30,new V(42,15),new V(32,16))),new ze(39,Int32Array.from([6,26,54,82,110,138,166]),new te(30,new V(20,117),new V(4,118)),new te(28,new V(40,47),new V(7,48)),new te(30,new V(43,24),new V(22,25)),new te(30,new V(10,15),new V(67,16))),new ze(40,Int32Array.from([6,30,58,86,114,142,170]),new te(30,new V(19,118),new V(6,119)),new te(28,new V(18,47),new V(31,48)),new te(30,new V(34,24),new V(34,25)),new te(30,new V(20,15),new V(61,16)))];var Jt;(function(P){P[P.DATA_MASK_000=0]="DATA_MASK_000",P[P.DATA_MASK_001=1]="DATA_MASK_001",P[P.DATA_MASK_010=2]="DATA_MASK_010",P[P.DATA_MASK_011=3]="DATA_MASK_011",P[P.DATA_MASK_100=4]="DATA_MASK_100",P[P.DATA_MASK_101=5]="DATA_MASK_101",P[P.DATA_MASK_110=6]="DATA_MASK_110",P[P.DATA_MASK_111=7]="DATA_MASK_111"})(Jt||(Jt={}));class ot{constructor(r,o){this.value=r,this.isMasked=o}unmaskBitMatrix(r,o){for(let u=0;u<o;u++)for(let d=0;d<o;d++)this.isMasked(u,d)&&r.flip(d,u)}}ot.values=new Map([[Jt.DATA_MASK_000,new ot(Jt.DATA_MASK_000,(P,r)=>(P+r&1)===0)],[Jt.DATA_MASK_001,new ot(Jt.DATA_MASK_001,(P,r)=>(P&1)===0)],[Jt.DATA_MASK_010,new ot(Jt.DATA_MASK_010,(P,r)=>r%3===0)],[Jt.DATA_MASK_011,new ot(Jt.DATA_MASK_011,(P,r)=>(P+r)%3===0)],[Jt.DATA_MASK_100,new ot(Jt.DATA_MASK_100,(P,r)=>(Math.floor(P/2)+Math.floor(r/3)&1)===0)],[Jt.DATA_MASK_101,new ot(Jt.DATA_MASK_101,(P,r)=>P*r%6===0)],[Jt.DATA_MASK_110,new ot(Jt.DATA_MASK_110,(P,r)=>P*r%6<3)],[Jt.DATA_MASK_111,new ot(Jt.DATA_MASK_111,(P,r)=>(P+r+P*r%3&1)===0)]]);class ol{constructor(r){const o=r.getHeight();if(o<21||(o&3)!==1)throw new ee;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let h=0;h<6;h++)r=this.copyBit(h,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let h=5;h>=0;h--)r=this.copyBit(8,h,r);const o=this.bitMatrix.getHeight();let u=0;const d=o-7;for(let h=o-1;h>=d;h--)u=this.copyBit(8,h,u);for(let h=o-8;h<o;h++)u=this.copyBit(h,8,u);if(this.parsedFormatInfo=yn.decodeFormatInformation(r,u),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new ee}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),o=Math.floor((r-17)/4);if(o<=6)return ze.getVersionForNumber(o);let u=0;const d=r-11;for(let g=5;g>=0;g--)for(let w=r-9;w>=d;w--)u=this.copyBit(w,g,u);let h=ze.decodeVersionInformation(u);if(h!==null&&h.getDimensionForVersion()===r)return this.parsedVersion=h,h;u=0;for(let g=5;g>=0;g--)for(let w=r-9;w>=d;w--)u=this.copyBit(g,w,u);if(h=ze.decodeVersionInformation(u),h!==null&&h.getDimensionForVersion()===r)return this.parsedVersion=h,h;throw new ee}copyBit(r,o,u){return(this.isMirror?this.bitMatrix.get(o,r):this.bitMatrix.get(r,o))?u<<1|1:u<<1}readCodewords(){const r=this.readFormatInformation(),o=this.readVersion(),u=ot.values.get(r.getDataMask()),d=this.bitMatrix.getHeight();u.unmaskBitMatrix(this.bitMatrix,d);const h=o.buildFunctionPattern();let g=!0;const w=new Uint8Array(o.getTotalCodewords());let S=0,T=0,R=0;for(let D=d-1;D>0;D-=2){D===6&&D--;for(let B=0;B<d;B++){const H=g?d-1-B:B;for(let j=0;j<2;j++)h.get(D-j,H)||(R++,T<<=1,this.bitMatrix.get(D-j,H)&&(T|=1),R===8&&(w[S++]=T,R=0,T=0))}g=!g}if(S!==o.getTotalCodewords())throw new ee;return w}remask(){if(this.parsedFormatInfo===null)return;const r=ot.values[this.parsedFormatInfo.getDataMask()],o=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,o)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let o=0,u=r.getWidth();o<u;o++)for(let d=o+1,h=r.getHeight();d<h;d++)r.get(o,d)!==r.get(d,o)&&(r.flip(d,o),r.flip(o,d))}}class oo{constructor(r,o){this.numDataCodewords=r,this.codewords=o}static getDataBlocks(r,o,u){if(r.length!==o.getTotalCodewords())throw new A;const d=o.getECBlocksForLevel(u);let h=0;const g=d.getECBlocks();for(const j of g)h+=j.getCount();const w=new Array(h);let S=0;for(const j of g)for(let Y=0;Y<j.getCount();Y++){const Q=j.getDataCodewords(),se=d.getECCodewordsPerBlock()+Q;w[S++]=new oo(Q,new Uint8Array(se))}const T=w[0].codewords.length;let R=w.length-1;for(;R>=0&&w[R].codewords.length!==T;)R--;R++;const D=T-d.getECCodewordsPerBlock();let B=0;for(let j=0;j<D;j++)for(let Y=0;Y<S;Y++)w[Y].codewords[j]=r[B++];for(let j=R;j<S;j++)w[j].codewords[D]=r[B++];const H=w[0].codewords.length;for(let j=D;j<H;j++)for(let Y=0;Y<S;Y++){const Q=Y<R?j:j+1;w[Y].codewords[Q]=r[B++]}return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Vn;(function(P){P[P.TERMINATOR=0]="TERMINATOR",P[P.NUMERIC=1]="NUMERIC",P[P.ALPHANUMERIC=2]="ALPHANUMERIC",P[P.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",P[P.BYTE=4]="BYTE",P[P.ECI=5]="ECI",P[P.KANJI=6]="KANJI",P[P.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",P[P.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",P[P.HANZI=9]="HANZI"})(Vn||(Vn={}));class je{constructor(r,o,u,d){this.value=r,this.stringValue=o,this.characterCountBitsForVersions=u,this.bits=d,je.FOR_BITS.set(d,this),je.FOR_VALUE.set(r,this)}static forBits(r){const o=je.FOR_BITS.get(r);if(o===void 0)throw new A;return o}getCharacterCountBits(r){const o=r.getVersionNumber();let u;return o<=9?u=0:o<=26?u=1:u=2,this.characterCountBitsForVersions[u]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof je))return!1;const o=r;return this.value===o.value}toString(){return this.stringValue}}je.FOR_BITS=new Map,je.FOR_VALUE=new Map,je.TERMINATOR=new je(Vn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),je.NUMERIC=new je(Vn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),je.ALPHANUMERIC=new je(Vn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),je.STRUCTURED_APPEND=new je(Vn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),je.BYTE=new je(Vn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),je.ECI=new je(Vn.ECI,"ECI",Int32Array.from([0,0,0]),7),je.KANJI=new je(Vn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),je.FNC1_FIRST_POSITION=new je(Vn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),je.FNC1_SECOND_POSITION=new je(Vn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),je.HANZI=new je(Vn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Bt{static decode(r,o,u,d){const h=new aa(r);let g=new Ne;const w=new Array;let S=-1,T=-1;try{let R=null,D=!1,B;do{if(h.available()<4)B=je.TERMINATOR;else{const H=h.readBits(4);B=je.forBits(H)}switch(B){case je.TERMINATOR:break;case je.FNC1_FIRST_POSITION:case je.FNC1_SECOND_POSITION:D=!0;break;case je.STRUCTURED_APPEND:if(h.available()<16)throw new ee;S=h.readBits(8),T=h.readBits(8);break;case je.ECI:const H=Bt.parseECIValue(h);if(R=Z.getCharacterSetECIByValue(H),R===null)throw new ee;break;case je.HANZI:const j=h.readBits(4),Y=h.readBits(B.getCharacterCountBits(o));j===Bt.GB2312_SUBSET&&Bt.decodeHanziSegment(h,g,Y);break;default:const Q=h.readBits(B.getCharacterCountBits(o));switch(B){case je.NUMERIC:Bt.decodeNumericSegment(h,g,Q);break;case je.ALPHANUMERIC:Bt.decodeAlphanumericSegment(h,g,Q,D);break;case je.BYTE:Bt.decodeByteSegment(h,g,Q,R,w,d);break;case je.KANJI:Bt.decodeKanjiSegment(h,g,Q);break;default:throw new ee}break}}while(B!==je.TERMINATOR)}catch{throw new ee}return new At(r,g.toString(),w.length===0?null:w,u===null?null:u.toString(),S,T)}static decodeHanziSegment(r,o,u){if(u*13>r.available())throw new ee;const d=new Uint8Array(2*u);let h=0;for(;u>0;){const g=r.readBits(13);let w=g/96<<8&4294967295|g%96;w<959?w+=41377:w+=42657,d[h]=w>>8&255,d[h+1]=w&255,h+=2,u--}try{o.append(Pe.decode(d,Ie.GB2312))}catch(g){throw new ee(g)}}static decodeKanjiSegment(r,o,u){if(u*13>r.available())throw new ee;const d=new Uint8Array(2*u);let h=0;for(;u>0;){const g=r.readBits(13);let w=g/192<<8&4294967295|g%192;w<7936?w+=33088:w+=49472,d[h]=w>>8,d[h+1]=w,h+=2,u--}try{o.append(Pe.decode(d,Ie.SHIFT_JIS))}catch(g){throw new ee(g)}}static decodeByteSegment(r,o,u,d,h,g){if(8*u>r.available())throw new ee;const w=new Uint8Array(u);for(let T=0;T<u;T++)w[T]=r.readBits(8);let S;d===null?S=Ie.guessEncoding(w,g):S=d.getName();try{o.append(Pe.decode(w,S))}catch(T){throw new ee(T)}h.push(w)}static toAlphaNumericChar(r){if(r>=Bt.ALPHANUMERIC_CHARS.length)throw new ee;return Bt.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,o,u,d){const h=o.length();for(;u>1;){if(r.available()<11)throw new ee;const g=r.readBits(11);o.append(Bt.toAlphaNumericChar(Math.floor(g/45))),o.append(Bt.toAlphaNumericChar(g%45)),u-=2}if(u===1){if(r.available()<6)throw new ee;o.append(Bt.toAlphaNumericChar(r.readBits(6)))}if(d)for(let g=h;g<o.length();g++)o.charAt(g)==="%"&&(g<o.length()-1&&o.charAt(g+1)==="%"?o.deleteCharAt(g+1):o.setCharAt(g,""))}static decodeNumericSegment(r,o,u){for(;u>=3;){if(r.available()<10)throw new ee;const d=r.readBits(10);if(d>=1e3)throw new ee;o.append(Bt.toAlphaNumericChar(Math.floor(d/100))),o.append(Bt.toAlphaNumericChar(Math.floor(d/10)%10)),o.append(Bt.toAlphaNumericChar(d%10)),u-=3}if(u===2){if(r.available()<7)throw new ee;const d=r.readBits(7);if(d>=100)throw new ee;o.append(Bt.toAlphaNumericChar(Math.floor(d/10))),o.append(Bt.toAlphaNumericChar(d%10))}else if(u===1){if(r.available()<4)throw new ee;const d=r.readBits(4);if(d>=10)throw new ee;o.append(Bt.toAlphaNumericChar(d))}}static parseECIValue(r){const o=r.readBits(8);if((o&128)===0)return o&127;if((o&192)===128){const u=r.readBits(8);return(o&63)<<8&4294967295|u}if((o&224)===192){const u=r.readBits(16);return(o&31)<<16&4294967295|u}throw new ee}}Bt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Bt.GB2312_SUBSET=1;class la{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const o=r[0];r[0]=r[2],r[2]=o}}class ua{constructor(){this.rsDecoder=new Fi(pt.QR_CODE_FIELD_256)}decodeBooleanArray(r,o){return this.decodeBitMatrix(We.parseFromBooleanArray(r),o)}decodeBitMatrix(r,o){const u=new ol(r);let d=null;try{return this.decodeBitMatrixParser(u,o)}catch(h){d=h}try{u.remask(),u.setMirror(!0),u.readVersion(),u.readFormatInformation(),u.mirror();const h=this.decodeBitMatrixParser(u,o);return h.setOther(new la(!0)),h}catch(h){throw d!==null?d:h}}decodeBitMatrixParser(r,o){const u=r.readVersion(),d=r.readFormatInformation().getErrorCorrectionLevel(),h=r.readCodewords(),g=oo.getDataBlocks(h,u,d);let w=0;for(const R of g)w+=R.getNumDataCodewords();const S=new Uint8Array(w);let T=0;for(const R of g){const D=R.getCodewords(),B=R.getNumDataCodewords();this.correctErrors(D,B);for(let H=0;H<B;H++)S[T++]=D[H]}return Bt.decode(S,u,d,o)}correctErrors(r,o){const u=new Int32Array(r);try{this.rsDecoder.decode(u,r.length-o)}catch{throw new k}for(let d=0;d<o;d++)r[d]=u[d]}}class ji extends Oe{constructor(r,o,u){super(r,o),this.estimatedModuleSize=u}aboutEquals(r,o,u){if(Math.abs(o-this.getY())<=r&&Math.abs(u-this.getX())<=r){const d=Math.abs(r-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(r,o,u){const d=(this.getX()+o)/2,h=(this.getY()+r)/2,g=(this.estimatedModuleSize+u)/2;return new ji(d,h,g)}}class xr{constructor(r,o,u,d,h,g,w){this.image=r,this.startX=o,this.startY=u,this.width=d,this.height=h,this.moduleSize=g,this.resultPointCallback=w,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,o=this.height,u=this.width,d=r+u,h=this.startY+o/2,g=new Int32Array(3),w=this.image;for(let S=0;S<o;S++){const T=h+((S&1)===0?Math.floor((S+1)/2):-Math.floor((S+1)/2));g[0]=0,g[1]=0,g[2]=0;let R=r;for(;R<d&&!w.get(R,T);)R++;let D=0;for(;R<d;){if(w.get(R,T))if(D===1)g[1]++;else if(D===2){if(this.foundPatternCross(g)){const B=this.handlePossibleCenter(g,T,R);if(B!==null)return B}g[0]=g[2],g[1]=1,g[2]=0,D=1}else g[++D]++;else D===1&&D++,g[D]++;R++}if(this.foundPatternCross(g)){const B=this.handlePossibleCenter(g,T,d);if(B!==null)return B}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ie}static centerFromEnd(r,o){return o-r[2]-r[1]/2}foundPatternCross(r){const o=this.moduleSize,u=o/2;for(let d=0;d<3;d++)if(Math.abs(o-r[d])>=u)return!1;return!0}crossCheckVertical(r,o,u,d){const h=this.image,g=h.getHeight(),w=this.crossCheckStateCount;w[0]=0,w[1]=0,w[2]=0;let S=r;for(;S>=0&&h.get(o,S)&&w[1]<=u;)w[1]++,S--;if(S<0||w[1]>u)return NaN;for(;S>=0&&!h.get(o,S)&&w[0]<=u;)w[0]++,S--;if(w[0]>u)return NaN;for(S=r+1;S<g&&h.get(o,S)&&w[1]<=u;)w[1]++,S++;if(S===g||w[1]>u)return NaN;for(;S<g&&!h.get(o,S)&&w[2]<=u;)w[2]++,S++;if(w[2]>u)return NaN;const T=w[0]+w[1]+w[2];return 5*Math.abs(T-d)>=2*d?NaN:this.foundPatternCross(w)?xr.centerFromEnd(w,S):NaN}handlePossibleCenter(r,o,u){const d=r[0]+r[1]+r[2],h=xr.centerFromEnd(r,u),g=this.crossCheckVertical(o,h,2*r[1],d);if(!isNaN(g)){const w=(r[0]+r[1]+r[2])/3;for(const T of this.possibleCenters)if(T.aboutEquals(w,g,h))return T.combineEstimate(g,h,w);const S=new ji(h,g,w);this.possibleCenters.push(S),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(S)}return null}}class Mr extends Oe{constructor(r,o,u,d){super(r,o),this.estimatedModuleSize=u,this.count=d,d===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,o,u){if(Math.abs(o-this.getY())<=r&&Math.abs(u-this.getX())<=r){const d=Math.abs(r-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(r,o,u){const d=this.count+1,h=(this.count*this.getX()+o)/d,g=(this.count*this.getY()+r)/d,w=(this.count*this.estimatedModuleSize+u)/d;return new Mr(h,g,w,d)}}class li{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class jt{constructor(r,o){this.image=r,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=o}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const o=r!=null&&r.get(ue.TRY_HARDER)!==void 0,u=r!=null&&r.get(ue.PURE_BARCODE)!==void 0,d=this.image,h=d.getHeight(),g=d.getWidth();let w=Math.floor(3*h/(4*jt.MAX_MODULES));(w<jt.MIN_SKIP||o)&&(w=jt.MIN_SKIP);let S=!1;const T=new Int32Array(5);for(let D=w-1;D<h&&!S;D+=w){T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0;let B=0;for(let H=0;H<g;H++)if(d.get(H,D))(B&1)===1&&B++,T[B]++;else if((B&1)===0)if(B===4)if(jt.foundPatternCross(T)){if(this.handlePossibleCenter(T,D,H,u)===!0)if(w=2,this.hasSkipped===!0)S=this.haveMultiplyConfirmedCenters();else{const Y=this.findRowSkip();Y>T[2]&&(D+=Y-T[2]-w,H=g-1)}else{T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,B=3;continue}B=0,T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0}else T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,B=3;else T[++B]++;else T[B]++;jt.foundPatternCross(T)&&this.handlePossibleCenter(T,D,g,u)===!0&&(w=T[0],this.hasSkipped&&(S=this.haveMultiplyConfirmedCenters()))}const R=this.selectBestPatterns();return Oe.orderBestPatterns(R),new li(R)}static centerFromEnd(r,o){return o-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let o=0;for(let h=0;h<5;h++){const g=r[h];if(g===0)return!1;o+=g}if(o<7)return!1;const u=o/7,d=u/2;return Math.abs(u-r[0])<d&&Math.abs(u-r[1])<d&&Math.abs(3*u-r[2])<3*d&&Math.abs(u-r[3])<d&&Math.abs(u-r[4])<d}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,o,u,d){const h=this.getCrossCheckStateCount();let g=0;const w=this.image;for(;r>=g&&o>=g&&w.get(o-g,r-g);)h[2]++,g++;if(r<g||o<g)return!1;for(;r>=g&&o>=g&&!w.get(o-g,r-g)&&h[1]<=u;)h[1]++,g++;if(r<g||o<g||h[1]>u)return!1;for(;r>=g&&o>=g&&w.get(o-g,r-g)&&h[0]<=u;)h[0]++,g++;if(h[0]>u)return!1;const S=w.getHeight(),T=w.getWidth();for(g=1;r+g<S&&o+g<T&&w.get(o+g,r+g);)h[2]++,g++;if(r+g>=S||o+g>=T)return!1;for(;r+g<S&&o+g<T&&!w.get(o+g,r+g)&&h[3]<u;)h[3]++,g++;if(r+g>=S||o+g>=T||h[3]>=u)return!1;for(;r+g<S&&o+g<T&&w.get(o+g,r+g)&&h[4]<u;)h[4]++,g++;if(h[4]>=u)return!1;const R=h[0]+h[1]+h[2]+h[3]+h[4];return Math.abs(R-d)<2*d&&jt.foundPatternCross(h)}crossCheckVertical(r,o,u,d){const h=this.image,g=h.getHeight(),w=this.getCrossCheckStateCount();let S=r;for(;S>=0&&h.get(o,S);)w[2]++,S--;if(S<0)return NaN;for(;S>=0&&!h.get(o,S)&&w[1]<=u;)w[1]++,S--;if(S<0||w[1]>u)return NaN;for(;S>=0&&h.get(o,S)&&w[0]<=u;)w[0]++,S--;if(w[0]>u)return NaN;for(S=r+1;S<g&&h.get(o,S);)w[2]++,S++;if(S===g)return NaN;for(;S<g&&!h.get(o,S)&&w[3]<u;)w[3]++,S++;if(S===g||w[3]>=u)return NaN;for(;S<g&&h.get(o,S)&&w[4]<u;)w[4]++,S++;if(w[4]>=u)return NaN;const T=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(T-d)>=2*d?NaN:jt.foundPatternCross(w)?jt.centerFromEnd(w,S):NaN}crossCheckHorizontal(r,o,u,d){const h=this.image,g=h.getWidth(),w=this.getCrossCheckStateCount();let S=r;for(;S>=0&&h.get(S,o);)w[2]++,S--;if(S<0)return NaN;for(;S>=0&&!h.get(S,o)&&w[1]<=u;)w[1]++,S--;if(S<0||w[1]>u)return NaN;for(;S>=0&&h.get(S,o)&&w[0]<=u;)w[0]++,S--;if(w[0]>u)return NaN;for(S=r+1;S<g&&h.get(S,o);)w[2]++,S++;if(S===g)return NaN;for(;S<g&&!h.get(S,o)&&w[3]<u;)w[3]++,S++;if(S===g||w[3]>=u)return NaN;for(;S<g&&h.get(S,o)&&w[4]<u;)w[4]++,S++;if(w[4]>=u)return NaN;const T=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(T-d)>=d?NaN:jt.foundPatternCross(w)?jt.centerFromEnd(w,S):NaN}handlePossibleCenter(r,o,u,d){const h=r[0]+r[1]+r[2]+r[3]+r[4];let g=jt.centerFromEnd(r,u),w=this.crossCheckVertical(o,Math.floor(g),r[2],h);if(!isNaN(w)&&(g=this.crossCheckHorizontal(Math.floor(g),Math.floor(w),r[2],h),!isNaN(g)&&(!d||this.crossCheckDiagonal(Math.floor(w),Math.floor(g),r[2],h)))){const S=h/7;let T=!1;const R=this.possibleCenters;for(let D=0,B=R.length;D<B;D++){const H=R[D];if(H.aboutEquals(S,w,g)){R[D]=H.combineEstimate(w,g,S),T=!0;break}}if(!T){const D=new Mr(g,w,S);R.push(D),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(D)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let o=null;for(const u of this.possibleCenters)if(u.getCount()>=jt.CENTER_QUORUM)if(o==null)o=u;else return this.hasSkipped=!0,Math.floor((Math.abs(o.getX()-u.getX())-Math.abs(o.getY()-u.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,o=0;const u=this.possibleCenters.length;for(const g of this.possibleCenters)g.getCount()>=jt.CENTER_QUORUM&&(r++,o+=g.getEstimatedModuleSize());if(r<3)return!1;const d=o/u;let h=0;for(const g of this.possibleCenters)h+=Math.abs(g.getEstimatedModuleSize()-d);return h<=.05*o}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new ie;const o=this.possibleCenters;let u;if(r>3){let d=0,h=0;for(const S of this.possibleCenters){const T=S.getEstimatedModuleSize();d+=T,h+=T*T}u=d/r;let g=Math.sqrt(h/r-u*u);o.sort((S,T)=>{const R=Math.abs(T.getEstimatedModuleSize()-u),D=Math.abs(S.getEstimatedModuleSize()-u);return R<D?-1:R>D?1:0});const w=Math.max(.2*u,g);for(let S=0;S<o.length&&o.length>3;S++){const T=o[S];Math.abs(T.getEstimatedModuleSize()-u)>w&&(o.splice(S,1),S--)}}if(o.length>3){let d=0;for(const h of o)d+=h.getEstimatedModuleSize();u=d/o.length,o.sort((h,g)=>{if(g.getCount()===h.getCount()){const w=Math.abs(g.getEstimatedModuleSize()-u),S=Math.abs(h.getEstimatedModuleSize()-u);return w<S?1:w>S?-1:0}else return g.getCount()-h.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]}}jt.CENTER_QUORUM=2,jt.MIN_SKIP=3,jt.MAX_MODULES=57;class Gr{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(ue.NEED_RESULT_POINT_CALLBACK);const u=new jt(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(u)}processFinderPatternInfo(r){const o=r.getTopLeft(),u=r.getTopRight(),d=r.getBottomLeft(),h=this.calculateModuleSize(o,u,d);if(h<1)throw new ie("No pattern found in proccess finder.");const g=Gr.computeDimension(o,u,d,h),w=ze.getProvisionalVersionForDimension(g),S=w.getDimensionForVersion()-7;let T=null;if(w.getAlignmentPatternCenters().length>0){const H=u.getX()-o.getX()+d.getX(),j=u.getY()-o.getY()+d.getY(),Y=1-3/S,Q=Math.floor(o.getX()+Y*(H-o.getX())),se=Math.floor(o.getY()+Y*(j-o.getY()));for(let xe=4;xe<=16;xe<<=1)try{T=this.findAlignmentInRegion(h,Q,se,xe);break}catch(Ee){if(!(Ee instanceof ie))throw Ee}}const R=Gr.createTransform(o,u,d,T,g),D=Gr.sampleGrid(this.image,R,g);let B;return T===null?B=[d,o,u]:B=[d,o,u,T],new Ui(D,B)}static createTransform(r,o,u,d,h){const g=h-3.5;let w,S,T,R;return d!==null?(w=d.getX(),S=d.getY(),T=g-3,R=T):(w=o.getX()-r.getX()+u.getX(),S=o.getY()-r.getY()+u.getY(),T=g,R=g),er.quadrilateralToQuadrilateral(3.5,3.5,g,3.5,T,R,3.5,g,r.getX(),r.getY(),o.getX(),o.getY(),w,S,u.getX(),u.getY())}static sampleGrid(r,o,u){return hr.getInstance().sampleGridWithTransform(r,u,u,o)}static computeDimension(r,o,u,d){const h=dt.round(Oe.distance(r,o)/d),g=dt.round(Oe.distance(r,u)/d);let w=Math.floor((h+g)/2)+7;switch(w&3){case 0:w++;break;case 2:w--;break;case 3:throw new ie("Dimensions could be not found.")}return w}calculateModuleSize(r,o,u){return(this.calculateModuleSizeOneWay(r,o)+this.calculateModuleSizeOneWay(r,u))/2}calculateModuleSizeOneWay(r,o){const u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(o.getX()),Math.floor(o.getY())),d=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(u)?d/7:isNaN(d)?u/7:(u+d)/14}sizeOfBlackWhiteBlackRunBothWays(r,o,u,d){let h=this.sizeOfBlackWhiteBlackRun(r,o,u,d),g=1,w=r-(u-r);w<0?(g=r/(r-w),w=0):w>=this.image.getWidth()&&(g=(this.image.getWidth()-1-r)/(w-r),w=this.image.getWidth()-1);let S=Math.floor(o-(d-o)*g);return g=1,S<0?(g=o/(o-S),S=0):S>=this.image.getHeight()&&(g=(this.image.getHeight()-1-o)/(S-o),S=this.image.getHeight()-1),w=Math.floor(r+(w-r)*g),h+=this.sizeOfBlackWhiteBlackRun(r,o,w,S),h-1}sizeOfBlackWhiteBlackRun(r,o,u,d){const h=Math.abs(d-o)>Math.abs(u-r);if(h){let H=r;r=o,o=H,H=u,u=d,d=H}const g=Math.abs(u-r),w=Math.abs(d-o);let S=-g/2;const T=r<u?1:-1,R=o<d?1:-1;let D=0;const B=u+T;for(let H=r,j=o;H!==B;H+=T){const Y=h?j:H,Q=h?H:j;if(D===1===this.image.get(Y,Q)){if(D===2)return dt.distance(H,j,r,o);D++}if(S+=w,S>0){if(j===d)break;j+=R,S-=g}}return D===2?dt.distance(u+T,d,r,o):NaN}findAlignmentInRegion(r,o,u,d){const h=Math.floor(d*r),g=Math.max(0,o-h),w=Math.min(this.image.getWidth()-1,o+h);if(w-g<r*3)throw new ie("Alignment top exceeds estimated module size.");const S=Math.max(0,u-h),T=Math.min(this.image.getHeight()-1,u+h);if(T-S<r*3)throw new ie("Alignment bottom exceeds estimated module size.");return new xr(this.image,g,S,w-g,T-S,r,this.resultPointCallback).find()}}class Mn{constructor(){this.decoder=new ua}getDecoder(){return this.decoder}decode(r,o){let u,d;if(o!=null&&o.get(ue.PURE_BARCODE)!==void 0){const S=Mn.extractPureBits(r.getBlackMatrix());u=this.decoder.decodeBitMatrix(S,o),d=Mn.NO_POINTS}else{const S=new Gr(r.getBlackMatrix()).detect(o);u=this.decoder.decodeBitMatrix(S.getBits(),o),d=S.getPoints()}u.getOther()instanceof la&&u.getOther().applyMirroredCorrection(d);const h=new De(u.getText(),u.getRawBytes(),void 0,d,Ce.QR_CODE,void 0),g=u.getByteSegments();g!==null&&h.putMetadata(Ze.BYTE_SEGMENTS,g);const w=u.getECLevel();return w!==null&&h.putMetadata(Ze.ERROR_CORRECTION_LEVEL,w),u.hasStructuredAppend()&&(h.putMetadata(Ze.STRUCTURED_APPEND_SEQUENCE,u.getStructuredAppendSequenceNumber()),h.putMetadata(Ze.STRUCTURED_APPEND_PARITY,u.getStructuredAppendParity())),h}reset(){}static extractPureBits(r){const o=r.getTopLeftOnBit(),u=r.getBottomRightOnBit();if(o===null||u===null)throw new ie;const d=this.moduleSize(o,r);let h=o[1],g=u[1],w=o[0],S=u[0];if(w>=S||h>=g)throw new ie;if(g-h!==S-w&&(S=w+(g-h),S>=r.getWidth()))throw new ie;const T=Math.round((S-w+1)/d),R=Math.round((g-h+1)/d);if(T<=0||R<=0)throw new ie;if(R!==T)throw new ie;const D=Math.floor(d/2);h+=D,w+=D;const B=w+Math.floor((T-1)*d)-S;if(B>0){if(B>D)throw new ie;w-=B}const H=h+Math.floor((R-1)*d)-g;if(H>0){if(H>D)throw new ie;h-=H}const j=new We(T,R);for(let Y=0;Y<R;Y++){const Q=h+Math.floor(Y*d);for(let se=0;se<T;se++)r.get(w+Math.floor(se*d),Q)&&j.set(se,Y)}return j}static moduleSize(r,o){const u=o.getHeight(),d=o.getWidth();let h=r[0],g=r[1],w=!0,S=0;for(;h<d&&g<u;){if(w!==o.get(h,g)){if(++S===5)break;w=!w}h++,g++}if(h===d||g===u)throw new ie;return(h-r[0])/7}}Mn.NO_POINTS=new Array;class Xe{PDF417Common(){}static getBitCountSum(r){return dt.sum(r)}static toIntArray(r){if(r==null||!r.length)return Xe.EMPTY_INT_ARRAY;const o=new Int32Array(r.length);let u=0;for(const d of r)o[u++]=d;return o}static getCodeword(r){const o=$.binarySearch(Xe.SYMBOL_TABLE,r&262143);return o<0?-1:(Xe.CODEWORD_TABLE[o]-1)%Xe.NUMBER_OF_CODEWORDS}}Xe.NUMBER_OF_CODEWORDS=929,Xe.MAX_CODEWORDS_IN_BARCODE=Xe.NUMBER_OF_CODEWORDS-1,Xe.MIN_ROWS_IN_BARCODE=3,Xe.MAX_ROWS_IN_BARCODE=90,Xe.MODULES_IN_CODEWORD=17,Xe.MODULES_IN_STOP_PATTERN=18,Xe.BARS_IN_MODULE=8,Xe.EMPTY_INT_ARRAY=new Int32Array([]),Xe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Xe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class al{constructor(r,o){this.bits=r,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class tt{static detectMultiple(r,o,u){let d=r.getBlackMatrix(),h=tt.detect(u,d);return h.length||(d=d.clone(),d.rotate180(),h=tt.detect(u,d)),new al(d,h)}static detect(r,o){const u=new Array;let d=0,h=0,g=!1;for(;d<o.getHeight();){const w=tt.findVertices(o,d,h);if(w[0]==null&&w[3]==null){if(!g)break;g=!1,h=0;for(const S of u)S[1]!=null&&(d=Math.trunc(Math.max(d,S[1].getY()))),S[3]!=null&&(d=Math.max(d,Math.trunc(S[3].getY())));d+=tt.ROW_STEP;continue}if(g=!0,u.push(w),!r)break;w[2]!=null?(h=Math.trunc(w[2].getX()),d=Math.trunc(w[2].getY())):(h=Math.trunc(w[4].getX()),d=Math.trunc(w[4].getY()))}return u}static findVertices(r,o,u){const d=r.getHeight(),h=r.getWidth(),g=new Array(8);return tt.copyToResult(g,tt.findRowsWithPattern(r,d,h,o,u,tt.START_PATTERN),tt.INDEXES_START_PATTERN),g[4]!=null&&(u=Math.trunc(g[4].getX()),o=Math.trunc(g[4].getY())),tt.copyToResult(g,tt.findRowsWithPattern(r,d,h,o,u,tt.STOP_PATTERN),tt.INDEXES_STOP_PATTERN),g}static copyToResult(r,o,u){for(let d=0;d<u.length;d++)r[u[d]]=o[d]}static findRowsWithPattern(r,o,u,d,h,g){const w=new Array(4);let S=!1;const T=new Int32Array(g.length);for(;d<o;d+=tt.ROW_STEP){let D=tt.findGuardPattern(r,h,d,u,!1,g,T);if(D!=null){for(;d>0;){const B=tt.findGuardPattern(r,h,--d,u,!1,g,T);if(B!=null)D=B;else{d++;break}}w[0]=new Oe(D[0],d),w[1]=new Oe(D[1],d),S=!0;break}}let R=d+1;if(S){let D=0,B=Int32Array.from([Math.trunc(w[0].getX()),Math.trunc(w[1].getX())]);for(;R<o;R++){const H=tt.findGuardPattern(r,B[0],R,u,!1,g,T);if(H!=null&&Math.abs(B[0]-H[0])<tt.MAX_PATTERN_DRIFT&&Math.abs(B[1]-H[1])<tt.MAX_PATTERN_DRIFT)B=H,D=0;else{if(D>tt.SKIPPED_ROW_COUNT_MAX)break;D++}}R-=D+1,w[2]=new Oe(B[0],R),w[3]=new Oe(B[1],R)}return R-d<tt.BARCODE_MIN_HEIGHT&&$.fill(w,null),w}static findGuardPattern(r,o,u,d,h,g,w){$.fillWithin(w,0,w.length,0);let S=o,T=0;for(;r.get(S,u)&&S>0&&T++<tt.MAX_PIXEL_DRIFT;)S--;let R=S,D=0,B=g.length;for(let H=h;R<d;R++)if(r.get(R,u)!==H)w[D]++;else{if(D===B-1){if(tt.patternMatchVariance(w,g,tt.MAX_INDIVIDUAL_VARIANCE)<tt.MAX_AVG_VARIANCE)return new Int32Array([S,R]);S+=w[0]+w[1],U.arraycopy(w,2,w,0,D-1),w[D-1]=0,w[D]=0,D--}else D++;w[D]=1,H=!H}return D===B-1&&tt.patternMatchVariance(w,g,tt.MAX_INDIVIDUAL_VARIANCE)<tt.MAX_AVG_VARIANCE?new Int32Array([S,R-1]):null}static patternMatchVariance(r,o,u){let d=r.length,h=0,g=0;for(let T=0;T<d;T++)h+=r[T],g+=o[T];if(h<g)return 1/0;let w=h/g;u*=w;let S=0;for(let T=0;T<d;T++){let R=r[T],D=o[T]*w,B=R>D?R-D:D-R;if(B>u)return 1/0;S+=B}return S/h}}tt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),tt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),tt.MAX_AVG_VARIANCE=.42,tt.MAX_INDIVIDUAL_VARIANCE=.8,tt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),tt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),tt.MAX_PIXEL_DRIFT=3,tt.MAX_PATTERN_DRIFT=5,tt.SKIPPED_ROW_COUNT_MAX=25,tt.ROW_STEP=5,tt.BARCODE_MIN_HEIGHT=10;class xn{constructor(r,o){if(o.length===0)throw new A;this.field=r;let u=o.length;if(u>1&&o[0]===0){let d=1;for(;d<u&&o[d]===0;)d++;d===u?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(u-d),U.arraycopy(o,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let d=0;for(let h of this.coefficients)d=this.field.add(d,h);return d}let o=this.coefficients[0],u=this.coefficients.length;for(let d=1;d<u;d++)o=this.field.add(this.field.multiply(r,o),this.coefficients[d]);return o}add(r){if(!this.field.equals(r.field))throw new A("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let o=this.coefficients,u=r.coefficients;if(o.length>u.length){let g=o;o=u,u=g}let d=new Int32Array(u.length),h=u.length-o.length;U.arraycopy(u,0,d,0,h);for(let g=h;g<u.length;g++)d[g]=this.field.add(o[g-h],u[g]);return new xn(this.field,d)}subtract(r){if(!this.field.equals(r.field))throw new A("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof xn?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new A("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new xn(this.field,new Int32Array([0]));let o=this.coefficients,u=o.length,d=r.coefficients,h=d.length,g=new Int32Array(u+h-1);for(let w=0;w<u;w++){let S=o[w];for(let T=0;T<h;T++)g[w+T]=this.field.add(g[w+T],this.field.multiply(S,d[T]))}return new xn(this.field,g)}negative(){let r=this.coefficients.length,o=new Int32Array(r);for(let u=0;u<r;u++)o[u]=this.field.subtract(0,this.coefficients[u]);return new xn(this.field,o)}multiplyScalar(r){if(r===0)return new xn(this.field,new Int32Array([0]));if(r===1)return this;let o=this.coefficients.length,u=new Int32Array(o);for(let d=0;d<o;d++)u[d]=this.field.multiply(this.coefficients[d],r);return new xn(this.field,u)}multiplyByMonomial(r,o){if(r<0)throw new A;if(o===0)return new xn(this.field,new Int32Array([0]));let u=this.coefficients.length,d=new Int32Array(u+r);for(let h=0;h<u;h++)d[h]=this.field.multiply(this.coefficients[h],o);return new xn(this.field,d)}toString(){let r=new Ne;for(let o=this.getDegree();o>=0;o--){let u=this.getCoefficient(o);u!==0&&(u<0?(r.append(" - "),u=-u):r.length()>0&&r.append(" + "),(o===0||u!==1)&&r.append(u),o!==0&&(o===1?r.append("x"):(r.append("x^"),r.append(o))))}return r.toString()}}class ll{add(r,o){return(r+o)%this.modulus}subtract(r,o){return(this.modulus+r-o)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new A;return this.logTable[r]}inverse(r){if(r===0)throw new xs;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,o){return r===0||o===0?0:this.expTable[(this.logTable[r]+this.logTable[o])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class qi extends ll{constructor(r,o){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let u=1;for(let d=0;d<r;d++)this.expTable[d]=u,u=u*o%r;for(let d=0;d<r-1;d++)this.logTable[this.expTable[d]]=d;this.zero=new xn(this,new Int32Array([0])),this.one=new xn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,o){if(r<0)throw new A;if(o===0)return this.zero;let u=new Int32Array(r+1);return u[0]=o,new xn(this,u)}}qi.PDF417_GF=new qi(Xe.NUMBER_OF_CODEWORDS,3);class ca{constructor(){this.field=qi.PDF417_GF}decode(r,o,u){let d=new xn(this.field,r),h=new Int32Array(o),g=!1;for(let j=o;j>0;j--){let Y=d.evaluateAt(this.field.exp(j));h[o-j]=Y,Y!==0&&(g=!0)}if(!g)return 0;let w=this.field.getOne();if(u!=null)for(const j of u){let Y=this.field.exp(r.length-1-j),Q=new xn(this.field,new Int32Array([this.field.subtract(0,Y),1]));w=w.multiply(Q)}let S=new xn(this.field,h),T=this.runEuclideanAlgorithm(this.field.buildMonomial(o,1),S,o),R=T[0],D=T[1],B=this.findErrorLocations(R),H=this.findErrorMagnitudes(D,R,B);for(let j=0;j<B.length;j++){let Y=r.length-1-this.field.log(B[j]);if(Y<0)throw k.getChecksumInstance();r[Y]=this.field.subtract(r[Y],H[j])}return B.length}runEuclideanAlgorithm(r,o,u){if(r.getDegree()<o.getDegree()){let B=r;r=o,o=B}let d=r,h=o,g=this.field.getZero(),w=this.field.getOne();for(;h.getDegree()>=Math.round(u/2);){let B=d,H=g;if(d=h,g=w,d.isZero())throw k.getChecksumInstance();h=B;let j=this.field.getZero(),Y=d.getCoefficient(d.getDegree()),Q=this.field.inverse(Y);for(;h.getDegree()>=d.getDegree()&&!h.isZero();){let se=h.getDegree()-d.getDegree(),xe=this.field.multiply(h.getCoefficient(h.getDegree()),Q);j=j.add(this.field.buildMonomial(se,xe)),h=h.subtract(d.multiplyByMonomial(se,xe))}w=j.multiply(g).subtract(H).negative()}let S=w.getCoefficient(0);if(S===0)throw k.getChecksumInstance();let T=this.field.inverse(S),R=w.multiply(T),D=h.multiply(T);return[R,D]}findErrorLocations(r){let o=r.getDegree(),u=new Int32Array(o),d=0;for(let h=1;h<this.field.getSize()&&d<o;h++)r.evaluateAt(h)===0&&(u[d]=this.field.inverse(h),d++);if(d!==o)throw k.getChecksumInstance();return u}findErrorMagnitudes(r,o,u){let d=o.getDegree(),h=new Int32Array(d);for(let T=1;T<=d;T++)h[d-T]=this.field.multiply(T,o.getCoefficient(T));let g=new xn(this.field,h),w=u.length,S=new Int32Array(w);for(let T=0;T<w;T++){let R=this.field.inverse(u[T]),D=this.field.subtract(0,r.evaluateAt(R)),B=this.field.inverse(g.evaluateAt(R));S[T]=this.field.multiply(D,B)}return S}}class xi{constructor(r,o,u,d,h){r instanceof xi?this.constructor_2(r):this.constructor_1(r,o,u,d,h)}constructor_1(r,o,u,d,h){const g=o==null||u==null,w=d==null||h==null;if(g&&w)throw new ie;g?(o=new Oe(0,d.getY()),u=new Oe(0,h.getY())):w&&(d=new Oe(r.getWidth()-1,o.getY()),h=new Oe(r.getWidth()-1,u.getY())),this.image=r,this.topLeft=o,this.bottomLeft=u,this.topRight=d,this.bottomRight=h,this.minX=Math.trunc(Math.min(o.getX(),u.getX())),this.maxX=Math.trunc(Math.max(d.getX(),h.getX())),this.minY=Math.trunc(Math.min(o.getY(),d.getY())),this.maxY=Math.trunc(Math.max(u.getY(),h.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,o){return r==null?o:o==null?r:new xi(r.image,r.topLeft,r.bottomLeft,o.topRight,o.bottomRight)}addMissingRows(r,o,u){let d=this.topLeft,h=this.bottomLeft,g=this.topRight,w=this.bottomRight;if(r>0){let S=u?this.topLeft:this.topRight,T=Math.trunc(S.getY()-r);T<0&&(T=0);let R=new Oe(S.getX(),T);u?d=R:g=R}if(o>0){let S=u?this.bottomLeft:this.bottomRight,T=Math.trunc(S.getY()+o);T>=this.image.getHeight()&&(T=this.image.getHeight()-1);let R=new Oe(S.getX(),T);u?h=R:w=R}return new xi(this.image,d,h,g,w)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Cs{constructor(r,o,u,d){this.columnCount=r,this.errorCorrectionLevel=d,this.rowCountUpperPart=o,this.rowCountLowerPart=u,this.rowCount=o+u}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class zr{constructor(){this.buffer=""}static form(r,o){let u=-1;function d(g,w,S,T,R,D){if(g==="%%")return"%";if(o[++u]===void 0)return;g=T?parseInt(T.substr(1)):void 0;let B=R?parseInt(R.substr(1)):void 0,H;switch(D){case"s":H=o[u];break;case"c":H=o[u][0];break;case"f":H=parseFloat(o[u]).toFixed(g);break;case"p":H=parseFloat(o[u]).toPrecision(g);break;case"e":H=parseFloat(o[u]).toExponential(g);break;case"x":H=parseInt(o[u]).toString(B||16);break;case"d":H=parseFloat(parseInt(o[u],B||10).toPrecision(g)).toFixed(0);break}H=typeof H=="object"?JSON.stringify(H):(+H).toString(B);let j=parseInt(S),Y=S&&S[0]+""=="0"?"0":" ";for(;H.length<j;)H=w!==void 0?H+Y:Y+H;return H}let h=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(h,d)}format(r,...o){this.buffer+=zr.form(r,o)}toString(){return this.buffer}}class kr{constructor(r){this.boundingBox=new xi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let o=this.getCodeword(r);if(o!=null)return o;for(let u=1;u<kr.MAX_NEARBY_DISTANCE;u++){let d=this.imageRowToCodewordIndex(r)-u;if(d>=0&&(o=this.codewords[d],o!=null)||(d=this.imageRowToCodewordIndex(r)+u,d<this.codewords.length&&(o=this.codewords[d],o!=null)))return o}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,o){this.codewords[this.imageRowToCodewordIndex(r)]=o}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new zr;let o=0;for(const u of this.codewords){if(u==null){r.format("%3d:    |   %n",o++);continue}r.format("%3d: %3d|%3d%n",o++,u.getRowNumber(),u.getValue())}return r.toString()}}kr.MAX_NEARBY_DISTANCE=5;class ui{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let o=this.values.get(r);o==null&&(o=0),o++,this.values.set(r,o)}getValue(){let r=-1,o=new Array;for(const[u,d]of this.values.entries()){const h={getKey:()=>u,getValue:()=>d};h.getValue()>r?(r=h.getValue(),o=[],o.push(h.getKey())):h.getValue()===r&&o.push(h.getKey())}return Xe.toIntArray(o)}getConfidence(r){return this.values.get(r)}}class ul extends kr{constructor(r,o){super(r),this._isLeft=o}setRowNumbers(){for(let r of this.getCodewords())r?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let o=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(o,r);let u=this.getBoundingBox(),d=this._isLeft?u.getTopLeft():u.getTopRight(),h=this._isLeft?u.getBottomLeft():u.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=this.imageRowToCodewordIndex(Math.trunc(h.getY())),S=-1,T=1,R=0;for(let D=g;D<w;D++){if(o[D]==null)continue;let B=o[D],H=B.getRowNumber()-S;if(H===0)R++;else if(H===1)T=Math.max(T,R),R=1,S=B.getRowNumber();else if(H<0||B.getRowNumber()>=r.getRowCount()||H>D)o[D]=null;else{let j;T>2?j=(T-2)*H:j=H;let Y=j>=D;for(let Q=1;Q<=j&&!Y;Q++)Y=o[D-Q]!=null;Y?o[D]=null:(S=B.getRowNumber(),R=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let o=new Int32Array(r.getRowCount());for(let u of this.getCodewords())if(u!=null){let d=u.getRowNumber();if(d>=o.length)continue;o[d]++}return o}adjustIncompleteIndicatorColumnRowNumbers(r){let o=this.getBoundingBox(),u=this._isLeft?o.getTopLeft():o.getTopRight(),d=this._isLeft?o.getBottomLeft():o.getBottomRight(),h=this.imageRowToCodewordIndex(Math.trunc(u.getY())),g=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=this.getCodewords(),S=-1;for(let T=h;T<g;T++){if(w[T]==null)continue;let R=w[T];R.setRowNumberAsRowIndicatorColumn();let D=R.getRowNumber()-S;D===0||(D===1?S=R.getRowNumber():R.getRowNumber()>=r.getRowCount()?w[T]=null:S=R.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),o=new ui,u=new ui,d=new ui,h=new ui;for(let w of r){if(w==null)continue;w.setRowNumberAsRowIndicatorColumn();let S=w.getValue()%30,T=w.getRowNumber();switch(this._isLeft||(T+=2),T%3){case 0:u.setValue(S*3+1);break;case 1:h.setValue(S/3),d.setValue(S%3);break;case 2:o.setValue(S+1);break}}if(o.getValue().length===0||u.getValue().length===0||d.getValue().length===0||h.getValue().length===0||o.getValue()[0]<1||u.getValue()[0]+d.getValue()[0]<Xe.MIN_ROWS_IN_BARCODE||u.getValue()[0]+d.getValue()[0]>Xe.MAX_ROWS_IN_BARCODE)return null;let g=new Cs(o.getValue()[0],u.getValue()[0],d.getValue()[0],h.getValue()[0]);return this.removeIncorrectCodewords(r,g),g}removeIncorrectCodewords(r,o){for(let u=0;u<r.length;u++){let d=r[u];if(r[u]==null)continue;let h=d.getValue()%30,g=d.getRowNumber();if(g>o.getRowCount()){r[u]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:h*3+1!==o.getRowCountUpperPart()&&(r[u]=null);break;case 1:(Math.trunc(h/3)!==o.getErrorCorrectionLevel()||h%3!==o.getRowCountLowerPart())&&(r[u]=null);break;case 2:h+1!==o.getColumnCount()&&(r[u]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Ss{constructor(r,o){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=o,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=Xe.MAX_CODEWORDS_IN_BARCODE,o;do o=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<o);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let o=1;o<this.barcodeColumnCount+1;o++){let u=this.detectionResultColumns[o].getCodewords();for(let d=0;d<u.length;d++)u[d]!=null&&(u[d].hasValidRowNumber()||this.adjustRowNumbers(o,d,u))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<r.length;u++)if(r[u]!=null&&o[u]!=null&&r[u].getRowNumber()===o[u].getRowNumber())for(let d=1;d<=this.barcodeColumnCount;d++){let h=this.detectionResultColumns[d].getCodewords()[u];h!=null&&(h.setRowNumber(r[u].getRowNumber()),h.hasValidRowNumber()||(this.detectionResultColumns[d].getCodewords()[u]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<o.length;u++){if(o[u]==null)continue;let d=o[u].getRowNumber(),h=0;for(let g=this.barcodeColumnCount+1;g>0&&h<this.ADJUST_ROW_NUMBER_SKIP;g--){let w=this.detectionResultColumns[g].getCodewords()[u];w!=null&&(h=Ss.adjustRowNumberIfValid(d,h,w),w.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,o=this.detectionResultColumns[0].getCodewords();for(let u=0;u<o.length;u++){if(o[u]==null)continue;let d=o[u].getRowNumber(),h=0;for(let g=1;g<this.barcodeColumnCount+1&&h<this.ADJUST_ROW_NUMBER_SKIP;g++){let w=this.detectionResultColumns[g].getCodewords()[u];w!=null&&(h=Ss.adjustRowNumberIfValid(d,h,w),w.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,o,u){return u==null||u.hasValidRowNumber()||(u.isValidRowNumber(r)?(u.setRowNumber(r),o=0):++o),o}adjustRowNumbers(r,o,u){if(!this.detectionResultColumns[r-1])return;let d=u[o],h=this.detectionResultColumns[r-1].getCodewords(),g=h;this.detectionResultColumns[r+1]!=null&&(g=this.detectionResultColumns[r+1].getCodewords());let w=new Array(14);w[2]=h[o],w[3]=g[o],o>0&&(w[0]=u[o-1],w[4]=h[o-1],w[5]=g[o-1]),o>1&&(w[8]=u[o-2],w[10]=h[o-2],w[11]=g[o-2]),o<u.length-1&&(w[1]=u[o+1],w[6]=h[o+1],w[7]=g[o+1]),o<u.length-2&&(w[9]=u[o+2],w[12]=h[o+2],w[13]=g[o+2]);for(let S of w)if(Ss.adjustRowNumber(d,S))return}static adjustRowNumber(r,o){return o==null?!1:o.hasValidRowNumber()&&o.getBucket()===r.getBucket()?(r.setRowNumber(o.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,o){this.detectionResultColumns[r]=o}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let o=new zr;for(let u=0;u<r.getCodewords().length;u++){o.format("CW %3d:",u);for(let d=0;d<this.barcodeColumnCount+2;d++){if(this.detectionResultColumns[d]==null){o.format("    |   ");continue}let h=this.detectionResultColumns[d].getCodewords()[u];if(h==null){o.format("    |   ");continue}o.format(" %3d|%3d",h.getRowNumber(),h.getValue())}o.format("%n")}return o.toString()}}class vi{constructor(r,o,u,d){this.rowNumber=vi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(o),this.bucket=Math.trunc(u),this.value=Math.trunc(d)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==vi.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}vi.BARCODE_ROW_UNKNOWN=-1;class vn{static initialize(){for(let r=0;r<Xe.SYMBOL_TABLE.length;r++){let o=Xe.SYMBOL_TABLE[r],u=o&1;for(let d=0;d<Xe.BARS_IN_MODULE;d++){let h=0;for(;(o&1)===u;)h+=1,o>>=1;u=o&1,vn.RATIOS_TABLE[r]||(vn.RATIOS_TABLE[r]=new Array(Xe.BARS_IN_MODULE)),vn.RATIOS_TABLE[r][Xe.BARS_IN_MODULE-d-1]=Math.fround(h/Xe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let o=vn.getDecodedCodewordValue(vn.sampleBitCounts(r));return o!==-1?o:vn.getClosestDecodedValue(r)}static sampleBitCounts(r){let o=dt.sum(r),u=new Int32Array(Xe.BARS_IN_MODULE),d=0,h=0;for(let g=0;g<Xe.MODULES_IN_CODEWORD;g++){let w=o/(2*Xe.MODULES_IN_CODEWORD)+g*o/Xe.MODULES_IN_CODEWORD;h+r[d]<=w&&(h+=r[d],d++),u[d]++}return u}static getDecodedCodewordValue(r){let o=vn.getBitValue(r);return Xe.getCodeword(o)===-1?-1:o}static getBitValue(r){let o=0;for(let u=0;u<r.length;u++)for(let d=0;d<r[u];d++)o=o<<1|(u%2===0?1:0);return Math.trunc(o)}static getClosestDecodedValue(r){let o=dt.sum(r),u=new Array(Xe.BARS_IN_MODULE);if(o>1)for(let g=0;g<u.length;g++)u[g]=Math.fround(r[g]/o);let d=si.MAX_VALUE,h=-1;this.bSymbolTableReady||vn.initialize();for(let g=0;g<vn.RATIOS_TABLE.length;g++){let w=0,S=vn.RATIOS_TABLE[g];for(let T=0;T<Xe.BARS_IN_MODULE;T++){let R=Math.fround(S[T]-u[T]);if(w+=Math.fround(R*R),w>=d)break}w<d&&(d=w,h=Xe.SYMBOL_TABLE[g])}return h}}vn.bSymbolTableReady=!1,vn.RATIOS_TABLE=new Array(Xe.SYMBOL_TABLE.length).map(P=>new Array(Xe.BARS_IN_MODULE));class ao{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class da{static parseLong(r,o=void 0){return parseInt(r,o)}}class jr extends p{}jr.kind="NullPointerException";class fa{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,o,u){if(r==null)throw new jr;if(o<0||o>r.length||u<0||o+u>r.length||o+u<0)throw new F;if(u===0)return;for(let d=0;d<u;d++)this.write(r[o+d])}flush(){}close(){}}class lo extends p{}class cl extends fa{constructor(r=32){if(super(),this.count=0,r<0)throw new A("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let u=this.buf.length<<1;if(u-r<0&&(u=r),u<0){if(r<0)throw new lo;u=G.MAX_VALUE}this.buf=$.copyOfUint8Array(this.buf,u)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,o,u){if(o<0||o>r.length||u<0||o+u-r.length>0)throw new F;this.ensureCapacity(this.count+u),U.arraycopy(r,o,this.buf,this.count,u),this.count+=u}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return $.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var yt;(function(P){P[P.ALPHA=0]="ALPHA",P[P.LOWER=1]="LOWER",P[P.MIXED=2]="MIXED",P[P.PUNCT=3]="PUNCT",P[P.ALPHA_SHIFT=4]="ALPHA_SHIFT",P[P.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(yt||(yt={}));function As(){if(typeof window<"u")return window.BigInt||null;if(typeof au<"u")return au.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ts;function Qt(P){if(typeof Ts>"u"&&(Ts=As()),Ts===null)throw new Error("BigInt is not supported!");return Ts(P)}function Wi(){let P=[];P[0]=Qt(1);let r=Qt(900);P[1]=r;for(let o=2;o<16;o++)P[o]=P[o-1]*r;return P}class oe{static decode(r,o){let u=new Ne(""),d=Z.ISO8859_1;u.enableDecoding(d);let h=1,g=r[h++],w=new ao;for(;h<r[0];){switch(g){case oe.TEXT_COMPACTION_MODE_LATCH:h=oe.textCompaction(r,h,u);break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:h=oe.byteCompaction(g,r,d,h,u);break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(r[h++]);break;case oe.NUMERIC_COMPACTION_MODE_LATCH:h=oe.numericCompaction(r,h,u);break;case oe.ECI_CHARSET:Z.getCharacterSetECIByValue(r[h++]);break;case oe.ECI_GENERAL_PURPOSE:h+=2;break;case oe.ECI_USER_DEFINED:h++;break;case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:h=oe.decodeMacroBlock(r,h,w);break;case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:throw new ee;default:h--,h=oe.textCompaction(r,h,u);break}if(h<r.length)g=r[h++];else throw ee.getFormatInstance()}if(u.length()===0)throw ee.getFormatInstance();let S=new At(null,u.toString(),null,o);return S.setOther(w),S}static decodeMacroBlock(r,o,u){if(o+oe.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw ee.getFormatInstance();let d=new Int32Array(oe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let w=0;w<oe.NUMBER_OF_SEQUENCE_CODEWORDS;w++,o++)d[w]=r[o];u.setSegmentIndex(G.parseInt(oe.decodeBase900toBase10(d,oe.NUMBER_OF_SEQUENCE_CODEWORDS)));let h=new Ne;o=oe.textCompaction(r,o,h),u.setFileId(h.toString());let g=-1;for(r[o]===oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=o+1);o<r[0];)switch(r[o]){case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(o++,r[o]){case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let w=new Ne;o=oe.textCompaction(r,o+1,w),u.setFileName(w.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let S=new Ne;o=oe.textCompaction(r,o+1,S),u.setSender(S.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let T=new Ne;o=oe.textCompaction(r,o+1,T),u.setAddressee(T.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let R=new Ne;o=oe.numericCompaction(r,o+1,R),u.setSegmentCount(G.parseInt(R.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let D=new Ne;o=oe.numericCompaction(r,o+1,D),u.setTimestamp(da.parseLong(D.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let B=new Ne;o=oe.numericCompaction(r,o+1,B),u.setChecksum(G.parseInt(B.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let H=new Ne;o=oe.numericCompaction(r,o+1,H),u.setFileSize(da.parseLong(H.toString()));break;default:throw ee.getFormatInstance()}break;case oe.MACRO_PDF417_TERMINATOR:o++,u.setLastSegment(!0);break;default:throw ee.getFormatInstance()}if(g!==-1){let w=o-g;u.isLastSegment()&&w--,u.setOptionalData($.copyOfRange(r,g,g+w))}return o}static textCompaction(r,o,u){let d=new Int32Array((r[0]-o)*2),h=new Int32Array((r[0]-o)*2),g=0,w=!1;for(;o<r[0]&&!w;){let S=r[o++];if(S<oe.TEXT_COMPACTION_MODE_LATCH)d[g]=S/30,d[g+1]=S%30,g+=2;else switch(S){case oe.TEXT_COMPACTION_MODE_LATCH:d[g++]=oe.TEXT_COMPACTION_MODE_LATCH;break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:o--,w=!0;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d[g]=oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,S=r[o++],h[g]=S,g++;break}}return oe.decodeTextCompaction(d,h,g,u),o}static decodeTextCompaction(r,o,u,d){let h=yt.ALPHA,g=yt.ALPHA,w=0;for(;w<u;){let S=r[w],T="";switch(h){case yt.ALPHA:if(S<26)T=String.fromCharCode(65+S);else switch(S){case 26:T=" ";break;case oe.LL:h=yt.LOWER;break;case oe.ML:h=yt.MIXED;break;case oe.PS:g=h,h=yt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[w]);break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break;case yt.LOWER:if(S<26)T=String.fromCharCode(97+S);else switch(S){case 26:T=" ";break;case oe.AS:g=h,h=yt.ALPHA_SHIFT;break;case oe.ML:h=yt.MIXED;break;case oe.PS:g=h,h=yt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[w]);break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break;case yt.MIXED:if(S<oe.PL)T=oe.MIXED_CHARS[S];else switch(S){case oe.PL:h=yt.PUNCT;break;case 26:T=" ";break;case oe.LL:h=yt.LOWER;break;case oe.AL:h=yt.ALPHA;break;case oe.PS:g=h,h=yt.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[w]);break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break;case yt.PUNCT:if(S<oe.PAL)T=oe.PUNCT_CHARS[S];else switch(S){case oe.PAL:h=yt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[w]);break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break;case yt.ALPHA_SHIFT:if(h=g,S<26)T=String.fromCharCode(65+S);else switch(S){case 26:T=" ";break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break;case yt.PUNCT_SHIFT:if(h=g,S<oe.PAL)T=oe.PUNCT_CHARS[S];else switch(S){case oe.PAL:h=yt.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[w]);break;case oe.TEXT_COMPACTION_MODE_LATCH:h=yt.ALPHA;break}break}T!==""&&d.append(T),w++}}static byteCompaction(r,o,u,d,h){let g=new cl,w=0,S=0,T=!1;switch(r){case oe.BYTE_COMPACTION_MODE_LATCH:let R=new Int32Array(6),D=o[d++];for(;d<o[0]&&!T;)switch(R[w++]=D,S=900*S+D,D=o[d++],D){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:d--,T=!0;break;default:if(w%5===0&&w>0){for(let B=0;B<6;++B)g.write(Number(Qt(S)>>Qt(8*(5-B))));S=0,w=0}break}d===o[0]&&D<oe.TEXT_COMPACTION_MODE_LATCH&&(R[w++]=D);for(let B=0;B<w;B++)g.write(R[B]);break;case oe.BYTE_COMPACTION_MODE_LATCH_6:for(;d<o[0]&&!T;){let B=o[d++];if(B<oe.TEXT_COMPACTION_MODE_LATCH)w++,S=900*S+B;else switch(B){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:d--,T=!0;break}if(w%5===0&&w>0){for(let H=0;H<6;++H)g.write(Number(Qt(S)>>Qt(8*(5-H))));S=0,w=0}}break}return h.append(Pe.decode(g.toByteArray(),u)),d}static numericCompaction(r,o,u){let d=0,h=!1,g=new Int32Array(oe.MAX_NUMERIC_CODEWORDS);for(;o<r[0]&&!h;){let w=r[o++];if(o===r[0]&&(h=!0),w<oe.TEXT_COMPACTION_MODE_LATCH)g[d]=w,d++;else switch(w){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:o--,h=!0;break}(d%oe.MAX_NUMERIC_CODEWORDS===0||w===oe.NUMERIC_COMPACTION_MODE_LATCH||h)&&d>0&&(u.append(oe.decodeBase900toBase10(g,d)),d=0)}return o}static decodeBase900toBase10(r,o){let u=Qt(0);for(let h=0;h<o;h++)u+=oe.EXP900[o-h-1]*Qt(r[h]);let d=u.toString();if(d.charAt(0)!=="1")throw new ee;return d.substring(1)}}oe.TEXT_COMPACTION_MODE_LATCH=900,oe.BYTE_COMPACTION_MODE_LATCH=901,oe.NUMERIC_COMPACTION_MODE_LATCH=902,oe.BYTE_COMPACTION_MODE_LATCH_6=924,oe.ECI_USER_DEFINED=925,oe.ECI_GENERAL_PURPOSE=926,oe.ECI_CHARSET=927,oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,oe.MACRO_PDF417_TERMINATOR=922,oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,oe.MAX_NUMERIC_CODEWORDS=15,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,oe.PL=25,oe.LL=27,oe.AS=27,oe.ML=28,oe.AL=28,oe.PS=29,oe.PAL=29,oe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,oe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",oe.EXP900=As()?Wi():[],oe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class rt{constructor(){}static decode(r,o,u,d,h,g,w){let S=new xi(r,o,u,d,h),T=null,R=null,D;for(let j=!0;;j=!1){if(o!=null&&(T=rt.getRowIndicatorColumn(r,S,o,!0,g,w)),d!=null&&(R=rt.getRowIndicatorColumn(r,S,d,!1,g,w)),D=rt.merge(T,R),D==null)throw ie.getNotFoundInstance();let Y=D.getBoundingBox();if(j&&Y!=null&&(Y.getMinY()<S.getMinY()||Y.getMaxY()>S.getMaxY()))S=Y;else break}D.setBoundingBox(S);let B=D.getBarcodeColumnCount()+1;D.setDetectionResultColumn(0,T),D.setDetectionResultColumn(B,R);let H=T!=null;for(let j=1;j<=B;j++){let Y=H?j:B-j;if(D.getDetectionResultColumn(Y)!==void 0)continue;let Q;Y===0||Y===B?Q=new ul(S,Y===0):Q=new kr(S),D.setDetectionResultColumn(Y,Q);let se=-1,xe=se;for(let Ee=S.getMinY();Ee<=S.getMaxY();Ee++){if(se=rt.getStartColumn(D,Y,Ee,H),se<0||se>S.getMaxX()){if(xe===-1)continue;se=xe}let he=rt.detectCodeword(r,S.getMinX(),S.getMaxX(),H,se,Ee,g,w);he!=null&&(Q.setCodeword(Ee,he),xe=se,g=Math.min(g,he.getWidth()),w=Math.max(w,he.getWidth()))}}return rt.createDecoderResult(D)}static merge(r,o){if(r==null&&o==null)return null;let u=rt.getBarcodeMetadata(r,o);if(u==null)return null;let d=xi.merge(rt.adjustBoundingBox(r),rt.adjustBoundingBox(o));return new Ss(u,d)}static adjustBoundingBox(r){if(r==null)return null;let o=r.getRowHeights();if(o==null)return null;let u=rt.getMax(o),d=0;for(let w of o)if(d+=u-w,w>0)break;let h=r.getCodewords();for(let w=0;d>0&&h[w]==null;w++)d--;let g=0;for(let w=o.length-1;w>=0&&(g+=u-o[w],!(o[w]>0));w--);for(let w=h.length-1;g>0&&h[w]==null;w--)g--;return r.getBoundingBox().addMissingRows(d,g,r.isLeft())}static getMax(r){let o=-1;for(let u of r)o=Math.max(o,u);return o}static getBarcodeMetadata(r,o){let u;if(r==null||(u=r.getBarcodeMetadata())==null)return o==null?null:o.getBarcodeMetadata();let d;return o==null||(d=o.getBarcodeMetadata())==null?u:u.getColumnCount()!==d.getColumnCount()&&u.getErrorCorrectionLevel()!==d.getErrorCorrectionLevel()&&u.getRowCount()!==d.getRowCount()?null:u}static getRowIndicatorColumn(r,o,u,d,h,g){let w=new ul(o,d);for(let S=0;S<2;S++){let T=S===0?1:-1,R=Math.trunc(Math.trunc(u.getX()));for(let D=Math.trunc(Math.trunc(u.getY()));D<=o.getMaxY()&&D>=o.getMinY();D+=T){let B=rt.detectCodeword(r,0,r.getWidth(),d,R,D,h,g);B!=null&&(w.setCodeword(D,B),d?R=B.getStartX():R=B.getEndX())}}return w}static adjustCodewordCount(r,o){let u=o[0][1],d=u.getValue(),h=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-rt.getNumberOfECCodeWords(r.getBarcodeECLevel());if(d.length===0){if(h<1||h>Xe.MAX_CODEWORDS_IN_BARCODE)throw ie.getNotFoundInstance();u.setValue(h)}else d[0]!==h&&u.setValue(h)}static createDecoderResult(r){let o=rt.createBarcodeMatrix(r);rt.adjustCodewordCount(r,o);let u=new Array,d=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),h=[],g=new Array;for(let S=0;S<r.getBarcodeRowCount();S++)for(let T=0;T<r.getBarcodeColumnCount();T++){let R=o[S][T+1].getValue(),D=S*r.getBarcodeColumnCount()+T;R.length===0?u.push(D):R.length===1?d[D]=R[0]:(g.push(D),h.push(R))}let w=new Array(h.length);for(let S=0;S<w.length;S++)w[S]=h[S];return rt.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),d,Xe.toIntArray(u),Xe.toIntArray(g),w)}static createDecoderResultFromAmbiguousValues(r,o,u,d,h){let g=new Int32Array(d.length),w=100;for(;w-- >0;){for(let S=0;S<g.length;S++)o[d[S]]=h[S][g[S]];try{return rt.decodeCodewords(o,r,u)}catch(S){if(!(S instanceof k))throw S}if(g.length===0)throw k.getChecksumInstance();for(let S=0;S<g.length;S++)if(g[S]<h[S].length-1){g[S]++;break}else if(g[S]=0,S===g.length-1)throw k.getChecksumInstance()}throw k.getChecksumInstance()}static createBarcodeMatrix(r){let o=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let d=0;d<o.length;d++)for(let h=0;h<o[d].length;h++)o[d][h]=new ui;let u=0;for(let d of r.getDetectionResultColumns()){if(d!=null){for(let h of d.getCodewords())if(h!=null){let g=h.getRowNumber();if(g>=0){if(g>=o.length)continue;o[g][u].setValue(h.getValue())}}}u++}return o}static isValidBarcodeColumn(r,o){return o>=0&&o<=r.getBarcodeColumnCount()+1}static getStartColumn(r,o,u,d){let h=d?1:-1,g=null;if(rt.isValidBarcodeColumn(r,o-h)&&(g=r.getDetectionResultColumn(o-h).getCodeword(u)),g!=null)return d?g.getEndX():g.getStartX();if(g=r.getDetectionResultColumn(o).getCodewordNearby(u),g!=null)return d?g.getStartX():g.getEndX();if(rt.isValidBarcodeColumn(r,o-h)&&(g=r.getDetectionResultColumn(o-h).getCodewordNearby(u)),g!=null)return d?g.getEndX():g.getStartX();let w=0;for(;rt.isValidBarcodeColumn(r,o-h);){o-=h;for(let S of r.getDetectionResultColumn(o).getCodewords())if(S!=null)return(d?S.getEndX():S.getStartX())+h*w*(S.getEndX()-S.getStartX());w++}return d?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,o,u,d,h,g,w,S){h=rt.adjustCodewordStartColumn(r,o,u,d,h,g);let T=rt.getModuleBitCount(r,o,u,d,h,g);if(T==null)return null;let R,D=dt.sum(T);if(d)R=h+D;else{for(let j=0;j<T.length/2;j++){let Y=T[j];T[j]=T[T.length-1-j],T[T.length-1-j]=Y}R=h,h=R-D}if(!rt.checkCodewordSkew(D,w,S))return null;let B=vn.getDecodedValue(T),H=Xe.getCodeword(B);return H===-1?null:new vi(h,R,rt.getCodewordBucketNumber(B),H)}static getModuleBitCount(r,o,u,d,h,g){let w=h,S=new Int32Array(8),T=0,R=d?1:-1,D=d;for(;(d?w<u:w>=o)&&T<S.length;)r.get(w,g)===D?(S[T]++,w+=R):(T++,D=!D);return T===S.length||w===(d?u:o)&&T===S.length-1?S:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,o,u,d,h,g){let w=h,S=d?-1:1;for(let T=0;T<2;T++){for(;(d?w>=o:w<u)&&d===r.get(w,g);){if(Math.abs(h-w)>rt.CODEWORD_SKEW_SIZE)return h;w+=S}S=-S,d=!d}return w}static checkCodewordSkew(r,o,u){return o-rt.CODEWORD_SKEW_SIZE<=r&&r<=u+rt.CODEWORD_SKEW_SIZE}static decodeCodewords(r,o,u){if(r.length===0)throw ee.getFormatInstance();let d=1<<o+1,h=rt.correctErrors(r,u,d);rt.verifyCodewordCount(r,d);let g=oe.decode(r,""+o);return g.setErrorsCorrected(h),g.setErasures(u.length),g}static correctErrors(r,o,u){if(o!=null&&o.length>u/2+rt.MAX_ERRORS||u<0||u>rt.MAX_EC_CODEWORDS)throw k.getChecksumInstance();return rt.errorCorrection.decode(r,u,o)}static verifyCodewordCount(r,o){if(r.length<4)throw ee.getFormatInstance();let u=r[0];if(u>r.length)throw ee.getFormatInstance();if(u===0)if(o<r.length)r[0]=r.length-o;else throw ee.getFormatInstance()}static getBitCountForCodeword(r){let o=new Int32Array(8),u=0,d=o.length-1;for(;!((r&1)!==u&&(u=r&1,d--,d<0));)o[d]++,r>>=1;return o}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return rt.getCodewordBucketNumber(rt.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let o=new zr;for(let u=0;u<r.length;u++){o.format("Row %2d: ",u);for(let d=0;d<r[u].length;d++){let h=r[u][d];h.getValue().length===0?o.format("        ",null):o.format("%4d(%2d)",h.getValue()[0],h.getConfidence(h.getValue()[0]))}o.format("%n")}return o.toString()}}rt.CODEWORD_SKEW_SIZE=2,rt.MAX_ERRORS=3,rt.MAX_EC_CODEWORDS=512,rt.errorCorrection=new ca;class wn{decode(r,o=null){let u=wn.decode(r,o,!1);if(u==null||u.length===0||u[0]==null)throw ie.getNotFoundInstance();return u[0]}decodeMultiple(r,o=null){try{return wn.decode(r,o,!0)}catch(u){throw u instanceof ee||u instanceof k?ie.getNotFoundInstance():u}}static decode(r,o,u){const d=new Array,h=tt.detectMultiple(r,o,u);for(const g of h.getPoints()){const w=rt.decode(h.getBits(),g[4],g[5],g[6],g[7],wn.getMinCodewordWidth(g),wn.getMaxCodewordWidth(g)),S=new De(w.getText(),w.getRawBytes(),void 0,g,Ce.PDF_417);S.putMetadata(Ze.ERROR_CORRECTION_LEVEL,w.getECLevel());const T=w.getOther();T!=null&&S.putMetadata(Ze.PDF417_EXTRA_METADATA,T),d.push(S)}return d.map(g=>g)}static getMaxWidth(r,o){return r==null||o==null?0:Math.trunc(Math.abs(r.getX()-o.getX()))}static getMinWidth(r,o){return r==null||o==null?G.MAX_VALUE:Math.trunc(Math.abs(r.getX()-o.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(wn.getMaxWidth(r[0],r[4]),wn.getMaxWidth(r[6],r[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.max(wn.getMaxWidth(r[1],r[5]),wn.getMaxWidth(r[7],r[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(wn.getMinWidth(r[0],r[4]),wn.getMinWidth(r[6],r[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.min(wn.getMinWidth(r[1],r[5]),wn.getMinWidth(r[7],r[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))}reset(){}}class Yi extends p{}Yi.kind="ReaderException";class uo{constructor(r,o){this.verbose=r===!0,o&&this.setHints(o)}decode(r,o){return o&&this.setHints(o),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const o=!i(r)&&r.get(ue.TRY_HARDER)===!0,u=i(r)?null:r.get(ue.POSSIBLE_FORMATS),d=new Array;if(!i(u)){const h=u.some(g=>g===Ce.UPC_A||g===Ce.UPC_E||g===Ce.EAN_13||g===Ce.EAN_8||g===Ce.CODABAR||g===Ce.CODE_39||g===Ce.CODE_93||g===Ce.CODE_128||g===Ce.ITF||g===Ce.RSS_14||g===Ce.RSS_EXPANDED);h&&!o&&d.push(new Gi(r,this.verbose)),u.includes(Ce.QR_CODE)&&d.push(new Mn),u.includes(Ce.DATA_MATRIX)&&d.push(new yr),u.includes(Ce.AZTEC)&&d.push(new oi),u.includes(Ce.PDF_417)&&d.push(new wn),h&&o&&d.push(new Gi(r,this.verbose))}d.length===0&&(o||d.push(new Gi(r,this.verbose)),d.push(new Mn),d.push(new yr),d.push(new oi),d.push(new wn),o&&d.push(new Gi(r,this.verbose))),this.readers=d}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new Yi("No readers where selected, nothing can be read.");for(const o of this.readers)try{return o.decode(r,this.hints)}catch(u){if(u instanceof Yi)continue}throw new ie("No MultiFormat Readers were able to detect the code.")}}class Is extends qe{constructor(r=null,o=500){const u=new uo;u.setHints(r),super(u,o)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class co extends qe{constructor(r=500){super(new wn,r)}}class dl extends qe{constructor(r=500){super(new Mn,r)}}var ha;(function(P){P[P.ERROR_CORRECTION=0]="ERROR_CORRECTION",P[P.CHARACTER_SET=1]="CHARACTER_SET",P[P.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",P[P.MIN_SIZE=3]="MIN_SIZE",P[P.MAX_SIZE=4]="MAX_SIZE",P[P.MARGIN=5]="MARGIN",P[P.PDF417_COMPACT=6]="PDF417_COMPACT",P[P.PDF417_COMPACTION=7]="PDF417_COMPACTION",P[P.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",P[P.AZTEC_LAYERS=9]="AZTEC_LAYERS",P[P.QR_VERSION=10]="QR_VERSION"})(ha||(ha={}));var an=ha;class pa{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new gn(r,Int32Array.from([1])))}buildGenerator(r){const o=this.cachedGenerators;if(r>=o.length){let u=o[o.length-1];const d=this.field;for(let h=o.length;h<=r;h++){const g=u.multiply(new gn(d,Int32Array.from([1,d.exp(h-1+d.getGeneratorBase())])));o.push(g),u=g}}return o[r]}encode(r,o){if(o===0)throw new A("No error correction bytes");const u=r.length-o;if(u<=0)throw new A("No data bytes provided");const d=this.buildGenerator(o),h=new Int32Array(u);U.arraycopy(r,0,h,0,u);let g=new gn(this.field,h);g=g.multiplyByMonomial(o,1);const S=g.divide(d)[1].getCoefficients(),T=o-S.length;for(let R=0;R<T;R++)r[u+R]=0;U.arraycopy(S,0,r,u+T,S.length)}}class Ft{constructor(){}static applyMaskPenaltyRule1(r){return Ft.applyMaskPenaltyRule1Internal(r,!0)+Ft.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let o=0;const u=r.getArray(),d=r.getWidth(),h=r.getHeight();for(let g=0;g<h-1;g++){const w=u[g];for(let S=0;S<d-1;S++){const T=w[S];T===w[S+1]&&T===u[g+1][S]&&T===u[g+1][S+1]&&o++}}return Ft.N2*o}static applyMaskPenaltyRule3(r){let o=0;const u=r.getArray(),d=r.getWidth(),h=r.getHeight();for(let g=0;g<h;g++)for(let w=0;w<d;w++){const S=u[g];w+6<d&&S[w]===1&&S[w+1]===0&&S[w+2]===1&&S[w+3]===1&&S[w+4]===1&&S[w+5]===0&&S[w+6]===1&&(Ft.isWhiteHorizontal(S,w-4,w)||Ft.isWhiteHorizontal(S,w+7,w+11))&&o++,g+6<h&&u[g][w]===1&&u[g+1][w]===0&&u[g+2][w]===1&&u[g+3][w]===1&&u[g+4][w]===1&&u[g+5][w]===0&&u[g+6][w]===1&&(Ft.isWhiteVertical(u,w,g-4,g)||Ft.isWhiteVertical(u,w,g+7,g+11))&&o++}return o*Ft.N3}static isWhiteHorizontal(r,o,u){o=Math.max(o,0),u=Math.min(u,r.length);for(let d=o;d<u;d++)if(r[d]===1)return!1;return!0}static isWhiteVertical(r,o,u,d){u=Math.max(u,0),d=Math.min(d,r.length);for(let h=u;h<d;h++)if(r[h][o]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let o=0;const u=r.getArray(),d=r.getWidth(),h=r.getHeight();for(let S=0;S<h;S++){const T=u[S];for(let R=0;R<d;R++)T[R]===1&&o++}const g=r.getHeight()*r.getWidth();return Math.floor(Math.abs(o*2-g)*10/g)*Ft.N4}static getDataMaskBit(r,o,u){let d,h;switch(r){case 0:d=u+o&1;break;case 1:d=u&1;break;case 2:d=o%3;break;case 3:d=(u+o)%3;break;case 4:d=Math.floor(u/2)+Math.floor(o/3)&1;break;case 5:h=u*o,d=(h&1)+h%3;break;case 6:h=u*o,d=(h&1)+h%3&1;break;case 7:h=u*o,d=h%3+(u+o&1)&1;break;default:throw new A("Invalid mask pattern: "+r)}return d===0}static applyMaskPenaltyRule1Internal(r,o){let u=0;const d=o?r.getHeight():r.getWidth(),h=o?r.getWidth():r.getHeight(),g=r.getArray();for(let w=0;w<d;w++){let S=0,T=-1;for(let R=0;R<h;R++){const D=o?g[w][R]:g[R][w];D===T?S++:(S>=5&&(u+=Ft.N1+(S-5)),S=1,T=D)}S>=5&&(u+=Ft.N1+(S-5))}return u}}Ft.N1=3,Ft.N2=3,Ft.N3=40,Ft.N4=10;class fo{constructor(r,o){this.width=r,this.height=o;const u=new Array(o);for(let d=0;d!==o;d++)u[d]=new Uint8Array(r);this.bytes=u}getHeight(){return this.height}getWidth(){return this.width}get(r,o){return this.bytes[o][r]}getArray(){return this.bytes}setNumber(r,o,u){this.bytes[o][r]=u}setBoolean(r,o,u){this.bytes[o][r]=u?1:0}clear(r){for(const o of this.bytes)$.fill(o,r)}equals(r){if(!(r instanceof fo))return!1;const o=r;if(this.width!==o.width||this.height!==o.height)return!1;for(let u=0,d=this.height;u<d;++u){const h=this.bytes[u],g=o.bytes[u];for(let w=0,S=this.width;w<S;++w)if(h[w]!==g[w])return!1}return!0}toString(){const r=new Ne;for(let o=0,u=this.height;o<u;++o){const d=this.bytes[o];for(let h=0,g=this.width;h<g;++h)switch(d[h]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class wi{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new Ne;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<wi.NUM_MASK_PATTERNS}}wi.NUM_MASK_PATTERNS=8;class Rt extends p{}Rt.kind="WriterException";class Ye{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,o,u,d,h){Ye.clearMatrix(h),Ye.embedBasicPatterns(u,h),Ye.embedTypeInfo(o,d,h),Ye.maybeEmbedVersionInfo(u,h),Ye.embedDataBits(r,d,h)}static embedBasicPatterns(r,o){Ye.embedPositionDetectionPatternsAndSeparators(o),Ye.embedDarkDotAtLeftBottomCorner(o),Ye.maybeEmbedPositionAdjustmentPatterns(r,o),Ye.embedTimingPatterns(o)}static embedTypeInfo(r,o,u){const d=new J;Ye.makeTypeInfoBits(r,o,d);for(let h=0,g=d.getSize();h<g;++h){const w=d.get(d.getSize()-1-h),S=Ye.TYPE_INFO_COORDINATES[h],T=S[0],R=S[1];if(u.setBoolean(T,R,w),h<8){const D=u.getWidth()-h-1;u.setBoolean(D,8,w)}else{const B=u.getHeight()-7+(h-8);u.setBoolean(8,B,w)}}}static maybeEmbedVersionInfo(r,o){if(r.getVersionNumber()<7)return;const u=new J;Ye.makeVersionInfoBits(r,u);let d=17;for(let h=0;h<6;++h)for(let g=0;g<3;++g){const w=u.get(d);d--,o.setBoolean(h,o.getHeight()-11+g,w),o.setBoolean(o.getHeight()-11+g,h,w)}}static embedDataBits(r,o,u){let d=0,h=-1,g=u.getWidth()-1,w=u.getHeight()-1;for(;g>0;){for(g===6&&(g-=1);w>=0&&w<u.getHeight();){for(let S=0;S<2;++S){const T=g-S;if(!Ye.isEmpty(u.get(T,w)))continue;let R;d<r.getSize()?(R=r.get(d),++d):R=!1,o!==255&&Ft.getDataMaskBit(o,T,w)&&(R=!R),u.setBoolean(T,w,R)}w+=h}h=-h,w+=h,g-=2}if(d!==r.getSize())throw new Rt("Not all bits consumed: "+d+"/"+r.getSize())}static findMSBSet(r){return 32-G.numberOfLeadingZeros(r)}static calculateBCHCode(r,o){if(o===0)throw new A("0 polynomial");const u=Ye.findMSBSet(o);for(r<<=u-1;Ye.findMSBSet(r)>=u;)r^=o<<Ye.findMSBSet(r)-u;return r}static makeTypeInfoBits(r,o,u){if(!wi.isValidMaskPattern(o))throw new Rt("Invalid mask pattern");const d=r.getBits()<<3|o;u.appendBits(d,5);const h=Ye.calculateBCHCode(d,Ye.TYPE_INFO_POLY);u.appendBits(h,10);const g=new J;if(g.appendBits(Ye.TYPE_INFO_MASK_PATTERN,15),u.xor(g),u.getSize()!==15)throw new Rt("should not happen but we got: "+u.getSize())}static makeVersionInfoBits(r,o){o.appendBits(r.getVersionNumber(),6);const u=Ye.calculateBCHCode(r.getVersionNumber(),Ye.VERSION_INFO_POLY);if(o.appendBits(u,12),o.getSize()!==18)throw new Rt("should not happen but we got: "+o.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let o=8;o<r.getWidth()-8;++o){const u=(o+1)%2;Ye.isEmpty(r.get(o,6))&&r.setNumber(o,6,u),Ye.isEmpty(r.get(6,o))&&r.setNumber(6,o,u)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new Rt;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,o,u){for(let d=0;d<8;++d){if(!Ye.isEmpty(u.get(r+d,o)))throw new Rt;u.setNumber(r+d,o,0)}}static embedVerticalSeparationPattern(r,o,u){for(let d=0;d<7;++d){if(!Ye.isEmpty(u.get(r,o+d)))throw new Rt;u.setNumber(r,o+d,0)}}static embedPositionAdjustmentPattern(r,o,u){for(let d=0;d<5;++d){const h=Ye.POSITION_ADJUSTMENT_PATTERN[d];for(let g=0;g<5;++g)u.setNumber(r+g,o+d,h[g])}}static embedPositionDetectionPattern(r,o,u){for(let d=0;d<7;++d){const h=Ye.POSITION_DETECTION_PATTERN[d];for(let g=0;g<7;++g)u.setNumber(r+g,o+d,h[g])}}static embedPositionDetectionPatternsAndSeparators(r){const o=Ye.POSITION_DETECTION_PATTERN[0].length;Ye.embedPositionDetectionPattern(0,0,r),Ye.embedPositionDetectionPattern(r.getWidth()-o,0,r),Ye.embedPositionDetectionPattern(0,r.getWidth()-o,r);const u=8;Ye.embedHorizontalSeparationPattern(0,u-1,r),Ye.embedHorizontalSeparationPattern(r.getWidth()-u,u-1,r),Ye.embedHorizontalSeparationPattern(0,r.getWidth()-u,r);const d=7;Ye.embedVerticalSeparationPattern(d,0,r),Ye.embedVerticalSeparationPattern(r.getHeight()-d-1,0,r),Ye.embedVerticalSeparationPattern(d,r.getHeight()-d,r)}static maybeEmbedPositionAdjustmentPatterns(r,o){if(r.getVersionNumber()<2)return;const u=r.getVersionNumber()-1,d=Ye.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[u];for(let h=0,g=d.length;h!==g;h++){const w=d[h];if(w>=0)for(let S=0;S!==g;S++){const T=d[S];T>=0&&Ye.isEmpty(o.get(T,w))&&Ye.embedPositionAdjustmentPattern(T-2,w-2,o)}}}}Ye.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ye.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ye.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ye.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ye.VERSION_INFO_POLY=7973,Ye.TYPE_INFO_POLY=1335,Ye.TYPE_INFO_MASK_PATTERN=21522;class dc{constructor(r,o){this.dataBytes=r,this.errorCorrectionBytes=o}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class kt{constructor(){}static calculateMaskPenalty(r){return Ft.applyMaskPenaltyRule1(r)+Ft.applyMaskPenaltyRule2(r)+Ft.applyMaskPenaltyRule3(r)+Ft.applyMaskPenaltyRule4(r)}static encode(r,o,u=null){let d=kt.DEFAULT_BYTE_MODE_ENCODING;const h=u!==null&&u.get(an.CHARACTER_SET)!==void 0;h&&(d=u.get(an.CHARACTER_SET).toString());const g=this.chooseMode(r,d),w=new J;if(g===je.BYTE&&(h||kt.DEFAULT_BYTE_MODE_ENCODING!==d)){const Ee=Z.getCharacterSetECIByName(d);Ee!==void 0&&this.appendECI(Ee,w)}this.appendModeInfo(g,w);const S=new J;this.appendBytes(r,g,S,d);let T;if(u!==null&&u.get(an.QR_VERSION)!==void 0){const Ee=Number.parseInt(u.get(an.QR_VERSION).toString(),10);T=ze.getVersionForNumber(Ee);const he=this.calculateBitsNeeded(g,w,S,T);if(!this.willFit(he,T,o))throw new Rt("Data too big for requested version")}else T=this.recommendVersion(o,g,w,S);const R=new J;R.appendBitArray(w);const D=g===je.BYTE?S.getSizeInBytes():r.length;this.appendLengthInfo(D,T,g,R),R.appendBitArray(S);const B=T.getECBlocksForLevel(o),H=T.getTotalCodewords()-B.getTotalECCodewords();this.terminateBits(H,R);const j=this.interleaveWithECBytes(R,T.getTotalCodewords(),H,B.getNumBlocks()),Y=new wi;Y.setECLevel(o),Y.setMode(g),Y.setVersion(T);const Q=T.getDimensionForVersion(),se=new fo(Q,Q),xe=this.chooseMaskPattern(j,o,T,se);return Y.setMaskPattern(xe),Ye.buildMatrix(j,o,T,xe,se),Y.setMatrix(se),Y}static recommendVersion(r,o,u,d){const h=this.calculateBitsNeeded(o,u,d,ze.getVersionForNumber(1)),g=this.chooseVersion(h,r),w=this.calculateBitsNeeded(o,u,d,g);return this.chooseVersion(w,r)}static calculateBitsNeeded(r,o,u,d){return o.getSize()+r.getCharacterCountBits(d)+u.getSize()}static getAlphanumericCode(r){return r<kt.ALPHANUMERIC_TABLE.length?kt.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,o=null){if(Z.SJIS.getName()===o&&this.isOnlyDoubleByteKanji(r))return je.KANJI;let u=!1,d=!1;for(let h=0,g=r.length;h<g;++h){const w=r.charAt(h);if(kt.isDigit(w))u=!0;else if(this.getAlphanumericCode(w.charCodeAt(0))!==-1)d=!0;else return je.BYTE}return d?je.ALPHANUMERIC:u?je.NUMERIC:je.BYTE}static isOnlyDoubleByteKanji(r){let o;try{o=Pe.encode(r,Z.SJIS)}catch{return!1}const u=o.length;if(u%2!==0)return!1;for(let d=0;d<u;d+=2){const h=o[d]&255;if((h<129||h>159)&&(h<224||h>235))return!1}return!0}static chooseMaskPattern(r,o,u,d){let h=Number.MAX_SAFE_INTEGER,g=-1;for(let w=0;w<wi.NUM_MASK_PATTERNS;w++){Ye.buildMatrix(r,o,u,w,d);let S=this.calculateMaskPenalty(d);S<h&&(h=S,g=w)}return g}static chooseVersion(r,o){for(let u=1;u<=40;u++){const d=ze.getVersionForNumber(u);if(kt.willFit(r,d,o))return d}throw new Rt("Data too big")}static willFit(r,o,u){const d=o.getTotalCodewords(),g=o.getECBlocksForLevel(u).getTotalECCodewords(),w=d-g,S=(r+7)/8;return w>=S}static terminateBits(r,o){const u=r*8;if(o.getSize()>u)throw new Rt("data bits cannot fit in the QR Code"+o.getSize()+" > "+u);for(let g=0;g<4&&o.getSize()<u;++g)o.appendBit(!1);const d=o.getSize()&7;if(d>0)for(let g=d;g<8;g++)o.appendBit(!1);const h=r-o.getSizeInBytes();for(let g=0;g<h;++g)o.appendBits((g&1)===0?236:17,8);if(o.getSize()!==u)throw new Rt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,o,u,d,h,g){if(d>=u)throw new Rt("Block ID too large");const w=r%u,S=u-w,T=Math.floor(r/u),R=T+1,D=Math.floor(o/u),B=D+1,H=T-D,j=R-B;if(H!==j)throw new Rt("EC bytes mismatch");if(u!==S+w)throw new Rt("RS blocks mismatch");if(r!==(D+H)*S+(B+j)*w)throw new Rt("Total bytes mismatch");d<S?(h[0]=D,g[0]=H):(h[0]=B,g[0]=j)}static interleaveWithECBytes(r,o,u,d){if(r.getSizeInBytes()!==u)throw new Rt("Number of bits and data bytes does not match");let h=0,g=0,w=0;const S=new Array;for(let R=0;R<d;++R){const D=new Int32Array(1),B=new Int32Array(1);kt.getNumDataBytesAndNumECBytesForBlockID(o,u,d,R,D,B);const H=D[0],j=new Uint8Array(H);r.toBytes(8*h,j,0,H);const Y=kt.generateECBytes(j,B[0]);S.push(new dc(j,Y)),g=Math.max(g,H),w=Math.max(w,Y.length),h+=D[0]}if(u!==h)throw new Rt("Data bytes does not match offset");const T=new J;for(let R=0;R<g;++R)for(const D of S){const B=D.getDataBytes();R<B.length&&T.appendBits(B[R],8)}for(let R=0;R<w;++R)for(const D of S){const B=D.getErrorCorrectionBytes();R<B.length&&T.appendBits(B[R],8)}if(o!==T.getSizeInBytes())throw new Rt("Interleaving error: "+o+" and "+T.getSizeInBytes()+" differ.");return T}static generateECBytes(r,o){const u=r.length,d=new Int32Array(u+o);for(let g=0;g<u;g++)d[g]=r[g]&255;new pa(pt.QR_CODE_FIELD_256).encode(d,o);const h=new Uint8Array(o);for(let g=0;g<o;g++)h[g]=d[u+g];return h}static appendModeInfo(r,o){o.appendBits(r.getBits(),4)}static appendLengthInfo(r,o,u,d){const h=u.getCharacterCountBits(o);if(r>=1<<h)throw new Rt(r+" is bigger than "+((1<<h)-1));d.appendBits(r,h)}static appendBytes(r,o,u,d){switch(o){case je.NUMERIC:kt.appendNumericBytes(r,u);break;case je.ALPHANUMERIC:kt.appendAlphanumericBytes(r,u);break;case je.BYTE:kt.append8BitBytes(r,u,d);break;case je.KANJI:kt.appendKanjiBytes(r,u);break;default:throw new Rt("Invalid mode: "+o)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const o=kt.getDigit(r);return o>=0&&o<=9}static appendNumericBytes(r,o){const u=r.length;let d=0;for(;d<u;){const h=kt.getDigit(r.charAt(d));if(d+2<u){const g=kt.getDigit(r.charAt(d+1)),w=kt.getDigit(r.charAt(d+2));o.appendBits(h*100+g*10+w,10),d+=3}else if(d+1<u){const g=kt.getDigit(r.charAt(d+1));o.appendBits(h*10+g,7),d+=2}else o.appendBits(h,4),d++}}static appendAlphanumericBytes(r,o){const u=r.length;let d=0;for(;d<u;){const h=kt.getAlphanumericCode(r.charCodeAt(d));if(h===-1)throw new Rt;if(d+1<u){const g=kt.getAlphanumericCode(r.charCodeAt(d+1));if(g===-1)throw new Rt;o.appendBits(h*45+g,11),d+=2}else o.appendBits(h,6),d++}}static append8BitBytes(r,o,u){let d;try{d=Pe.encode(r,u)}catch(h){throw new Rt(h)}for(let h=0,g=d.length;h!==g;h++){const w=d[h];o.appendBits(w,8)}}static appendKanjiBytes(r,o){let u;try{u=Pe.encode(r,Z.SJIS)}catch(h){throw new Rt(h)}const d=u.length;for(let h=0;h<d;h+=2){const g=u[h]&255,w=u[h+1]&255,S=g<<8&4294967295|w;let T=-1;if(S>=33088&&S<=40956?T=S-33088:S>=57408&&S<=60351&&(T=S-49472),T===-1)throw new Rt("Invalid byte sequence");const R=(T>>8)*192+(T&255);o.appendBits(R,13)}}static appendECI(r,o){o.appendBits(je.ECI.getBits(),4),o.appendBits(r.getValue(),8)}}kt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),kt.DEFAULT_BYTE_MODE_ENCODING=Z.UTF8.getName();class Ei{write(r,o,u,d=null){if(r.length===0)throw new A("Found empty contents");if(o<0||u<0)throw new A("Requested dimensions are too small: "+o+"x"+u);let h=It.L,g=Ei.QUIET_ZONE_SIZE;d!==null&&(d.get(an.ERROR_CORRECTION)!==void 0&&(h=It.fromString(d.get(an.ERROR_CORRECTION).toString())),d.get(an.MARGIN)!==void 0&&(g=Number.parseInt(d.get(an.MARGIN).toString(),10)));const w=kt.encode(r,h,d);return this.renderResult(w,o,u,g)}writeToDom(r,o,u,d,h=null){typeof r=="string"&&(r=document.querySelector(r));const g=this.write(o,u,d,h);r&&r.appendChild(g)}renderResult(r,o,u,d){const h=r.getMatrix();if(h===null)throw new fr;const g=h.getWidth(),w=h.getHeight(),S=g+d*2,T=w+d*2,R=Math.max(o,S),D=Math.max(u,T),B=Math.min(Math.floor(R/S),Math.floor(D/T)),H=Math.floor((R-g*B)/2),j=Math.floor((D-w*B)/2),Y=this.createSVGElement(R,D);for(let Q=0,se=j;Q<w;Q++,se+=B)for(let xe=0,Ee=H;xe<g;xe++,Ee+=B)if(h.get(xe,Q)===1){const he=this.createSvgRectElement(Ee,se,B,B);Y.appendChild(he)}return Y}createSVGElement(r,o){const u=document.createElementNS(Ei.SVG_NS,"svg");return u.setAttributeNS(null,"height",r.toString()),u.setAttributeNS(null,"width",o.toString()),u}createSvgRectElement(r,o,u,d){const h=document.createElementNS(Ei.SVG_NS,"rect");return h.setAttributeNS(null,"x",r.toString()),h.setAttributeNS(null,"y",o.toString()),h.setAttributeNS(null,"height",u.toString()),h.setAttributeNS(null,"width",d.toString()),h.setAttributeNS(null,"fill","#000000"),h}}Ei.QUIET_ZONE_SIZE=4,Ei.SVG_NS="http://www.w3.org/2000/svg";class $i{encode(r,o,u,d,h){if(r.length===0)throw new A("Found empty contents");if(o!==Ce.QR_CODE)throw new A("Can only encode QR_CODE, but got "+o);if(u<0||d<0)throw new A(`Requested dimensions are too small: ${u}x${d}`);let g=It.L,w=$i.QUIET_ZONE_SIZE;h!==null&&(h.get(an.ERROR_CORRECTION)!==void 0&&(g=It.fromString(h.get(an.ERROR_CORRECTION).toString())),h.get(an.MARGIN)!==void 0&&(w=Number.parseInt(h.get(an.MARGIN).toString(),10)));const S=kt.encode(r,g,h);return $i.renderResult(S,u,d,w)}static renderResult(r,o,u,d){const h=r.getMatrix();if(h===null)throw new fr;const g=h.getWidth(),w=h.getHeight(),S=g+d*2,T=w+d*2,R=Math.max(o,S),D=Math.max(u,T),B=Math.min(Math.floor(R/S),Math.floor(D/T)),H=Math.floor((R-g*B)/2),j=Math.floor((D-w*B)/2),Y=new We(R,D);for(let Q=0,se=j;Q<w;Q++,se+=B)for(let xe=0,Ee=H;xe<g;xe++,Ee+=B)h.get(xe,Q)===1&&Y.setRegion(Ee,se,B,B);return Y}}$i.QUIET_ZONE_SIZE=4;class fc{encode(r,o,u,d,h){let g;switch(o){case Ce.QR_CODE:g=new $i;break;default:throw new A("No encoder available for format "+o)}return g.encode(r,o,u,d,h)}}class Pr extends pe{constructor(r,o,u,d,h,g,w,S){if(super(g,w),this.yuvData=r,this.dataWidth=o,this.dataHeight=u,this.left=d,this.top=h,d+g>o||h+w>u)throw new A("Crop rectangle does not fit within image data.");S&&this.reverseHorizontal(g,w)}getRow(r,o){if(r<0||r>=this.getHeight())throw new A("Requested row is outside the image: "+r);const u=this.getWidth();(o==null||o.length<u)&&(o=new Uint8ClampedArray(u));const d=(r+this.top)*this.dataWidth+this.left;return U.arraycopy(this.yuvData,d,o,0,u),o}getMatrix(){const r=this.getWidth(),o=this.getHeight();if(r===this.dataWidth&&o===this.dataHeight)return this.yuvData;const u=r*o,d=new Uint8ClampedArray(u);let h=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return U.arraycopy(this.yuvData,h,d,0,u),d;for(let g=0;g<o;g++){const w=g*r;U.arraycopy(this.yuvData,h,d,w,r),h+=this.dataWidth}return d}isCropSupported(){return!0}crop(r,o,u,d){return new Pr(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+o,u,d,!1)}renderThumbnail(){const r=this.getWidth()/Pr.THUMBNAIL_SCALE_FACTOR,o=this.getHeight()/Pr.THUMBNAIL_SCALE_FACTOR,u=new Int32Array(r*o),d=this.yuvData;let h=this.top*this.dataWidth+this.left;for(let g=0;g<o;g++){const w=g*r;for(let S=0;S<r;S++){const T=d[h+S*Pr.THUMBNAIL_SCALE_FACTOR]&255;u[w+S]=4278190080|T*65793}h+=this.dataWidth*Pr.THUMBNAIL_SCALE_FACTOR}return u}getThumbnailWidth(){return this.getWidth()/Pr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Pr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,o){const u=this.yuvData;for(let d=0,h=this.top*this.dataWidth+this.left;d<o;d++,h+=this.dataWidth){const g=h+r/2;for(let w=h,S=h+r-1;w<g;w++,S--){const T=u[w];u[w]=u[S],u[S]=T}}}invert(){return new be(this)}}Pr.THUMBNAIL_SCALE_FACTOR=2;class bs extends pe{constructor(r,o,u,d,h,g,w){if(super(o,u),this.dataWidth=d,this.dataHeight=h,this.left=g,this.top=w,r.BYTES_PER_ELEMENT===4){const S=o*u,T=new Uint8ClampedArray(S);for(let R=0;R<S;R++){const D=r[R],B=D>>16&255,H=D>>7&510,j=D&255;T[R]=(B+H+j)/4&255}this.luminances=T}else this.luminances=r;if(d===void 0&&(this.dataWidth=o),h===void 0&&(this.dataHeight=u),g===void 0&&(this.left=0),w===void 0&&(this.top=0),this.left+o>this.dataWidth||this.top+u>this.dataHeight)throw new A("Crop rectangle does not fit within image data.")}getRow(r,o){if(r<0||r>=this.getHeight())throw new A("Requested row is outside the image: "+r);const u=this.getWidth();(o==null||o.length<u)&&(o=new Uint8ClampedArray(u));const d=(r+this.top)*this.dataWidth+this.left;return U.arraycopy(this.luminances,d,o,0,u),o}getMatrix(){const r=this.getWidth(),o=this.getHeight();if(r===this.dataWidth&&o===this.dataHeight)return this.luminances;const u=r*o,d=new Uint8ClampedArray(u);let h=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return U.arraycopy(this.luminances,h,d,0,u),d;for(let g=0;g<o;g++){const w=g*r;U.arraycopy(this.luminances,h,d,w,r),h+=this.dataWidth}return d}isCropSupported(){return!0}crop(r,o,u,d){return new bs(this.luminances,u,d,this.dataWidth,this.dataHeight,this.left+r,this.top+o)}invert(){return new be(this)}}class fl extends Z{static forName(r){return this.getCharacterSetECIByName(r)}}class ga{}ga.ISO_8859_1=Z.ISO8859_1;class hl{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class ma{static singletonList(r){return[r]}static min(r,o){return r.sort(o)[0]}}class hc{constructor(r){this.previous=r}getPrevious(){return this.previous}}class Ki extends hc{constructor(r,o,u){super(r),this.value=o,this.bitCount=u}appendTo(r,o){r.appendBits(this.value,this.bitCount)}add(r,o){return new Ki(this,r,o)}addBinaryShift(r,o){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Ki(this,r,o)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+G.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class ya extends Ki{constructor(r,o,u){super(r,0,0),this.binaryShiftStart=o,this.binaryShiftByteCount=u}appendTo(r,o){for(let u=0;u<this.binaryShiftByteCount;u++)(u===0||u===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):u===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(o[this.binaryShiftStart+u],8)}addBinaryShift(r,o){return new ya(this,r,o)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function pc(P,r,o){return new ya(P,r,o)}function Ns(P,r,o){return new Ki(P,r,o)}const gc=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],ci=0,Xi=1,An=2,pl=3,vr=4,gl=new Ki(null,0,0),ho=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function ml(P){for(let r of P)$.fill(r,-1);return P[ci][vr]=0,P[Xi][vr]=0,P[Xi][ci]=28,P[pl][vr]=0,P[An][vr]=0,P[An][ci]=15,P}const xa=ml($.createInt32Array(6,6));class kn{constructor(r,o,u,d){this.token=r,this.mode=o,this.binaryShiftByteCount=u,this.bitCount=d}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,o){let u=this.bitCount,d=this.token;if(r!==this.mode){let g=ho[this.mode][r];d=Ns(d,g&65535,g>>16),u+=g>>16}let h=r===An?4:5;return d=Ns(d,o,h),new kn(d,r,0,u+h)}shiftAndAppend(r,o){let u=this.token,d=this.mode===An?4:5;return u=Ns(u,xa[this.mode][r],d),u=Ns(u,o,5),new kn(u,this.mode,0,this.bitCount+d+5)}addBinaryShiftChar(r){let o=this.token,u=this.mode,d=this.bitCount;if(this.mode===vr||this.mode===An){let w=ho[u][ci];o=Ns(o,w&65535,w>>16),d+=w>>16,u=ci}let h=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,g=new kn(o,u,this.binaryShiftByteCount+1,d+h);return g.binaryShiftByteCount===2078&&(g=g.endBinaryShift(r+1)),g}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let o=this.token;return o=pc(o,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new kn(o,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let o=this.bitCount+(ho[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?o+=kn.calculateBinaryShiftCost(r)-kn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(o+=10),o<=r.bitCount}toBitArray(r){let o=[];for(let d=this.endBinaryShift(r.length).token;d!==null;d=d.getPrevious())o.unshift(d);let u=new J;for(const d of o)d.appendTo(u,r);return u}toString(){return Ie.format("%s bits=%d bytes=%d",gc[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}kn.INITIAL_STATE=new kn(gl,ci,0,0);function mc(P){const r=Ie.getCharCode(" "),o=Ie.getCharCode("."),u=Ie.getCharCode(",");P[ci][r]=1;const d=Ie.getCharCode("Z"),h=Ie.getCharCode("A");for(let B=h;B<=d;B++)P[ci][B]=B-h+2;P[Xi][r]=1;const g=Ie.getCharCode("z"),w=Ie.getCharCode("a");for(let B=w;B<=g;B++)P[Xi][B]=B-w+2;P[An][r]=1;const S=Ie.getCharCode("9"),T=Ie.getCharCode("0");for(let B=T;B<=S;B++)P[An][B]=B-T+2;P[An][u]=12,P[An][o]=13;const R=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let B=0;B<R.length;B++)P[pl][Ie.getCharCode(R[B])]=B;const D=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let B=0;B<D.length;B++)Ie.getCharCode(D[B])>0&&(P[vr][Ie.getCharCode(D[B])]=B);return P}const va=mc($.createInt32Array(5,256));class Rs{constructor(r){this.text=r}encode(){const r=Ie.getCharCode(" "),o=Ie.getCharCode(`
`);let u=ma.singletonList(kn.INITIAL_STATE);for(let h=0;h<this.text.length;h++){let g,w=h+1<this.text.length?this.text[h+1]:0;switch(this.text[h]){case Ie.getCharCode("\r"):g=w===o?2:0;break;case Ie.getCharCode("."):g=w===r?3:0;break;case Ie.getCharCode(","):g=w===r?4:0;break;case Ie.getCharCode(":"):g=w===r?5:0;break;default:g=0}g>0?(u=Rs.updateStateListForPair(u,h,g),h++):u=this.updateStateListForChar(u,h)}return ma.min(u,(h,g)=>h.getBitCount()-g.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,o){const u=[];for(let d of r)this.updateStateForChar(d,o,u);return Rs.simplifyStates(u)}updateStateForChar(r,o,u){let d=this.text[o]&255,h=va[r.getMode()][d]>0,g=null;for(let w=0;w<=vr;w++){let S=va[w][d];if(S>0){if(g==null&&(g=r.endBinaryShift(o)),!h||w===r.getMode()||w===An){const T=g.latchAndAppend(w,S);u.push(T)}if(!h&&xa[r.getMode()][w]>=0){const T=g.shiftAndAppend(w,S);u.push(T)}}}if(r.getBinaryShiftByteCount()>0||va[r.getMode()][d]===0){let w=r.addBinaryShiftChar(o);u.push(w)}}static updateStateListForPair(r,o,u){const d=[];for(let h of r)this.updateStateForPair(h,o,u,d);return this.simplifyStates(d)}static updateStateForPair(r,o,u,d){let h=r.endBinaryShift(o);if(d.push(h.latchAndAppend(vr,u)),r.getMode()!==vr&&d.push(h.shiftAndAppend(vr,u)),u===3||u===4){let g=h.latchAndAppend(An,16-u).latchAndAppend(An,1);d.push(g)}if(r.getBinaryShiftByteCount()>0){let g=r.addBinaryShiftChar(o).addBinaryShiftChar(o+1);d.push(g)}}static simplifyStates(r){let o=[];for(const u of r){let d=!0;for(const h of o){if(h.isBetterThanOrEqualTo(u)){d=!1;break}u.isBetterThanOrEqualTo(h)&&(o=o.filter(g=>g!==h))}d&&o.push(u)}return o}}class gt{constructor(){}static encodeBytes(r){return gt.encode(r,gt.DEFAULT_EC_PERCENT,gt.DEFAULT_AZTEC_LAYERS)}static encode(r,o,u){let d=new Rs(r).encode(),h=G.truncDivision(d.getSize()*o,100)+11,g=d.getSize()+h,w,S,T,R,D;if(u!==gt.DEFAULT_AZTEC_LAYERS){if(w=u<0,S=Math.abs(u),S>(w?gt.MAX_NB_BITS_COMPACT:gt.MAX_NB_BITS))throw new A(Ie.format("Illegal value %s for layers",u));T=gt.totalBitsInLayer(S,w),R=gt.WORD_SIZE[S];let he=T-T%R;if(D=gt.stuffBits(d,R),D.getSize()+h>he)throw new A("Data to large for user specified layer");if(w&&D.getSize()>R*64)throw new A("Data to large for user specified layer")}else{R=0,D=null;for(let he=0;;he++){if(he>gt.MAX_NB_BITS)throw new A("Data too large for an Aztec code");if(w=he<=3,S=w?he+1:he,T=gt.totalBitsInLayer(S,w),g>T)continue;(D==null||R!==gt.WORD_SIZE[S])&&(R=gt.WORD_SIZE[S],D=gt.stuffBits(d,R));let lt=T-T%R;if(!(w&&D.getSize()>R*64)&&D.getSize()+h<=lt)break}}let B=gt.generateCheckWords(D,T,R),H=D.getSize()/R,j=gt.generateModeMessage(w,S,H),Y=(w?11:14)+S*4,Q=new Int32Array(Y),se;if(w){se=Y;for(let he=0;he<Q.length;he++)Q[he]=he}else{se=Y+1+2*G.truncDivision(G.truncDivision(Y,2)-1,15);let he=G.truncDivision(Y,2),lt=G.truncDivision(se,2);for(let nt=0;nt<he;nt++){let Hn=nt+G.truncDivision(nt,15);Q[he-nt-1]=lt-Hn-1,Q[he+nt]=lt+Hn+1}}let xe=new We(se);for(let he=0,lt=0;he<S;he++){let nt=(S-he)*4+(w?9:12);for(let Hn=0;Hn<nt;Hn++){let wr=Hn*2;for(let ln=0;ln<2;ln++)B.get(lt+wr+ln)&&xe.set(Q[he*2+ln],Q[he*2+Hn]),B.get(lt+nt*2+wr+ln)&&xe.set(Q[he*2+Hn],Q[Y-1-he*2-ln]),B.get(lt+nt*4+wr+ln)&&xe.set(Q[Y-1-he*2-ln],Q[Y-1-he*2-Hn]),B.get(lt+nt*6+wr+ln)&&xe.set(Q[Y-1-he*2-Hn],Q[he*2+ln])}lt+=nt*8}if(gt.drawModeMessage(xe,w,se,j),w)gt.drawBullsEye(xe,G.truncDivision(se,2),5);else{gt.drawBullsEye(xe,G.truncDivision(se,2),7);for(let he=0,lt=0;he<G.truncDivision(Y,2)-1;he+=15,lt+=16)for(let nt=G.truncDivision(se,2)&1;nt<se;nt+=2)xe.set(G.truncDivision(se,2)-lt,nt),xe.set(G.truncDivision(se,2)+lt,nt),xe.set(nt,G.truncDivision(se,2)-lt),xe.set(nt,G.truncDivision(se,2)+lt)}let Ee=new hl;return Ee.setCompact(w),Ee.setSize(se),Ee.setLayers(S),Ee.setCodeWords(H),Ee.setMatrix(xe),Ee}static drawBullsEye(r,o,u){for(let d=0;d<u;d+=2)for(let h=o-d;h<=o+d;h++)r.set(h,o-d),r.set(h,o+d),r.set(o-d,h),r.set(o+d,h);r.set(o-u,o-u),r.set(o-u+1,o-u),r.set(o-u,o-u+1),r.set(o+u,o-u),r.set(o+u,o-u+1),r.set(o+u,o+u-1)}static generateModeMessage(r,o,u){let d=new J;return r?(d.appendBits(o-1,2),d.appendBits(u-1,6),d=gt.generateCheckWords(d,28,4)):(d.appendBits(o-1,5),d.appendBits(u-1,11),d=gt.generateCheckWords(d,40,4)),d}static drawModeMessage(r,o,u,d){let h=G.truncDivision(u,2);if(o)for(let g=0;g<7;g++){let w=h-3+g;d.get(g)&&r.set(w,h-5),d.get(g+7)&&r.set(h+5,w),d.get(20-g)&&r.set(w,h+5),d.get(27-g)&&r.set(h-5,w)}else for(let g=0;g<10;g++){let w=h-5+g+G.truncDivision(g,5);d.get(g)&&r.set(w,h-7),d.get(g+10)&&r.set(h+7,w),d.get(29-g)&&r.set(w,h+7),d.get(39-g)&&r.set(h-7,w)}}static generateCheckWords(r,o,u){let d=r.getSize()/u,h=new pa(gt.getGF(u)),g=G.truncDivision(o,u),w=gt.bitsToWords(r,u,g);h.encode(w,g-d);let S=o%u,T=new J;T.appendBits(0,S);for(const R of Array.from(w))T.appendBits(R,u);return T}static bitsToWords(r,o,u){let d=new Int32Array(u),h,g;for(h=0,g=r.getSize()/o;h<g;h++){let w=0;for(let S=0;S<o;S++)w|=r.get(h*o+S)?1<<o-S-1:0;d[h]=w}return d}static getGF(r){switch(r){case 4:return pt.AZTEC_PARAM;case 6:return pt.AZTEC_DATA_6;case 8:return pt.AZTEC_DATA_8;case 10:return pt.AZTEC_DATA_10;case 12:return pt.AZTEC_DATA_12;default:throw new A("Unsupported word size "+r)}}static stuffBits(r,o){let u=new J,d=r.getSize(),h=(1<<o)-2;for(let g=0;g<d;g+=o){let w=0;for(let S=0;S<o;S++)(g+S>=d||r.get(g+S))&&(w|=1<<o-1-S);(w&h)===h?(u.appendBits(w&h,o),g--):(w&h)===0?(u.appendBits(w|1,o),g--):u.appendBits(w,o)}return u}static totalBitsInLayer(r,o){return((o?88:112)+16*r)*r}}gt.DEFAULT_EC_PERCENT=33,gt.DEFAULT_AZTEC_LAYERS=0,gt.MAX_NB_BITS=32,gt.MAX_NB_BITS_COMPACT=4,gt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ms{encode(r,o,u,d){return this.encodeWithHints(r,o,u,d,null)}encodeWithHints(r,o,u,d,h){let g=ga.ISO_8859_1,w=gt.DEFAULT_EC_PERCENT,S=gt.DEFAULT_AZTEC_LAYERS;return h!=null&&(h.has(an.CHARACTER_SET)&&(g=fl.forName(h.get(an.CHARACTER_SET).toString())),h.has(an.ERROR_CORRECTION)&&(w=G.parseInt(h.get(an.ERROR_CORRECTION).toString())),h.has(an.AZTEC_LAYERS)&&(S=G.parseInt(h.get(an.AZTEC_LAYERS).toString()))),Ms.encodeLayers(r,o,u,d,g,w,S)}static encodeLayers(r,o,u,d,h,g,w){if(o!==Ce.AZTEC)throw new A("Can only encode AZTEC, but got "+o);let S=gt.encode(Ie.getBytes(r,h),g,w);return Ms.renderResult(S,u,d)}static renderResult(r,o,u){let d=r.getMatrix();if(d==null)throw new fr;let h=d.getWidth(),g=d.getHeight(),w=Math.max(o,h),S=Math.max(u,g),T=Math.min(w/h,S/g),R=(w-h*T)/2,D=(S-g*T)/2,B=new We(w,S);for(let H=0,j=D;H<g;H++,j+=T)for(let Y=0,Q=R;Y<h;Y++,Q+=T)d.get(Y,H)&&B.setRegion(Q,j,T,T);return B}}t.AbstractExpandedDecoder=ia,t.ArgumentException=_,t.ArithmeticException=xs,t.AztecCode=hl,t.AztecCodeReader=oi,t.AztecCodeWriter=Ms,t.AztecDecoder=Nt,t.AztecDetector=Vi,t.AztecDetectorResult=Zo,t.AztecEncoder=gt,t.AztecHighLevelEncoder=Rs,t.AztecPoint=Cn,t.BarcodeFormat=Ce,t.Binarizer=O,t.BinaryBitmap=b,t.BitArray=J,t.BitMatrix=We,t.BitSource=aa,t.BrowserAztecCodeReader=uc,t.BrowserBarcodeReader=sl,t.BrowserCodeReader=qe,t.BrowserDatamatrixCodeReader=cc,t.BrowserMultiFormatReader=Is,t.BrowserPDF417Reader=co,t.BrowserQRCodeReader=dl,t.BrowserQRCodeSvgWriter=Ei,t.CharacterSetECI=Z,t.ChecksumException=k,t.Code128Reader=Ae,t.Code39Reader=sn,t.DataMatrixDecodedBitStreamParser=mr,t.DataMatrixReader=yr,t.DecodeHintType=ue,t.DecoderResult=At,t.DefaultGridSampler=no,t.DetectorResult=Ui,t.EAN13Reader=tr,t.EncodeHintType=an,t.Exception=p,t.FormatException=ee,t.GenericGF=pt,t.GenericGFPoly=gn,t.GlobalHistogramBinarizer=ve,t.GridSampler=to,t.GridSamplerInstance=hr,t.HTMLCanvasElementLuminanceSource=we,t.HybridBinarizer=me,t.ITFReader=_t,t.IllegalArgumentException=A,t.IllegalStateException=fr,t.InvertedLuminanceSource=be,t.LuminanceSource=pe,t.MathUtils=dt,t.MultiFormatOneDReader=Gi,t.MultiFormatReader=uo,t.MultiFormatWriter=fc,t.NotFoundException=ie,t.OneDReader=Yt,t.PDF417DecodedBitStreamParser=oe,t.PDF417DecoderErrorCorrection=ca,t.PDF417Reader=wn,t.PDF417ResultMetadata=ao,t.PerspectiveTransform=er,t.PlanarYUVLuminanceSource=Pr,t.QRCodeByteMatrix=fo,t.QRCodeDataMask=ot,t.QRCodeDecodedBitStreamParser=Bt,t.QRCodeDecoderErrorCorrectionLevel=It,t.QRCodeDecoderFormatInformation=yn,t.QRCodeEncoder=kt,t.QRCodeEncoderQRCode=wi,t.QRCodeMaskUtil=Ft,t.QRCodeMatrixUtil=Ye,t.QRCodeMode=je,t.QRCodeReader=Mn,t.QRCodeVersion=ze,t.QRCodeWriter=$i,t.RGBLuminanceSource=bs,t.RSS14Reader=Pt,t.RSSExpandedReader=ce,t.ReaderException=Yi,t.ReedSolomonDecoder=Fi,t.ReedSolomonEncoder=pa,t.ReedSolomonException=ii,t.Result=De,t.ResultMetadataType=Ze,t.ResultPoint=Oe,t.StringUtils=Ie,t.UnsupportedOperationException=Se,t.VideoInputDevice=X,t.WhiteRectangleDetector=br,t.WriterException=Rt,t.ZXingArrays=$,t.ZXingCharset=fl,t.ZXingInteger=G,t.ZXingStandardCharsets=ga,t.ZXingStringBuilder=Ne,t.ZXingStringEncoding=Pe,t.ZXingSystem=U,t.createAbstractExpandedDecoder=rl,Object.defineProperty(t,"__esModule",{value:!0})}))})(Ka,Ka.exports)),Ka.exports}var zt=Lb();const Bb=Ku(zt),Fb=kg({__proto__:null,default:Bb},[zt]);var Eg=(function(){function n(e,t,i){if(this.formatMap=new Map([[Le.QR_CODE,zt.BarcodeFormat.QR_CODE],[Le.AZTEC,zt.BarcodeFormat.AZTEC],[Le.CODABAR,zt.BarcodeFormat.CODABAR],[Le.CODE_39,zt.BarcodeFormat.CODE_39],[Le.CODE_93,zt.BarcodeFormat.CODE_93],[Le.CODE_128,zt.BarcodeFormat.CODE_128],[Le.DATA_MATRIX,zt.BarcodeFormat.DATA_MATRIX],[Le.MAXICODE,zt.BarcodeFormat.MAXICODE],[Le.ITF,zt.BarcodeFormat.ITF],[Le.EAN_13,zt.BarcodeFormat.EAN_13],[Le.EAN_8,zt.BarcodeFormat.EAN_8],[Le.PDF_417,zt.BarcodeFormat.PDF_417],[Le.RSS_14,zt.BarcodeFormat.RSS_14],[Le.RSS_EXPANDED,zt.BarcodeFormat.RSS_EXPANDED],[Le.UPC_A,zt.BarcodeFormat.UPC_A],[Le.UPC_E,zt.BarcodeFormat.UPC_E],[Le.UPC_EAN_EXTENSION,zt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Fb)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=i;var a=this.createZXingFormats(e),l=new Map;l.set(zt.DecodeHintType.POSSIBLE_FORMATS,a),l.set(zt.DecodeHintType.TRY_HARDER,!1),this.hints=l}return n.prototype.decodeAsync=function(e){var t=this;return new Promise(function(i,a){try{i(t.decode(e))}catch(l){a(l)}})},n.prototype.decode=function(e){var t=new zt.MultiFormatReader(this.verbose,this.hints),i=new zt.HTMLCanvasElementLuminanceSource(e),a=new zt.BinaryBitmap(new zt.HybridBinarizer(i)),l=t.decode(a);return{text:l.text,format:lx.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,a){e.set(t,i)}),e},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createZXingFormats=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var l=a[i];this.formatMap.has(l)?t.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return t},n.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},n})(),Ub=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},Vb=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},_g=(function(){function n(e,t,i){if(this.formatMap=new Map([[Le.QR_CODE,"qr_code"],[Le.AZTEC,"aztec"],[Le.CODABAR,"codabar"],[Le.CODE_39,"code_39"],[Le.CODE_93,"code_93"],[Le.CODE_128,"code_128"],[Le.DATA_MATRIX,"data_matrix"],[Le.ITF,"itf"],[Le.EAN_13,"ean_13"],[Le.EAN_8,"ean_8"],[Le.PDF_417,"pdf417"],[Le.UPC_A,"upc_a"],[Le.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!n.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=i;var a=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return n.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},n.prototype.decodeAsync=function(e){return Ub(this,void 0,void 0,function(){var t,i;return Vb(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=a.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(t),[2,{text:i.rawValue,format:lx.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},n.prototype.selectLargestBarcode=function(e){for(var t=null,i=0,a=0,l=e;a<l.length;a++){var f=l[a],x=f.boundingBox.width*f.boundingBox.height;x>i&&(i=x,t=f)}if(!t)throw"No largest barcode found";return t},n.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var l=a[i];this.formatMap.has(l)?t.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},n.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},n.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,i,a){e.set(t,i)}),e},n.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},n})(),Cg=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},Sg=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Hb=(function(){function n(e,t,i,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,t&&_g.isSupported()?(this.primaryDecoder=new _g(e,i,a),this.secondaryDecoder=new Eg(e,i,a)):this.primaryDecoder=new Eg(e,i,a)}return n.prototype.decodeAsync=function(e){return Cg(this,void 0,void 0,function(){var t;return Sg(this,function(i){switch(i.label){case 0:t=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},n.prototype.decodeRobustlyAsync=function(e){return Cg(this,void 0,void 0,function(){var t,i;return Sg(this,function(a){switch(a.label){case 0:t=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,a.sent()];case 3:if(i=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw i;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},n.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},n.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},n.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,i=this.executionResults;t<i.length;t++){var a=i[t];e+=a}var l=e/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},n})(),eh=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Yu=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},$u=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},fx=(function(){function n(e,t){this.name=e,this.track=t}return n.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},n.prototype.apply=function(e){var t={};t[this.name]=e;var i={advanced:[t]};return this.track.applyConstraints(i)},n.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},n})(),Gb=(function(n){eh(e,n);function e(t,i){return n.call(this,t,i)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var i={};i[this.name]=t;var a={advanced:[i]};return this.track.applyConstraints(a)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),i=t[this.name];return{min:i.min,max:i.max,step:i.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(fx),zb=(function(n){eh(e,n);function e(t){return n.call(this,"zoom",t)||this}return e})(Gb),jb=(function(n){eh(e,n);function e(t){return n.call(this,"torch",t)||this}return e})(fx),qb=(function(){function n(e){this.track=e}return n.prototype.zoomFeature=function(){return new zb(this.track)},n.prototype.torchFeature=function(){return new jb(this.track)},n})(),Wb=(function(){function n(e,t,i){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return n.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},n.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var i=e.surface.clientWidth,a=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(i,a),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},n.create=function(e,t,i,a){return Yu(this,void 0,void 0,function(){var l,f;return $u(this,function(x){switch(x.label){case 0:return l=new n(e,t,a),i.aspectRatio?(f={aspectRatio:i.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(f)]):[3,2];case 1:x.sent(),x.label=2;case 2:return l.setupSurface(),[2,l]}})})},n.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},n.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},n.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},n.prototype.resume=function(e){this.failIfClosed();var t=this,i=function(){setTimeout(e,200),t.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},n.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},n.prototype.getSurface=function(){return this.failIfClosed(),this.surface},n.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},n.prototype.applyVideoConstraints=function(e){return Yu(this,void 0,void 0,function(){return $u(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},n.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,i){var a=e.mediaStream.getVideoTracks(),l=a.length,f=0;e.mediaStream.getVideoTracks().forEach(function(x){e.mediaStream.removeTrack(x),x.stop(),++f,f>=l&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},n.prototype.getCapabilities=function(){return new qb(this.getFirstTrackOrFail())},n})(),Yb=(function(){function n(e){this.mediaStream=e}return n.prototype.render=function(e,t,i){return Yu(this,void 0,void 0,function(){return $u(this,function(a){return[2,Wb.create(e,this.mediaStream,t,i)]})})},n.create=function(e){return Yu(this,void 0,void 0,function(){var t,i;return $u(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return i=a.sent(),[2,new n(i)]}})})},n})(),Ag=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},Tg=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},$b=(function(){function n(){}return n.failIfNotSupported=function(){return Ag(this,void 0,void 0,function(){return Tg(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new n]})})},n.prototype.create=function(e){return Ag(this,void 0,void 0,function(){return Tg(this,function(t){return[2,Yb.create(e)]})})},n})(),Kb=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},Xb=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Jb=(function(){function n(){}return n.retrieve=function(){if(navigator.mediaDevices)return n.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?n.getCamerasFromMediaStreamTrack():n.rejectWithError()},n.rejectWithError=function(){var e=Ho.unableToQuerySupportedDevices();return n.isHttpsOrLocalhost()||(e=Ho.insecureContextCameraQueryError()),Promise.reject(e)},n.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},n.getCamerasFromMediaDevices=function(){return Kb(this,void 0,void 0,function(){var e,t,i,a,l,f,x;return Xb(this,function(v){switch(v.label){case 0:return e=function(p){for(var _=p.getVideoTracks(),A=0,b=_;A<b.length;A++){var k=b[A];k.enabled=!1,k.stop(),p.removeTrack(k)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=v.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=v.sent(),a=[],l=0,f=i;l<f.length;l++)x=f[l],x.kind==="videoinput"&&a.push({id:x.deviceId,label:x.label});return e(t),[2,a]}})})},n.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var i=function(l){for(var f=[],x=0,v=l;x<v.length;x++){var p=v[x];p.kind==="video"&&f.push({id:p.id,label:p.label})}e(f)},a=MediaStreamTrack;a.getSources(i)})},n})(),tn;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.NOT_STARTED=1]="NOT_STARTED",n[n.SCANNING=2]="SCANNING",n[n.PAUSED=3]="PAUSED"})(tn||(tn={}));var Qb=(function(){function n(){this.state=tn.NOT_STARTED,this.onGoingTransactionNewState=tn.UNKNOWN}return n.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},n.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},n.prototype.execute=function(){if(this.onGoingTransactionNewState===tn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=tn.UNKNOWN,this.directTransition(e)},n.prototype.cancel=function(){if(this.onGoingTransactionNewState===tn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=tn.UNKNOWN},n.prototype.getState=function(){return this.state},n.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==tn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},n.prototype.validateTransition=function(e){switch(this.state){case tn.UNKNOWN:throw"Transition from unknown is not allowed";case tn.NOT_STARTED:this.failIfNewStateIs(e,[tn.PAUSED]);break;case tn.SCANNING:break;case tn.PAUSED:break}},n.prototype.failIfNewStateIs=function(e,t){for(var i=0,a=t;i<a.length;i++){var l=a[i];if(e===l)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},n})(),Zb=(function(){function n(e){this.stateManager=e}return n.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},n.prototype.directTransition=function(e){this.stateManager.directTransition(e)},n.prototype.getState=function(){return this.stateManager.getState()},n.prototype.canScanFile=function(){return this.stateManager.getState()===tn.NOT_STARTED},n.prototype.isScanning=function(){return this.stateManager.getState()!==tn.NOT_STARTED},n.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===tn.SCANNING},n.prototype.isPaused=function(){return this.stateManager.getState()===tn.PAUSED},n})(),eN=(function(){function n(){}return n.create=function(){return new Zb(new Qb)},n})(),tN=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Sr=(function(n){tN(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(ei),nN=(function(){function n(e,t){this.logger=t,this.fps=Sr.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Sr.DEFAULT_DISABLE_FLIP}return n.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?dx.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},n.prototype.isShadedBoxEnabled=function(){return!gi(this.qrbox)},n.create=function(e,t){return new n(e,t)},n})(),Ig=(function(){function n(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var i;typeof t=="boolean"?this.verbose=t===!0:t&&(i=t,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new cx(this.verbose),this.qrcode=new Hb(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=eN.create()}return n.prototype.start=function(e,t,i,a){var l=this;if(!e)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var f;a?f=a:f=this.verbose?this.logger.log:function(){};var x=nN.create(t,this.logger);this.clearElement();var v=!1;x.videoConstraints&&(x.isMediaStreamConstraintsValid()?v=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var p=v,_=document.getElementById(this.elementId);_.clientWidth?_.clientWidth:Sr.DEFAULT_WIDTH,_.style.position="relative",this.shouldScan=!0,this.element=_;var A=this,b=this.stateManagerProxy.startTransition(tn.SCANNING);return new Promise(function(k,O){var U=p?x.videoConstraints:A.createVideoConstraints(e);if(!U){b.cancel(),O("videoConstraints should be defined");return}var F={};(!p||x.aspectRatio)&&(F.aspectRatio=x.aspectRatio);var W={onRenderSurfaceReady:function($,G){A.setupUi($,G,x),A.isScanning=!0,A.foreverScan(x,i,f)}};$b.failIfNotSupported().then(function($){$.create(U).then(function(G){return G.render(l.element,F,W).then(function(J){A.renderedCamera=J,b.execute(),k(null)}).catch(function(J){b.cancel(),O(J)})}).catch(function(G){b.cancel(),O(Ho.errorGettingUserMedia(G))})}).catch(function($){b.cancel(),O(Ho.cameraStreamingNotSupported())})})},n.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(tn.PAUSED),this.showPausedState(),(gi(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},n.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(tn.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},n.prototype.getState=function(){return this.stateManagerProxy.getState()},n.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(tn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(e.element){var l=document.getElementById(Sr.SHADED_REGION_ELEMENT_ID);l&&e.element.removeChild(l)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),i(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),t.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},n.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(i){return i.decodedText})},n.prototype.scanFileV2=function(e,t){var i=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(gi(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,l){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(e);var f=new Image;f.onload=function(){var x=f.width,v=f.height,p=document.getElementById(i.elementId),_=p.clientWidth?p.clientWidth:Sr.DEFAULT_WIDTH,A=Math.max(p.clientHeight?p.clientHeight:v,Sr.FILE_SCAN_MIN_HEIGHT),b=i.computeCanvasDrawConfig(x,v,_,A);if(t){var k=i.createCanvasElement(_,A,"qr-canvas-visible");k.style.display="inline-block",p.appendChild(k);var O=k.getContext("2d");if(!O)throw"Unable to get 2d context from canvas";O.canvas.width=_,O.canvas.height=A,O.drawImage(f,0,0,x,v,b.x,b.y,b.width,b.height)}var U=Sr.FILE_SCAN_HIDDEN_CANVAS_PADDING,F=Math.max(f.width,b.width),W=Math.max(f.height,b.height),$=F+2*U,G=W+2*U,J=i.createCanvasElement($,G);p.appendChild(J);var de=J.getContext("2d");if(!de)throw"Unable to get 2d context from canvas";de.canvas.width=$,de.canvas.height=G,de.drawImage(f,0,0,x,v,U,U,F,W);try{i.qrcode.decodeRobustlyAsync(J).then(function(ue){a(xg.createFromQrcodeResult(ue))}).catch(l)}catch(ue){l("QR code parse error, error = ".concat(ue))}},f.onerror=l,f.onabort=l,f.onstalled=l,f.onsuspend=l,f.src=URL.createObjectURL(e)})},n.prototype.clear=function(){this.clearElement()},n.getCameras=function(){return Jb.retrieve()},n.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},n.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},n.prototype.applyVideoConstraints=function(e){if(e){if(!dx.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},n.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},n.prototype.getSupportedFormats=function(e){var t=[Le.QR_CODE,Le.AZTEC,Le.CODABAR,Le.CODE_39,Le.CODE_93,Le.CODE_128,Le.DATA_MATRIX,Le.MAXICODE,Le.ITF,Le.EAN_13,Le.EAN_8,Le.PDF_417,Le.RSS_14,Le.RSS_EXPANDED,Le.UPC_A,Le.UPC_E,Le.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],a=0,l=e.formatsToSupport;a<l.length;a++){var f=l[a];Pb(f)?i.push(f):this.logger.warn("Invalid format: ".concat(f," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},n.prototype.getUseBarCodeDetectorIfSupported=function(e){if(gi(e))return!0;if(!gi(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(gi(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return gi(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},n.prototype.validateQrboxSize=function(e,t,i){var a=this,l=i.qrbox;this.validateQrboxConfig(l);var f=this.toQrdimensions(e,t,l),x=function(p){if(p<Sr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Sr.MIN_QR_BOX_SIZE,"px.")},v=function(p){return p>e&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),p=e),p};x(f.width),x(f.height),f.width=v(f.width)},n.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},n.prototype.toQrdimensions=function(e,t,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(e,t)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return i},n.prototype.setupUi=function(e,t,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,i);var a=gi(i.qrbox)?{width:e,height:t}:i.qrbox;this.validateQrboxConfig(a);var l=this.toQrdimensions(e,t,a);l.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var f=i.isShadedBoxEnabled()&&l.height<=t,x={x:0,y:0,width:e,height:t},v=f?this.getShadedRegionBounds(e,t,l):x,p=this.createCanvasElement(v.width,v.height),_={willReadFrequently:!0},A=p.getContext("2d",_);A.canvas.width=v.width,A.canvas.height=v.height,this.element.append(p),f&&this.possiblyInsertShadingElement(this.element,e,t,l),this.createScannerPausedUiElement(this.element),this.qrRegion=v,this.context=A,this.canvasElement=p},n.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=Ho.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},n.prototype.scanContext=function(e,t){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return e(a.text,xg.createFromQrcodeResult(a)),i.possiblyUpdateShaders(!0),!0}).catch(function(a){i.possiblyUpdateShaders(!1);var l=Ho.codeParseError(a);return t(l,ux.createFrom(l)),!1})},n.prototype.foreverScan=function(e,t,i){var a=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),f=l.videoWidth/l.clientWidth,x=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var v=this.qrRegion.width*f,p=this.qrRegion.height*x,_=this.qrRegion.x*f,A=this.qrRegion.y*x;this.context.drawImage(l,_,A,v,p,0,0,this.qrRegion.width,this.qrRegion.height);var b=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(e,t,i)},a.getTimeoutFps(e.fps))};this.scanContext(t,i).then(function(k){!k&&e.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(t,i).finally(function(){b()})):b()}).catch(function(k){a.logger.logError("Error happend while scanning context",k),b()})}},n.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",i="deviceId",a={user:!0,environment:!0},l="exact",f=function(O){if(O in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(O,"'")},x=Object.keys(e);if(x.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(x.length," keys");var v=Object.keys(e)[0];if(v!==t&&v!==i)throw"Only '".concat(t,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(v===t){var p=e.facingMode;if(typeof p=="string"){if(f(p))return{facingMode:p}}else if(typeof p=="object")if(l in p){if(f(p["".concat(l)]))return{facingMode:{exact:p["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var _=typeof p;throw"Invalid type of 'facingMode' = ".concat(_)}}else{var A=e.deviceId;if(typeof A=="string")return{deviceId:A};if(typeof A=="object"){if(l in A)return{deviceId:{exact:A["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var b=typeof A;throw"Invalid type of 'deviceId' = ".concat(b)}}}var k=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(k)},n.prototype.computeCanvasDrawConfig=function(e,t,i,a){if(e<=i&&t<=a){var l=(i-e)/2,f=(a-t)/2;return{x:l,y:f,width:e,height:t}}else{var x=e,v=t;return e>i&&(t=i/e*t,e=i),t>a&&(e=a/t*e,t=a),this.logger.log("Image downsampled from "+"".concat(x,"X").concat(v)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,i,a)}},n.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},n.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?Sr.BORDER_SHADER_MATCH_COLOR:Sr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},n.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},n.prototype.createCanvasElement=function(e,t,i){var a=e,l=t,f=document.createElement("canvas");return f.style.width="".concat(a,"px"),f.style.height="".concat(l,"px"),f.style.display="none",f.id=gi(i)?"qr-canvas":i,f},n.prototype.getShadedRegionBounds=function(e,t,i){if(i.width>e||i.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-i.width)/2,y:(t-i.height)/2,width:i.width,height:i.height}},n.prototype.possiblyInsertShadingElement=function(e,t,i,a){if(!(t-a.width<1||i-a.height<1)){var l=document.createElement("div");l.style.position="absolute";var f=(t-a.width)/2,x=(i-a.height)/2;if(l.style.borderLeft="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(Sr.SHADED_REGION_ELEMENT_ID),t-a.width<11||i-a.height<11)this.hasBorderShaders=!1;else{var v=5,p=40;this.insertShaderBorders(l,p,v,-v,null,0,!0),this.insertShaderBorders(l,p,v,-v,null,0,!1),this.insertShaderBorders(l,p,v,null,-v,0,!0),this.insertShaderBorders(l,p,v,null,-v,0,!1),this.insertShaderBorders(l,v,p+v,-v,null,-v,!0),this.insertShaderBorders(l,v,p+v,null,-v,-v,!0),this.insertShaderBorders(l,v,p+v,-v,null,-v,!1),this.insertShaderBorders(l,v,p+v,null,-v,-v,!1),this.hasBorderShaders=!0}e.append(l)}},n.prototype.insertShaderBorders=function(e,t,i,a,l,f,x){var v=document.createElement("div");v.style.position="absolute",v.style.backgroundColor=Sr.BORDER_SHADER_DEFAULT_COLOR,v.style.width="".concat(t,"px"),v.style.height="".concat(i,"px"),a!==null&&(v.style.top="".concat(a,"px")),l!==null&&(v.style.bottom="".concat(l,"px")),x?v.style.left="".concat(f,"px"):v.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(v),e.appendChild(v)},n.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},n.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},n.prototype.getTimeoutFps=function(e){return 1e3/e},n})(),th="data:image/svg+xml;base64,",rN=th+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",iN=th+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",bg=th+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",sN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",Ng=(function(){function n(){}return n.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},n})(),oN=(function(){function n(){this.data=Ng.createDefault();var e=localStorage.getItem(n.LOCAL_STORAGE_KEY);e?this.data=JSON.parse(e):this.reset()}return n.prototype.hasCameraPermissions=function(){return this.data.hasPermission},n.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},n.prototype.setHasPermission=function(e){this.data.hasPermission=e,this.flush()},n.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e,this.flush()},n.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},n.prototype.reset=function(){this.data=Ng.createDefault(),this.flush()},n.prototype.flush=function(){localStorage.setItem(n.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},n.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",n})(),aN=(function(){function n(){this.infoDiv=document.createElement("div")}return n.prototype.renderInto=function(e){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=vg.poweredBy();var t=document.createElement("a");t.innerText="ScanApp",t.href="https://scanapp.org",t.target="new",t.style.color="white",this.infoDiv.appendChild(t);var i=document.createElement("br"),a=document.createElement("br");this.infoDiv.appendChild(i),this.infoDiv.appendChild(a);var l=document.createElement("a");l.innerText=vg.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),e.appendChild(this.infoDiv)},n.prototype.show=function(){this.infoDiv.style.display="block"},n.prototype.hide=function(){this.infoDiv.style.display="none"},n})(),lN=(function(){function n(e,t){this.isShowingInfoIcon=!0,this.onTapIn=e,this.onTapOut=t,this.infoIcon=document.createElement("img")}return n.prototype.renderInto=function(e){var t=this;this.infoIcon.alt="Info icon",this.infoIcon.src=bg,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(i){return t.onHoverIn()},this.infoIcon.onmouseout=function(i){return t.onHoverOut()},this.infoIcon.onclick=function(i){return t.onClick()},e.appendChild(this.infoIcon)},n.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},n.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},n.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=sN,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=bg,this.infoIcon.style.opacity="0.6")},n})(),uN=(function(){function n(){var e=this;this.infoDiv=new aN,this.infoIcon=new lN(function(){e.infoDiv.show()},function(){e.infoDiv.hide()})}return n.prototype.renderInto=function(e){this.infoDiv.renderInto(e),this.infoIcon.renderInto(e)},n})(),cN=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},dN=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Rg=(function(){function n(){}return n.hasPermissions=function(){return cN(this,void 0,void 0,function(){var e,t,i,a;return dN(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(e=l.sent(),t=0,i=e;t<i.length;t++)if(a=i[t],a.kind==="videoinput"&&a.label)return[2,!0];return[2,!1]}})})},n})(),fs=(function(){function n(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}return n.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},n.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},n.prototype.isCameraScanRequired=function(){for(var e=0,t=this.supportedScanTypes;e<t.length;e++){var i=t[e];if(n.isCameraScanType(i))return!0}return!1},n.isCameraScanType=function(e){return e===ms.SCAN_TYPE_CAMERA},n.isFileScanType=function(e){return e===ms.SCAN_TYPE_FILE},n.prototype.validateAndReturnScanTypes=function(e){if(!e||e.length===0)return ei.DEFAULT_SUPPORTED_SCAN_TYPE;var t=ei.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>t)throw"Max ".concat(t," values expected for ")+"supportedScanTypes";for(var i=0,a=e;i<a.length;i++){var l=a[i];if(!ei.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return e},n})(),Ir=(function(){function n(){}return n.ALL_ELEMENT_CLASS="html5-qrcode-element",n.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",n.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",n.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",n.TORCH_BUTTON_ID="html5-qrcode-button-torch",n.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",n.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",n.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",n.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",n.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",n.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",n})(),Pi=(function(){function n(){}return n.createElement=function(e,t){var i=document.createElement(e);return i.id=t,i.classList.add(Ir.ALL_ELEMENT_CLASS),e==="button"&&i.setAttribute("type","button"),i},n})(),hx=function(n,e,t,i){function a(l){return l instanceof t?l:new t(function(f){f(l)})}return new(t||(t=Promise))(function(l,f){function x(_){try{p(i.next(_))}catch(A){f(A)}}function v(_){try{p(i.throw(_))}catch(A){f(A)}}function p(_){_.done?l(_.value):a(_.value).then(x,v)}p((i=i.apply(n,e||[])).next())})},px=function(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function x(p){return function(_){return v([p,_])}}function v(p){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,p[0]&&(t=0)),t;)try{if(i=1,a&&(l=p[0]&2?a.return:p[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,p[1])).done)return l;switch(a=0,l&&(p=[p[0]&2,l.value]),p[0]){case 0:case 1:l=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,a=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!l||p[1]>l[0]&&p[1]<l[3])){t.label=p[1];break}if(p[0]===6&&t.label<l[1]){t.label=l[1],l=p;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(p);break}l[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],a=0}finally{i=l=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Mg=(function(){function n(e,t,i){this.isTorchOn=!1,this.torchCapability=e,this.buttonController=t,this.onTorchActionFailureCallback=i}return n.prototype.isTorchEnabled=function(){return this.isTorchOn},n.prototype.flipState=function(){return hx(this,void 0,void 0,function(){var e,t;return px(this,function(i){switch(i.label){case 0:this.buttonController.disable(),e=!this.isTorchOn,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.torchCapability.apply(e)];case 2:return i.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e),[3,4];case 3:return t=i.sent(),this.propagateFailure(e,t),this.buttonController.enable(),[3,4];case 4:return[2]}})})},n.prototype.updateUiBasedOnLatestSettings=function(e,t){e===t?(this.buttonController.setText(t?Mt.torchOffButton():Mt.torchOnButton()),this.isTorchOn=t):this.propagateFailure(t),this.buttonController.enable()},n.prototype.propagateFailure=function(e,t){var i=e?Mt.torchOnFailedMessage():Mt.torchOffFailedMessage();t&&(i+="; Error = "+t),this.onTorchActionFailureCallback(i)},n.prototype.reset=function(){this.isTorchOn=!1},n})(),fN=(function(){function n(e,t){this.onTorchActionFailureCallback=t,this.torchButton=Pi.createElement("button",Ir.TORCH_BUTTON_ID),this.torchController=new Mg(e,this,t)}return n.prototype.render=function(e,t){var i=this;this.torchButton.innerText=Mt.torchOnButton(),this.torchButton.style.display=t.display,this.torchButton.style.marginLeft=t.marginLeft;var a=this;this.torchButton.addEventListener("click",function(l){return hx(i,void 0,void 0,function(){return px(this,function(f){switch(f.label){case 0:return[4,a.torchController.flipState()];case 1:return f.sent(),a.torchController.isTorchEnabled()?(a.torchButton.classList.remove(Ir.TORCH_BUTTON_CLASS_TORCH_OFF),a.torchButton.classList.add(Ir.TORCH_BUTTON_CLASS_TORCH_ON)):(a.torchButton.classList.remove(Ir.TORCH_BUTTON_CLASS_TORCH_ON),a.torchButton.classList.add(Ir.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),e.appendChild(this.torchButton)},n.prototype.updateTorchCapability=function(e){this.torchController=new Mg(e,this,this.onTorchActionFailureCallback)},n.prototype.getTorchButton=function(){return this.torchButton},n.prototype.hide=function(){this.torchButton.style.display="none"},n.prototype.show=function(){this.torchButton.style.display="inline-block"},n.prototype.disable=function(){this.torchButton.disabled=!0},n.prototype.enable=function(){this.torchButton.disabled=!1},n.prototype.setText=function(e){this.torchButton.innerText=e},n.prototype.reset=function(){this.torchButton.innerText=Mt.torchOnButton(),this.torchController.reset()},n.create=function(e,t,i,a){var l=new n(t,a);return l.render(e,i),l},n})(),hN=(function(){function n(e,t,i){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=t?"block":"none",e.appendChild(this.fileBasedScanRegion);var a=document.createElement("label");a.setAttribute("for",this.getFileScanInputId()),a.style.display="inline-block",this.fileBasedScanRegion.appendChild(a),this.fileSelectionButton=Pi.createElement("button",Ir.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(x){a.click()}),a.append(this.fileSelectionButton),this.fileScanInput=Pi.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",a.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(x){if(!(x==null||x.target==null)){var v=x.target;if(!(v.files&&v.files.length===0)){var p=v.files,_=p[0],A=_.name;l.setImageNameToButton(A),i(_)}}});var f=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(f),this.fileBasedScanRegion.addEventListener("dragenter",function(x){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),x.stopPropagation(),x.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(x){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),x.stopPropagation(),x.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(x){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),x.stopPropagation(),x.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(x){x.stopPropagation(),x.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var v=x.dataTransfer;if(v){var p=v.files;if(!p||p.length===0)return;for(var _=!1,A=0;A<p.length;++A){var b=p.item(A);if(b){var k=/image.*/;if(b.type.match(k)){_=!0;var O=b.name;l.setImageNameToButton(O),i(b),f.innerText=Mt.dragAndDropMessage();break}}}_||(f.innerText=Mt.dragAndDropMessageOnlyImages())}})}return n.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},n.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},n.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},n.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},n.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");return e.style.textAlign="center",e.style.margin="auto",e.style.width="80%",e.style.maxWidth="600px",e.style.border=this.fileBasedScanRegionDefaultBorder(),e.style.padding="10px",e.style.marginBottom="10px",e},n.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},n.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},n.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");return e.innerText=Mt.dragAndDropMessage(),e.style.fontWeight="400",e},n.prototype.setImageNameToButton=function(e){var t=20;if(e.length>t){var i=e.substring(0,8),a=e.length,l=e.substring(a-8,a);e="".concat(i,"....").concat(l)}var f=Mt.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=f},n.prototype.setInitialValueToButton=function(){var e=Mt.fileSelectionChooseImage()+" - "+Mt.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e},n.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},n.create=function(e,t,i){var a=new n(e,t,i);return a},n})(),pN=(function(){function n(e){this.selectElement=Pi.createElement("select",Ir.CAMERA_SELECTION_SELECT_ID),this.cameras=e,this.options=[]}return n.prototype.render=function(e){var t=document.createElement("span");t.style.marginRight="10px";var i=this.cameras.length;if(i===0)throw new Error("No cameras found");if(i===1)t.style.display="none";else{var a=Mt.selectCamera();t.innerText="".concat(a," (").concat(this.cameras.length,")  ")}for(var l=1,f=0,x=this.cameras;f<x.length;f++){var v=x[f],p=v.id,_=v.label==null?p:v.label;(!_||_==="")&&(_=[Mt.anonymousCameraPrefix(),l++].join(" "));var A=document.createElement("option");A.value=p,A.innerText=_,this.options.push(A),this.selectElement.appendChild(A)}t.appendChild(this.selectElement),e.appendChild(t)},n.prototype.disable=function(){this.selectElement.disabled=!0},n.prototype.isDisabled=function(){return this.selectElement.disabled===!0},n.prototype.enable=function(){this.selectElement.disabled=!1},n.prototype.getValue=function(){return this.selectElement.value},n.prototype.hasValue=function(e){for(var t=0,i=this.options;t<i.length;t++){var a=i[t];if(a.value===e)return!0}return!1},n.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e},n.prototype.hasSingleItem=function(){return this.cameras.length===1},n.prototype.numCameras=function(){return this.cameras.length},n.create=function(e,t){var i=new n(t);return i.render(e),i},n})(),gN=(function(){function n(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=Pi.createElement("input",Ir.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return n.prototype.render=function(e,t){this.zoomElementContainer.style.display=t?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",e.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var i=Mt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(i),this.rangeText.style.marginRight="10px";var a=this;this.rangeInput.addEventListener("input",function(){return a.onValueChange()}),this.rangeInput.addEventListener("change",function(){return a.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},n.prototype.onValueChange=function(){var e=Mt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},n.prototype.setValues=function(e,t,i,a){this.rangeInput.min=e.toString(),this.rangeInput.max=t.toString(),this.rangeInput.step=a.toString(),this.rangeInput.value=i.toString(),this.onValueChange()},n.prototype.show=function(){this.zoomElementContainer.style.display="block"},n.prototype.hide=function(){this.zoomElementContainer.style.display="none"},n.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},n.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},n.create=function(e,t){var i=new n;return i.render(e,t),i},n})(),Ar;(function(n){n[n.STATUS_DEFAULT=0]="STATUS_DEFAULT",n[n.STATUS_SUCCESS=1]="STATUS_SUCCESS",n[n.STATUS_WARNING=2]="STATUS_WARNING",n[n.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Ar||(Ar={}));function mN(n){return{fps:n.fps,qrbox:n.qrbox,aspectRatio:n.aspectRatio,disableFlip:n.disableFlip,videoConstraints:n.videoConstraints}}function yN(n,e){return{formatsToSupport:n.formatsToSupport,useBarCodeDetectorIfSupported:n.useBarCodeDetectorIfSupported,experimentalFeatures:n.experimentalFeatures,verbose:e}}var xN=(function(){function n(e,t,i){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=e,this.config=this.createConfig(t),this.verbose=i===!0,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new fs(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new cx(this.verbose),this.persistedDataManager=new oN,t.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return n.prototype.render=function(e,t){var i=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,f){if(e)e(l,f);else{if(i.lastMatchFound===l)return;i.lastMatchFound=l,i.setHeaderMessage(Mt.lastMatch(l),Ar.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,f){t&&t(l,f)};var a=document.getElementById(this.elementId);if(!a)throw"HTML Element with id=".concat(this.elementId," not found");a.innerHTML="",this.createBasicLayout(a),this.html5Qrcode=new Ig(this.getScanRegionId(),yN(this.config,this.verbose))},n.prototype.pause=function(e){(gi(e)||e!==!0)&&(e=!1),this.getHtml5QrcodeOrFail().pause(e)},n.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},n.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},n.prototype.clear=function(){var e=this,t=function(){var i=document.getElementById(e.elementId);i&&(i.innerHTML="",e.resetBasicLayout(i))};return this.html5Qrcode?new Promise(function(i,a){if(!e.html5Qrcode){i();return}e.html5Qrcode.isScanning?e.html5Qrcode.stop().then(function(l){if(!e.html5Qrcode){i();return}e.html5Qrcode.clear(),t(),i()}).catch(function(l){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",l),a(l)}):(e.html5Qrcode.clear(),t(),i())}):Promise.resolve()},n.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},n.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)},n.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},n.prototype.createConfig=function(e){return e?(e.fps||(e.fps=ei.SCAN_DEFAULT_FPS),e.rememberLastUsedCamera!==!ei.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=ei.DEFAULT_REMEMBER_LAST_CAMERA_USED),e.supportedScanTypes||(e.supportedScanTypes=ei.DEFAULT_SUPPORTED_SCAN_TYPE),e):{fps:ei.SCAN_DEFAULT_FPS,rememberLastUsedCamera:ei.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:ei.DEFAULT_SUPPORTED_SCAN_TYPE}},n.prototype.createBasicLayout=function(e){e.style.position="relative",e.style.padding="0px",e.style.border="1px solid silver",this.createHeader(e);var t=document.createElement("div"),i=this.getScanRegionId();t.id=i,t.style.width="100%",t.style.minHeight="100px",t.style.textAlign="center",e.appendChild(t),fs.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var a=document.createElement("div"),l=this.getDashboardId();a.id=l,a.style.width="100%",e.appendChild(a),this.setupInitialDashboard(a)},n.prototype.resetBasicLayout=function(e){e.style.border="none"},n.prototype.setupInitialDashboard=function(e){this.createSection(e),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},n.prototype.createHeader=function(e){var t=document.createElement("div");t.style.textAlign="left",t.style.margin="0px",e.appendChild(t);var i=new uN;i.renderInto(t);var a=document.createElement("div");a.id=this.getHeaderMessageContainerId(),a.style.display="none",a.style.textAlign="center",a.style.fontSize="14px",a.style.padding="2px 10px",a.style.margin="4px",a.style.borderTop="1px solid #f6f6f6",t.appendChild(a)},n.prototype.createSection=function(e){var t=document.createElement("div");t.id=this.getDashboardSectionId(),t.style.width="100%",t.style.padding="10px 0px 10px 0px",t.style.textAlign="left",e.appendChild(t)},n.prototype.createCameraListUi=function(e,t,i){var a=this;a.showHideScanTypeSwapLink(!1),a.setHeaderMessage(Mt.cameraPermissionRequesting());var l=function(){i||a.createPermissionButton(e,t)};Ig.getCameras().then(function(f){a.persistedDataManager.setHasPermission(!0),a.showHideScanTypeSwapLink(!0),a.resetHeaderMessage(),f&&f.length>0?(e.removeChild(t),a.renderCameraSelection(f)):(a.setHeaderMessage(Mt.noCameraFound(),Ar.STATUS_WARNING),l())}).catch(function(f){a.persistedDataManager.setHasPermission(!1),i?i.disabled=!1:l(),a.setHeaderMessage(f,Ar.STATUS_WARNING),a.showHideScanTypeSwapLink(!0)})},n.prototype.createPermissionButton=function(e,t){var i=this,a=Pi.createElement("button",this.getCameraPermissionButtonId());a.innerText=Mt.cameraPermissionTitle(),a.addEventListener("click",function(){a.disabled=!0,i.createCameraListUi(e,t,a)}),t.appendChild(a)},n.prototype.createPermissionsUi=function(e,t){var i=this;if(fs.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){Rg.hasPermissions().then(function(a){a?i.createCameraListUi(e,t):(i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(e,t))}).catch(function(a){i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(e,t)});return}this.createPermissionButton(e,t)},n.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId()),t=document.createElement("div");e.appendChild(t);var i=document.createElement("div");i.id=this.getDashboardSectionCameraScanRegionId(),i.style.display=fs.isCameraScanType(this.currentScanType)?"block":"none",t.appendChild(i);var a=document.createElement("div");a.style.textAlign="center",i.appendChild(a),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(i,a),this.renderFileScanUi(t)},n.prototype.renderFileScanUi=function(e){var t=fs.isFileScanType(this.currentScanType),i=this,a=function(l){if(!i.html5Qrcode)throw"html5Qrcode not defined";fs.isFileScanType(i.currentScanType)&&(i.setHeaderMessage(Mt.loadingImage()),i.html5Qrcode.scanFileV2(l,!0).then(function(f){i.resetHeaderMessage(),i.qrCodeSuccessCallback(f.decodedText,f)}).catch(function(f){i.setHeaderMessage(f,Ar.STATUS_WARNING),i.qrCodeErrorCallback(f,ux.createFrom(f))}))};this.fileSelectionUi=hN.create(e,t,a)},n.prototype.renderCameraSelection=function(e){var t=this,i=this,a=document.getElementById(this.getDashboardSectionCameraScanRegionId());a.style.textAlign="center";var l=gN.create(a,!1),f=function(U){var F=U.zoomFeature();if(F.isSupported()){l.setOnCameraZoomValueChangeCallback(function($){F.apply($)});var W=1;t.config.defaultZoomValueIfSupported&&(W=t.config.defaultZoomValueIfSupported),W=Db(W,F.min(),F.max()),l.setValues(F.min(),F.max(),W,F.step()),l.show()}},x=pN.create(a,e),v=document.createElement("span"),p=Pi.createElement("button",Ir.CAMERA_START_BUTTON_ID);p.innerText=Mt.scanButtonStartScanningText(),v.appendChild(p);var _=Pi.createElement("button",Ir.CAMERA_STOP_BUTTON_ID);_.innerText=Mt.scanButtonStopScanningText(),_.style.display="none",_.disabled=!0,v.appendChild(_);var A,b=function(U){if(!U.torchFeature().isSupported()){A&&A.hide();return}A?A.updateTorchCapability(U.torchFeature()):A=fN.create(v,U.torchFeature(),{display:"none",marginLeft:"5px"},function(F){i.setHeaderMessage(F,Ar.STATUS_WARNING)}),A.show()};a.appendChild(v);var k=function(U){U||(p.style.display="none"),p.innerText=Mt.scanButtonStartScanningText(),p.style.opacity="1",p.disabled=!1,U&&(p.style.display="inline-block")};if(p.addEventListener("click",function(U){p.innerText=Mt.scanButtonScanningStarting(),x.disable(),p.disabled=!0,p.style.opacity="0.5",t.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!1),i.resetHeaderMessage();var F=x.getValue();i.persistedDataManager.setLastUsedCameraId(F),i.html5Qrcode.start(F,mN(i.config),i.qrCodeSuccessCallback,i.qrCodeErrorCallback).then(function(W){_.disabled=!1,_.style.display="inline-block",k(!1);var $=i.html5Qrcode.getRunningTrackCameraCapabilities();t.config.showTorchButtonIfSupported===!0&&b($),t.config.showZoomSliderIfSupported===!0&&f($)}).catch(function(W){i.showHideScanTypeSwapLink(!0),x.enable(),k(!0),i.setHeaderMessage(W,Ar.STATUS_WARNING)})}),x.hasSingleItem()&&p.click(),_.addEventListener("click",function(U){if(!i.html5Qrcode)throw"html5Qrcode not defined";_.disabled=!0,i.html5Qrcode.stop().then(function(F){t.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!0),x.enable(),p.disabled=!1,_.style.display="none",p.style.display="inline-block",A&&(A.reset(),A.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),i.insertCameraScanImageToScanRegion()}).catch(function(F){_.disabled=!1,i.setHeaderMessage(F,Ar.STATUS_WARNING)})}),i.persistedDataManager.getLastUsedCameraId()){var O=i.persistedDataManager.getLastUsedCameraId();x.hasValue(O)?(x.setValue(O),p.click()):i.persistedDataManager.resetLastUsedCameraId()}},n.prototype.createSectionSwap=function(){var e=this,t=Mt.textIfCameraScanSelected(),i=Mt.textIfFileScanSelected(),a=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var f=Pi.createElement("span",this.getDashboardSectionSwapLinkId());f.style.textDecoration="underline",f.style.cursor="pointer",f.innerText=fs.isCameraScanType(this.currentScanType)?t:i,f.addEventListener("click",function(){if(!e.sectionSwapAllowed){e.verbose&&e.logger.logError("Section swap called when not allowed");return}e.resetHeaderMessage(),e.fileSelectionUi.resetValue(),e.sectionSwapAllowed=!1,fs.isCameraScanType(e.currentScanType)?(e.clearScanRegion(),e.getCameraScanRegion().style.display="none",e.fileSelectionUi.show(),f.innerText=i,e.currentScanType=ms.SCAN_TYPE_FILE,e.insertFileScanImageToScanRegion()):(e.clearScanRegion(),e.getCameraScanRegion().style.display="block",e.fileSelectionUi.hide(),f.innerText=t,e.currentScanType=ms.SCAN_TYPE_CAMERA,e.insertCameraScanImageToScanRegion(),e.startCameraScanIfPermissionExistsOnSwap()),e.sectionSwapAllowed=!0}),l.appendChild(f),a.appendChild(l)},n.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this,t=this;if(this.persistedDataManager.hasCameraPermissions()){Rg.hasPermissions().then(function(i){if(i){var a=document.getElementById(t.getCameraPermissionButtonId());if(!a)throw e.logger.logError("Permission button not found, fail;"),"Permission button not found";a.click()}else t.persistedDataManager.setHasPermission(!1)}).catch(function(i){t.persistedDataManager.setHasPermission(!1)});return}},n.prototype.resetHeaderMessage=function(){var e=document.getElementById(this.getHeaderMessageContainerId());e.style.display="none"},n.prototype.setHeaderMessage=function(e,t){t||(t=Ar.STATUS_DEFAULT);var i=this.getHeaderMessageDiv();switch(i.innerText=e,i.style.display="block",t){case Ar.STATUS_SUCCESS:i.style.background="rgba(106, 175, 80, 0.26)",i.style.color="#477735";break;case Ar.STATUS_WARNING:i.style.background="rgba(203, 36, 49, 0.14)",i.style.color="#cb2431";break;case Ar.STATUS_DEFAULT:default:i.style.background="rgba(0, 0, 0, 0)",i.style.color="rgb(17, 17, 17)";break}},n.prototype.showHideScanTypeSwapLink=function(e){this.scanTypeSelector.hasMoreThanOneScanType()&&(e!==!0&&(e=!1),this.sectionSwapAllowed=e,this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none")},n.prototype.insertCameraScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){t.innerHTML="<br>",t.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(i){t.innerHTML="<br>",t.appendChild(e.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=rN,this.cameraScanImage.alt=Mt.cameraScanAltText()},n.prototype.insertFileScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.fileScanImage){t.innerHTML="<br>",t.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(i){t.innerHTML="<br>",t.appendChild(e.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=iN,this.fileScanImage.alt=Mt.fileScanAltText()},n.prototype.clearScanRegion=function(){var e=document.getElementById(this.getScanRegionId());e.innerHTML=""},n.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},n.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},n.prototype.getDashboardSectionSwapLinkId=function(){return Ir.SCAN_TYPE_CHANGE_ANCHOR_ID},n.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},n.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},n.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},n.prototype.getCameraPermissionButtonId=function(){return Ir.CAMERA_PERMISSION_BUTTON_ID},n.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},n.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},n.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},n})();const vN=()=>{const[n,e]=Je.useState(!1),[t,i]=Je.useState(""),[a,l]=Je.useState(""),[f,x]=Je.useState(""),[v,p]=Je.useState(!1),[_,A]=Je.useState(null),[b,k]=Je.useState("loyalty"),[O,U]=Je.useState("Corte"),[F,W]=Je.useState("7000"),[$,G]=Je.useState(null);Je.useEffect(()=>{if(v&&!_){const Se=new xN("reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1);return setTimeout(()=>{try{Se.render(J,de)}catch(Pe){x("Error iniciando cmara: "+Pe)}},100),()=>{Se.clear().catch(Pe=>console.error("Failed to clear html5-qrcode scanner. ",Pe))}}},[v,_]);const J=async(Se,Pe)=>{if(!_){A(Se),p(!1);try{x("Procesando visita...");const{data:Ie,error:Ne}=await Qn.rpc("register_visit",{token_input:Se});if(Ne)throw Ne;Ie.success?x("OK: "+Ie.message+" Visitas: "+Ie.new_visits):x("Error: "+Ie.message),setTimeout(()=>{A(null),x("")},4e3)}catch(Ie){console.error(Ie),x("Error al procesar el cdigo."),A(null)}}},de=Se=>{console.warn(Se),typeof Se=="string"&&(Se.includes("NotAllowedError")||Se.includes("NotFoundError"))&&x("Error de Cmara: "+Se)},ue=Se=>{Se.preventDefault(),t==="admin2026"?e(!0):alert("Contrasea incorrecta")},ee=async()=>{if(!$||!window.confirm("Confirmar canje del 10% de Descuento?"))return;const{data:Se,error:Pe}=await Qn.rpc("redeem_discount_5th",{token_input:$.member_token});if(Pe)x("Error: "+Pe.message);else if(x(Se.message),Se.success){const{data:Ie}=await Qn.from("clients").select("*").eq("id",$.id).single();G(Ie)}},Te=async()=>{if(!$||!window.confirm("Confirmar canje del Corte Gratis?"))return;const{data:Se,error:Pe}=await Qn.rpc("redeem_free_cut",{token_input:$.member_token});if(Pe)x("Error: "+Pe.message);else if(x(Se.message),Se.success){const{data:Ie}=await Qn.from("clients").select("*").eq("id",$.id).single();G(Ie)}},Z=async()=>{if(!(a.length<8))try{const{data:Se,error:Pe}=await Qn.from("clients").select("*").eq("phone",a).single();if(Pe&&Pe.code!=="PGRST116"){alert("Error al buscar cliente");return}const Ne=(Se?Se.visits:0)+1,{data:We,error:ie}=await Qn.from("clients").upsert({phone:a,visits:Ne,last_visit:new Date().toISOString()},{onConflict:"phone"}).select().single();if(ie){console.error(ie),alert("Error al actualizar visita");return}G(We),x("Visita registrada para "+a+". Total visitas: "+Ne),l("")}catch(Se){console.error(Se),alert("Error de conexin")}};return n?M.jsxs("div",{className:"max-w-2xl mx-auto p-4 py-12",children:[M.jsx("h2",{className:"text-3xl serif text-stone-900 mb-8 border-b pb-4 flex justify-between",children:"Panel de Control"}),M.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-stone-100 mb-8",children:[M.jsxs("h3",{className:"text-xl font-bold text-stone-900 mb-4 flex items-center gap-2",children:[M.jsx(Nv,{className:"text-green-600"}),"Registrar Visita Manual"]}),M.jsx("p",{className:"text-sm text-stone-500 mb-6",children:"Usa esto para clientes que agendaron por WhatsApp o en persona."}),M.jsxs("div",{className:"flex gap-4 mb-4",children:[M.jsx("input",{type:"tel",value:a,onChange:Se=>l(Se.target.value),placeholder:"+569...",className:"flex-1 px-4 py-3 rounded-lg border border-stone-300 focus:ring-2 focus:ring-green-600 outline-none"}),M.jsxs("button",{onClick:Z,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-green-700 transition flex items-center gap-2",children:[M.jsx(Pv,{size:18}),"Registrar"]})]}),M.jsx("div",{className:"flex justify-center mb-6",children:M.jsxs("div",{className:"bg-stone-800 p-1 rounded-xl inline-flex",children:[M.jsx("button",{onClick:()=>k("loyalty"),className:`px-4 py-2 rounded-lg text-sm font-bold transition ${b==="loyalty"?"bg-amber-500 text-stone-900":"text-stone-400 hover:text-white"}`,children:"Visitas (General)"}),M.jsx("button",{onClick:()=>k("hair"),className:`px-4 py-2 rounded-lg text-sm font-bold transition ${b==="hair"?"bg-purple-500 text-white":"text-stone-400 hover:text-white"}`,children:"Peluquera (Servicios)"})]})}),M.jsxs("div",{className:"bg-stone-800 p-6 rounded-2xl shadow-xl border border-white/5",children:[M.jsx("h3",{className:"serif text-xl mb-4 text-center",children:b==="loyalty"?"Registrar Visita":"Registrar Servicio Peluquera"}),b==="hair"&&M.jsxs("div",{className:"mb-4 space-y-3",children:[M.jsxs("select",{value:O,onChange:Se=>U(Se.target.value),className:"w-full bg-stone-900 border border-white/10 rounded-lg px-3 py-2 text-white",children:[M.jsx("option",{value:"Corte",children:"Corte ($7.000+)"}),M.jsx("option",{value:"Lavado",children:"Lavado ($5.000)"}),M.jsx("option",{value:"Tintura",children:"Tintura ($10.000+)"}),M.jsx("option",{value:"Masaje",children:"Masaje ($5.000)"})]}),M.jsx("input",{type:"number",value:F,onChange:Se=>W(Se.target.value),placeholder:"Precio Real",className:"w-full bg-stone-900 border border-white/10 rounded-lg px-3 py-2 text-white"})]}),M.jsxs("button",{onClick:()=>p(!0),className:`w-full py-4 rounded-xl flex items-center justify-center gap-2 font-bold text-lg transition ${b==="hair"?"bg-purple-600 hover:bg-purple-500 text-white":"bg-amber-500 hover:bg-amber-400 text-stone-900"}`,children:[M.jsx(Rv,{size:24}),b==="hair"?"Escanear para Servicio":"Escanear Tarjeta"]}),f&&M.jsx("div",{className:"mt-4 p-3 bg-green-500/20 text-green-400 rounded-lg text-sm font-medium whitespace-pre-wrap",children:f}),$&&M.jsxs("div",{className:"mt-6 border-t border-white/10 pt-4",children:[M.jsxs("h3",{className:"font-bold text-white mb-3",children:["Cliente: ",$.phone]}),M.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-stone-300 mb-4",children:[M.jsxs("div",{children:["Visitas: ",$.visits]}),M.jsxs("div",{children:["Peluquera: ",$.hair_service_count||0]})]}),M.jsxs("div",{className:"space-y-3",children:[$.discount_5th_visit_available?M.jsx("button",{onClick:ee,className:"w-full bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 animate-pulse",children:M.jsx("span",{children:" Canjear 10% Descuento"})}):M.jsxs("div",{className:"p-2 bg-stone-900/50 rounded text-center text-stone-500 text-xs",children:["Descuento 10%: ",5-($.hair_service_count||0)%5," para desbloquear"]}),$.free_cut_available?M.jsx("button",{onClick:Te,className:"w-full bg-yellow-500 hover:bg-yellow-400 text-stone-900 font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 animate-pulse shadow-lg",children:M.jsx("span",{children:" Canjear Corte Gratis"})}):M.jsxs("div",{className:"p-2 bg-stone-900/50 rounded text-center text-stone-500 text-xs",children:["Corte Gratis: ",10-($.hair_service_count||0)%10," para desbloquear"]})]})]})]}),v&&M.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex flex-col items-center justify-center p-4",children:M.jsxs("div",{className:"bg-white p-4 rounded-2xl w-full max-w-sm relative",children:[M.jsx("button",{onClick:()=>p(!1),className:"absolute -top-12 right-0 text-white p-2",children:M.jsx(Ju,{size:32})}),M.jsx("h3",{className:"text-center font-bold mb-4",children:"Escanea el Cdigo del Cliente"}),M.jsx("div",{id:"reader",className:"w-full bg-stone-100 rounded-lg overflow-hidden"}),M.jsx("p",{className:"text-center text-xs text-stone-500 mt-4",children:"Apunta la cmara al QR de la tarjeta digital"})]})}),f&&M.jsx("div",{className:"mt-4 p-3 bg-green-50 text-green-800 rounded-lg text-sm font-medium animate-in fade-in",children:f})]}),M.jsxs("div",{className:"bg-stone-50 p-6 rounded-2xl border border-stone-200",children:[M.jsx("h3",{className:"text-lg font-bold text-stone-700 mb-2",children:"Estadsticas Rpidas"}),M.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[M.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[M.jsx("span",{className:"block text-2xl font-bold text-stone-900",children:"12"}),M.jsx("span",{className:"text-xs text-stone-500 uppercase",children:"Visitas Hoy"})]}),M.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[M.jsx("span",{className:"block text-2xl font-bold text-purple-600",children:"3"}),M.jsx("span",{className:"text-xs text-stone-500 uppercase",children:"Nuevos Referidos"})]})]})]})]}):M.jsx("div",{className:"flex flex-col items-center justify-center min-h-[50vh] bg-stone-50 p-4",children:M.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl border border-stone-100 max-w-sm w-full text-center",children:[M.jsx(Lv,{className:"w-12 h-12 text-stone-900 mx-auto mb-4"}),M.jsx("h2",{className:"text-xl font-bold text-stone-900 mb-6",children:"Acceso Administrativo"}),M.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[M.jsx("input",{type:"password",value:t,onChange:Se=>i(Se.target.value),placeholder:"Contrasea",className:"w-full px-4 py-3 rounded-lg border border-stone-300 focus:ring-2 focus:ring-stone-900 outline-none"}),M.jsx("button",{type:"submit",className:"w-full bg-stone-900 text-white py-3 rounded-lg font-bold",children:"Ingresar"})]})]})})},wN=()=>{const[n,e]=Je.useState("Todos"),[t,i]=Je.useState(null),a=["Todos","Cortes","Color","Peinados"],l=n==="Todos"?rp:rp.filter(f=>f.category===n);return M.jsxs("div",{className:"animate-in fade-in duration-700",children:[M.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-12",children:a.map(f=>M.jsx("button",{onClick:()=>e(f),className:`px-6 py-2 rounded-full text-sm font-bold uppercase tracking-widest transition-all ${n===f?"bg-stone-900 text-white shadow-lg scale-105":"bg-stone-100 text-stone-500 hover:bg-stone-200"}`,children:f},f))}),M.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8 px-4",children:l.map((f,x)=>M.jsxs("div",{className:"break-inside-avoid relative group cursor-zoom-in overflow-hidden rounded-xl shadow-md bg-stone-100",onClick:()=>i(f.url),children:[M.jsx("img",{src:f.url,alt:f.description,className:"w-full h-auto object-cover transform transition duration-700 group-hover:scale-110",loading:"lazy"}),M.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:M.jsxs("div",{className:"text-white text-center p-4 transform translate-y-4 group-hover:translate-y-0 transition duration-300",children:[M.jsx(Uv,{className:"mx-auto mb-2 opacity-80"}),M.jsx("p",{className:"font-serif italic text-lg",children:f.description})]})})]},x))}),t&&M.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/95 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:()=>i(null),children:[M.jsx("button",{className:"absolute top-6 right-6 text-white/50 hover:text-white transition",onClick:()=>i(null),children:M.jsx(Ju,{size:32})}),M.jsx("img",{src:t,alt:"Zoom",className:"max-w-full max-h-[90vh] object-contain rounded-sm shadow-2xl scale-in-95 animate-in duration-300"})]})]})},EN=()=>{const[n,e]=Je.useState(bt.HOME),[t,i]=Je.useState(null);nn.useEffect(()=>{new URLSearchParams(window.location.search).get("token")&&e(bt.LOYALTY)},[]);const a=()=>{switch(n){case bt.ADMIN:return M.jsx(vN,{});case bt.GALLERY:return M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[M.jsxs("div",{className:"text-center mb-16",children:[M.jsx("span",{className:"text-sm font-bold tracking-widest text-stone-500 uppercase",children:"Nuestro Arte"}),M.jsx("h2",{className:"serif text-4xl md:text-5xl mt-3 text-stone-900",children:"Galera de Trabajos"}),M.jsx("p",{className:"text-stone-500 mt-4 max-w-2xl mx-auto",children:"Resultados reales de clientas felices. Insprate para tu prximo cambio de look."})]}),M.jsx(wN,{})]});case bt.LOYALTY:return M.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 min-h-[60vh] flex flex-col justify-center items-center",children:M.jsx(kb,{})});case bt.BOOKING:return M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[M.jsxs("div",{className:"text-center mb-16",children:[M.jsx("span",{className:"text-sm font-bold tracking-widest text-stone-500 uppercase",children:"Reserva tu momento"}),M.jsx("h2",{className:"serif text-4xl md:text-5xl mt-3 text-stone-900",children:"Agenda tu Cita"})]}),M.jsx(n2,{onSuccess:l=>{i(l),e(bt.CONFIRMATION)}})]});case bt.CONFIRMATION:return M.jsx(wb,{isHomeService:t?.isHomeService||!1,onGoHome:()=>e(bt.HOME),onGoCatalog:()=>e(bt.CATALOG)});case bt.CATALOG:return M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[M.jsxs("div",{className:"text-center mb-16",children:[M.jsx("span",{className:"text-sm font-bold tracking-widest text-stone-500 uppercase",children:"Aromas Exclusivos"}),M.jsx("h2",{className:"serif text-4xl md:text-5xl mt-3 text-stone-900",children:"Nuestra Coleccin"})]}),M.jsx(r2,{})]});case bt.HOME:default:return M.jsxs(M.Fragment,{children:[M.jsx(Hv,{onCtaClick:()=>e(bt.BOOKING)}),M.jsx("section",{className:"py-24 bg-white",children:M.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-16 items-center",children:[M.jsx("div",{children:M.jsx("img",{src:"/images/gallery/work_1.png",alt:"Hair Styling",className:"rounded-sm shadow-xl",onError:l=>{l.target.src="https://images.unsplash.com/photo-1560869713-7d0a29430803?auto=format&fit=crop&q=80&w=800"}})}),M.jsxs("div",{className:"space-y-6",children:[M.jsx("h3",{className:"serif text-4xl text-stone-900",children:"Corte, Color & Styling"}),M.jsx("p",{className:"text-stone-600 font-light text-lg leading-relaxed",children:"Desde cortes de puntas esenciales hasta cambios de look completos con coloracin. Descubre nuestros nuevos servicios de verano 2026."}),M.jsxs("div",{className:"flex items-center space-x-4 pt-2",children:[M.jsx("button",{onClick:()=>e(bt.GALLERY),className:"px-6 py-2 bg-stone-100 text-stone-900 rounded-full font-bold text-sm hover:bg-stone-200 transition",children:"Ver Galera"}),M.jsxs("div",{className:"flex items-center space-x-2 text-stone-900 font-medium",children:[M.jsx(Pf,{size:20}),M.jsx("span",{children:"Desde $7.000"})]})]})]})]})})}),M.jsxs("section",{className:"py-16 bg-stone-900 text-white relative overflow-hidden",children:[M.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-amber-500 rounded-full blur-[100px] opacity-20 transform translate-x-1/2 -translate-y-1/2"}),M.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10",children:[M.jsx(Dg,{className:"mx-auto text-amber-400 mb-4 h-12 w-12"}),M.jsx("h2",{className:"serif text-3xl md:text-4xl mb-4",children:"Ya eres Clienta?"}),M.jsx("p",{className:"text-stone-300 max-w-lg mx-auto mb-8",children:"Revisa tus puntos acumulados y descubre cunto te falta para tu **Descuento de la 5ta Visita**."}),M.jsx("button",{onClick:()=>e(bt.LOYALTY),className:"bg-white text-stone-900 px-8 py-3 rounded-full font-bold hover:bg-amber-50 transition shadow-lg",children:"Revisar mis Puntos"})]})]}),M.jsx("section",{className:"py-24 bg-stone-50",children:M.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-16 items-center flex-row-reverse",children:[M.jsxs("div",{className:"order-2 md:order-1 space-y-6",children:[M.jsxs("h3",{className:"serif text-4xl text-stone-900",children:["Alta Perfumera ",M.jsx("br",{})," en Decants"]}),M.jsx("p",{className:"text-stone-600 font-light text-lg leading-relaxed",children:"Accede a las fragancias ms deseadas del mundo en formatos de 5 y 10 ml. La forma inteligente de coleccionar aromas y descubrir tu nueva firma olfativa."}),M.jsxs("div",{className:"flex items-center space-x-2 text-stone-900 font-medium pt-2",children:[M.jsx(Xu,{size:20}),M.jsx("span",{children:"100% Originales"})]}),M.jsxs("button",{onClick:()=>e(bt.CATALOG),className:"inline-flex items-center text-stone-900 border-b border-stone-900 pb-1 hover:text-stone-600 hover:border-stone-600 transition mt-4",children:["Explorar Catlogo ",M.jsx(wv,{size:16,className:"ml-2"})]})]}),M.jsx("div",{className:"order-1 md:order-2",children:M.jsx("img",{src:"https://images.unsplash.com/photo-1615634260167-c8cdede054de?auto=format&fit=crop&q=80&w=800",alt:"Perfumes",className:"rounded-sm shadow-xl"})})]})})}),M.jsx(Eb,{}),M.jsx("div",{className:"bg-white py-4 text-center",children:M.jsxs("button",{onClick:()=>e(bt.ADMIN),className:"text-[10px] text-stone-300 hover:text-stone-500 flex items-center justify-center gap-1 mx-auto transition",children:[M.jsx(Ov,{size:10})," Admin"]})})]})}};return M.jsxs("div",{className:"min-h-screen flex flex-col bg-white",children:[M.jsx(Vv,{currentView:n,onChangeView:e}),M.jsx("main",{className:"flex-grow pt-16 md:pt-0",children:a()}),M.jsx(i2,{}),M.jsx(vb,{})]})};console.log("Iniciando aplicacin React...");const gx=document.getElementById("root");if(!gx)throw new Error("Could not find root element to mount to");try{mv.createRoot(gx).render(M.jsx(nn.StrictMode,{children:M.jsx(EN,{})})),console.log("Aplicacin montada correctamente.")}catch(n){console.error("Error al montar la aplicacin:",n);const e=document.getElementById("app-error");e&&(e.style.display="block",e.innerHTML="Error crtico al iniciar React: "+n.message)}
